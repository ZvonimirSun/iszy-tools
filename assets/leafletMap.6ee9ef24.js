import{_ as Y,j as A,r as S,aq as ee,H as oe,a8 as te,af as ae,bv as ne,o as i,L as w,M as _,b0 as re,k as n,c as y,w as p,a1 as M,a as u,F as L,au as se,T as E,b as C,bw as ie,U as pe,V as le,I as ce,B as ue,b1 as me}from"./index.5225add7.js";/* empty css              *//* empty css               */import{m as P,c as l}from"./marker-shadow.775f35fa.js";import{l as o}from"./leaflet-src.f3537682.js";import{F as de}from"./Form.3121af8c.js";import{_ as fe}from"./FormItem.2fec0685.js";import"./_arrayIncludesWith.91d14080.js";import"./_baseFindIndex.10ef1a58.js";import"./Col.6da9c2a9.js";import"./responsiveObserve.b8aa4967.js";import"./useFlexGapSupport.08dd27fd.js";import"./toArray.1be0410b.js";import"./get.af123360.js";import"./hasIn.47b3f0c3.js";import"./toInteger.b3f7ff85.js";import"./toFinite.f1c80f15.js";import"./collapseMotion.450b64d3.js";const V=b=>(pe("data-v-a6fbbd1c"),b=b(),le(),b),_e=V(()=>_("div",{class:"title"},[_("span",null,"\u5C5E\u6027")],-1)),ve={class:"content"},ge=V(()=>_("span",{class:"i-icon-park-outline-add-one"},null,-1)),he={class:"btn-container"},ye={__name:"leafletMap",props:{geoJsonLayer:{type:o.exports.GeoJSON,default:void 0}},emits:["update:geoJsonLayer","getMap","getControl"],setup(b,{emit:Z}){const m=b,J=new o.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-blue.png",shadowUrl:P,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),$=new o.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-yellow.png",shadowUrl:P,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),v="bed806b1ccb34b268ab1c0700123d444";let B,r;const g=A("$eventBus"),q=A("$msg"),a=S(void 0),G=S(),z=S(),d=ee({properties:[]}),R=t=>{t.properties.forEach(e=>{e.label&&e.value&&(a.value.properties[e.label]!=null?q.warn("\u5B57\u6BB5 [ "+e.label+" ] \u5B58\u5728\uFF0C\u5DF2\u8DF3\u8FC7"):a.value.properties[e.label]=isNaN(e.value)?e.value:parseFloat(e.value))}),I(),g.emit("updateEditor")};function H(){d.properties.push({label:"",value:"",id:Date.now()})}function I(){d.properties=[]}oe(()=>{g.on("locationGeo",U),g.on("updateGeojsonLayer",O),K(),te(()=>{Q(),W()})}),ae(()=>{g.off("locationGeo",U),g.off("updateGeojsonLayer",O),r&&(r.remove(),r=void 0)});function K(){r=ne(o.exports.map(G.value,{attributionControl:!0,zoomControl:!1})),Z("getMap",r),r.setView([35,105],4),Z("update:geoJsonLayer",o.exports.geoJSON(void 0,{onEachFeature:X,pointToLayer:(t,e)=>o.exports.marker(e,{icon:J})}).addTo(r))}function Q(){B=o.exports.control.layers({\u9AD8\u5FB7\u77E2\u91CF:l("GaoDe.Normal.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}).addTo(r),\u9AD8\u5FB7\u5F71\u50CF:o.exports.layerGroup([l("GaoDe.Satellite.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20}),l("GaoDe.Satellite.Annotation",{minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u77E2\u91CF:o.exports.layerGroup([l("TianDiTu.Normal.Map",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20}),l("TianDiTu.Normal.Annotation",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5F71\u50CF:o.exports.layerGroup([l("TianDiTu.Satellite.Map",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20}),l("TianDiTu.Satellite.Annotation",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5730\u5F62:o.exports.layerGroup([l("TianDiTu.Terrain.Map",{key:v,minZoom:3,maxNativeZoom:14,maxZoom:20}),l("TianDiTu.Terrain.Annotation",{key:v,minZoom:3,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),OpenStreetMap:l("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> \u8D21\u732E\u8005',minZoom:3,maxNativeZoom:19,maxZoom:20})},{\u56FE\u5F62:se(m.geoJsonLayer)},{hideSingleBase:!0,position:"bottomleft"}).addTo(r),Z("getControl",B)}function W(){o.exports.control.scale({imperial:!1,position:"bottomright"}).addTo(r),o.exports.control.zoom({zoomInTitle:"\u653E\u5927",zoomOutTitle:"\u7F29\u5C0F",position:"topright"}).addTo(r)}function X(t,e){t.properties||(t.properties={}),e.bindPopup(z.value).on("popupopen",()=>{a.value=t,e instanceof o.exports.Marker?e.setIcon($):e.setStyle({color:"#ffff00",weight:5,opacity:.65})}).on("popupclose",()=>{a.value=void 0,d.properties=[],e instanceof o.exports.Marker?e.setIcon(J):m.geoJsonLayer.resetStyle(e)})}function T(t,e,c){if(t instanceof InputEvent&&e&&c)try{e.properties[c]=JSON.parse(t.currentTarget.value)}catch{e.properties[c]=t.currentTarget.value}g.emit("updateEditor")}function U(t){try{const e=o.exports.geoJSON(t);r.fitBounds(e.getBounds())}catch{}}function O(t){if(m.geoJsonLayer&&m.geoJsonLayer instanceof o.exports.GeoJSON){m.geoJsonLayer.clearLayers();try{m.geoJsonLayer.addData(t),r.fitBounds(m.geoJsonLayer.getBounds())}catch(e){console.log(e)}}}return(t,e)=>{var j,F;const c=ce,h=fe,D=de,N=ue;return i(),w(L,null,[_("div",{ref_key:"mapContainer",ref:G,class:"map-container"},null,512),re(_("div",{ref_key:"propertyPopup",ref:z,class:"property-popup"},[_e,_("div",ve,[((j=n(a))==null?void 0:j.properties)&&Object.keys((F=n(a))==null?void 0:F.properties).length?(i(),y(D,{key:0,name:"selected-feature-form","label-col":{span:8},"wrapper-col":{span:16},colon:!1},{default:p(()=>[(i(!0),w(L,null,E(n(a).properties,(f,s,x)=>(i(),y(h,{key:"prop"+x,label:s},{default:p(()=>[typeof n(a).properties[s]=="string"?(i(),y(c,{key:0,value:n(a).properties[s],"onUpdate:value":k=>n(a).properties[s]=k,onChange:T},null,8,["value","onUpdate:value"])):typeof n(a).properties[s]=="number"?(i(),y(c,{key:1,value:n(a).properties[s],"onUpdate:value":k=>n(a).properties[s]=k,valueModifiers:{number:!0},onChange:T},null,8,["value","onUpdate:value"])):(i(),y(c,{key:2,value:JSON.stringify(f),onChange:k=>T(k,n(a),s)},null,8,["value","onChange"]))]),_:2},1032,["label"]))),128))]),_:1})):M("",!0),u(D,{name:"add-property-form",model:n(d),onFinish:R},{default:p(()=>[Object.keys(n(d).properties).length?(i(!0),w(L,{key:0},E(n(d).properties,(f,s)=>(i(),w("div",{key:f.id,class:"form-item-container"},[u(h,{name:["properties",s,"label"],rules:{required:!0,message:"\u5C5E\u6027\u540D\u79F0\u7F3A\u5931"}},{default:p(()=>[u(c,{value:f.label,"onUpdate:value":x=>f.label=x,placeholder:"\u5C5E\u6027\u540D\u79F0"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),u(h,{name:["properties",s,"value"],rules:{required:!0,message:"\u5C5E\u6027\u503C\u7F3A\u5931"}},{default:p(()=>[u(c,{value:f.value,"onUpdate:value":x=>f.value=x,placeholder:"\u5C5E\u6027\u503C"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]))),128)):M("",!0),u(h,null,{default:p(()=>[u(N,{type:"dashed",block:"",onClick:H},{default:p(()=>[ge,C("\u65B0\u589E\u5C5E\u6027 ")]),_:1})]),_:1}),Object.keys(n(d).properties).length?(i(),y(h,{key:1},{default:p(()=>[_("div",he,[u(N,{type:"primary","html-type":"submit"},{default:p(()=>[C(" \u786E\u8BA4 ")]),_:1}),u(N,{onClick:ie(I,["stop"])},{default:p(()=>[C(" \u53D6\u6D88 ")]),_:1},8,["onClick"])])]),_:1})):M("",!0)]),_:1},8,["model"])])],512),[[me,!1]])],64)}}},De=Y(ye,[["__scopeId","data-v-a6fbbd1c"]]);export{De as default};
