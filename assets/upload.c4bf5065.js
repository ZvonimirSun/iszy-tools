var f=Object.defineProperty,x=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var c=(t,e,s)=>e in t?f(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,a=(t,e)=>{for(var s in e||(e={}))w.call(e,s)&&c(t,s,e[s]);if(p)for(var s of p(e))v.call(e,s)&&c(t,s,e[s]);return t},d=(t,e)=>x(t,b(e));import{u as j}from"./index.51a44884.js";import{E as y,b2 as I,b3 as S,a as i,o as U,c as $,w as r,b as m,e as o,aw as R,p as C,h as D,g as l}from"./vendor.af973e49.js";/* empty css               *//* empty css                */import{_ as q}from"./index.e23c56d8.js";const{Dragger:F}=R,{mapGetters:L,mapState:O,mapActions:T}=y("imgHosting"),N={name:"upload",components:{Dragger:F,UploadOne:I,Spin:S},props:["activeKey"],data:()=>({spinning:!1,timeoutIndex:void 0}),computed:a(a({},L(["config"])),O(["uploader","commonConfig"])),mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:d(a({},T(["addImage"])),{async customRequest({file:t}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const e=t.name||"";t=new File([t],(new Date().getTime()+e.substring(e.lastIndexOf("."))).toLowerCase(),{type:t.type,lastModified:t.lastModified})}try{const e=await j[this.uploader].handle(this.config(this.uploader),t);if(this.addImage(e),this.commonConfig.copyUrlAfterUpload)try{await navigator.clipboard.writeText(e.url),this.$msg.success("\u4E0A\u4F20\u6210\u529F\uFF0C\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch{this.$msg.error("\u4E0A\u4F20\u6210\u529F\uFF0C\u4F46\u5730\u5740\u590D\u5236\u5931\u8D25")}else this.$msg.success("\u4E0A\u4F20\u6210\u529F")}catch(e){console.log(e),this.$msg.error("\u4E0A\u4F20\u5931\u8D25")}}else this.$msg.warn("\u8BF7\u5148\u8FDB\u884C\u8BBE\u7F6E");this.spinning=!1},rejectFile(){this.$msg.warning("\u4E0D\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B\uFF01")},paste(t){if(this.activeKey==="home"&&!this.spinning&&!this.timeoutIndex){this.timeoutIndex=setTimeout(()=>{this.timeoutIndex=void 0},500);const e=t.clipboardData&&t.clipboardData.items;let s;e&&e.length&&(e[0].type.indexOf("image")!==-1?(s=e[0].getAsFile(),this.customRequest({file:s})):this.rejectFile())}}})},u=t=>(C("data-v-98b36360"),t=t(),D(),t),A={class:"ant-upload-drag-icon"},B=u(()=>o("p",{class:"ant-upload-text"},[l("\u76F4\u63A5\u7C98\u8D34\u56FE\u7247\u6216\u62D6\u62FD\u56FE\u7247\u5230\u8FD9\u91CC\u4E0A\u4F20"),o("br"),l("\u6216\u8005\u76F4\u63A5\u70B9\u51FB\u9009\u62E9\u6587\u4EF6\u4E0A\u4F20")],-1)),E=u(()=>o("p",{class:"ant-upload-hint"}," \u6682\u65F6\u4EC5\u652F\u6301\u5355\u6587\u4EF6\u4E0A\u4F20\u3002 ",-1));function V(t,e,s,k,H,n){const g=i("UploadOne"),h=i("Dragger"),_=i("Spin");return U(),$(_,{spinning:t.spinning},{default:r(()=>[m(h,{fileList:[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp",onReject:n.rejectFile,showUploadList:!1,customRequest:n.customRequest},{default:r(()=>[o("p",A,[m(g)]),B,E]),_:1},8,["onReject","customRequest"])]),_:1},8,["spinning"])}var Q=q(N,[["render",V],["__scopeId","data-v-98b36360"]]);export{Q as default};
