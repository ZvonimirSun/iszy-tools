var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,r=(e,t)=>{for(var n in t||(t={}))i.call(t,n)&&o(e,n,t[n]);if(a)for(var n of a(t))s.call(t,n)&&o(e,n,t[n]);return e},p=(e,a)=>t(e,n(a));import{u as d}from"./index.18e8bfc5.js";import{E as c,b1 as m,b2 as g,a as l,o as f,c as u,w as h,b,e as j,au as v,p as w,h as y,g as O}from"./vendor.588f181b.js";/* empty css              *//* empty css              */import{_ as x}from"./index.fe943be2.js";var D=".container[data-v-5eb44f22] {\n  width: 100%;\n  height: 100%;\n}\n[data-v-5eb44f22] .ant-upload-drag-icon .i-icon {\n  font-size: 4.8rem;\n}\n.ant-spin-nested-loading[data-v-5eb44f22] {\n  height: 100% !important;\n}\n.ant-spin-nested-loading[data-v-5eb44f22] .ant-spin {\n  height: 100%;\n  max-height: unset;\n}\n.ant-spin-nested-loading[data-v-5eb44f22] .ant-spin-container {\n  height: 100%;\n}";const{Dragger:R}=v,{mapGetters:q,mapState:F,mapActions:I}=c("imgHosting"),L={name:"upload",components:{Dragger:R,UploadOne:m,Spin:g},data:()=>({spinning:!1}),computed:r(r({},q(["config"])),F(["uploader","commonConfig"])),mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:p(r({},I(["addImage"])),{async customRequest({file:e}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const t=e.name||"";e=new File([e],((new Date).getTime()+t.substring(t.lastIndexOf("."))).toLowerCase(),{type:e.type,lastModified:e.lastModified})}try{this.addImage(await d[this.uploader].handle(this.config(this.uploader),e)),this.$msg.success("上传成功"),this.$emit("success")}catch(t){this.$msg.error("上传失败")}}else this.$msg.warn("请先进行设置");this.spinning=!1},rejectFile(){this.$msg.warning("不支持的文件类型！")},paste(e){const t=e.clipboardData&&e.clipboardData.items;let n;t&&t.length&&(-1!==t[0].type.indexOf("image")?(n=t[0].getAsFile(),this.customRequest({file:n})):this.rejectFile())}})},P=e=>(w("data-v-5eb44f22"),e=e(),y(),e),S={class:"ant-upload-drag-icon"},$=P((()=>j("p",{class:"ant-upload-text"},[O("直接粘贴图片或拖拽图片到这里上传"),j("br"),O("或者直接点击选择文件上传")],-1))),_=P((()=>j("p",{class:"ant-upload-hint"}," 暂时仅支持单文件上传。 ",-1)));function E(e,t,n,a,i,s){const o=l("UploadOne"),r=l("Dragger"),p=l("Spin");return f(),u(p,{spinning:e.spinning},{default:h((()=>[b(r,{fileList:[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp",onReject:s.rejectFile,showUploadList:!1,customRequest:s.customRequest},{default:h((()=>[j("p",S,[b(o)]),$,_])),_:1},8,["onReject","customRequest"])])),_:1},8,["spinning"])}var U=x(L,[["render",E],["__scopeId","data-v-5eb44f22"]]);export{U as default};
