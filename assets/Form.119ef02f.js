import{f as S,H as Ee,aw as ye,ax as Ce,ay as Se,az as se,aA as qe,aB as Ae,K as we,k as te,aC as U,aD as ke,aE as Ie,S as G,O as B,aF as Re,av as Te,aG as de,aH as Pe,a8 as ee,d as Le,aa as We,P as ne,J as ce,e as _e,aI as Be,g as Ne,h as J,a as He,Y as fe,aJ as ae,M as xe}from"./index.6b075e9a.js";import{v as ze,d as Oe,_ as De,u as $e,c as ve,t as re,g as he,a as Ye}from"./FormItem.b9ef37ce.js";import{a as Ue,b as Xe}from"./_arrayIncludesWith.91d14080.js";import{d as Qe}from"./debounce.548054c3.js";var Ze=Symbol("SizeProvider"),Je=function(e){var t=e?S(function(){return e.size}):Ee(Ze,S(function(){return"default"}));return t};function je(r){var e=!1,t=r.length,u=[];return r.length?new Promise(function(n,i){r.forEach(function(d,y){d.catch(function(O){return e=!0,O}).then(function(O){t-=1,u[y]=O,!(t>0)&&(e&&i(u),n(u))})})}):Promise.resolve([])}function me(r){return typeof r=="object"&&r!=null&&r.nodeType===1}function ge(r,e){return(!e||r!=="hidden")&&r!=="visible"&&r!=="clip"}function ie(r,e){if(r.clientHeight<r.scrollHeight||r.clientWidth<r.scrollWidth){var t=getComputedStyle(r,null);return ge(t.overflowY,e)||ge(t.overflowX,e)||function(u){var n=function(i){if(!i.ownerDocument||!i.ownerDocument.defaultView)return null;try{return i.ownerDocument.defaultView.frameElement}catch{return null}}(u);return!!n&&(n.clientHeight<u.scrollHeight||n.clientWidth<u.scrollWidth)}(r)}return!1}function K(r,e,t,u,n,i,d,y){return i<r&&d>e||i>r&&d<e?0:i<=r&&y<=t||d>=e&&y>=t?i-r-u:d>e&&y<t||i<r&&y>t?d-e+n:0}function pe(r,e){var t=window,u=e.scrollMode,n=e.block,i=e.inline,d=e.boundary,y=e.skipOverflowHiddenElements,O=typeof d=="function"?d:function(Y){return Y!==d};if(!me(r))throw new TypeError("Invalid target");for(var q=document.scrollingElement||document.documentElement,j=[],F=r;me(F)&&O(F);){if((F=F.parentElement)===q){j.push(F);break}F!=null&&F===document.body&&ie(F)&&!ie(document.documentElement)||F!=null&&ie(F,y)&&j.push(F)}for(var A=t.visualViewport?t.visualViewport.width:innerWidth,M=t.visualViewport?t.visualViewport.height:innerHeight,V=window.scrollX||pageXOffset,I=window.scrollY||pageYOffset,N=r.getBoundingClientRect(),R=N.height,x=N.width,w=N.top,a=N.right,s=N.bottom,m=N.left,c=n==="start"||n==="nearest"?w:n==="end"?s:w+R/2,f=i==="center"?m+x/2:i==="end"?a:m,g=[],T=0;T<j.length;T++){var p=j[T],P=p.getBoundingClientRect(),z=P.height,L=P.width,D=P.top,E=P.right,o=P.bottom,l=P.left;if(u==="if-needed"&&w>=0&&m>=0&&s<=M&&a<=A&&w>=D&&s<=o&&m>=l&&a<=E)return g;var v=getComputedStyle(p),h=parseInt(v.borderLeftWidth,10),b=parseInt(v.borderTopWidth,10),k=parseInt(v.borderRightWidth,10),H=parseInt(v.borderBottomWidth,10),W=0,C=0,$="offsetWidth"in p?p.offsetWidth-p.clientWidth-h-k:0,_="offsetHeight"in p?p.offsetHeight-p.clientHeight-b-H:0;if(q===p)W=n==="start"?c:n==="end"?c-M:n==="nearest"?K(I,I+M,M,b,H,I+c,I+c+R,R):c-M/2,C=i==="start"?f:i==="center"?f-A/2:i==="end"?f-A:K(V,V+A,A,h,k,V+f,V+f+x,x),W=Math.max(0,W+I),C=Math.max(0,C+V);else{W=n==="start"?c-D-b:n==="end"?c-o+H+_:n==="nearest"?K(D,o,z,b,H+_,c,c+R,R):c-(D+z/2)+_/2,C=i==="start"?f-l-h:i==="center"?f-(l+L/2)+$/2:i==="end"?f-E+k+$:K(l,E,L,h,k+$,f,f+x,x);var X=p.scrollLeft,Q=p.scrollTop;c+=Q-(W=Math.max(0,Math.min(Q+W,p.scrollHeight-z+_))),f+=X-(C=Math.max(0,Math.min(X+C,p.scrollWidth-L+$)))}g.push({el:p,top:W,left:C})}return g}function Me(r){return r===Object(r)&&Object.keys(r).length!==0}function Ke(r,e){e===void 0&&(e="auto");var t="scrollBehavior"in document.body.style;r.forEach(function(u){var n=u.el,i=u.top,d=u.left;n.scroll&&t?n.scroll({top:i,left:d,behavior:e}):(n.scrollTop=i,n.scrollLeft=d)})}function Ge(r){return r===!1?{block:"end",inline:"nearest"}:Me(r)?r:{block:"start",inline:"nearest"}}function er(r,e){var t=r.isConnected||r.ownerDocument.documentElement.contains(r);if(Me(e)&&typeof e.behavior=="function")return e.behavior(t?pe(r,e):[]);if(!!t){var u=Ge(e);return Ke(pe(r,u),u.behavior)}}var rr=Math.min;function tr(r,e,t){for(var u=t?Ue:Xe,n=r[0].length,i=r.length,d=i,y=Array(i),O=1/0,q=[];d--;){var j=r[d];d&&e&&(j=ye(j,Ce(e))),O=rr(j.length,O),y[d]=!t&&(e||n>=120&&j.length>=120)?new Se(d&&j):void 0}j=r[0];var F=-1,A=y[0];e:for(;++F<n&&q.length<O;){var M=j[F],V=e?e(M):M;if(M=t||M!==0?M:0,!(A?se(A,V):u(q,V,t))){for(d=i;--d;){var I=y[d];if(!(I?se(I,V):u(r[d],V,t)))continue e}A&&A.push(V),q.push(M)}}return q}function nr(r){return qe(r)?r:[]}var ar=Ae(function(r){var e=ye(r,nr);return e.length&&e[0]===r[0]?tr(e):[]}),ir=ar;function Fe(r){var e=!1;return r&&r.length&&r.every(function(t){return t.required?(e=!0,!1):!0}),e}function be(r){return r==null?[]:Array.isArray(r)?r:[r]}function le(r,e,t){var u=r;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var n=e.split("."),i=0,d=n.length;i<d-1&&!(!u&&!t);++i){var y=n[i];if(y in u)u=u[y];else{if(t)throw new Error("please transfer a valid name path to validate!");break}}return{o:u,k:n[i],v:u?u[n[i]]:null,isValid:u&&n[i]in u}}function lr(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:we({}),t=arguments.length>2?arguments[2]:void 0,u=te(U(r)),n=ke({}),i=Ie([]),d=function(a){B(U(r),B(B({},te(u)),a)),Te(function(){Object.keys(n).forEach(function(s){n[s]={autoLink:!1,required:Fe(U(e)[s])}})})},y=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],s=arguments.length>1?arguments[1]:void 0;return s.length?a.filter(function(m){var c=be(m.trigger||"change");return ir(c,s).length}):a},O=null,q=function(a){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=arguments.length>2?arguments[2]:void 0,c=[],f={},g=function(D){var E=a[D],o=le(U(r),E,m);if(!o.isValid)return"continue";f[E]=o.v;var l=y(U(e)[E],be(s&&s.trigger));l.length&&c.push(j(E,o.v,l,s||{}).then(function(){return{name:E,errors:[],warnings:[]}}).catch(function(v){var h=[],b=[];return v.forEach(function(k){var H=k.rule.warningOnly,W=k.errors;H?b.push.apply(b,ee(W)):h.push.apply(h,ee(W))}),h.length?Promise.reject({name:E,errors:h,warnings:b}):{name:E,errors:h,warnings:b}}))},T=0;T<a.length;T++)var p=g(T);var P=je(c);O=P;var z=P.then(function(){return O===P?Promise.resolve(f):Promise.reject([])}).catch(function(L){var D=L.filter(function(E){return E&&E.errors.length});return Promise.reject({values:f,errorFields:D,outOfDate:O!==P})});return z.catch(function(L){return L}),z},j=function(a,s,m){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},f=ze([a],s,m,B({validateMessages:Oe},c),!!c.validateFirst);return n[a]?(n[a].validateStatus="validating",f.catch(function(g){return g}).then(function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],T;if(n[a].validateStatus==="validating"){var p=g.filter(function(P){return P&&P.errors.length});n[a].validateStatus=p.length?"error":"success",n[a].help=p.length?p.map(function(P){return P.errors}):null,(T=t==null?void 0:t.onValidate)===null||T===void 0||T.call(t,a,!p.length,p.length?de(n[a].help[0]):null)}}),f):f.catch(function(g){return g})},F=function(a,s){var m=[],c=!0;a?Array.isArray(a)?m=a:m=[a]:(c=!1,m=i.value);var f=q(m,s||{},c);return f.catch(function(g){return g}),f},A=function(a){var s=[];a?Array.isArray(a)?s=a:s=[a]:s=i.value,s.forEach(function(m){n[m]&&B(n[m],{validateStatus:"",help:null})})},M=function(a){for(var s={autoLink:!1},m=[],c=Array.isArray(a)?a:[a],f=0;f<c.length;f++){var g=c[f];(g==null?void 0:g.validateStatus)==="error"&&(s.validateStatus="error",g.help&&m.push(g.help)),s.required=s.required||(g==null?void 0:g.required)}return s.help=m,s},V=u,I=!0,N=function(a){var s=[];i.value.forEach(function(m){var c=le(a,m,!1),f=le(V,m,!1),g=I&&(t==null?void 0:t.immediate)&&c.isValid;(g||!Pe(c.v,f.v))&&s.push(m)}),F(s,{trigger:"change"}),I=!1,V=te(de(a))},R=t==null?void 0:t.debounce,x=!0;return G(e,function(){i.value=e?Object.keys(U(e)):[],!x&&t&&t.validateOnRuleChange&&F(),x=!1},{deep:!0,immediate:!0}),G(i,function(){var w={};i.value.forEach(function(s){w[s]=B({},n[s],{autoLink:!1,required:Fe(U(e)[s])}),delete n[s]});for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&delete n[a];B(n,w)},{immediate:!0}),G(r,R&&R.wait?Qe(N,R.wait,Re(R,["wait"])):N,{immediate:t&&!!t.immediate,deep:!0}),{modelRef:r,rulesRef:e,initialModel:u,validateInfos:n,resetFields:d,validate:F,validateField:j,mergeValidateInfo:M,clearValidate:A}}var ur=function(){return{layout:ne.oneOf(ce("horizontal","inline","vertical")),labelCol:{type:Object},wrapperCol:{type:Object},colon:{type:Boolean,default:void 0},labelAlign:ne.oneOf(ce("left","right")),labelWrap:{type:Boolean,default:void 0},prefixCls:String,requiredMark:{type:[String,Boolean],default:void 0},hideRequiredMark:{type:Boolean,default:void 0},model:ne.object,rules:{type:Object},validateMessages:{type:Object,default:void 0},validateOnRuleChange:{type:Boolean,default:void 0},scrollToFirstError:{type:[Boolean,Object]},onSubmit:Function,name:String,validateTrigger:{type:[String,Array]},size:{type:String},onValuesChange:{type:Function},onFieldsChange:{type:Function},onFinish:{type:Function},onFinishFailed:{type:Function},onValidate:{type:Function}}};function or(r,e){return Pe(re(r),re(e))}var sr=Le({name:"AForm",inheritAttrs:!1,props:We(ur(),{layout:"horizontal",hideRequiredMark:!1,colon:!0}),Item:De,useForm:lr,setup:function(e,t){var u=t.emit,n=t.slots,i=t.expose,d=t.attrs,y=Je(e),O=_e("form",e),q=O.prefixCls,j=O.direction,F=O.form,A=S(function(){return e.requiredMark===""||e.requiredMark}),M=S(function(){var o;return A.value!==void 0?A.value:F&&((o=F.value)===null||o===void 0?void 0:o.requiredMark)!==void 0?F.value.requiredMark:!e.hideRequiredMark}),V=S(function(){var o,l;return(o=e.colon)!==null&&o!==void 0?o:(l=F.value)===null||l===void 0?void 0:l.colon}),I=Be(),N=I.validateMessages,R=S(function(){return B(B(B({},Oe),N.value),e.validateMessages)}),x=S(function(){var o;return Ne(q.value,(o={},J(o,"".concat(q.value,"-").concat(e.layout),!0),J(o,"".concat(q.value,"-hide-required-mark"),M.value===!1),J(o,"".concat(q.value,"-rtl"),j.value==="rtl"),J(o,"".concat(q.value,"-").concat(y.value),y.value),o))}),w=we(),a={},s=function(l,v){a[l]=v},m=function(l){delete a[l]},c=function(l){var v=!!l,h=v?re(l).map(he):[];return v?Object.values(a).filter(function(b){return h.findIndex(function(k){return or(k,b.fieldName.value)})>-1}):Object.values(a)},f=function(l){if(!e.model){ae(!1,"Form","model is required for resetFields to work.");return}c(l).forEach(function(v){v.resetField()})},g=function(l){c(l).forEach(function(v){v.clearValidate()})},T=function(l){var v=e.scrollToFirstError;if(u("finishFailed",l),v&&l.errorFields.length){var h={};xe(v)==="object"&&(h=v),P(l.errorFields[0].name,h)}},p=function(){return D.apply(void 0,arguments)},P=function(l){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=c(l?[l]:void 0);if(h.length){var b=h[0].fieldId.value,k=b?document.getElementById(b):null;k&&er(k,B({scrollMode:"if-needed",block:"nearest"},v))}},z=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(l===!0){var v=[];return Object.values(a).forEach(function(h){var b=h.namePath;v.push(b.value)}),ve(e.model,v)}else return ve(e.model,l)},L=function(l,v){if(ae(!(l instanceof Function),"Form","validateFields/validateField/validate not support callback, please use promise instead"),!e.model)return ae(!1,"Form","model is required for validateFields to work."),Promise.reject("Form `model` is required for validateFields to work.");var h=!!l,b=h?re(l).map(he):[],k=[];Object.values(a).forEach(function(C){var $;if(h||b.push(C.namePath.value),!!(!(($=C.rules)===null||$===void 0)&&$.value.length)){var _=C.namePath.value;if(!h||Ye(b,_)){var X=C.validateRules(B({validateMessages:R.value},v));k.push(X.then(function(){return{name:_,errors:[],warnings:[]}}).catch(function(Q){var Y=[],Z=[];return Q.forEach(function(ue){var Ve=ue.rule.warningOnly,oe=ue.errors;Ve?Z.push.apply(Z,ee(oe)):Y.push.apply(Y,ee(oe))}),Y.length?Promise.reject({name:_,errors:Y,warnings:Z}):{name:_,errors:Y,warnings:Z}}))}}});var H=je(k);w.value=H;var W=H.then(function(){return w.value===H?Promise.resolve(z(b)):Promise.reject([])}).catch(function(C){var $=C.filter(function(_){return _&&_.errors.length});return Promise.reject({values:z(b),errorFields:$,outOfDate:w.value!==H})});return W.catch(function(C){return C}),W},D=function(){return L.apply(void 0,arguments)},E=function(l){if(l.preventDefault(),l.stopPropagation(),u("submit",l),e.model){var v=L();v.then(function(h){u("finish",h)}).catch(function(h){T(h)})}};return i({resetFields:f,clearValidate:g,validateFields:L,getFieldsValue:z,validate:p,scrollToField:P}),$e({model:S(function(){return e.model}),name:S(function(){return e.name}),labelAlign:S(function(){return e.labelAlign}),labelCol:S(function(){return e.labelCol}),labelWrap:S(function(){return e.labelWrap}),wrapperCol:S(function(){return e.wrapperCol}),vertical:S(function(){return e.layout==="vertical"}),colon:V,requiredMark:M,validateTrigger:S(function(){return e.validateTrigger}),rules:S(function(){return e.rules}),addField:s,removeField:m,onValidate:function(l,v,h){u("validate",l,v,h)},validateMessages:R}),G(function(){return e.rules},function(){e.validateOnRuleChange&&L()}),function(){var o;return He("form",fe(fe({},d),{},{onSubmit:E,class:[x.value,d.class]}),[(o=n.default)===null||o===void 0?void 0:o.call(n)])}}}),hr=sr;export{hr as F};
