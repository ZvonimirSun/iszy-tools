import{K as ue,z as pe,H as me}from"./common-pBJ5SvZ2.js";import{j as fe,B as j,k as S,bM as M,b as a,bN as R,aC as E,W as f,by as K,F as P,l as _e,a3 as s,a8 as d,o as k,c as w,y as l,a as i,e as ve,t as C,aA as n,X as z,i as he,bi as be,bO as ye,bn as ge,bo as je,aB as ke,aN as we,aO as Ve,aH as De,ba as $e,bb as Ee,bA as Ce,aI as Be,aJ as Ie,ad as xe}from"./vendor-P7BCdu4M.js";import{C as F}from"./mock-df_mxL_w.js";import"./ant-design-vue-r1_T4oPT.js";import"./vanilla-jsoneditor-qva85DqO.js";const y=_=>(Be("data-v-3cca9bf9"),_=_(),Ie(),_),Pe={key:0,class:"prj-wrapper"},Fe={"w-full":"",class:"prj-list"},Oe={class:"prj-title"},Te={class:"prj-path"},Ue={class:"prj-desc"},Ae={class:"prj-control"},Se=["onClick"],Me=y(()=>i("i",{class:"i-icon-park-outline-preview-open"},null,-1)),Re=[Me],Ke=["onClick"],ze=y(()=>i("i",{class:"i-icon-park-outline-edit-two"},null,-1)),He=[ze],Ne=y(()=>i("div",{class:"prj-control-btn prj-btn-delete"},[i("i",{class:"i-icon-park-outline-delete"})],-1)),qe=y(()=>i("i",{class:"i-icon-park-outline-plus"},null,-1)),Le=[qe],Ye={key:1,class:"prj-detail"},Ge={class:"prj-meta-wrapper"},Je={class:"prj-meta"},We=y(()=>i("div",{class:"prj-meta-name"}," 接口根地址 ",-1)),Xe={class:"prj-meta"},Qe=y(()=>i("div",{class:"prj-meta-name"}," 项目ID ",-1)),Ze={class:"prj-data-control"},et={class:"prj-data-wrapper"},tt={class:"dialog-footer"},at={class:"edit-data-wrapper"},lt={class:"dialog-footer"};function ot(_){return typeof _=="function"||Object.prototype.toString.call(_)==="[object Object]"&&!he(_)}const st=fe({__name:"mock",setup(_){const B=j([]),c=j(null),I=j([]),v=j(!1),h=j(!1),u=S({id:"",name:"",path:"",description:""}),r=S({id:-1,name:"",type:"get",enabled:!0,path:"",description:"",delay:0,response:"",projectId:""}),H=[{title:"名称",key:"name",dataKey:"name",width:300,fixed:M.LEFT},{title:"请求类型",key:"type",dataKey:"type",width:100,align:"center",cellRenderer:({cellData:e})=>a(R,null,ot(e)?e:{default:()=>[e]})},{title:"请求状态",key:"enabled",dataKey:"enabled",width:100,align:"center",cellRenderer:({cellData:e})=>a(R,{type:"success"},{default:()=>[e?"开启":"关闭"]})},{title:"接口地址",key:"path",dataKey:"path",width:300,cellRenderer:({cellData:e})=>a(F,{val:e},null)},{title:"接口描述",key:"description",dataKey:"description",width:300},{title:"创建时间",key:"createdAt",dataKey:"createdAt",width:200},{title:"操作",key:"operations",fixed:M.RIGHT,cellRenderer:({rowData:e})=>a(P,null,[a(E,{size:"small",onClick:()=>oe(e.url??"")},{default:()=>[f("复制")]}),a(E,{size:"small",onClick:()=>X(e)},{default:()=>[f("编辑")]}),a(K,{title:"确认要删除该数据吗？删除后无法恢复！",onConfirm:()=>ae(e)},{reference:()=>a(E,{size:"small",type:"danger"},{default:()=>[f("删除")]})})]),width:200,align:"center"}];_e(async()=>{await V();const e=ue("prjId");if(e){const t=B.value.find(p=>p.id===e);t&&O(t)}});function N(){Object.assign(u,{id:"",name:"",path:"",description:""}),v.value=!0}function q(e){Object.assign(u,{id:e.id??"",name:e.name,path:e.path,description:e.description??""}),v.value=!0}function L(e){e.id?G(e):Y(e)}function Y(e){s.post(`${s.$apiBase}/mock/api/prj`,{...e,id:void 0}).then(s.getData).then(t=>{t.success?(d.success("创建项目成功"),V(),v.value=!1):d.error("创建项目失败")})}function G(e){s.put(`${s.$apiBase}/mock/api/prj/${e.id}`,e).then(s.getData).then(t=>{t.success?(d.success("修改项目成功"),V(),v.value=!1):d.error("修改项目失败")})}async function J(e){try{(await s.delete(`${s.$apiBase}/mock/api/prj/${e.id}`).then(s.getData)).success?(d.success("删除项目成功"),await V()):d.error("删除项目失败")}catch{d.error("删除项目失败")}}async function V(){try{const e=await s.get(`${s.$apiBase}/mock/api/prj/list`).then(s.getData);e.success?B.value=e.data||[]:d.error("获取项目列表失败")}catch{d.error("获取项目列表失败")}}function D(e){s.get(`${s.$apiBase}/mock/api/prj/${e.id}/list`).then(s.getData).then(t=>{t.success?I.value=(t.data||[]).map(p=>(p.createdAt=be(p.createdAt).format("YYYY-MM-DD HH:mm:ss"),p.url=`${s.$apiBase}/mock/${e.id}${e.path}${p.path}`,p)):d.error("获取接口列表失败")})}function O(e){c.value=e,pe("prjId",e.id),D(e)}function W(){Object.assign(r,{id:-1,name:"",type:"get",enabled:!0,path:"",description:"",delay:0,response:"",projectId:""}),h.value=!0}function X(e){Object.assign(r,{id:e.id,name:e.name,type:e.type,enabled:e.enabled,path:e.path,description:e.description,delay:e.delay,response:e.response,projectId:e.projectId}),h.value=!0}function Q(e){r.response=e}function Z(e){e.id>-1?ee(e):te(e)}async function ee(e){try{(await s.put(`${s.$apiBase}/mock/api/data/${e.id}`,{...e,id:void 0,projectId:void 0}).then(s.getData)).success?(d.success("修改数据成功"),D(c.value),h.value=!1):d.error("修改数据失败")}catch{d.error("修改数据失败")}}async function te(e){var t;try{(await s.post(`${s.$apiBase}/mock/api/data`,{...e,id:void 0,projectId:(t=c.value)==null?void 0:t.id}).then(s.getData)).success?(d.success("创建数据成功"),D(c.value),h.value=!1):d.error("创建数据失败")}catch{d.error("创建数据失败")}}async function ae(e){try{(await s.delete(`${s.$apiBase}/mock/api/data/${e.id}`).then(s.getData)).success?(d.success("删除数据成功"),D(c.value)):d.error("删除数据失败")}catch{d.error("删除数据失败")}}function le(){c.value=null,I.value=[]}async function oe(e){try{await navigator.clipboard.writeText(e),d.success("复制成功")}catch{d.error("复制失败")}}return(e,t)=>{const p=K,se=ye,g=E,ne=ge,ie=je,b=ke,m=we,T=Ve,U=De,$=$e,de=Ee,re=Ce,ce=me;return k(),w(P,null,[l(c)?(k(),w("div",Ye,[a(se,{onBack:le},{content:n(()=>[f(C(l(c).name),1)]),_:1}),i("div",Ge,[i("div",Je,[We,a(F,{val:l(s).$apiBase+"/mock/"+l(c).id+l(c).path,class:"prj-meta-content"},null,8,["val"])]),i("div",Xe,[Qe,a(F,{val:l(c).id,class:"prj-meta-content"},null,8,["val"])])]),i("div",Ze,[a(g,{type:"primary",onClick:W},{default:n(()=>[f(" 新增接口 ")]),_:1})]),i("div",et,[a(ie,null,{default:n(({height:o,width:x})=>[a(ne,{columns:H,data:l(I),width:x,height:o,fixed:""},null,8,["data","width","height"])]),_:1})])])):(k(),w("div",Pe,[i("div",Fe,[(k(!0),w(P,null,ve(l(B),(o,x)=>(k(),w("div",{key:x,class:"prj-item"},[i("div",Oe,C(o.name),1),i("div",Te,C(o.path),1),i("div",Ue,C(o.description),1),i("div",Ae,[i("div",{class:"prj-control-btn prj-btn-open",onClick:A=>O(o)},Re,8,Se),i("div",{class:"prj-control-btn prj-btn-edit",onClick:A=>q(o)},He,8,Ke),a(p,{title:"确认要删除该项目吗？删除后无法恢复！",onConfirm:A=>J(o)},{reference:n(()=>[Ne]),_:2},1032,["onConfirm"])])]))),128)),i("div",{class:"prj-add",onClick:N},Le)])])),a(U,{modelValue:l(v),"onUpdate:modelValue":t[5]||(t[5]=o=>z(v)?v.value=o:null),title:l(u).id?"修改项目":"添加项目"},{footer:n(()=>[i("span",tt,[a(g,{onClick:t[3]||(t[3]=o=>v.value=!1)},{default:n(()=>[f("取消")]),_:1}),a(g,{type:"primary",onClick:t[4]||(t[4]=o=>L(l(u)))},{default:n(()=>[f(" 提交 ")]),_:1})])]),default:n(()=>[a(T,{model:l(u)},{default:n(()=>[a(m,{label:"项目名称","label-width":120,required:!0},{default:n(()=>[a(b,{modelValue:l(u).name,"onUpdate:modelValue":t[0]||(t[0]=o=>l(u).name=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(m,{label:"接口基础路径","label-width":120,required:!0},{default:n(()=>[a(b,{modelValue:l(u).path,"onUpdate:modelValue":t[1]||(t[1]=o=>l(u).path=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(m,{label:"项目描述","label-width":120},{default:n(()=>[a(b,{modelValue:l(u).description,"onUpdate:modelValue":t[2]||(t[2]=o=>l(u).description=o),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),a(U,{modelValue:l(h),"onUpdate:modelValue":t[14]||(t[14]=o=>z(h)?h.value=o:null),fullscreen:"",title:l(r).id>-1?"修改接口":"添加接口","destroy-on-close":""},{footer:n(()=>[i("span",lt,[a(g,{onClick:t[12]||(t[12]=o=>h.value=!1)},{default:n(()=>[f("取消")]),_:1}),a(g,{type:"primary",onClick:t[13]||(t[13]=o=>Z(l(r)))},{default:n(()=>[f(" 提交 ")]),_:1})])]),default:n(()=>[i("div",at,[a(T,{model:l(r),class:"edit-data-form"},{default:n(()=>[a(m,{label:"接口名","label-width":120,required:!0},{default:n(()=>[a(b,{modelValue:l(r).name,"onUpdate:modelValue":t[6]||(t[6]=o=>l(r).name=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(m,{label:"类型(method)","label-width":120,required:!0},{default:n(()=>[a(de,{modelValue:l(r).type,"onUpdate:modelValue":t[7]||(t[7]=o=>l(r).type=o)},{default:n(()=>[a($,{label:"GET",value:"get"}),a($,{label:"POST",value:"post"}),a($,{label:"DELETE",value:"delete"}),a($,{label:"PUT",value:"put"})]),_:1},8,["modelValue"])]),_:1}),a(m,{label:"返回延时(单位毫秒)","label-width":120},{default:n(()=>[a(b,{modelValue:l(r).delay,"onUpdate:modelValue":t[8]||(t[8]=o=>l(r).delay=o),modelModifiers:{number:!0},autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(m,{label:"接口","label-width":120,required:!0},{default:n(()=>[a(b,{modelValue:l(r).path,"onUpdate:modelValue":t[9]||(t[9]=o=>l(r).path=o),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(m,{label:"接口描述","label-width":120},{default:n(()=>[a(b,{modelValue:l(r).description,"onUpdate:modelValue":t[10]||(t[10]=o=>l(r).description=o),type:"textarea",autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(m,{label:"接口状态","label-width":120},{default:n(()=>[a(re,{modelValue:l(r).enabled,"onUpdate:modelValue":t[11]||(t[11]=o=>l(r).enabled=o),"inline-prompt":"","active-text":"开","inactive-text":"关"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a(ce,{class:"edit-data-json",config:{mode:"text"},content:l(r).response,onChange:Q},null,8,["content"])])]),_:1},8,["modelValue","title"])],64)}}}),ut=xe(st,[["__scopeId","data-v-3cca9bf9"]]);export{ut as default};
