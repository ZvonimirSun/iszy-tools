import{_ as j,a as v}from"./index.f44d3f6b.js";import{l as t,m as b,c as a}from"./marker-shadow.747f3308.js";import{J as O}from"./jsoneditor.min.f83722ad.js";import{d as A,a2 as _,a3 as T,_ as k,$ as E,a9 as J,aN as G,a as s,o as i,c as l,w as p,e as c,J as M,f as P,Q as D,P as z,O as B,b as m,ag as U}from"./vendor.a1d008c9.js";/* empty css               *//* empty css               *//* empty css              */import{C as V}from"./vue-codemirror.c53b1c48.js";const{TabPane:$}=T,{Item:R}=k,w=new t.exports.Icon({iconUrl:"https://cdn.jsdelivr.net/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-blue.png",shadowUrl:b,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Q=new t.exports.Icon({iconUrl:"https://cdn.jsdelivr.net/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-yellow.png",shadowUrl:b,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),q=A({name:"geoJson",components:{PropertyTable:_(()=>v(()=>import("./propertyTable.8b3301e9.js"),["assets/propertyTable.8b3301e9.js","assets/index.eb531402.css","assets/index.28f6fdd0.css","assets/index.a361a67d.css","assets/index.414482b4.css","assets/index.e2b8fdb7.css","assets/index.74580095.css","assets/index.4ca0d3d7.css","assets/index.5580ceba.css","assets/vendor.a1d008c9.js","assets/vendor.6b12421d.css","assets/marker-shadow.747f3308.js","assets/marker-shadow.1e6cfa9a.css","assets/index.f44d3f6b.js","assets/index.5843569a.css"])),AddService:_(()=>v(()=>import("./addService.073b7128.js"),["assets/addService.073b7128.js","assets/addService.ccbaaff5.css","assets/index.d5ecd051.css","assets/index.ccc15a38.css","assets/index.5580ceba.css","assets/index.28f6fdd0.css","assets/marker-shadow.747f3308.js","assets/marker-shadow.1e6cfa9a.css","assets/vendor.a1d008c9.js","assets/vendor.6b12421d.css","assets/index.f44d3f6b.js","assets/index.5843569a.css"])),Container:V,Tabs:T,TabPane:$,Form:k,Item:R,Input:E},data:()=>({map:void 0,editor:void 0,geoJson:{type:"FeatureCollection",features:[]},geoJsonLayer:void 0,selectedFeature:void 0,tdtToken:"bed806b1ccb34b268ab1c0700123d444",gaodeToken:"868d6830a7409520ae283cde3a3f84d1",layerControl:void 0}),computed:{tableColumns(){if(this.propertyList&&this.propertyList.length>0){const o=Object.keys(this.propertyList[0]).map(n=>({title:n,dataIndex:n,key:n,slots:{customRender:"property"}}));return o.push({title:"\u64CD\u4F5C",dataIndex:"operation",width:40,fixed:"right",slots:{customRender:"operation"}}),o}else return null},propertyList(){return this.features?this.features.map(e=>e.properties):null},features(){if(this.geoJsonLayer)try{return this.geoJsonLayer.toGeoJSON().features}catch(e){return null}return null}},mounted(){this.editor=J(new O(this.$refs.geoJsonContainer,{mode:"code",onChangeText:this.updateGeoJsonLayer},this.geoJson)),this.initMap()},methods:{initMap(){this.map=J(t.exports.map(this.$refs.mapContainer,{attributionControl:!0,zoomControl:!1})),this.map.setView([35,105],4),this.geoJsonLayer=t.exports.geoJSON(void 0,{onEachFeature:this.onEachFeature,pointToLayer:(e,o)=>t.exports.marker(o,{icon:w})}).addTo(this.map),this.layerControl=t.exports.control.layers({\u9AD8\u5FB7\u77E2\u91CF:a("GaoDe.Normal.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}).addTo(this.map),\u9AD8\u5FB7\u5F71\u50CF:t.exports.layerGroup([a("GaoDe.Satellite.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20}),a("GaoDe.Satellite.Annotation",{minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u77E2\u91CF:t.exports.layerGroup([a("TianDiTu.Normal.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20}),a("TianDiTu.Normal.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5F71\u50CF:t.exports.layerGroup([a("TianDiTu.Satellite.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20}),a("TianDiTu.Satellite.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5730\u5F62:t.exports.layerGroup([a("TianDiTu.Terrain.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:14,maxZoom:20}),a("TianDiTu.Terrain.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),OpenStreetMap:a("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> \u8D21\u732E\u8005'})},{\u56FE\u5F62:G(this.geoJsonLayer)},{hideSingleBase:!0,position:"topright"}).addTo(this.map),t.exports.control.scale({imperial:!1,position:"bottomleft"}).addTo(this.map),t.exports.control.zoom({zoomInTitle:"\u653E\u5927",zoomOutTitle:"\u7F29\u5C0F",position:"bottomright"}).addTo(this.map)},updateGeoJsonLayer(){try{if(this.geoJson=this.editor.get(),this.geoJsonLayer&&this.geoJsonLayer instanceof t.exports.GeoJSON){this.geoJsonLayer.clearLayers(),this.geoJsonLayer.addData(this.geoJson);const e=this.geoJsonLayer.getBounds(),o=e.getCenter(),n=this.map.getBoundsZoom(e);this.map.setView(o,n)}}catch(e){}},locationGeo(e){try{const n=t.exports.geoJSON(e).getBounds(),f=n.getCenter(),g=this.map.getBoundsZoom(n);this.map.setView(f,g)}catch(o){}},onEachFeature(e,o){e.properties&&o.bindPopup(this.$refs.propertyPopup).on("popupopen",()=>{this.selectedFeature=e,o instanceof t.exports.Marker?o.setIcon(Q):o.setStyle({color:"#ffff00",weight:5,opacity:.65})}).on("popupclose",()=>{this.selectedFeature=void 0,o instanceof t.exports.Marker?o.setIcon(w):this.geoJsonLayer.resetStyle(o)})},saveToEditor(){this.geoJson=this.geoJsonLayer.toGeoJSON(),this.editor.update(this.geoJson)}},beforeUnmount(){this.map&&(this.map.remove(),this.map=void 0),this.editor&&(this.editor.destroy(),this.editor=void 0)}}),H={class:"container"},K={class:"mapContainer",ref:"mapContainer"},W={class:"propertyPopup",ref:"propertyPopup"},X={class:"geoJsonContainer",ref:"geoJsonContainer"};function Y(e,o,n,f,g,ee){const u=s("Input"),x=s("Item"),C=s("Form"),h=s("TabPane"),S=s("PropertyTable"),Z=s("AddService"),L=s("Tabs"),N=s("container");return i(),l(N,null,{default:p(()=>{var y;return[c("div",H,[c("div",K,null,512),M(c("div",W,[((y=e.selectedFeature)==null?void 0:y.properties)?(i(),l(C,{key:0,"label-col":{span:6},"wrapper-col":{span:18},colon:!1},{default:p(()=>[(i(!0),P(z,null,D(e.selectedFeature.properties,(F,r,I)=>(i(),l(x,{label:r,key:"prop"+I},{default:p(()=>[typeof e.selectedFeature.properties[r]=="string"?(i(),l(u,{key:0,value:e.selectedFeature.properties[r],"onUpdate:value":d=>e.selectedFeature.properties[r]=d,onChange:e.saveToEditor},null,8,["value","onUpdate:value","onChange"])):typeof e.selectedFeature.properties[r]=="number"?(i(),l(u,{key:1,value:e.selectedFeature.properties[r],"onUpdate:value":d=>e.selectedFeature.properties[r]=d,valueModifiers:{number:!0},onChange:e.saveToEditor},null,8,["value","onUpdate:value","onChange"])):(i(),l(u,{key:2,value:JSON.stringify(F),onChange:d=>e.saveToEditor(d,e.selectedFeature,r)},null,8,["value","onChange"]))]),_:2},1032,["label"]))),128))]),_:1})):B("",!0)],512),[[U,!1]]),m(L,{type:"card"},{default:p(()=>[m(h,{key:"geoJson",tab:"GeoJSON"},{default:p(()=>[c("div",X,null,512)]),_:1}),m(h,{key:"table",tab:"\u8868\u683C"},{default:p(()=>[m(S,{map:e.map,"geo-json-layer":e.geoJsonLayer,onChange:e.saveToEditor},null,8,["map","geo-json-layer","onChange"])]),_:1}),m(h,{key:"addService",tab:"\u6DFB\u52A0\u670D\u52A1"},{default:p(()=>[m(Z,{"layer-control":e.layerControl,map:e.map},null,8,["layer-control","map"])]),_:1})]),_:1})])]}),_:1})}var le=j(q,[["render",Y],["__scopeId","data-v-158115e4"]]);export{le as default};
