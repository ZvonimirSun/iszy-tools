import{n as De,v as Fe,d as fe,e as Be,r as c,aD as Z,g as Ae,h as I,a as t,a7 as ke,K as we,D as Re,af as Se,ah as q,ai as J,s as ve,ag as Te,P as H,C as xe,cz as Oe,i as Ie,E as Ue,cA as Me,cB as Ne,cC as Ve,cD as Le,f as oe,k as e,o as D,L as ee,M as r,bm as T,w as s,b as F,c as K,F as ue,bl as ae,l as W,$ as pe,B as Pe,N as $e,ch as je,_ as He}from"./index.ae07ae9c.js";/* empty css              *//* empty css               */import{_ as Ke}from"./index.ef1889e2.js";/* empty css               */import{_ as We,F as ze}from"./Form.2526de11.js";import"./toArray.88a764c0.js";import"./Overflow.5a2648a8.js";import"./isMobile.481c1aec.js";import"./useState.135b03d5.js";import"./DownOutlined.c4b0fb07.js";import"./SearchOutlined.ee8a16e3.js";import"./Col.e66b75c0.js";import"./responsiveObserve.ee522443.js";import"./useFlexGapSupport.2c8ccc1e.js";import"./get.c61b3778.js";import"./_baseGet.2820b254.js";import"./toString.91d5579e.js";import"./_arrayMap.dc1f124f.js";import"./_flatRest.6a791d79.js";import"./toInteger.64c43e44.js";import"./toFinite.c10c9a20.js";import"./_arrayIncludesWith.40afec22.js";import"./collapseMotion.8c55a50b.js";var Ge={success:xe,info:Oe,error:Ie,warning:Ue},qe={success:Me,info:Ne,error:Ve,warning:Le},Je=Fe("success","info","warning","error"),Qe=function(){return{type:H.oneOf(Je),closable:{type:Boolean,default:void 0},closeText:H.any,message:H.any,description:H.any,afterClose:Function,showIcon:{type:Boolean,default:void 0},prefixCls:String,banner:{type:Boolean,default:void 0},icon:H.any,closeIcon:H.any,onClose:Function}},Xe=fe({compatConfig:{MODE:3},name:"AAlert",inheritAttrs:!1,props:Qe(),setup:function(i,U){var v=U.slots,M=U.emit,N=U.attrs,V=U.expose,w=Be("alert",i),p=w.prefixCls,m=w.direction,o=c(!1),L=c(!1),_=c(),z=function(n){n.preventDefault();var b=_.value;b.style.height="".concat(b.offsetHeight,"px"),b.style.height="".concat(b.offsetHeight,"px"),o.value=!0,M("close",n)},G=function(){var n;o.value=!1,L.value=!0,(n=i.afterClose)===null||n===void 0||n.call(i)};V({animationEnd:G});var y=c({});return function(){var R,n,b=i.banner,S=i.closeIcon,Q=S===void 0?(R=v.closeIcon)===null||R===void 0?void 0:R.call(v):S,B=i.closable,x=i.type,E=i.showIcon,P=Z(v,i,"closeText"),C=Z(v,i,"description"),O=Z(v,i,"message"),$=Z(v,i,"icon");E=b&&E===void 0?!0:E,x=b&&x===void 0?"warning":x||"info";var te=(C?qe:Ge)[x]||null;P&&(B=!0);var u=p.value,X=Ae(u,(n={},I(n,"".concat(u,"-").concat(x),!0),I(n,"".concat(u,"-closing"),o.value),I(n,"".concat(u,"-with-description"),!!C),I(n,"".concat(u,"-no-icon"),!E),I(n,"".concat(u,"-banner"),!!b),I(n,"".concat(u,"-closable"),B),I(n,"".concat(u,"-rtl"),m.value==="rtl"),n)),le=B?t("button",{type:"button",onClick:z,class:"".concat(u,"-close-icon"),tabindex:0},[P?t("span",{class:"".concat(u,"-close-text")},[P]):Q===void 0?t(ke,null,null):Q]):null,A=$&&(we($)?Re($,{class:"".concat(u,"-icon")}):t("span",{class:"".concat(u,"-icon")},[$]))||t(te,{class:"".concat(u,"-icon")},null),ne=Se("".concat(u,"-motion"),{appear:!1,css:!0,onAfterLeave:G,onBeforeLeave:function(j){j.style.maxHeight="".concat(j.offsetHeight,"px")},onLeave:function(j){j.style.maxHeight="0px"}});return L.value?null:t(Te,ne,{default:function(){return[q(t("div",ve(ve({role:"alert"},N),{},{style:[N.style,y.value],class:[N.class,X],"data-show":!o.value,ref:_}),[E?A:null,t("div",{class:"".concat(u,"-content")},[O?t("div",{class:"".concat(u,"-message")},[O]):null,C?t("div",{class:"".concat(u,"-description")},[C]):null]),le]),[[J,!o.value]])]}})}}});const Ye=De(Xe);const Ze={key:0,class:"wrapper"},ea={class:"video-wrapper"},aa={class:"previewVideo"},ta=["src"],la={class:"operations"},na={class:"settings-wrapper"},oa=fe({__name:"screenRecord",setup(se){const i="unshare",U="unstart",v="recording",M="paused",N="stopped",V=c(),w=c();let p=null,m=null;const o=c(i);let L=[];const _=c(""),z=c(!1),G=[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],y=c("never"),R=[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],n=c("never"),b=[{label:"\u9ED8\u8BA4",value:"default"},{label:"16:9",value:1.77},{label:"4:3",value:1.33},{label:"21:9",value:2.35},{label:"14:10",value:1.4},{label:"19:10",value:1.9}],S=c("default"),Q=[{label:"\u9ED8\u8BA4",value:"default"},{label:"60",value:60},{label:"30",value:30},{label:"25",value:25},{label:"15",value:15},{label:"5",value:5}],B=c("default"),x=[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u5C4F\u5E55\u5C3A\u5BF8",value:"fit-screen"},{label:"4K",value:"4k"},{label:"1080p",value:"1080p"},{label:"720p",value:"720p"}],E=c("default"),P=[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u603B\u662F\u663E\u793A",value:"always"},{label:"\u79FB\u52A8\u65F6\u663E\u793A",value:"motion"},{label:"\u4ECE\u4E0D\u663E\u793A",value:"never"}],C=c("default"),O=(()=>navigator&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?navigator.mediaDevices.getSupportedConstraints():{})(),$=(()=>Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia))(),te=(()=>Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia))(),u=$&&te,X=oe(()=>{switch(o.value){case v:return"REC";case M:return"PAUSE";default:return!1}}),le=oe(()=>{const a={};switch(typeof S.value=="number"&&(a.aspectRatio=S.value),typeof B.value=="number"&&(a.frameRate=B.value),C.value!=="default"&&(a.cursor=C.value),E.value){case"fit-screen":a.width=screen.width,a.height=screen.height;break;case"4K":a.width=3840,a.height=2160;break;case"1080p":a.width=1920,a.height=1080;break;case"720p":a.width=1280,a.height=720;break}return{video:a,audio:y.value==="always"}}),A=oe(()=>{if(p){const a=p.getVideoTracks();if(a.length>0){const l=a[0].getSettings(),d={recordAudio:G.find(h=>y.value===h.value)?.label,recordMicro:R.find(h=>n.value===h.value)?.label,frameRate:l.frameRate,width:l.width,height:l.height,aspectRatio:"\u9ED8\u8BA4",cursor:""};if(l.aspectRatio){const h=l.aspectRatio,g=b.find(k=>typeof k.value=="number"?h-k.value<=.1:!1);g?d.aspectRatio=g.label:d.aspectRatio="\u9ED8\u8BA4"}if(l.cursor){const h=P.find(g=>l.cursor===g.value);h?d.cursor=h.label:d.cursor="\u9ED8\u8BA4"}return{video:d}}}return{video:{},audio:{}}});async function ne(){try{if(p=await navigator.mediaDevices.getDisplayMedia(le.value),n.value==="always"){const l=await navigator.mediaDevices.getUserMedia({audio:!0});p.addTrack(l.getAudioTracks()[0])}const a=p.getVideoTracks()[0];a&&(a.onended=ce,a.onmute=ce),m=new MediaRecorder(p),m.onstop=be,m.ondataavailable=ge,V.value.srcObject=p,V.value.muted=!0,o.value="unstart"}catch(a){pe.error(a.message)}}function Y(){re(),m?.start(),o.value=v}function j(){m?.pause(),o.value=M}function me(){m?.resume(),o.value=v}function ie(){m&&m.state!=="inactive"&&m.stop(),o.value=N}function re(){_.value=""}function _e(){if(_.value){const a=document.createElement("a");a.href=_.value,a.download="screen-record.mp4",a.click()}}function ce(){if(ie(),p)p.getTracks().forEach(l=>{l.stop()});else return;pe.info("\u5C4F\u5E55\u5206\u4EAB\u7ED3\u675F"),p=null,V.value.srcObject=null,o.value="unshare"}function be(){const a=new Blob(L,{type:"video/mp4"});_.value=URL.createObjectURL(a),L=[];const l=setInterval(async()=>{w.value.readyState>0&&(w.value.duration===1/0?w.value.currentTime=1e7*Math.random():(clearInterval(l),w.value.currentTime=0))},200)}function ge(a){L.push(a.data)}function ye(){y.value&&n.value&&(n.value="never")}function Ee(){y.value&&n.value&&(y.value="never")}return(a,l)=>{const d=Pe,h=Ye,g=Ke,k=We,Ce=ze,de=$e,he=je;return e(u)?(D(),ee("div",Ze,[r("div",ea,[r("div",aa,[q(r("video",{ref_key:"screenShareVideoElement",ref:V,autoplay:""},null,512),[[J,!e(_)]]),q(r("video",{ref_key:"recordVideoElement",ref:w,controls:"",src:e(_)},null,8,ta),[[J,e(_)]]),q(r("span",{class:"rec"},T(e(X)),513),[[J,e(X)]])]),r("div",la,[t(d,{type:"primary",onClick:l[0]||(l[0]=f=>z.value=!e(z))},{default:s(()=>[F(" \u8BBE\u7F6E ")]),_:1}),e(o)===i?(D(),K(d,{key:0,type:"primary",onClick:ne},{default:s(()=>[F(" \u5F00\u542F\u5C4F\u5E55\u5171\u4EAB ")]),_:1})):(D(),ee(ue,{key:1},[t(d,{type:"primary",disabled:e(o)===v||e(o)===M,onClick:Y},{default:s(()=>[F(" \u5F00\u59CB\u5F55\u5236 ")]),_:1},8,["disabled"]),t(d,{type:"primary",disabled:e(o)!==v,onClick:j},{default:s(()=>[F(" \u6682\u505C ")]),_:1},8,["disabled"]),t(d,{type:"primary",disabled:e(o)!==M,onClick:me},{default:s(()=>[F(" \u7EE7\u7EED ")]),_:1},8,["disabled"]),t(d,{type:"primary",disabled:e(o)===U||e(o)===N,onClick:ie},{default:s(()=>[F(" \u505C\u6B62 ")]),_:1},8,["disabled"])],64)),e(_)?(D(),ee(ue,{key:2},[t(d,{type:"primary",onClick:re},{default:s(()=>[F(" \u6E05\u9664 ")]),_:1}),t(d,{type:"primary",onClick:_e},{default:s(()=>[F(" \u4E0B\u8F7D ")]),_:1})],64)):ae("",!0)])]),q(r("div",na,[t(h,{message:"\u7531\u4E8E\u6D4F\u89C8\u5668\u9650\u5236\uFF0C\u90E8\u5206\u8BBE\u7F6E\u53EF\u80FD\u65E0\u6CD5\u751F\u6548",type:"warning","show-icon":"",closable:"",style:{"margin-bottom":".8rem"}}),e(o)==="unshare"?(D(),K(Ce,{key:0,layout:"vertical"},{default:s(()=>[t(k,{label:"\u7CFB\u7EDF\u97F3\u9891"},{default:s(()=>[t(g,{value:e(y),"onUpdate:value":l[1]||(l[1]=f=>W(y)?y.value=f:null),options:G,onChange:ye},null,8,["value"])]),_:1}),t(k,{label:"\u9EA6\u514B\u98CE"},{default:s(()=>[t(g,{value:e(n),"onUpdate:value":l[2]||(l[2]=f=>W(n)?n.value=f:null),options:R,onChange:Ee},null,8,["value"])]),_:1}),e(O).aspectRatio?(D(),K(k,{key:0,label:"\u9009\u62E9\u957F\u5BBD\u6BD4"},{default:s(()=>[t(g,{value:e(S),"onUpdate:value":l[3]||(l[3]=f=>W(S)?S.value=f:null),options:b},null,8,["value"])]),_:1})):ae("",!0),e(O).frameRate?(D(),K(k,{key:1,label:"\u9009\u62E9\u5E27\u7387"},{default:s(()=>[t(g,{value:e(B),"onUpdate:value":l[4]||(l[4]=f=>W(B)?B.value=f:null),options:Q},null,8,["value"])]),_:1})):ae("",!0),e(O).width&&e(O).height?(D(),K(k,{key:2,label:"\u9009\u62E9\u5206\u8FA8\u7387"},{default:s(()=>[t(g,{value:e(E),"onUpdate:value":l[5]||(l[5]=f=>W(E)?E.value=f:null),options:x},null,8,["value"])]),_:1})):ae("",!0),t(k,{label:"\u662F\u5426\u663E\u793A\u5149\u6807"},{default:s(()=>[t(g,{value:e(C),"onUpdate:value":l[6]||(l[6]=f=>W(C)?C.value=f:null),options:P},null,8,["value"])]),_:1})]),_:1})):(D(),ee(ue,{key:1},[t(de,{level:4},{default:s(()=>[F(" \u5F53\u524D\u8BBE\u7F6E ")]),_:1}),t(he,null,{default:s(()=>[r("ul",null,[r("li",null,"\u7CFB\u7EDF\u97F3\u9891: "+T(e(A).video.recordAudio),1),r("li",null,"\u9EA6\u514B\u98CE: "+T(e(A).video.recordMicro),1),r("li",null,"\u957F\u5BBD\u6BD4: "+T(e(A).video.aspectRatio),1),r("li",null,"\u5E27\u7387: "+T(e(A).video.frameRate),1),r("li",null,"\u89C6\u9891\u5BBD\u5EA6: "+T(e(A).video.width),1),r("li",null,"\u89C6\u9891\u9AD8\u5EA6: "+T(e(A).video.height),1),r("li",null,"\u663E\u793A\u9F20\u6807: "+T(e(A).video.cursor),1)])]),_:1})],64))],512),[[J,e(z)]])])):(D(),K(de,{key:1,level:3},{default:s(()=>[F(" \u4F60\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301WebRTC\uFF0C\u8BF7\u5B89\u88C5\u6700\u65B0\u7248\u672CChrome\u540E\u91CD\u8BD5\u3002 ")]),_:1}))}}});const Sa=He(oa,[["__scopeId","data-v-14be4e7a"]]);export{Sa as default};
