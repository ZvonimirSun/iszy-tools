import{d as $,D as A,aZ as K,dm as L,cy as Q,f as W,u as X,q as Y,l as U,G as b,o as c,h as v,s as e,w as l,z as s,t as o,j as m,C as I,H as C,F as O,a4 as R,I as S,E as ee,y as le,p as oe,k as te,g as ae}from"./index-jCyllJZn.js";import{E as se}from"./el-checkbox-HqvA0KW9.js";import{E as ne,a as de}from"./el-radio-group-z0FG0Tbf.js";/* empty css                 */import{E as re}from"./el-divider-2HMlHTvD.js";import{E as ie}from"./el-popover-oOSJDyst.js";import"./el-popper-rcur5Z-K.js";import{a as ue,E as me}from"./el-form-item-OcOQEG9Y.js";import{E as pe}from"./el-space-PqfEf4yu.js";import"./index-8-FdNn2G.js";import{_ as fe}from"./Title-d5z37_D1.js";import"./isEqual-RJXH5g-i.js";import"./hasIn-0f2CMhn3.js";import"./index-Q3VZIcf6.js";import"./isUndefined-IZwZ21d-.js";import"./castArray-X16EVl0N.js";const ce=$("main",{persist:!0,state:()=>({_cache:{},clearOfflineCacheTag:!1}),getters:{getData:i=>p=>{if(p)return(i._cache||{})[p]}},actions:{setData({key:i,val:p}={}){i&&(this._cache=this._cache||{},this._cache[i]=p)},clear(){this._cache={}},clearOfflineCache(){console.log("clearOfflineCache"),this.clearOfflineCacheTag=!0}}}),T=i=>(oe("data-v-63f0429f"),i=i(),te(),i),_e={key:0,flex:"","flex-col":"","text-7":"","gap-4":"","items-start":""},we={flex:""},ge=T(()=>m("div",{"w-32":""}," 昵称: ",-1)),Ve={flex:""},ye=T(()=>m("div",{"w-32":""}," 邮箱: ",-1)),he={flex:"","text-7":"","gap-4":"","items-start":"","flex-wrap":"",class:"settings-container"},ve={class:"settings-wrapper"},ke={key:0,class:"settings-wrapper"},Ee=A({__name:"settings",setup(i){const p=K(),F=L(),B=Q(),f=W(),k=X(),r=Y(()=>k.general),g=U(!1),x=U(),a=b({nickName:"",email:"",passwd:"",rePasswd:"",oldPasswd:""}),D=b({rePasswd:[{validator:(V,t,d)=>{t&&t!==a.passwd?d(new Error("两次输入的密码不一致")):d()}}],oldPasswd:[{validator:(V,t,d)=>{!t&&(a.passwd||a.rePasswd)?d(new Error("请输入旧密码")):d()}}]}),N=()=>ce().clearOfflineCache();function j(){p.push({path:"/login",query:{redirect:F.fullPath}})}function M(){p.push("/logout")}function q(){a.nickName=f.profile.nickName??"",a.email=f.profile.email??"",a.passwd="",a.rePasswd="",a.oldPasswd="",g.value=!0}function G(){g.value=!1}async function z(V){V&&await V.validate(async t=>{if(t){const d={};if(a.nickName&&(d.nickName=a.nickName),a.email&&(d.email=a.email),a.passwd&&(d.passwd=a.passwd,d.oldPasswd=a.oldPasswd),Object.keys(d).length===0){S.warning("没有需要修改的信息");return}try{await f.updateUser(d)}catch(u){S.error(u.message)}g.value=!1}else return S.warning("请检查输入"),!1})}return(V,t)=>{const d=fe,u=ee,_=pe,y=le,h=ue,H=me,P=ie,J=re,E=ne,Z=de,w=se;return c(),v(O,null,[e(d,{level:3},{default:l(()=>[s(" 账户信息 ")]),_:1}),o(f).logged?(c(),v("div",_e,[m("div",we,[ge,m("div",null,I(o(f).profile.nickName),1)]),m("div",Ve,[ye,m("div",null,I(o(f).profile.email),1)]),e(_,null,{default:l(()=>[e(u,{type:"primary",onClick:M},{default:l(()=>[s(" 登出 ")]),_:1}),o(g)?(c(),v(O,{key:1},[e(u,{type:"primary",onClick:t[0]||(t[0]=n=>z(o(x)))},{default:l(()=>[s(" 保存 ")]),_:1}),e(u,{onClick:G},{default:l(()=>[s(" 取消 ")]),_:1})],64)):(c(),C(u,{key:0,onClick:q},{default:l(()=>[s(" 修改信息 ")]),_:1}))]),_:1}),o(g)?(c(),C(H,{key:0,ref_key:"ruleFormRef",ref:x,model:o(a),rules:o(D),"label-width":"8rem","label-position":"left"},{default:l(()=>[e(h,{label:"昵称",prop:"nickName"},{default:l(()=>[e(y,{modelValue:o(a).nickName,"onUpdate:modelValue":t[1]||(t[1]=n=>o(a).nickName=n)},null,8,["modelValue"])]),_:1}),e(h,{label:"邮箱",prop:"email"},{default:l(()=>[e(y,{modelValue:o(a).email,"onUpdate:modelValue":t[2]||(t[2]=n=>o(a).email=n)},null,8,["modelValue"])]),_:1}),e(h,{label:"旧密码",prop:"oldPasswd"},{default:l(()=>[e(y,{modelValue:o(a).oldPasswd,"onUpdate:modelValue":t[3]||(t[3]=n=>o(a).oldPasswd=n),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(h,{label:"新密码",prop:"passwd"},{default:l(()=>[e(y,{modelValue:o(a).passwd,"onUpdate:modelValue":t[4]||(t[4]=n=>o(a).passwd=n),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(h,{label:"确认密码",prop:"rePasswd"},{default:l(()=>[e(y,{modelValue:o(a).rePasswd,"onUpdate:modelValue":t[5]||(t[5]=n=>o(a).rePasswd=n),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])):R("",!0),e(P,{title:"您是否确定要清空本地缓存？","confirm-button-text":"清空",onConfirm:N},{reference:l(()=>[e(u,{type:"danger",plain:""},{default:l(()=>[s(" 清空本地缓存 ")]),_:1})]),_:1})])):(c(),C(_,{key:1},{default:l(()=>[e(u,{type:"primary",onClick:j},{default:l(()=>[s(" 登录 ")]),_:1}),e(P,{title:"您是否确定要清空本地缓存？","confirm-button-text":"清空",onConfirm:N},{reference:l(()=>[e(u,{type:"danger",plain:""},{default:l(()=>[s(" 清空本地缓存 ")]),_:1})]),_:1})]),_:1})),e(J),m("div",he,[m("div",ve,[e(d,{level:4},{default:l(()=>[s(" 全局设置 ")]),_:1}),e(d,{level:5},{default:l(()=>[s(" 外观 ")]),_:1}),e(_,null,{default:l(()=>[e(Z,{"model-value":o(r).theme.mode,onChange:o(B).setTheme},{default:l(()=>[e(E,{label:"auto"},{default:l(()=>[s(" 跟随系统 ")]),_:1}),e(E,{label:"light"},{default:l(()=>[s(" 浅色 ")]),_:1}),e(E,{label:"dark"},{default:l(()=>[s(" 深色 ")]),_:1})]),_:1},8,["model-value","onChange"])]),_:1}),e(d,{level:5},{default:l(()=>[s(" 访问统计 ")]),_:1}),e(_,null,{default:l(()=>[e(w,{modelValue:o(r).showMost,"onUpdate:modelValue":t[6]||(t[6]=n=>o(r).showMost=n)},{default:l(()=>[s(" 最常访问 ")]),_:1},8,["modelValue"]),e(w,{modelValue:o(r).showRecent,"onUpdate:modelValue":t[7]||(t[7]=n=>o(r).showRecent=n)},{default:l(()=>[s(" 最近访问 ")]),_:1},8,["modelValue"])]),_:1}),e(d,{level:5},{default:l(()=>[s(" 其他设置 ")]),_:1}),e(_,null,{default:l(()=>[e(w,{modelValue:o(r).showSearch,"onUpdate:modelValue":t[8]||(t[8]=n=>o(r).showSearch=n)},{default:l(()=>[s(" 显示搜索 ")]),_:1},8,["modelValue"]),e(w,{modelValue:o(r).showType,"onUpdate:modelValue":t[9]||(t[9]=n=>o(r).showType=n)},{default:l(()=>[s(" 显示分类 ")]),_:1},8,["modelValue"]),e(w,{modelValue:o(r).openInNewTab,"onUpdate:modelValue":t[10]||(t[10]=n=>o(r).openInNewTab=n)},{default:l(()=>[s(" 新标签页打开工具 ")]),_:1},8,["modelValue"])]),_:1})]),o(f).logged?(c(),v("div",ke,[e(d,{level:4},{default:l(()=>[s(" 应用设置 ")]),_:1}),e(d,{level:5},{default:l(()=>[s(" JSON 编辑器 ")]),_:1}),e(_,null,{default:l(()=>[e(w,{modelValue:o(k).modules.jsonEditor.syncCloud,"onUpdate:modelValue":t[11]||(t[11]=n=>o(k).modules.jsonEditor.syncCloud=n)},{default:l(()=>[s(" 从云端获取 ")]),_:1},8,["modelValue"])]),_:1})])):R("",!0)])],64)}}}),qe=ae(Ee,[["__scopeId","data-v-63f0429f"]]);export{qe as default};
