import{L as P,l as G,c as J}from"./leaflet.ChineseLayer.f142a669.js";import{C as we}from"./vue-codemirror.1b16b113.js";import{a8 as ee,d as Ue,a3 as me,ah as De,aN as xe,_ as Se,$ as Ge,aa as Te,a0 as Be,a9 as ge,aO as be,l as He,a as H,o as w,c as F,w as M,e as X,J as Fe,f as te,Q as ke,P as Je,O as We,b as B,U as Ve,V as fe,g as ce,ag as qe}from"./vendor.3bd2b7e4.js";import{J as Ke}from"./jsoneditor.min.255f8499.js";/* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                *//* empty css                *//* empty css                *//* empty css               *//* empty css               *//* empty css              */import{_ as Ye}from"./index.20d3c8f6.js";var s=window.SuperMap=window.SuperMap||{};s.Components=window.SuperMap.Components||{};s.inherit=function(n,e){var t=function(){};t.prototype=e.prototype,n.prototype=new t;var r,i,o;for(r=2,i=arguments.length;r<i;r++)o=arguments[r],typeof o=="function"&&(o=o.prototype),s.Util.extend(n.prototype,o)};s.mixin=function(...n){class e{constructor(a){for(var u=0;u<n.length;u++)i(this,new n[u](a))}}for(var t=0;t<n.length;t++){var r=n[t];i(e,r),i(e.prototype,r.prototype),i(e.prototype,new r)}return e;function i(o,a){var u=Object.getOwnPropertyNames(a);Object.getOwnPropertySymbols&&(u=u.concat(Object.getOwnPropertySymbols(a)));for(var c=0;c<u.length;c++){var E=u[c];if(E!=="constructor"&&E!=="prototype"&&E!=="name"&&E!=="length"){let f=Object.getOwnPropertyDescriptor(a,E);window.ActiveXObject?Object.defineProperty(o,E,f||{}):Object.defineProperty(o,E,f)}}}};s.String={startsWith:function(n,e){return n.indexOf(e)==0},contains:function(n,e){return n.indexOf(e)!=-1},trim:function(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(n){for(var e=n.split("-"),t=e[0],r=1,i=e.length;r<i;r++){var o=e[r];t+=o.charAt(0).toUpperCase()+o.substring(1)}return t},format:function(n,e,t){e||(e=window);var r=function(i,o){for(var a,u=o.split(/\.+/),c=0;c<u.length;c++)c==0&&(a=e),a=a[u[c]];return typeof a=="function"&&(a=t?a.apply(null,t):a()),typeof a=="undefined"?"undefined":a};return n.replace(s.String.tokenRegEx,r)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(n){return s.String.numberRegEx.test(n)},numericIf:function(n){return s.String.isNumeric(n)?parseFloat(n):n}};var ze=s.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(n,e){var t=0;return e>0&&(t=parseFloat(n.toPrecision(e))),t},format:function(n,e,t,r){e=typeof e!="undefined"?e:0,t=typeof t!="undefined"?t:s.Number.thousandsSeparator,r=typeof r!="undefined"?r:s.Number.decimalSeparator,e!=null&&(n=parseFloat(n.toFixed(e)));var i=n.toString().split(".");i.length===1&&e==null&&(e=0);var o=i[0];if(t)for(var a=/(-?[0-9]+)([0-9]{3})/;a.test(o);)o=o.replace(a,"$1"+t+"$2");var u;if(e==0)u=o;else{var c=i.length>1?i[1]:"0";e!=null&&(c=c+new Array(e-c.length+1).join("0")),u=o+r+c}return u}};Number.prototype.limitSigDigs||(Number.prototype.limitSigDigs=function(n){return ze.limitSigDigs(this,n)});s.Function={bind:function(n,e){var t=Array.prototype.slice.apply(arguments,[2]);return function(){var r=t.concat(Array.prototype.slice.apply(arguments,[0]));return n.apply(e,r)}},bindAsEventListener:function(n,e){return function(t){return n.call(e,t||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}};s.Array={filter:function(n,e,t){var r=[];if(Array.prototype.filter)r=n.filter(e,t);else{var i=n.length;if(typeof e!="function")throw new TypeError;for(var o=0;o<i;o++)if(o in n){var a=n[o];e.call(t,a,o,n)&&r.push(a)}}return r}};var T=s.Util=s.Util||{};s.Util.extend=function(n,e){if(n=n||{},e){for(var t in e){var r=e[t];r!==void 0&&(n[t]=r)}var i=typeof window.Event=="function"&&e instanceof window.Event;!i&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&(n.toString=e.toString)}return n};s.Util.copy=function(n,e){n=n||{};var t;if(e)for(var r in n)t=e[r],typeof t!="undefined"&&(n[r]=t)};s.Util.reset=function(n){n=n||{};for(var e in n)if(n.hasOwnProperty(e)){if(typeof n[e]=="object"&&n[e]instanceof Array){for(var t in n[e])n[e][t].destroy&&n[e][t].destroy();n[e].length=0}else typeof n[e]=="object"&&n[e]instanceof Object&&n[e].destroy&&n[e].destroy();n[e]=null}};s.Util.getElement=function(){for(var n=[],e=0,t=arguments.length;e<t;e++){var r=arguments[e];if(typeof r=="string"&&(r=document.getElementById(r)),arguments.length===1)return r;n.push(r)}return n};s.Util.isElement=function(n){return!!(n&&n.nodeType===1)};s.Util.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"};s.Util.removeItem=function(n,e){for(var t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1);return n};s.Util.indexOf=function(n,e){if(n==null)return-1;if(typeof n.indexOf=="function")return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t;return-1};s.Util.modifyDOMElement=function(n,e,t,r,i,o,a,u){e&&(n.id=e),t&&(n.style.left=t.x+"px",n.style.top=t.y+"px"),r&&(n.style.width=r.w+"px",n.style.height=r.h+"px"),i&&(n.style.position=i),o&&(n.style.border=o),a&&(n.style.overflow=a),parseFloat(u)>=0&&parseFloat(u)<1?(n.style.filter="alpha(opacity="+u*100+")",n.style.opacity=u):parseFloat(u)===1&&(n.style.filter="",n.style.opacity="")};s.Util.applyDefaults=function(n,e){n=n||{};var t=typeof window.Event=="function"&&e instanceof window.Event;for(var r in e)(n[r]===void 0||!t&&e.hasOwnProperty&&e.hasOwnProperty(r)&&!n.hasOwnProperty(r))&&(n[r]=e[r]);return!t&&e&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&!n.hasOwnProperty("toString")&&(n.toString=e.toString),n};s.Util.getParameterString=function(n){var e=[];for(var t in n){var r=n[t];if(r!=null&&typeof r!="function"){var i;Array.isArray(r)||r.toString()==="[object Object]"?i=encodeURIComponent(JSON.stringify(r)):i=encodeURIComponent(r),e.push(encodeURIComponent(t)+"="+i)}}return e.join("&")};s.Util.urlAppend=function(n,e){var t=n;if(e){e.indexOf("?")===0&&(e=e.substring(1));var r=(n+" ").split(/[?&]/);t+=r.pop()===" "?e:r.length?"&"+e:"?"+e}return t};s.Util.urlPathAppend=function(n,e){let t=n;if(!e)return t;e.indexOf("/")===0&&(e=e.substring(1));const r=n.split("?");return r[0].indexOf("/",r[0].length-1)<0&&(r[0]+="/"),t=`${r[0]}${e}${r.length>1?`?${r[1]}`:""}`,t};s.Util.DEFAULT_PRECISION=14;s.Util.toFloat=function(n,e){return e==null&&(e=s.Util.DEFAULT_PRECISION),typeof n!="number"&&(n=parseFloat(n)),e===0?n:parseFloat(n.toPrecision(e))};s.Util.rad=function(n){return n*Math.PI/180};s.Util.getParameters=function(n){n=n==null?window.location.href:n;var e="";if(s.String.contains(n,"?")){var t=n.indexOf("?")+1,r=s.String.contains(n,"#")?n.indexOf("#"):n.length;e=n.substring(t,r)}for(var i={},o=e.split(/[&;]/),a=0,u=o.length;a<u;++a){var c=o[a].split("=");if(c[0]){var E=c[0];try{E=decodeURIComponent(E)}catch(m){E=unescape(E)}var f=(c[1]||"").replace(/\+/g," ");try{f=decodeURIComponent(f)}catch(m){f=unescape(f)}f=f.split(","),f.length==1&&(f=f[0]),i[E]=f}}return i};s.Util.lastSeqID=0;s.Util.createUniqueID=function(n){return n==null&&(n="id_"),s.Util.lastSeqID+=1,n+s.Util.lastSeqID};s.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};s.INCHES_PER_UNIT.in=s.INCHES_PER_UNIT.inches;s.INCHES_PER_UNIT.degrees=s.INCHES_PER_UNIT.dd;s.INCHES_PER_UNIT.nmi=1852*s.INCHES_PER_UNIT.m;s.METERS_PER_INCH=.0254000508001016;s.Util.extend(s.INCHES_PER_UNIT,{Inch:s.INCHES_PER_UNIT.inches,Meter:1/s.METERS_PER_INCH,Foot:.3048006096012192/s.METERS_PER_INCH,IFoot:.3048/s.METERS_PER_INCH,ClarkeFoot:.3047972651151/s.METERS_PER_INCH,SearsFoot:.30479947153867626/s.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/s.METERS_PER_INCH,IInch:.0254/s.METERS_PER_INCH,MicroInch:254e-7/s.METERS_PER_INCH,Mil:254e-10/s.METERS_PER_INCH,Centimeter:.01/s.METERS_PER_INCH,Kilometer:1e3/s.METERS_PER_INCH,Yard:.9144018288036576/s.METERS_PER_INCH,SearsYard:.914398414616029/s.METERS_PER_INCH,IndianYard:.9143985307444408/s.METERS_PER_INCH,IndianYd37:.91439523/s.METERS_PER_INCH,IndianYd62:.9143988/s.METERS_PER_INCH,IndianYd75:.9143985/s.METERS_PER_INCH,IndianFoot:.30479951/s.METERS_PER_INCH,IndianFt37:.30479841/s.METERS_PER_INCH,IndianFt62:.3047996/s.METERS_PER_INCH,IndianFt75:.3047995/s.METERS_PER_INCH,Mile:1609.3472186944373/s.METERS_PER_INCH,IYard:.9144/s.METERS_PER_INCH,IMile:1609.344/s.METERS_PER_INCH,NautM:1852/s.METERS_PER_INCH,"Lat-66":110943.31648893273/s.METERS_PER_INCH,"Lat-83":110946.25736872235/s.METERS_PER_INCH,Decimeter:.1/s.METERS_PER_INCH,Millimeter:.001/s.METERS_PER_INCH,Dekameter:10/s.METERS_PER_INCH,Decameter:10/s.METERS_PER_INCH,Hectometer:100/s.METERS_PER_INCH,GermanMeter:1.0000135965/s.METERS_PER_INCH,CaGrid:.999738/s.METERS_PER_INCH,ClarkeChain:20.1166194976/s.METERS_PER_INCH,GunterChain:20.11684023368047/s.METERS_PER_INCH,BenoitChain:20.116782494375872/s.METERS_PER_INCH,SearsChain:20.11676512155/s.METERS_PER_INCH,ClarkeLink:.201166194976/s.METERS_PER_INCH,GunterLink:.2011684023368047/s.METERS_PER_INCH,BenoitLink:.20116782494375873/s.METERS_PER_INCH,SearsLink:.2011676512155/s.METERS_PER_INCH,Rod:5.02921005842012/s.METERS_PER_INCH,IntnlChain:20.1168/s.METERS_PER_INCH,IntnlLink:.201168/s.METERS_PER_INCH,Perch:5.02921005842012/s.METERS_PER_INCH,Pole:5.02921005842012/s.METERS_PER_INCH,Furlong:201.1684023368046/s.METERS_PER_INCH,Rood:3.778266898/s.METERS_PER_INCH,CapeFoot:.3047972615/s.METERS_PER_INCH,Brealey:375/s.METERS_PER_INCH,ModAmFt:.304812252984506/s.METERS_PER_INCH,Fathom:1.8288/s.METERS_PER_INCH,"NautM-UK":1853.184/s.METERS_PER_INCH,"50kilometers":5e4/s.METERS_PER_INCH,"150kilometers":15e4/s.METERS_PER_INCH});s.Util.extend(s.INCHES_PER_UNIT,{mm:s.INCHES_PER_UNIT.Meter/1e3,cm:s.INCHES_PER_UNIT.Meter/100,dm:s.INCHES_PER_UNIT.Meter*100,km:s.INCHES_PER_UNIT.Meter*1e3,kmi:s.INCHES_PER_UNIT.nmi,fath:s.INCHES_PER_UNIT.Fathom,ch:s.INCHES_PER_UNIT.IntnlChain,link:s.INCHES_PER_UNIT.IntnlLink,"us-in":s.INCHES_PER_UNIT.inches,"us-ft":s.INCHES_PER_UNIT.Foot,"us-yd":s.INCHES_PER_UNIT.Yard,"us-ch":s.INCHES_PER_UNIT.GunterChain,"us-mi":s.INCHES_PER_UNIT.Mile,"ind-yd":s.INCHES_PER_UNIT.IndianYd37,"ind-ft":s.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/s.METERS_PER_INCH});s.DOTS_PER_INCH=96;s.Util.normalizeScale=function(n){var e=n>1?1/n:n;return e};s.Util.getResolutionFromScale=function(n,e){var t;if(n){e==null&&(e="degrees");var r=s.Util.normalizeScale(n);t=1/(r*s.INCHES_PER_UNIT[e]*s.DOTS_PER_INCH)}return t};s.Util.getScaleFromResolution=function(n,e){e==null&&(e="degrees");var t=n*s.INCHES_PER_UNIT[e]*s.DOTS_PER_INCH;return t};s.IS_GECKO=function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("webkit")===-1&&n.indexOf("gecko")!==-1}();s.Browser=function(){var n="",e="",t="pc",r,i=navigator.userAgent.toLowerCase();return i.indexOf("msie")>-1||i.indexOf("trident")>-1&&i.indexOf("rv")>-1?(n="msie",r=i.match(/msie ([\d.]+)/)||i.match(/rv:([\d.]+)/)):i.indexOf("chrome")>-1?(n="chrome",r=i.match(/chrome\/([\d.]+)/)):i.indexOf("firefox")>-1?(n="firefox",r=i.match(/firefox\/([\d.]+)/)):i.indexOf("opera")>-1?(n="opera",r=i.match(/version\/([\d.]+)/)):i.indexOf("safari")>-1&&(n="safari",r=i.match(/version\/([\d.]+)/)),e=r?r[1]:"",i.indexOf("ipad")>-1||i.indexOf("ipod")>-1||i.indexOf("iphone")>-1?t="apple":i.indexOf("android")>-1&&(r=i.match(/version\/([\d.]+)/),e=r?r[1]:"",t="android"),{name:n,version:e,device:t}}();s.Util.getBrowser=function(){return s.Browser};s.Util.isSupportCanvas=function(){var n=!0,e=s.Util.getBrowser();return document.createElement("canvas").getContext?(e.name==="firefox"&&parseFloat(e.version)<5&&(n=!1),e.name==="safari"&&parseFloat(e.version)<4&&(n=!1),e.name==="opera"&&parseFloat(e.version)<10&&(n=!1),e.name==="msie"&&parseFloat(e.version)<9&&(n=!1)):n=!1,n}();s.Util.supportCanvas=function(){return s.Util.isSupportCanvas};s.INCHES_PER_UNIT.degree=s.INCHES_PER_UNIT.dd;s.INCHES_PER_UNIT.meter=s.INCHES_PER_UNIT.m;s.INCHES_PER_UNIT.foot=s.INCHES_PER_UNIT.ft;s.INCHES_PER_UNIT.inch=s.INCHES_PER_UNIT.inches;s.INCHES_PER_UNIT.mile=s.INCHES_PER_UNIT.mi;s.INCHES_PER_UNIT.kilometer=s.INCHES_PER_UNIT.km;s.INCHES_PER_UNIT.yard=s.INCHES_PER_UNIT.yd;s.Util.isInTheSameDomain=function(n){if(!n)return!0;var e=n.indexOf("//"),t=document.location.toString(),r=t.indexOf("//");if(e===-1)return!0;var i,o=i=n.substring(0,e),a=t.substring(r+2);r=a.indexOf("/");var u=a.indexOf(":"),c=a.substring(0,r),E=document.location.protocol;if(u!==-1||(c+=":"+(E.toLowerCase()==="http:"?80:443)),E.toLowerCase()!==o.toLowerCase())return!1;o=n.substring(e+2);var f=o.indexOf(":");e=o.indexOf("/");var m=o.substring(0,e),S;f!==-1?S=o.substring(0,f):(S=o.substring(0,e),m+=":"+(i.toLowerCase()==="http:"?80:443));var g=document.domain;return S===g&&m===c};s.Util.calculateDpi=function(n,e,t,r,i){if(!(!n||!e||!t)){var o=1e4,a=n.getWidth(),u=n.getHeight(),c=e.w,E=e.h;i=i||6378137,r=r||"degrees";var f;if(r.toLowerCase()==="degree"||r.toLowerCase()==="degrees"||r.toLowerCase()==="dd"){let m=a/c,S=u/E,g=m>S?m:S;f=.0254*o/g/t/(Math.PI*2*i/360)/o}else{let m=a/c;f=.0254*o/m/t/o}return f}};s.Util.toJSON=function(n){var e=n;if(e==null)return null;switch(e.constructor){case String:return e='"'+e.replace(/(["\\])/g,"\\$1")+'"',e=e.replace(/\n/g,"\\n"),e=e.replace(/\r/g,"\\r"),e=e.replace("<","&lt;"),e=e.replace(">","&gt;"),e=e.replace(/%/g,"%25"),e=e.replace(/&/g,"%26"),e;case Array:for(var t=[],r=0,i=e.length;r<i;r++)t.push(s.Util.toJSON(e[r]));return"["+t.join(",")+"]";case Number:return isFinite(e)?String(e):null;case Boolean:return String(e);case Date:var o=`{'__type':"System.DateTime",'Year':`+e.getFullYear()+",'Month':"+(e.getMonth()+1)+",'Day':"+e.getDate()+",'Hour':"+e.getHours()+",'Minute':"+e.getMinutes()+",'Second':"+e.getSeconds()+",'Millisecond':"+e.getMilliseconds()+",'TimezoneOffset':"+e.getTimezoneOffset()+"}";return o;default:if(e.toJSON!=null&&typeof e.toJSON=="function")return e.toJSON();if(typeof e=="object"){if(e.length){let u=[];for(let c=0,E=e.length;c<E;c++)u.push(s.Util.toJSON(e[c]));return"["+u.join(",")+"]"}let a=[];for(let u in e)typeof e[u]!="function"&&u!=="CLASS_NAME"&&u!=="parent"&&a.push("'"+u+"':"+s.Util.toJSON(e[u]));return a.length>0?"{"+a.join(",")+"}":"{}"}return e.toString()}};s.Util.getResolutionFromScaleDpi=function(n,e,t,r){var i=null,o=1e4;return r=r||6378137,t=t||"",n>0&&e>0?(n=s.Util.normalizeScale(n),t.toLowerCase()==="degree"||t.toLowerCase()==="degrees"||t.toLowerCase()==="dd"?(i=.0254*o/e/n/(Math.PI*2*r/360)/o,i):(i=.0254*o/e/n/o,i)):-1};s.Util.getScaleFromResolutionDpi=function(n,e,t,r){var i=null,o=1e4;return r=r||6378137,t=t||"",n>0&&e>0?t.toLowerCase()==="degree"||t.toLowerCase()==="degrees"||t.toLowerCase()==="dd"?(i=.0254*o/e/n/(Math.PI*2*r/360)/o,i):(i=.0254*o/e/n/o,i):-1};s.Util.transformResult=function(n){return n.responseText&&typeof n.responseText=="string"&&(n=JSON.parse(n.responseText)),n};s.Util.copyAttributes=function(n,e){if(n=n||{},e)for(var t in e){var r=e[t];r!==void 0&&t!=="CLASS_NAME"&&typeof r!="function"&&(n[t]=r)}return n};s.Util.copyAttributesWithClip=function(n,e,t){if(n=n||{},e)for(var r in e){var i=!1;if(t&&t.length){for(var o=0,a=t.length;o<a;o++)if(r===t[o]){i=!0;break}}if(i!==!0){var u=e[r];u!==void 0&&r!=="CLASS_NAME"&&typeof u!="function"&&(n[r]=u)}}return n};s.Util.cloneObject=function(n){if(n===null||typeof n!="object")return n;if(n instanceof Date){let t=new Date;return t.setTime(n.getTime()),t}if(n instanceof Array)return n.slice(0);if(n instanceof Object){let t={};for(var e in n)n.hasOwnProperty(e)&&(t[e]=s.Util.cloneObject(n[e]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")};s.Util.lineIntersection=function(n,e,t,r){var i=null,o,a,u=(r.x-t.x)*(n.y-t.y)-(r.y-t.y)*(n.x-t.x),c=(e.x-n.x)*(n.y-t.y)-(e.y-n.y)*(n.x-t.x),E=(r.y-t.y)*(e.x-n.x)-(r.x-t.x)*(e.y-n.y);if(E!=0)o=u/E,a=c/E,o>=0&&a<=1&&o<=1&&a>=0?i=new s.Geometry.Point(n.x+o*(e.x-n.x),n.y+o*(e.y-n.y)):i="No Intersection";else if(u==0&&c==0){var f=Math.max(n.y,e.y),m=Math.min(n.y,e.y),S=Math.max(n.x,e.x),g=Math.min(n.x,e.x);(t.y>=m&&t.y<=f||r.y>=m&&r.y<=f)&&t.x>=g&&t.x<=S||r.x>=g&&r.x<=S?i="Coincident":i="Parallel"}else i="Parallel";return i};s.Util.getTextBounds=function(n,e,t){document.body.appendChild(t),t.style.width="auto",t.style.height="auto",n.fontSize&&(t.style.fontSize=n.fontSize),n.fontFamily&&(t.style.fontFamily=n.fontFamily),n.fontWeight&&(t.style.fontWeight=n.fontWeight),t.style.position="relative",t.style.visibility="hidden",t.style.display="inline-block",t.innerHTML=e;var r=t.clientWidth,i=t.clientHeight;return document.body.removeChild(t),{textWidth:r,textHeight:i}};s.Util.convertPath=function(n,e){return e?n.replace(/\{([\w-\.]+)\}/g,(t,r)=>{var i;return e.hasOwnProperty(r)?i=Xe(e[r]):i=t,encodeURIComponent(i)}):n};function Xe(n){return n==null||n==null?"":n instanceof Date?n.toJSON():Ze(n)?JSON.stringify(n):n.toString()}function Ze(n){if(typeof n!="string"&&typeof n!="object")return!1;try{const e=n.toString();return e==="[object Object]"||e==="[object Array]"}catch(e){return!1}}(function(n,e){(function(t,r){r()})(ee,function(){function t(h){var d=this.constructor;return this.then(function(l){return d.resolve(h()).then(function(){return l})},function(l){return d.resolve(h()).then(function(){return d.reject(l)})})}function r(h){var d=this;return new d(function(l,p){if(!(h&&typeof h.length!="undefined"))return p(new TypeError(typeof h+" "+h+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var y=Array.prototype.slice.call(h);if(y.length===0)return l([]);var I=y.length;function O(A,_){if(_&&(typeof _=="object"||typeof _=="function")){var b=_.then;if(typeof b=="function"){b.call(_,function(x){O(A,x)},function(x){y[A]={status:"rejected",reason:x},--I==0&&l(y)});return}}y[A]={status:"fulfilled",value:_},--I==0&&l(y)}for(var v=0;v<y.length;v++)O(v,y[v])})}var i=setTimeout;function o(h){return Boolean(h&&typeof h.length!="undefined")}function a(){}function u(h,d){return function(){h.apply(d,arguments)}}function c(h){if(!(this instanceof c))throw new TypeError("Promises must be constructed via new");if(typeof h!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],N(h,this)}function E(h,d){for(;h._state===3;)h=h._value;if(h._state===0){h._deferreds.push(d);return}h._handled=!0,c._immediateFn(function(){var l=h._state===1?d.onFulfilled:d.onRejected;if(l===null){(h._state===1?f:m)(d.promise,h._value);return}var p;try{p=l(h._value)}catch(y){m(d.promise,y);return}f(d.promise,p)})}function f(h,d){try{if(d===h)throw new TypeError("A promise cannot be resolved with itself.");if(d&&(typeof d=="object"||typeof d=="function")){var l=d.then;if(d instanceof c){h._state=3,h._value=d,S(h);return}else if(typeof l=="function"){N(u(l,d),h);return}}h._state=1,h._value=d,S(h)}catch(p){m(h,p)}}function m(h,d){h._state=2,h._value=d,S(h)}function S(h){h._state===2&&h._deferreds.length===0&&c._immediateFn(function(){h._handled||c._unhandledRejectionFn(h._value)});for(var d=0,l=h._deferreds.length;d<l;d++)E(h,h._deferreds[d]);h._deferreds=null}function g(h,d,l){this.onFulfilled=typeof h=="function"?h:null,this.onRejected=typeof d=="function"?d:null,this.promise=l}function N(h,d){var l=!1;try{h(function(p){l||(l=!0,f(d,p))},function(p){l||(l=!0,m(d,p))})}catch(p){if(l)return;l=!0,m(d,p)}}c.prototype.catch=function(h){return this.then(null,h)},c.prototype.then=function(h,d){var l=new this.constructor(a);return E(this,new g(h,d,l)),l},c.prototype.finally=t,c.all=function(h){return new c(function(d,l){if(!o(h))return l(new TypeError("Promise.all accepts an array"));var p=Array.prototype.slice.call(h);if(p.length===0)return d([]);var y=p.length;function I(v,A){try{if(A&&(typeof A=="object"||typeof A=="function")){var _=A.then;if(typeof _=="function"){_.call(A,function(b){I(v,b)},l);return}}p[v]=A,--y==0&&d(p)}catch(b){l(b)}}for(var O=0;O<p.length;O++)I(O,p[O])})},c.allSettled=r,c.resolve=function(h){return h&&typeof h=="object"&&h.constructor===c?h:new c(function(d){d(h)})},c.reject=function(h){return new c(function(d,l){l(h)})},c.race=function(h){return new c(function(d,l){if(!o(h))return l(new TypeError("Promise.race accepts an array"));for(var p=0,y=h.length;p<y;p++)c.resolve(h[p]).then(d,l)})},c._immediateFn=typeof setImmediate=="function"&&function(h){setImmediate(h)}||function(h){i(h,0)},c._unhandledRejectionFn=function(d){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",d)};var R=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof ee!="undefined")return ee;throw new Error("unable to locate global object")}();typeof R.Promise!="function"?R.Promise=c:R.Promise.prototype.finally?R.Promise.allSettled||(R.Promise.allSettled=r):R.Promise.prototype.finally=t})})();var Qe={exports:{}};(function(n){(function(e){if(!e.__disableNativeFetch&&e.fetch)return;function t(l){if(typeof l!="string"&&(l=String(l)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(l))throw new TypeError("Invalid character in header field name");return l.toLowerCase()}function r(l){return typeof l!="string"&&(l=String(l)),l}function i(l){this.map={},l instanceof i?l.forEach(function(p,y){this.append(y,p)},this):l&&Object.getOwnPropertyNames(l).forEach(function(p){this.append(p,l[p])},this)}i.prototype.append=function(l,p){l=t(l),p=r(p);var y=this.map[l];y||(y=[],this.map[l]=y),y.push(p)},i.prototype.delete=function(l){delete this.map[t(l)]},i.prototype.get=function(l){var p=this.map[t(l)];return p?p[0]:null},i.prototype.getAll=function(l){return this.map[t(l)]||[]},i.prototype.has=function(l){return this.map.hasOwnProperty(t(l))},i.prototype.set=function(l,p){this.map[t(l)]=[r(p)]},i.prototype.forEach=function(l,p){Object.getOwnPropertyNames(this.map).forEach(function(y){this.map[y].forEach(function(I){l.call(p,I,y,this)},this)},this)};function o(l){if(l.bodyUsed)return Promise.reject(new TypeError("Already read"));l.bodyUsed=!0}function a(l){return new Promise(function(p,y){l.onload=function(){p(l.result)},l.onerror=function(){y(l.error)}})}function u(l){var p=new FileReader;return p.readAsArrayBuffer(l),a(p)}function c(l,p){var y=new FileReader,I=p.headers.map["content-type"]?p.headers.map["content-type"].toString():"",O=/charset\=[0-9a-zA-Z\-\_]*;?/,v=l.type.match(O)||I.match(O),A=[l];return v&&A.push(v[0].replace(/^charset\=/,"").replace(/;$/,"")),y.readAsText.apply(y,A),a(y)}var E={blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(l){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};function f(){return this.bodyUsed=!1,this._initBody=function(l,p){if(this._bodyInit=l,typeof l=="string")this._bodyText=l;else if(E.blob&&Blob.prototype.isPrototypeOf(l))this._bodyBlob=l,this._options=p;else if(E.formData&&FormData.prototype.isPrototypeOf(l))this._bodyFormData=l;else if(!l)this._bodyText="";else if(!(E.arrayBuffer&&ArrayBuffer.prototype.isPrototypeOf(l)))throw new Error("unsupported BodyInit type")},E.blob?(this.blob=function(){var l=o(this);if(l)return l;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(u)},this.text=function(){var l=o(this);if(l)return l;if(this._bodyBlob)return c(this._bodyBlob,this._options);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var l=o(this);return l||Promise.resolve(this._bodyText)},E.formData&&(this.formData=function(){return this.text().then(N)}),this.json=function(){return this.text().then(JSON.parse)},this}var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function S(l){var p=l.toUpperCase();return m.indexOf(p)>-1?p:l}function g(l,p){p=p||{};var y=p.body;if(g.prototype.isPrototypeOf(l)){if(l.bodyUsed)throw new TypeError("Already read");this.url=l.url,this.credentials=l.credentials,p.headers||(this.headers=new i(l.headers)),this.method=l.method,this.mode=l.mode,y||(y=l._bodyInit,l.bodyUsed=!0)}else this.url=l;if(this.credentials=p.credentials||this.credentials||"omit",(p.headers||!this.headers)&&(this.headers=new i(p.headers)),this.method=S(p.method||this.method||"GET"),this.mode=p.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&y)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(y,p)}g.prototype.clone=function(){return new g(this)};function N(l){var p=new FormData;return l.trim().split("&").forEach(function(y){if(y){var I=y.split("="),O=I.shift().replace(/\+/g," "),v=I.join("=").replace(/\+/g," ");p.append(decodeURIComponent(O),decodeURIComponent(v))}}),p}function R(l){var p=new i,y=l.getAllResponseHeaders().trim().split(`
`);return y.forEach(function(I){var O=I.trim().split(":"),v=O.shift().trim(),A=O.join(":").trim();p.append(v,A)}),p}f.call(g.prototype);function h(l,p){p||(p={}),this._initBody(l,p),this.type="default",this.status=p.status,this.ok=this.status>=200&&this.status<300,this.statusText=p.statusText,this.headers=p.headers instanceof i?p.headers:new i(p.headers),this.url=p.url||""}f.call(h.prototype),h.prototype.clone=function(){return new h(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},h.error=function(){var l=new h(null,{status:0,statusText:""});return l.type="error",l};var d=[301,302,303,307,308];h.redirect=function(l,p){if(d.indexOf(p)===-1)throw new RangeError("Invalid status code");return new h(null,{status:p,headers:{location:l}})},e.Headers=i,e.Request=g,e.Response=h,e.fetch=function(l,p){return new Promise(function(y,I){var O;g.prototype.isPrototypeOf(l)&&!p?O=l:O=new g(l,p);var v=new XMLHttpRequest;function A(){if("responseURL"in v)return v.responseURL;if(/^X-Request-URL:/m.test(v.getAllResponseHeaders()))return v.getResponseHeader("X-Request-URL")}var _=!1;function b(){if(v.readyState===4){var x=v.status===1223?204:v.status;if(x<100||x>599){if(_)return;_=!0,I(new TypeError("Network request failed"));return}var pe={status:x,statusText:v.statusText,headers:R(v),url:A()},Me="response"in v?v.response:v.responseText;_||(_=!0,y(new h(Me,pe)))}}v.onreadystatechange=b,v.onload=b,v.onerror=function(){_||(_=!0,I(new TypeError("Network request failed")))},v.open(O.method,O.url,!0);try{O.credentials==="include"&&("withCredentials"in v?v.withCredentials=!0:console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning"))}catch(x){console&&console.warn&&console.warn("set withCredentials error:"+x)}"responseType"in v&&E.blob&&(v.responseType="blob"),O.headers.forEach(function(x,pe){v.setRequestHeader(pe,x)}),v.send(typeof O._bodyInit=="undefined"?null:O._bodyInit)})},e.fetch.polyfill=!0,n.exports&&(n.exports=e.fetch)})(typeof self!="undefined"?self:ee)})(Qe);var Ee={exports:{}};(function(n,e){(function(t,r){r(e,n)})(ee,function(t,r){var i={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function o(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function a(E){try{delete window[E]}catch(f){window[E]=void 0}}function u(E){var f=document.getElementById(E);f&&document.getElementsByTagName("head")[0].removeChild(f)}function c(E){var f=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],m=E,S=f.timeout||i.timeout,g=f.jsonpCallback||i.jsonpCallback,N=void 0;return new Promise(function(R,h){var d=f.jsonpCallbackFunction||o(),l=g+"_"+d;window[d]=function(y){R({ok:!0,json:function(){return Promise.resolve(y)}}),N&&clearTimeout(N),u(l),a(d)},m+=m.indexOf("?")===-1?"?":"&";var p=document.createElement("script");p.setAttribute("src",""+m+g+"="+d),f.charset&&p.setAttribute("charset",f.charset),p.id=l,document.getElementsByTagName("head")[0].appendChild(p),N=setTimeout(function(){h(new Error("JSONP request to "+E+" timed out")),a(d),u(l),window[d]=function(){a(d)}},S),p.onerror=function(){h(new Error("JSONP request to "+E+" failed")),a(d),u(l),N&&clearTimeout(N)}})}r.exports=c})})(Ee,Ee.exports);var Ne=Ee.exports;let ve=window.fetch;s.setCORS=function(n){s.CORS=n};var $e=s.isCORS=function(){return s.CORS!=null?s.CORS:window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest};s.setRequestTimeout=function(n){return s.RequestTimeout=n};var Ie=s.getRequestTimeout=function(){return s.RequestTimeout||45e3},Q=s.FetchRequest={commit:function(n,e,t,r){switch(n=n&&n.toUpperCase(),n){case"GET":return this.get(e,t,r);case"POST":return this.post(e,t,r);case"PUT":return this.put(e,t,r);case"DELETE":return this.delete(e,t,r);default:return this.get(e,t,r)}},supportDirectRequest:function(n,e){return T.isInTheSameDomain(n)?!0:e.crossOrigin!=null?e.crossOrigin:$e()||e.proxy},get:function(n,e,t){t=t||{};var r="GET";if(n=T.urlAppend(n,this._getParameterString(e||{})),n=this._processUrl(n,t),!this.supportDirectRequest(n,t)){n=n.replace(".json",".jsonp");var i={url:n,data:e};return s.Util.RequestJSONPPromise.GET(i)}return this.urlIsLong(n)?this._postSimulatie(r,n.substring(0,n.indexOf("?")-1),e,t):this._fetch(n,e,t,r)},delete:function(n,e,t){t=t||{};var r="DELETE";if(n=T.urlAppend(n,this._getParameterString(e||{})),n=this._processUrl(n,t),!this.supportDirectRequest(n,t)){n=n.replace(".json",".jsonp");var i={url:n+="&_method=DELETE",data:e};return s.Util.RequestJSONPPromise.DELETE(i)}return this.urlIsLong(n)?this._postSimulatie(r,n.substring(0,n.indexOf("?")-1),e,t):this._fetch(n,e,t,r)},post:function(n,e,t){if(t=t||{},!this.supportDirectRequest(n,t)){n=n.replace(".json",".jsonp");var r={url:n+="&_method=POST",data:e};return s.Util.RequestJSONPPromise.POST(r)}return this._fetch(this._processUrl(n,t),e,t,"POST")},put:function(n,e,t){if(t=t||{},n=this._processUrl(n,t),!this.supportDirectRequest(n,t)){n=n.replace(".json",".jsonp");var r={url:n+="&_method=PUT",data:e};return s.Util.RequestJSONPPromise.PUT(r)}return this._fetch(n,e,t,"PUT")},urlIsLong:function(n){for(var e=0,t=null,r=0,i=n.length;r<i;r++)t=n.charCodeAt(r),t<127?e++:128<=t&&t<=2047?e+=2:2048<=t&&t<=65535&&(e+=3);return!(e<2e3)},_postSimulatie:function(n,e,t,r){var i=e.indexOf("?")>-1?"&":"?";return e+=i+"_method="+n,typeof t!="string"&&(t=JSON.stringify(t)),this.post(e,t,r)},_processUrl:function(n,e){if(this._isMVTRequest(n))return n;if(n.indexOf(".json")===-1&&!e.withoutFormatSuffix)if(n.indexOf("?")<0)n+=".json";else{var t=n.split("?");t.length===2&&(n=t[0]+".json?"+t[1])}return e&&e.proxy&&(typeof e.proxy=="function"?n=e.proxy(n):(n=decodeURIComponent(n),n=e.proxy+encodeURIComponent(n))),n},_fetch:function(n,e,t,r){return t=t||{},t.headers=t.headers||{},!t.headers["Content-Type"]&&!FormData.prototype.isPrototypeOf(e)&&(t.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),t.timeout?this._timeout(t.timeout,ve(n,{method:r,headers:t.headers,body:r==="PUT"||r==="POST"?e:void 0,credentials:this._getWithCredentials(t),mode:"cors",timeout:Ie()}).then(function(i){return i})):ve(n,{method:r,body:r==="PUT"||r==="POST"?e:void 0,headers:t.headers,credentials:this._getWithCredentials(t),mode:"cors",timeout:Ie()}).then(function(i){return i})},_getWithCredentials:function(n){return n.withCredentials===!0?"include":n.withCredentials===!1?"omit":"same-origin"},_fetchJsonp:function(n,e){return e=e||{},Ne(n,{method:"GET",timeout:e.timeout}).then(function(t){return t})},_timeout:function(n,e){return new Promise(function(t,r){setTimeout(function(){r(new Error("timeout"))},n),e.then(t,r)})},_getParameterString:function(n){var e=[];for(var t in n){var r=n[t];if(r!=null&&typeof r!="function"){var i;Array.isArray(r)||r.toString()==="[object Object]"?i=encodeURIComponent(JSON.stringify(r)):i=encodeURIComponent(r),e.push(encodeURIComponent(t)+"="+i)}}return e.join("&")},_isMVTRequest:function(n){return n.indexOf(".mvt")>-1||n.indexOf(".pbf")>-1}};s.Util.RequestJSONPPromise={limitLength:1500,queryKeys:[],queryValues:[],supermap_callbacks:{},addQueryStrings:function(n){var e=this;for(var t in n){e.queryKeys.push(t),typeof n[t]!="string"&&(n[t]=s.Util.toJSON(n[t]));var r=encodeURIComponent(n[t]);e.queryValues.push(r)}},issue:function(n){for(var e=this,t=e.getUid(),r=n.url,i=[],o=new Promise(function(g){e.supermap_callbacks[t]=function(N){delete e.supermap_callbacks[t],g(N)}}),a=r,u=0,c=e.queryKeys?e.queryKeys.length:0,E=0;E<c;E++)if(a.length+e.queryKeys[E].length+2>=e.limitLength){if(u==0)return!1;i.push(a),a=r,u=0,E--}else if(a.length+e.queryKeys[E].length+2+e.queryValues[E].length>e.limitLength)for(var f=e.queryValues[E];f.length>0;){var m=e.limitLength-a.length-e.queryKeys[E].length-2;a.indexOf("?")>-1?a+="&":a+="?";var S=f.substring(0,m);S.substring(m-1,m)==="%"?(m-=1,S=f.substring(0,m)):S.substring(m-2,m-1)==="%"&&(m-=2,S=f.substring(0,m)),a+=e.queryKeys[E]+"="+S,f=f.substring(m),S.length>0&&(i.push(a),a=r,u=0)}else u++,a.indexOf("?")>-1?a+="&":a+="?",a+=e.queryKeys[E]+"="+e.queryValues[E];return i.push(a),e.send(i,"SuperMap.Util.RequestJSONPPromise.supermap_callbacks["+t+"]",n&&n.proxy),o},getUid:function(){var n=new Date().getTime(),e=Math.floor(Math.random()*1e17);return n*1e3+e},send:function(n,e,t){var r=n.length;if(r>0)for(var i=new Date().getTime(),o=0;o<r;o++){var a=n[o];a.indexOf("?")>-1?a+="&":a+="?",a+="sectionCount="+r,a+="&sectionIndex="+o,a+="&jsonpUserID="+i,t&&(a=decodeURIComponent(a),a=t+encodeURIComponent(a)),Ne(a,{jsonpCallbackFunction:e,timeout:3e4})}},GET:function(n){var e=this;return e.queryKeys.length=0,e.queryValues.length=0,e.addQueryStrings(n.params),e.issue(n)},POST:function(n){var e=this;return e.queryKeys.length=0,e.queryValues.length=0,e.addQueryStrings({requestEntity:n.data}),e.issue(n)},PUT:function(n){var e=this;return e.queryKeys.length=0,e.queryValues.length=0,e.addQueryStrings({requestEntity:n.data}),e.issue(n)},DELETE:function(n){var e=this;return e.queryKeys.length=0,e.queryValues.length=0,e.addQueryStrings({requestEntity:n.data}),e.issue(n)}};class se{constructor(e,t){this.value=e||"",this.name=t||"token",this.CLASS_NAME="SuperMap.Credential"}getUrlParameters(){return this.name+"="+this.value}getValue(){return this.value}destroy(){this.value=null,this.name=null}}se.CREDENTIAL=null;s.Credential=se;class Y{static generateToken(e,t){var r=this.servers[e];if(!!r)return Q.post(r.tokenServiceUrl,JSON.stringify(t.toJSON())).then(function(i){return i.text()})}static registerServers(e){this.servers=this.servers||{},T.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var r=e[t];this.servers[r.server]=r}}static registerToken(e,t){if(this.tokens=this.tokens||{},!(!e||!t)){var r=this._getTokenStorageKey(e);this.tokens[r]=t}}static registerKey(e,t){if(this.keys=this.keys||{},!(!e||e.length<1||!t)){e=T.isArray(e)?e:[e];for(var r=0;r<e.length;r++){var i=this._getUrlRestString(e[0])||e[0];this.keys[i]=t}}}static getServerInfo(e){return this.servers=this.servers||{},this.servers[e]}static getToken(e){if(!!e){this.tokens=this.tokens||{};var t=this._getTokenStorageKey(e);return this.tokens[t]}}static getKey(e){this.keys=this.keys||{};var t=this._getUrlRestString(e)||e;return this.keys[t]}static loginiServer(e,t,r,i){e=T.urlPathAppend(e,"services/security/login");var o={username:t&&t.toString(),password:r&&r.toString(),rememberme:i};o=JSON.stringify(o);var a={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}};return Q.post(e,o,a).then(function(u){return u.json()})}static logoutiServer(e){e=T.urlPathAppend(e,"services/security/logout");var t={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withoutFormatSuffix:!0};return Q.get(e,"",t).then(function(){return!0}).catch(function(){return!1})}static loginOnline(e,t){var r=Y.SSO+"/login?service="+e;this._open(r,t)}static loginiPortal(e,t,r){e=T.urlPathAppend(e,"web/login");var i={username:t&&t.toString(),password:r&&r.toString()};i=JSON.stringify(i);var o={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0};return Q.post(e,i,o).then(function(a){return a.json()})}static logoutiPortal(e){e=T.urlPathAppend(e,"services/security/logout");var t={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0,withoutFormatSuffix:!0};return Q.get(e,"",t).then(function(){return!0}).catch(function(){return!1})}static loginManager(e,t,r){if(!T.isInTheSameDomain(e)){var i=r?r.isNewTab:!0;this._open(e,i);return}var o=T.urlPathAppend(e,"icloud/security/tokens"),a=t||{},u={username:a.userName&&a.userName.toString(),password:a.password&&a.password.toString()};u=JSON.stringify(u);var c={headers:{Accept:"*/*","Content-Type":"application/json"}},E=this;return Q.post(o,u,c).then(function(f){f.text().then(function(m){return E.imanagerToken=m,m})})}static destroyAllCredentials(){this.keys=null,this.tokens=null,this.servers=null}static destroyToken(e){if(!!e){var t=this._getTokenStorageKey(e);this.tokens=this.tokens||{},this.tokens[t]&&delete this.tokens[t]}}static destroyKey(e){if(!!e){this.keys=this.keys||{};var t=this._getUrlRestString(e)||e;this.keys[t]&&delete this.keys[t]}}static appendCredential(e){var t=e,r=this.getToken(e),i=r?new se(r,"token"):null;return i||(r=this.getKey(e),i=r?new se(r,"key"):null),i&&(t=T.urlAppend(t,i.getUrlParameters())),t}static _open(e,t){t=t!=null?t:!0;var r=window.screen.availWidth/2-this.INNER_WINDOW_WIDTH/2,i=window.screen.availHeight/2-this.INNER_WINDOW_HEIGHT/2,o="height="+this.INNER_WINDOW_HEIGHT+", width="+this.INNER_WINDOW_WIDTH+",top="+i+", left="+r+",toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no";t?window.open(e,"login"):window.open(e,"login",o)}static _getTokenStorageKey(e){var t=/(.*?):\/\/([^\/]+)/i,r=e.match(t);return r?r[0]:e}static _getUrlRestString(e){if(!e)return e;var t=/(http|https):\/\/(.*\/rest)/i,r=e.match(t);return r?r[0]:e}}Y.INNER_WINDOW_WIDTH=600;Y.INNER_WINDOW_HEIGHT=600;Y.SSO="https://sso.supermap.com";Y.ONLINE="https://www.supermapol.com";s.SecurityManager=Y;s.DataFormat={GEOJSON:"GEOJSON",ISERVER:"ISERVER"};s.ServerType={ISERVER:"ISERVER",IPORTAL:"IPORTAL",ONLINE:"ONLINE"};var U=s.GeometryType={LINE:"LINE",LINEM:"LINEM",POINT:"POINT",REGION:"REGION",POINTEPS:"POINTEPS",LINEEPS:"LINEEPS",REGIONEPS:"REGIONEPS",ELLIPSE:"ELLIPSE",CIRCLE:"CIRCLE",TEXT:"TEXT",RECTANGLE:"RECTANGLE",UNKNOWN:"UNKNOWN",GEOCOMPOUND:"GEOCOMPOUND"};s.QueryOption={ATTRIBUTE:"ATTRIBUTE",ATTRIBUTEANDGEOMETRY:"ATTRIBUTEANDGEOMETRY",GEOMETRY:"GEOMETRY"};s.JoinType={INNERJOIN:"INNERJOIN",LEFTJOIN:"LEFTJOIN"};s.SpatialQueryMode={CONTAIN:"CONTAIN",CROSS:"CROSS",DISJOINT:"DISJOINT",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",NONE:"NONE",OVERLAP:"OVERLAP",TOUCH:"TOUCH",WITHIN:"WITHIN"};s.SpatialRelationType={CONTAIN:"CONTAIN",INTERSECT:"INTERSECT",WITHIN:"WITHIN"};s.MeasureMode={DISTANCE:"DISTANCE",AREA:"AREA"};var z=s.Unit={METER:"METER",KILOMETER:"KILOMETER",MILE:"MILE",YARD:"YARD",DEGREE:"DEGREE",MILLIMETER:"MILLIMETER",CENTIMETER:"CENTIMETER",INCH:"INCH",DECIMETER:"DECIMETER",FOOT:"FOOT",SECOND:"SECOND",MINUTE:"MINUTE",RADIAN:"RADIAN"};s.BufferRadiusUnit={CENTIMETER:"CENTIMETER",DECIMETER:"DECIMETER",FOOT:"FOOT",INCH:"INCH",KILOMETER:"KILOMETER",METER:"METER",MILE:"MILE",MILLIMETER:"MILLIMETER",YARD:"YARD"};s.EngineType={IMAGEPLUGINS:"IMAGEPLUGINS",OGC:"OGC",ORACLEPLUS:"ORACLEPLUS",SDBPLUS:"SDBPLUS",SQLPLUS:"SQLPLUS",UDB:"UDB"};s.ThemeGraphTextFormat={CAPTION:"CAPTION",CAPTION_PERCENT:"CAPTION_PERCENT",CAPTION_VALUE:"CAPTION_VALUE",PERCENT:"PERCENT",VALUE:"VALUE"};s.ThemeGraphType={AREA:"AREA",BAR:"BAR",BAR3D:"BAR3D",LINE:"LINE",PIE:"PIE",PIE3D:"PIE3D",POINT:"POINT",RING:"RING",ROSE:"ROSE",ROSE3D:"ROSE3D",STACK_BAR:"STACK_BAR",STACK_BAR3D:"STACK_BAR3D",STEP:"STEP"};s.GraphAxesTextDisplayMode={ALL:"ALL",NONE:"NONE",YAXES:"YAXES"};s.GraduatedMode={CONSTANT:"CONSTANT",LOGARITHM:"LOGARITHM",SQUAREROOT:"SQUAREROOT"};s.RangeMode={CUSTOMINTERVAL:"CUSTOMINTERVAL",EQUALINTERVAL:"EQUALINTERVAL",LOGARITHM:"LOGARITHM",QUANTILE:"QUANTILE",SQUAREROOT:"SQUAREROOT",STDDEVIATION:"STDDEVIATION"};s.ThemeType={DOTDENSITY:"DOTDENSITY",GRADUATEDSYMBOL:"GRADUATEDSYMBOL",GRAPH:"GRAPH",LABEL:"LABEL",RANGE:"RANGE",UNIQUE:"UNIQUE"};s.ColorGradientType={BLACK_WHITE:"BLACKWHITE",BLUE_BLACK:"BLUEBLACK",BLUE_RED:"BLUERED",BLUE_WHITE:"BLUEWHITE",CYAN_BLACK:"CYANBLACK",CYAN_BLUE:"CYANBLUE",CYAN_GREEN:"CYANGREEN",CYAN_WHITE:"CYANWHITE",GREEN_BLACK:"GREENBLACK",GREEN_BLUE:"GREENBLUE",GREEN_ORANGE_VIOLET:"GREENORANGEVIOLET",GREEN_RED:"GREENRED",GREEN_WHITE:"GREENWHITE",PINK_BLACK:"PINKBLACK",PINK_BLUE:"PINKBLUE",PINK_RED:"PINKRED",PINK_WHITE:"PINKWHITE",RAIN_BOW:"RAINBOW",RED_BLACK:"REDBLACK",RED_WHITE:"REDWHITE",SPECTRUM:"SPECTRUM",TERRAIN:"TERRAIN",YELLOW_BLACK:"YELLOWBLACK",YELLOW_BLUE:"YELLOWBLUE",YELLOW_GREEN:"YELLOWGREEN",YELLOW_RED:"YELLOWRED",YELLOW_WHITE:"YELLOWWHITE"};s.TextAlignment={TOPLEFT:"TOPLEFT",TOPCENTER:"TOPCENTER",TOPRIGHT:"TOPRIGHT",BASELINELEFT:"BASELINELEFT",BASELINECENTER:"BASELINECENTER",BASELINERIGHT:"BASELINERIGHT",BOTTOMLEFT:"BOTTOMLEFT",BOTTOMCENTER:"BOTTOMCENTER",BOTTOMRIGHT:"BOTTOMRIGHT",MIDDLELEFT:"MIDDLELEFT",MIDDLECENTER:"MIDDLECENTER",MIDDLERIGHT:"MIDDLERIGHT"};s.FillGradientMode={NONE:"NONE",LINEAR:"LINEAR",RADIAL:"RADIAL",CONICAL:"CONICAL",SQUARE:"SQUARE"};s.AlongLineDirection={NORMAL:"ALONG_LINE_NORMAL",LB_TO_RT:"LEFT_BOTTOM_TO_RIGHT_TOP",LT_TO_RB:"LEFT_TOP_TO_RIGHT_BOTTOM",RB_TO_LT:"RIGHT_BOTTOM_TO_LEFT_TOP",RT_TO_LB:"RIGHT_TOP_TO_LEFT_BOTTOM"};s.LabelBackShape={DIAMOND:"DIAMOND",ELLIPSE:"ELLIPSE",MARKER:"MARKER",NONE:"NONE",RECT:"RECT",ROUNDRECT:"ROUNDRECT",TRIANGLE:"TRIANGLE"};s.LabelOverLengthMode={NEWLINE:"NEWLINE",NONE:"NONE",OMIT:"OMIT"};s.DirectionType={EAST:"EAST",NONE:"NONE",NORTH:"NORTH",SOURTH:"SOURTH",WEST:"WEST"};s.SideType={LEFT:"LEFT",MIDDLE:"MIDDLE",NONE:"NONE",RIGHT:"RIGHT"};s.SupplyCenterType={FIXEDCENTER:"FIXEDCENTER",NULL:"NULL",OPTIONALCENTER:"OPTIONALCENTER"};s.TurnType={AHEAD:"AHEAD",BACK:"BACK",END:"END",LEFT:"LEFT",NONE:"NONE",RIGHT:"RIGHT"};s.BufferEndType={FLAT:"FLAT",ROUND:"ROUND"};s.OverlayOperationType={CLIP:"CLIP",ERASE:"ERASE",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",UNION:"UNION",UPDATE:"UPDATE",XOR:"XOR"};s.OutputType={INDEXEDHDFS:"INDEXEDHDFS",UDB:"UDB",MONGODB:"MONGODB",PG:"PG"};s.SmoothMethod={BSPLINE:"BSPLINE",POLISH:"POLISH"};s.SurfaceAnalystMethod={ISOLINE:"ISOLINE",ISOREGION:"ISOREGION"};s.DataReturnMode={DATASET_AND_RECORDSET:"DATASET_AND_RECORDSET",DATASET_ONLY:"DATASET_ONLY",RECORDSET_ONLY:"RECORDSET_ONLY"};s.EditType={ADD:"add",UPDATE:"update",DELETE:"delete"};s.TransferTactic={LESS_TIME:"LESS_TIME",LESS_TRANSFER:"LESS_TRANSFER",LESS_WALK:"LESS_WALK",MIN_DISTANCE:"MIN_DISTANCE"};s.TransferPreference={BUS:"BUS",SUBWAY:"SUBWAY",NO_SUBWAY:"NO_SUBWAY",NONE:"NONE"};s.GridType={CROSS:"CROSS",GRID:"GRID",POINT:"POINT"};s.ColorSpaceType={CMYK:"CMYK",RGB:"RGB"};s.LayerType={UGC:"UGC",WMS:"WMS",WFS:"WFS",CUSTOM:"CUSTOM"};s.UGCLayerType={THEME:"THEME",VECTOR:"VECTOR",GRID:"GRID",IMAGE:"IMAGE"};s.StatisticMode={AVERAGE:"AVERAGE",MAX:"MAX",MIN:"MIN",STDDEVIATION:"STDDEVIATION",SUM:"SUM",VARIANCE:"VARIANCE"};s.PixelFormat={BIT16:"BIT16",BIT32:"BIT32",BIT64:"BIT64",SINGLE:"SINGLE",DOUBLE:"DOUBLE",UBIT1:"UBIT1",UBIT4:"UBIT4",UBIT8:"UBIT8",UBIT24:"UBIT24",UBIT32:"UBIT32"};s.SearchMode={KDTREE_FIXED_COUNT:"KDTREE_FIXED_COUNT",KDTREE_FIXED_RADIUS:"KDTREE_FIXED_RADIUS",NONE:"NONE",QUADTREE:"QUADTREE"};s.InterpolationAlgorithmType={KRIGING:"KRIGING",SimpleKriging:"SimpleKriging",UniversalKriging:"UniversalKriging"};s.VariogramMode={EXPONENTIAL:"EXPONENTIAL",GAUSSIAN:"GAUSSIAN",SPHERICAL:"SPHERICAL"};s.Exponent={EXP1:"EXP1",EXP2:"EXP2"};s.ClientType={IP:"IP",REFERER:"Referer",REQUESTIP:"RequestIP",NONE:"NONE",SERVER:"SERVER",WEB:"WEB"};s.ChartType={BAR:"Bar",BAR3D:"Bar3D",CIRCLE:"Circle",PIE:"Pie",POINT:"Point",LINE:"Line",RING:"Ring"};s.ClipAnalystMode={CLIP:"clip",INTERSECT:"intersect"};s.AnalystAreaUnit={SQUAREMETER:"SquareMeter",SQUAREKILOMETER:"SquareKiloMeter",HECTARE:"Hectare",ARE:"Are",ACRE:"Acre",SQUAREFOOT:"SquareFoot",SQUAREYARD:"SquareYard",SQUAREMILE:"SquareMile"};s.AnalystSizeUnit={METER:"Meter",KILOMETER:"Kilometer",YARD:"Yard",FOOT:"Foot",MILE:"Mile"};s.StatisticAnalystMode={MAX:"max",MIN:"min",AVERAGE:"average",SUM:"sum",VARIANCE:"variance",STDDEVIATION:"stdDeviation"};s.SummaryType={SUMMARYMESH:"SUMMARYMESH",SUMMARYREGION:"SUMMARYREGION"};s.TopologyValidatorRule={REGIONNOOVERLAP:"REGIONNOOVERLAP",REGIONNOOVERLAPWITH:"REGIONNOOVERLAPWITH",REGIONCONTAINEDBYREGION:"REGIONCONTAINEDBYREGION",REGIONCOVEREDBYREGION:"REGIONCOVEREDBYREGION",LINENOOVERLAP:"LINENOOVERLAP",LINENOOVERLAPWITH:"LINENOOVERLAPWITH",POINTNOIDENTICAL:"POINTNOIDENTICAL"};s.BucketAggType={GEOHASH_GRID:"geohash_grid"};s.MetricsAggType={AVG:"avg",MAX:"max",MIN:"min",SUM:"sum"};s.GetFeatureMode={BOUNDS:"BOUNDS",BUFFER:"BUFFER",ID:"ID",SPATIAL:"SPATIAL",SQL:"SQL"};s.RasterFunctionType={NDVI:"NDVI",HILLSHADE:"HILLSHADE"};s.ResourceType={MAP:"MAP",SERVICE:"SERVICE",SCENE:"SCENE",DATA:"DATA",INSIGHTS_WORKSPACE:"INSIGHTS_WORKSPACE",MAP_DASHBOARD:"MAP_DASHBOARD"};s.OrderBy={UPDATETIME:"UPDATETIME",HEATLEVEL:"HEATLEVEL",RELEVANCE:"RELEVANCE"};s.OrderType={ASC:"ASC",DESC:"DESC"};s.SearchType={PUBLIC:"PUBLIC",MY_RES:"MY_RES",MYGROUP_RES:"MYGROUP_RES",MYDEPARTMENT_RES:"MYDEPARTMENT_RES",SHARETOME_RES:"SHARETOME_RES"};s.AggregationTypes={TAG:"TAG",TYPE:"TYPE"};s.PermissionType={SEARCH:"SEARCH",READ:"READ",READWRITE:"READWRITE",DELETE:"DELETE",DOWNLOAD:"DOWNLOAD"};s.EntityType={DEPARTMENT:"DEPARTMENT",GROUP:"GROUP",IPORTALGROUP:"IPORTALGROUP",ROLE:"ROLE",USER:"USER"};s.DataItemType={WORKSPACE:"WORKSPACE",UDB:"UDB",SHP:"SHP",EXCEL:"EXCEL",CSV:"CSV",GEOJSON:"GEOJSON",SMTILES:"SMTILES",SVTILES:"SVTILES",MBTILES:"MBTILES",TPK:"TPK",UGCV5:"UGCV5",UGCV5_MVT:"UGCV5_MVT",JSON:"JSON"};s.WebExportFormatType={PNG:"PNG",PDF:"PDF"};s.WebScaleOrientationType={HORIZONTALLABELSBELOW:"HORIZONTALLABELSBELOW",HORIZONTALLABELSABOVE:"HORIZONTALLABELSABOVE",VERTICALLABELSLEFT:"VERTICALLABELSLEFT",VERTICALLABELSRIGHT:"VERTICALLABELSRIGHT"};s.WebScaleType={LINE:"LINE",BAR:"BAR",BAR_SUB:"BAR_SUB"};s.WebScaleUnit={METER:"METER",FOOT:"FOOT",DEGREES:"DEGREES"};class re{constructor(){this.CLASS_NAME="SuperMap.Geometry",this.id=T.createUniqueID(this.CLASS_NAME+"_"),this.parent=null,this.bounds=null,this.SRID=null}destroy(){this.id=null,this.bounds=null,this.SRID=null}clone(){return new re}setBounds(e){e&&(this.bounds=e.clone())}clearBounds(){this.bounds=null,this.parent&&this.parent.clearBounds()}extendBounds(e){var t=this.getBounds();t?this.bounds.extend(e):this.setBounds(e)}getBounds(){return this.bounds==null&&this.calculateBounds(),this.bounds}calculateBounds(){}getVertices(e){}getArea(){return 0}}s.Geometry=re;class ae{constructor(e,t){this.w=e?parseFloat(e):0,this.h=e?parseFloat(t):0,this.CLASS_NAME="SuperMap.Size"}toString(){return"w="+this.w+",h="+this.h}clone(){return new ae(this.w,this.h)}equals(e){var t=!1;return e!=null&&(t=this.w===e.w&&this.h===e.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(e.w)&&isNaN(e.h)),t}destroy(){this.w=null,this.h=null}}s.Size=ae;class ne{constructor(e,t,r){this.x=e?parseFloat(e):0,this.y=t?parseFloat(t):0,this.mode=r,this.CLASS_NAME="SuperMap.Pixel",s.Pixel.Mode={LeftTop:"lefttop",RightTop:"righttop",RightBottom:"rightbottom",LeftBottom:"leftbottom"}}toString(){return"x="+this.x+",y="+this.y}clone(){return new ne(this.x,this.y,this.mode)}equals(e){var t=!1;return e!=null&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}add(e,t){if(e==null||t==null)throw new TypeError("Pixel.add cannot receive null values");return new ne(this.x+e,this.y+t)}offset(e){var t=this.clone();return e&&(t=this.add(e.x,e.y)),t}destroy(){this.x=null,this.y=null,this.mode=null}}s.Pixel=ne;class ${constructor(e,t){T.isArray(e)&&(t=e[1],e=e[0]),this.lon=e?T.toFloat(e):0,this.lat=t?T.toFloat(t):0,this.CLASS_NAME="SuperMap.LonLat"}toString(){return"lon="+this.lon+",lat="+this.lat}toShortString(){return this.lon+","+this.lat}clone(){return new $(this.lon,this.lat)}add(e,t){if(e==null||t==null)throw new TypeError("LonLat.add cannot receive null values");return new $(this.lon+T.toFloat(e),this.lat+T.toFloat(t))}equals(e){var t=!1;return e!=null&&(t=this.lon===e.lon&&this.lat===e.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(e.lon)&&isNaN(e.lat)),t}wrapDateLine(e){var t=this.clone();if(e){for(;t.lon<e.left;)t.lon+=e.getWidth();for(;t.lon>e.right;)t.lon-=e.getWidth()}return t}destroy(){this.lon=null,this.lat=null}static fromString(e){var t=e.split(",");return new $(t[0],t[1])}static fromArray(e){var t=T.isArray(e),r=t&&e[0],i=t&&e[1];return new $(r,i)}}class D{constructor(e,t,r,i){T.isArray(e)&&(i=e[3],r=e[2],t=e[1],e=e[0]),this.left=e!=null?T.toFloat(e):this.left,this.bottom=t!=null?T.toFloat(t):this.bottom,this.right=r!=null?T.toFloat(r):this.right,this.top=i!=null?T.toFloat(i):this.top,this.centerLonLat=null,this.CLASS_NAME="SuperMap.Bounds"}clone(){return new D(this.left,this.bottom,this.right,this.top)}equals(e){var t=!1;return e!=null&&(t=this.left===e.left&&this.right===e.right&&this.top===e.top&&this.bottom===e.bottom),t}toString(){return[this.left,this.bottom,this.right,this.top].join(",")}toArray(e){return e===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]}toBBOX(e,t){e==null&&(e=6);var r=Math.pow(10,e),i=Math.round(this.left*r)/r,o=Math.round(this.bottom*r)/r,a=Math.round(this.right*r)/r,u=Math.round(this.top*r)/r;return t===!0?o+","+i+","+u+","+a:i+","+o+","+a+","+u}getWidth(){return this.right-this.left}getHeight(){return this.top-this.bottom}getSize(){return new ae(this.getWidth(),this.getHeight())}getCenterPixel(){return new ne((this.left+this.right)/2,(this.bottom+this.top)/2)}getCenterLonLat(){return this.centerLonLat||(this.centerLonLat=new $((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat}scale(e,t){e=e||1,t==null&&(t=this.getCenterLonLat());var r,i;t.CLASS_NAME==="SuperMap.LonLat"?(r=t.lon,i=t.lat):(r=t.x,i=t.y);var o=(this.left-r)*e+r,a=(this.bottom-i)*e+i,u=(this.right-r)*e+r,c=(this.top-i)*e+i;return new D(o,a,u,c)}add(e,t){if(e==null||t==null)throw new TypeError("Bounds.add cannot receive null values");return new D(this.left+e,this.bottom+t,this.right+e,this.top+t)}extend(e){var t=null;if(e){switch(e.CLASS_NAME){case"SuperMap.LonLat":t=new D(e.lon,e.lat,e.lon,e.lat);break;case"SuperMap.Geometry.Point":t=new D(e.x,e.y,e.x,e.y);break;case"SuperMap.Bounds":t=e;break}t&&(this.centerLonLat=null,(this.left==null||t.left<this.left)&&(this.left=t.left),(this.bottom==null||t.bottom<this.bottom)&&(this.bottom=t.bottom),(this.right==null||t.right>this.right)&&(this.right=t.right),(this.top==null||t.top>this.top)&&(this.top=t.top))}}containsLonLat(e,t){typeof t=="boolean"&&(t={inclusive:t}),t=t||{};var r=this.contains(e.lon,e.lat,t.inclusive),i=t.worldBounds;if(i&&!r){var o=i.getWidth(),a=(i.left+i.right)/2,u=Math.round((e.lon-a)/o);r=this.containsLonLat({lon:e.lon-u*o,lat:e.lat},{inclusive:t.inclusive})}return r}containsPixel(e,t){return this.contains(e.x,e.y,t)}contains(e,t,r){if(r==null&&(r=!0),e==null||t==null)return!1;var i=!1;return r?i=e>=this.left&&e<=this.right&&t>=this.bottom&&t<=this.top:i=e>this.left&&e<this.right&&t>this.bottom&&t<this.top,i}intersectsBounds(e,t){if(typeof t=="boolean"&&(t={inclusive:t}),t=t||{},t.worldBounds){var r=this.wrapDateLine(t.worldBounds);e=e.wrapDateLine(t.worldBounds)}else r=this;t.inclusive==null&&(t.inclusive=!0);var i=!1,o=r.left===e.right||r.right===e.left||r.top===e.bottom||r.bottom===e.top;if(t.inclusive||!o){var a=e.bottom>=r.bottom&&e.bottom<=r.top||r.bottom>=e.bottom&&r.bottom<=e.top,u=e.top>=r.bottom&&e.top<=r.top||r.top>e.bottom&&r.top<e.top,c=e.left>=r.left&&e.left<=r.right||r.left>=e.left&&r.left<=e.right,E=e.right>=r.left&&e.right<=r.right||r.right>=e.left&&r.right<=e.right;i=(a||u)&&(c||E)}if(t.worldBounds&&!i){var f=t.worldBounds,m=f.getWidth(),S=!f.containsBounds(r),g=!f.containsBounds(e);S&&!g?(e=e.add(-m,0),i=r.intersectsBounds(e,{inclusive:t.inclusive})):g&&!S&&(r=r.add(-m,0),i=e.intersectsBounds(r,{inclusive:t.inclusive}))}return i}containsBounds(e,t,r){t==null&&(t=!1),r==null&&(r=!0);var i=this.contains(e.left,e.bottom,r),o=this.contains(e.right,e.bottom,r),a=this.contains(e.left,e.top,r),u=this.contains(e.right,e.top,r);return t?i||o||a||u:i&&o&&a&&u}determineQuadrant(e){var t="",r=this.getCenterLonLat();return t+=e.lat<r.lat?"b":"t",t+=e.lon<r.lon?"l":"r",t}wrapDateLine(e,t){t=t||{};var r=t.leftTolerance||0,i=t.rightTolerance||0,o=this.clone();if(e){for(var a=e.getWidth();o.left<e.left&&o.right-i<=e.left;)o=o.add(a,0);for(;o.left+r>=e.right&&o.right>e.right;)o=o.add(-a,0);var u=o.left+r;u<e.right&&u>e.left&&o.right-i>e.right&&(o=o.add(-a,0))}return o}toServerJSONObject(){var e={rightTop:{x:this.right,y:this.top},leftBottom:{x:this.left,y:this.bottom},left:this.left,right:this.right,top:this.top,bottom:this.bottom};return e}destroy(){this.left=null,this.right=null,this.top=null,this.bottom=null,this.centerLonLat=null}static fromString(e,t){var r=e.split(",");return D.fromArray(r,t)}static fromArray(e,t){return t===!0?new D(e[1],e[0],e[3],e[2]):new D(e[0],e[1],e[2],e[3])}static fromSize(e){return new D(0,e.h,e.w,0)}static oppositeQuadrant(e){var t="";return t+=e.charAt(0)==="t"?"b":"t",t+=e.charAt(1)==="l"?"r":"l",t}}s.Bounds=D;class C extends re{constructor(e,t,r,i){super(e,t,r,i);this.x=parseFloat(e),this.y=parseFloat(t),this.tag=i||i==0?parseFloat(i):null,this.type=r||"Point",this.CLASS_NAME="SuperMap.Geometry.Point",this.geometryType="Point"}clone(e){return e==null&&(e=new C(this.x,this.y)),T.applyDefaults(e,this),e}calculateBounds(){this.bounds=new D(this.x,this.y,this.x,this.y)}equals(e){var t=!1;return e!=null&&(t=this.x===e.x&&this.y===e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t}move(e,t){this.x=this.x+e,this.y=this.y+t,this.clearBounds()}toShortString(){return this.x+", "+this.y}destroy(){this.x=null,this.y=null,this.tag=null,super.destroy()}getVertices(e){return[this]}}s.Geometry.Point=C;class W extends re{constructor(e){super();this.components=[],this.componentTypes=null,e!=null&&this.addComponents(e),this.CLASS_NAME="SuperMap.Geometry.Collection",this.geometryType="Collection"}destroy(){this.components.length=0,this.components=null,super.destroy()}clone(){for(var e=new W,t=0,r=this.components.length;t<r;t++)e.addComponent(this.components[t].clone());return T.applyDefaults(e,this),e}getComponentsString(){for(var e=[],t=0,r=this.components.length;t<r;t++)e.push(this.components[t].toShortString());return e.join(",")}calculateBounds(){this.bounds=null;var e=new D,t=this.components;if(t)for(var r=0,i=t.length;r<i;r++)e.extend(t[r].getBounds());e.left!=null&&e.bottom!=null&&e.right!=null&&e.top!=null&&this.setBounds(e)}addComponents(e){T.isArray(e)||(e=[e]);for(var t=0,r=e.length;t<r;t++)this.addComponent(e[t])}addComponent(e,t){var r=!1;if(e&&(this.componentTypes==null||T.indexOf(this.componentTypes,e.CLASS_NAME)>-1)){if(t!=null&&t<this.components.length){var i=this.components.slice(0,t),o=this.components.slice(t,this.components.length);i.push(e),this.components=i.concat(o)}else this.components.push(e);e.parent=this,this.clearBounds(),r=!0}return r}removeComponents(e){var t=!1;T.isArray(e)||(e=[e]);for(var r=e.length-1;r>=0;--r)t=this.removeComponent(e[r])||t;return t}removeComponent(e){return T.removeItem(this.components,e),this.clearBounds(),!0}getArea(){for(var e=0,t=0,r=this.components.length;t<r;t++)e+=this.components[t].getArea();return e}equals(e){var t=!0;if(!e||!e.CLASS_NAME||this.CLASS_NAME!==e.CLASS_NAME)t=!1;else if(!T.isArray(e.components)||e.components.length!==this.components.length)t=!1;else for(var r=0,i=this.components.length;r<i;++r)if(!this.components[r].equals(e.components[r])){t=!1;break}return t}getVertices(e){for(var t=[],r=0,i=this.components.length;r<i;++r)Array.prototype.push.apply(t,this.components[r].getVertices(e));return t}}s.Geometry.Collection=W;class ie extends W{constructor(e){super(e);this.componentTypes=["SuperMap.Geometry.Point"],this.CLASS_NAME="SuperMap.Geometry.MultiPoint",this.geometryType="MultiPoint"}addPoint(e,t){this.addComponent(e,t)}removePoint(e){this.removeComponent(e)}}s.Geometry.MultiPoint=ie;class Re extends ie{constructor(e){super(e);this.componentTypes=["SuperMap.Geometry.Point","SuperMap.PointWithMeasure"],this.CLASS_NAME="SuperMap.Geometry.Curve",this.geometryType="Curve"}}s.Geometry.Curve=Re;class L extends Re{constructor(e){super(e);this.CLASS_NAME="SuperMap.Geometry.LineString",this.geometryType="LineString"}removeComponent(e){var t=this.components&&this.components.length>2;return t&&super.removeComponent.apply(this,arguments),t}getSortedSegments(){for(var e=this.components.length-1,t=new Array(e),r,i,o=0;o<e;++o)r=this.components[o],i=this.components[o+1],r.x<i.x?t[o]={x1:r.x,y1:r.y,x2:i.x,y2:i.y}:t[o]={x1:i.x,y1:i.y,x2:r.x,y2:r.y};function a(u,c){return u.x1-c.x1}return t.sort(a)}getVertices(e){var t;return e===!0?t=[this.components[0],this.components[this.components.length-1]]:e===!1?t=this.components.slice(1,this.components.length-1):t=this.components.slice(),t}static calculateCircle(e){if(e.length<3)return e;var t={},r=e[0],i=e[1],o=e[2],a=0,u=0,c=!0,E=0,f=0,m=0,S=72,g=[],N=(o.y-r.y)/(o.x-r.x),R=o.y-N*o.x;if(o.x!=r.x&&o.y!=r.y&&i.y==N*i.x+R||o.x==r.x&&i.x==r.x||o.y==r.y&&i.y==r.y||o.x==r.x&&o.y==r.y||o.x==i.x&&o.y==i.y||r.x==i.x&&r.y==i.y)g.push(r),g.push(i),g.push(o);else{var h=(i.x*i.x+i.y*i.y-(r.x*r.x+r.y*r.y))*(2*(o.y-r.y))-(o.x*o.x+o.y*o.y-(r.x*r.x+r.y*r.y))*(2*(i.y-r.y)),d=2*(i.x-r.x)*(o.x*o.x+o.y*o.y-(r.x*r.x+r.y*r.y))-2*(o.x-r.x)*(i.x*i.x+i.y*i.y-(r.x*r.x+r.y*r.y)),l=4*((i.x-r.x)*(o.y-r.y)-(o.x-r.x)*(i.y-r.y));t.x=h/l,t.y=d/l,a=Math.sqrt((r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y));var p=(r.x-o.x)*(r.x-o.x)+(r.y-o.y)*(r.y-o.y),y=(2*a*a-p)/(2*a*a);y=y>=1?1:y,y=y<=-1?-1:y,m=Math.acos(y)*180/Math.PI,o.x==r.x?m=t.x>r.x&&i.x>r.x||t.x<r.x&&i.x<r.x?360-m:m:m=t.y>N*t.x+R&&i.y>N*i.x+R||t.y<N*t.x+R&&i.y<N*i.x+R?360-m:m,u=m/72,o.y!=r.y?o.x==r.x?o.y>r.y?i.x<r.x&&(c=!1):i.x>r.x&&(c=!1):o.x<r.x?i.y<N*i.x+R&&(c=!1):i.y>N*i.x+R&&(c=!1):o.x>r.x?i.y>r.y&&(c=!1):i.y<r.y&&(c=!1);var I=(r.y-t.y)/(r.x-t.x),O=I>=0?Math.atan(I)*180/Math.PI:Math.abs(Math.atan(I)*180/Math.PI)+90,v=Math.abs(t.y);r.y==v&&v==o.y&&r.x<o.x&&(O=O+180);var A=r.y-t.y;g.push(r);for(var _=1;_<S;_++){E=u*_,f=O,c?A>=0?I>=0?f=f+E:f=180-(f-90)+E:I>0?f=f-180+E:f=90-f+E:A>=0?I>=0?f=f-E:f=180-(f-90)-E:I>=0?f=f-180-E:f=90-f-E,f=f*Math.PI/180;var b=t.x+a*Math.cos(f),x=t.y+a*Math.sin(f);g.push(new C(b,x))}g.push(o)}return g}static createLineEPS(e){var t=[],r=e.length;if(r<2)return e;for(var i=0;i<r;){var o=e[i].type;if(o=="LTypeArc"){var a=L.createLineArc(t,i,r,e);t=a[0],i=a[1]}else t.push(e[i]),i++}return t}static createLineArc(e,t,r,i){if(t==0){let u=L.addPointEPS(i,t,r,"LTypeArc");Array.prototype.push.apply(e,u[0]),t=u[1]+1}else if(t==r-1){var o=[i[t-1],i[t]],a=L.calculateCircle(o);Array.prototype.push.apply(e,a),t++}else{let u=L.addPointEPS(i,t,r,"LTypeArc");e.pop(),Array.prototype.push.apply(e,u[0]),t=u[1]+1}return[e,t]}static addPointEPS(e,t,r,i){var o=[],a=t+1;t==0?Array.prototype.push.apply(o,[e[t],e[t+1]]):t==r-1?Array.prototype.push.apply(o,[e[t-1],e[t]]):Array.prototype.push.apply(o,[e[t-1],e[t],e[t+1]]);var u;return i=="LTypeCurve"?u=L.calculatePointsFBZN(o):i=="LTypeArc"&&(u=L.calculateCircle(o)),[u,a]}}s.Geometry.LineString=L;class k extends L{constructor(e){super(e);this.componentTypes=["SuperMap.Geometry.Point"],this.CLASS_NAME="SuperMap.Geometry.LinearRing",this.geometryType="LinearRing"}addComponent(e,t){var r=!1,i=this.components.pop();(t!=null||!e.equals(i))&&(r=super.addComponent.apply(this,arguments));var o=this.components[0];return super.addComponent.apply(this,[o]),r}removeComponent(e){var t=this.components&&this.components.length>3;if(t){this.components.pop(),super.removeComponent.apply(this,arguments);var r=this.components[0];super.addComponent.apply(this,[r])}return t}getArea(){var e=0;if(this.components&&this.components.length>2){for(var t=0,r=0,i=this.components.length;r<i-1;r++){var o=this.components[r],a=this.components[r+1];t+=(o.x+a.x)*(a.y-o.y)}e=-t/2}return e}getVertices(e){return e===!0?[]:this.components.slice(0,this.components.length-1)}}s.Geometry.LinearRing=k;class oe extends W{constructor(e){super(e);this.componentTypes=["SuperMap.Geometry.LineString"],this.CLASS_NAME="SuperMap.Geometry.MultiLineString",this.geometryType="MultiLineString"}}s.Geometry.MultiLineString=oe;class V extends W{constructor(e){super(e);this.componentTypes=["SuperMap.Geometry.LinearRing"],this.CLASS_NAME="SuperMap.Geometry.Polygon",this.geometryType="Polygon"}getArea(){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getArea());for(var t=1,r=this.components.length;t<r;t++)e-=Math.abs(this.components[t].getArea())}return e}}s.Geometry.Polygon=V;class Z extends W{constructor(e){super(e);this.componentTypes=["SuperMap.Geometry.Polygon"],this.CLASS_NAME="SuperMap.Geometry.MultiPolygon",this.geometryType="MultiPolygon"}}s.Geometry.MultiPolygon=Z;class K{constructor(e,t,r){this.red=!e&&e!=0?255:e,this.green=t||0,this.blue=r||0,this.CLASS_NAME="SuperMap.ServerColor"}destroy(){var e=this;e.red=null,e.green=null,e.blue=null}static fromJson(e){if(!!e){var t=new K,r=255;e.red!==null&&(r=Number(e.red)),t.red=r;var i=0;e.green!==null&&(i=Number(e.green)),t.green=i;var o=0;return e.blue!==null&&(o=Number(e.blue)),t.blue=o,t}}}s.ServerColor=K;class le{constructor(e){this.fillBackColor=new K(255,255,255),this.fillBackOpaque=!1,this.fillForeColor=new K(255,0,0),this.fillGradientMode=null,this.fillGradientAngle=0,this.fillGradientOffsetRatioX=0,this.fillGradientOffsetRatioY=0,this.fillOpaqueRate=100,this.fillSymbolID=0,this.lineColor=new K(0,0,0),this.lineSymbolID=0,this.lineWidth=1,this.markerAngle=0,this.markerSize=1,this.markerSymbolID=-1,e&&T.extend(this,e),this.CLASS_NAME="SuperMap.ServerStyle"}destroy(){var e=this;e.fillBackColor&&(e.fillBackColor.destroy(),e.fillBackColor=null),e.fillBackOpaque=null,e.fillForeColor&&(e.fillForeColor.destroy(),e.fillForeColor=null),e.fillGradientMode=null,e.fillGradientAngle=null,e.fillGradientOffsetRatioX=null,e.fillGradientOffsetRatioY=null,e.fillOpaqueRate=null,e.fillSymbolID=null,e.lineColor&&(e.lineColor.destroy(),e.lineColor=null),e.lineSymbolID=null,e.lineWidth=null,e.markerAngle=null,e.markerSize=null,e.markerSymbolID=null}toServerJSONObject(){var e={};return e=T.copyAttributes(e,this),e}static fromJson(e){if(!!e)return new le({fillBackColor:K.fromJson(e.fillBackColor),fillBackOpaque:e.fillBackOpaque,fillForeColor:K.fromJson(e.fillForeColor),fillGradientMode:e.fillGradientMode,fillGradientAngle:e.fillGradientAngle,fillGradientOffsetRatioX:e.fillGradientOffsetRatioX,fillGradientOffsetRatioY:e.fillGradientOffsetRatioY,fillOpaqueRate:e.fillOpaqueRate,fillSymbolID:e.fillSymbolID,lineColor:K.fromJson(e.lineColor),lineSymbolID:e.lineSymbolID,lineWidth:e.lineWidth,markerAngle:e.markerAngle,markerSize:e.markerSize,markerSymbolID:e.markerSymbolID})}}s.ServerStyle=le;class ue extends C{constructor(e){super(e);this.measure=null,e&&T.extend(this,e),this.CLASS_NAME="SuperMap.PointWithMeasure"}equals(e){var t=!1;if(e!=null){var r=this.x===e.x&&this.y===e.y&&this.measure===e.measure,i=isNaN(this.x)&&isNaN(this.y)&&isNaN(this.measure),o=isNaN(e.x)&&isNaN(e.y)&&isNaN(e.measure);t=r||i&&o}return t}toJson(){var e="{";return this.measure!=null&&this.measure!=null&&(e+='"measure":'+this.measure+","),e+='"x":'+this.x+",",e+='"y":'+this.y,e+="}",e}destroy(){var e=this;e.measure=null,e.x=null,e.y=null}static fromJson(e){if(!!e)return new ue({x:e.x,y:e.y,measure:e.measure})}}s.PointWithMeasure=ue;class he extends W{constructor(e,t){super(e,t);this.id=null,this.center=null,this.style=null,this.length=null,this.maxM=null,this.minM=null,this.parts=null,this.points=null,this.type=null,this.componentTypes=["SuperMap.Geometry.LinearRing","SuperMap.Geometry.LineString"],t&&T.extend(this,t),this.CLASS_NAME="SuperMap.Route",this.geometryType="LINEM"}toJson(){var e="{";if(this.id!=null&&this.id!=null&&(e+='"id":'+this.id+","),this.center!=null&&this.center!=null&&(e+='"center":'+this.center+","),this.style!=null&&this.style!=null&&(e+='"style":'+this.style+","),this.length!=null&&this.length!=null&&(e+='"length":'+this.length+","),this.maxM!=null&&this.maxM!=null&&(e+='"maxM":'+this.maxM+","),this.minM!=null&&this.minM!=null&&(e+='"minM":'+this.minM+","),this.type!=null&&this.type!=null&&(e+='"type":"'+this.type+'",'),this.parts!=null&&this.parts!=null){e+='"parts":['+this.parts[0];for(var t=1;t<this.parts.length;t++)e+=","+this.parts[t];e+="],"}if(this.components!=null&&this.components.length>0){e+='"points":[';for(var r=0,i=this.components.length;r<i;r++)for(var o=0,a=this.components[r].components.length;o<a;o++)e+=this.components[r].components[o].toJson()+",";e=e.replace(/,$/g,""),e+="]"}return e=e.replace(/,$/g,""),e+="}",e}destroy(){var e=this;e.id=null,e.center=null,e.style=null,e.length=null,e.maxM=null,e.minM=null,e.type=null,e.parts=null,e.components.length=0,e.components=null,e.componentTypes=null}static fromJson(e){if(!!e){var t=e.parts||[],r=e.points||[],i=t.length,o=[];if(i>0)for(var a=0,u=0,c=[];a<i;a++){for(var E=0;E<t[a];E++)c.push(ue.fromJson(r[u+E]));u+=t[a],c[0].equals(c[t[a]-1])?o.push(new k(c)):o.push(new L(c)),c=[]}else return null;return new he(o,{id:e.id,center:e.center,style:e.style,length:e.length,maxM:e.maxM,minM:e.minM,type:e.type,parts:e.parts})}}}s.Route=he;class q{constructor(e){this.id=0,this.style=null,this.parts=null,this.points=null,this.type=null,this.prjCoordSys=null,e&&T.extend(this,e),this.CLASS_NAME="SuperMap.ServerGeometry"}destroy(){var e=this;e.id=null,e.style=null,e.parts=null,e.partTopo=null,e.points=null,e.type=null,e.prjCoordSys=null}toGeometry(){var e=this,t=e.type;switch(t.toUpperCase()){case U.POINT:return e.toGeoPoint();case U.LINE:return e.toGeoLine();case U.LINEM:return e.toGeoLinem();case U.REGION:return e.toGeoRegion();case U.POINTEPS:return e.toGeoPoint();case U.LINEEPS:return e.toGeoLineEPS();case U.REGIONEPS:return e.toGeoRegionEPS();case U.GEOCOMPOUND:return e.transformGeoCompound()}}toGeoPoint(){var e=this,t=e.parts||[],r=e.points||[],i=t.length;if(i>0){if(i===1)return new C(r[0].x,r[0].y);var o=[];for(let a=0;a<i;a++)o.push(new C(r[a].x,r[a].y));return new ie(o)}else return null}toGeoLine(){var e=this,t=e.parts||[],r=e.points||[],i=t.length;if(i>0)if(i===1){let o=[];for(let a=0;a<t[0];a++)o.push(new C(r[a].x,r[a].y));return o[0].equals(o[t[0]-1])?new k(o):new L(o)}else{let o=[];for(let a=0;a<i;a++){let u=[];for(let c=0;c<t[a];c++)u.push(new C(r[c].x,r[c].y));o.push(new L(u)),r.splice(0,t[a])}return new oe(o)}else return null}toGeoLineEPS(){var e=this,t=e.parts||[],r=e.points||[],i,o,a,u,c,E=t.length;if(E>0)if(E===1){for(i=0,a=[];i<t[0];i++)a.push(new C(r[i].x,r[i].y,r[i].type));return a[0].equals(a[t[0]-1])?(c=L.createLineEPS(a),new k(c)):(c=L.createLineEPS(a),new L(c))}else{for(i=0,u=[];i<E;i++){for(o=0,a=[];o<t[i];o++)a.push(new C(r[o].x,r[o].y));c=L.createLineEPS(a),u.push(new L(c)),r.splice(0,t[i])}return new oe(u)}else return null}toGeoLinem(){var e=this;return he.fromJson(e)}toGeoRegion(){var e=this,t=e.parts||[],r=e.partTopo||[],i=e.points||[],o=t.length;if(o<=0)return null;var a=[],u=[];if(o==1){for(let h=0;h<i.length;h++)u.push(new C(i[h].x,i[h].y));return a.push(new V([new k(u)])),new Z(a)}var c=[],E=[],f=[],m=[],S=[];for(let h=0,d=0;h<o;h++){for(let l=0;l<t[h];l++)u.push(new C(i[d+l].x,i[d+l].y));d+=t[h];var g=new V([new k(u)]);u=[],f.push(g),r.length===0&&m.push(g.getBounds()),S.push(1),E.push(g.getArea())}if(r.length===0){q.bubbleSort(E,f,r,m);var N=[];for(let h=1;h<f.length;h++)for(let d=h-1;d>=0;d--)if(N[h]=-1,m[d].containsBounds(m[h])){S[h]=S[d]*-1,S[h]<0&&(N[h]=d);break}for(let h=0;h<f.length;h++)S[h]>0?a.push(f[h]):(a[N[h]].components=a[N[h]].components.concat(f[h].components),a.push(""))}else{a=new Array;for(let h=0;h<f.length;h++)if(r[h]&&r[h]==-1?c=c.concat(f[h].components):(c.length>0&&a.length>0&&(a[a.length-1].components=a[a.length-1].components.concat(c),c=[]),a.push(f[h])),h==o-1){var R=a.length;if(R)a[R-1].components=a[R-1].components.concat(c);else for(let d=0,l=c.length;d<l;d++)a.push(new V(c))}}return new Z(a)}toGeoRegionEPS(){var e=this,t=e.parts||[],r=e.partTopo||[],i=e.points||[],o=t.length;if(o<=0)return null;var a=[],u=[],c;if(o==1){for(var E=0;E<i.length;E++)u.push(new C(i[E].x,i[E].y));return c=L.createLineEPS(u),a.push(new V([new k(c)])),new Z(a)}var f=[],m=[],S=[],g=[],N=[];for(let l=0,p=0;l<o;l++){for(let y=0;y<t[l];y++)u.push(new C(i[p+y].x,i[p+y].y));p+=t[l],c=L.createLineEPS(u);var R=new V([new k(c)]);u=[],S.push(R),r.length===0&&g.push(R.getBounds()),N.push(1),m.push(R.getArea())}if(r.length===0){q.bubbleSort(m,S,r,g);var h=[];for(let l=1;l<S.length;l++)for(let p=l-1;p>=0;p--)if(h[l]=-1,g[p].containsBounds(g[l])){N[l]=N[p]*-1,N[l]<0&&(h[l]=p);break}for(let l=0;l<S.length;l++)N[l]>0?a.push(S[l]):(a[h[l]].components=a[h[l]].components.concat(S[l].components),a.push(""))}else{a=new Array;for(let l=0;l<S.length;l++)if(r[l]&&r[l]==-1?f=f.concat(S[l].components):(f.length>0&&a.length>0&&(a[a.length-1].components=a[a.length-1].components.concat(f),f=[]),a.push(S[l])),l==o-1){var d=a.length;if(d)a[d-1].components=a[d-1].components.concat(f);else for(let p=0,y=f.length;p<y;p++)a.push(new V(f))}}return new Z(a)}transformGeoCompound(){const e=this,t=e.geoParts||[],r=t.length;if(r<=0)return null;const i=[];for(let o=0;o<r;o++){const a=t[o];i.push(new q(a).toGeometry())}return new W(i)}static fromJson(e){if(!!e)return new q({id:e.id,style:le.fromJson(e.style),parts:e.parts,partTopo:e.partTopo,points:e.points,center:e.center,length:e.length,maxM:e.maxM,minM:e.minM,type:e.type})}static fromGeometry(e){if(!!e){var t=0,r=[],i=[],o=null,a=e.components,u=e.CLASS_NAME,c={epsgCode:e.SRID};if(isNaN(e.id)||(t=e.id),u!="SuperMap.Geometry.LinearRing"&&u!="SuperMap.Geometry.LineString"&&(e instanceof ie||e instanceof oe)){let E=a.length;for(let f=0;f<E;f++){let m=a[f].getVertices().length;r.push(m);for(let S=0;S<m;S++)i.push(new C(a[f].getVertices()[S].x,a[f].getVertices()[S].y))}o=u=="SuperMap.Geometry.MultiPoint"?U.POINT:U.LINE}else if(e instanceof Z){let E=a.length;for(let f=0;f<E;f++){let m=a[f],S=m.components,g=S.length;for(let N=0;N<g;N++){let R=S[N].getVertices().length+1;r.push(R);for(let h=0;h<R-1;h++)i.push(new C(S[N].getVertices()[h].x,S[N].getVertices()[h].y));i.push(new C(S[N].getVertices()[0].x,S[N].getVertices()[0].y))}}o=U.REGION}else if(e instanceof V){let E=a.length;for(let f=0;f<E;f++){let m=a[f].getVertices().length+1;r.push(m);for(let S=0;S<m-1;S++)i.push(new C(a[f].getVertices()[S].x,a[f].getVertices()[S].y));i.push(new C(a[f].getVertices()[0].x,a[f].getVertices()[0].y))}o=U.REGION}else{let E=e.getVertices().length;for(let f=0;f<E;f++)i.push(new C(e.getVertices()[f].x,e.getVertices()[f].y));e instanceof k&&(i.push(new C(e.getVertices()[0].x,e.getVertices()[0].y)),E++),r.push(E),o=e instanceof C?U.POINT:U.LINE}return new q({id:t,style:null,parts:r,points:i,type:o,prjCoordSys:c})}}static IsClockWise(e){var t=e.length;if(t<3)return 0;var r=e[0].y*(e[t-1].x-e[1].x);e.push(e[0]);for(var i=1;i<t;i++)r+=e[i].y*(e[i-1].x-e[i+1].x);return r*.5}static bubbleSort(e,t,r,i){for(var o=0;o<e.length;o++)for(var a=0;a<e.length;a++)if(e[o]>e[a]){var u=e[a];e[a]=e[o],e[o]=u;var c=t[a];if(t[a]=t[o],t[o]=c,r&&r.length>0){var E=r[a];r[a]=r[o],r[o]=E}if(i&&i.length>0){var f=i[a];i[a]=i[o],i[o]=f}}}}s.ServerGeometry=q;class Ce{constructor(e,t,r){this.CLASS_NAME="SuperMap.Feature",this.layer=e,this.id=T.createUniqueID(this.CLASS_NAME+"_"),this.lonlat=t,this.data=r!=null?r:{}}destroy(){this.id=null,this.lonlat=null,this.data=null}}s.Feature=Ce;class j extends Ce{constructor(e,t,r){super(null,null,t);this.fid=null,this.geometry=e||null,this.attributes={},t&&(this.attributes=T.extend(this.attributes,t)),this.bounds=null,this.state=null,this.style=r||null,this.url=null,this.lonlat=null,this.CLASS_NAME="SuperMap.Feature.Vector",s.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},j.style={default:{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"default",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},delete:{display:"none"}}}destroy(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,super.destroy()}clone(){return new j(this.geometry?this.geometry.clone():null,this.attributes,this.style)}toState(e){if(e===s.State.UPDATE)switch(this.state){case s.State.UNKNOWN:case s.State.DELETE:this.state=e;break;case s.State.UPDATE:case s.State.INSERT:break}else if(e===s.State.INSERT)switch(this.state){case s.State.UNKNOWN:break;default:this.state=e;break}else if(e===s.State.DELETE)switch(this.state){case s.State.INSERT:break;case s.State.DELETE:break;case s.State.UNKNOWN:case s.State.UPDATE:this.state=e;break}else e===s.State.UNKNOWN&&(this.state=e)}}s.Feature.Vector=j;class Oe{constructor(e){this.data=null,this.keepData=!1,T.extend(this,e),this.options=e,this.CLASS_NAME="SuperMap.Format"}destroy(){}read(e){}write(e){}}s.Format=s.Format||Oe;class Ae extends Oe{constructor(e){super(e);this.indent="    ",this.space=" ",this.newline=`
`,this.level=0,this.pretty=!1,this.nativeJSON=function(){return!!(window.JSON&&typeof JSON.parse=="function"&&typeof JSON.stringify=="function")}(),this.CLASS_NAME="SuperMap.Format.JSON",this.serialize={object:function(t){if(t==null)return"null";if(t.constructor===Date)return this.serialize.date.apply(this,[t]);if(t.constructor===Array)return this.serialize.array.apply(this,[t]);var r=["{"];this.level+=1;var i,o,a,u=!1;for(i in t)t.hasOwnProperty(i)&&(o=this.write.apply(this,[i,this.pretty]),a=this.write.apply(this,[t[i],this.pretty]),o!=null&&a!=null&&(u&&r.push(","),r.push(this.writeNewline(),this.writeIndent(),o,":",this.writeSpace(),a),u=!0));return this.level-=1,r.push(this.writeNewline(),this.writeIndent(),"}"),r.join("")},array:function(t){var r,i=["["];this.level+=1;for(var o=0,a=t.length;o<a;++o)r=this.write.apply(this,[t[o],this.pretty]),r!=null&&(o>0&&i.push(","),i.push(this.writeNewline(),this.writeIndent(),r));return this.level-=1,i.push(this.writeNewline(),this.writeIndent(),"]"),i.join("")},string:function(t){var r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(t)?'"'+t.replace(/([\x00-\x1f\\"])/g,function(i,o){var a=r[o];return a||(a=o.charCodeAt(),"\\u00"+Math.floor(a/16).toString(16)+(a%16).toString(16))})+'"':'"'+t+'"'},number:function(t){return isFinite(t)?String(t):"null"},boolean:function(t){return String(t)},date:function(t){function r(i){return i<10?"0"+i:i}return'"'+t.getFullYear()+"-"+r(t.getMonth()+1)+"-"+r(t.getDate())+"T"+r(t.getHours())+":"+r(t.getMinutes())+":"+r(t.getSeconds())+'"'}}}read(e,t){var r;if(this.nativeJSON)try{r=JSON.parse(e,t)}catch(i){}return this.keepData&&(this.data=r),r}write(e,t){this.pretty=!!t;var r=null,i=typeof e;if(this.serialize[i])try{r=!this.pretty&&this.nativeJSON?JSON.stringify(e):this.serialize[i].apply(this,[e])}catch(o){}return r}writeIndent(){var e=[];if(this.pretty)for(var t=0;t<this.level;++t)e.push(this.indent);return e.join("")}writeNewline(){return this.pretty?this.newline:""}writeSpace(){return this.pretty?this.space:""}}s.Format.JSON=Ae;class de extends Ae{constructor(e){super(e);this.ignoreExtraDims=!0,this.CLASS_NAME="SuperMap.Format.GeoJSON",this.parseCoords={point:function(t){if(this.ignoreExtraDims===!1&&t.length!=2)throw"Only 2D points are supported: "+t;return new C(t[0],t[1])},multipoint:function(t){for(var r=[],i=null,o=0,a=t.length;o<a;++o){try{i=this.parseCoords.point.apply(this,[t[o]])}catch(u){throw u}r.push(i)}return new ie(r)},linestring:function(t){for(var r=[],i=null,o=0,a=t.length;o<a;++o){try{i=this.parseCoords.point.apply(this,[t[o]])}catch(u){throw u}r.push(i)}return new L(r)},multilinestring:function(t){for(var r=[],i=null,o=0,a=t.length;o<a;++o){try{i=this.parseCoords.linestring.apply(this,[t[o]])}catch(u){throw u}r.push(i)}return new oe(r)},polygon:function(t){for(var r=[],i,o,a=0,u=t.length;a<u;++a){try{o=this.parseCoords.linestring.apply(this,[t[a]])}catch(c){throw c}i=new k(o.components),r.push(i)}return new V(r)},multipolygon:function(t){for(var r=[],i=null,o=0,a=t.length;o<a;++o){try{i=this.parseCoords.polygon.apply(this,[t[o]])}catch(u){throw u}r.push(i)}return new Z(r)},box:function(t){if(t.length!=2)throw"GeoJSON box coordinates must have 2 elements";return new V([new k([new C(t[0][0],t[0][1]),new C(t[1][0],t[0][1]),new C(t[1][0],t[1][1]),new C(t[0][0],t[1][1]),new C(t[0][0],t[0][1])])])}},this.extract={feature:function(t){var r=this.extract.geometry.apply(this,[t.geometry]),i={type:"Feature",properties:this.createAttributes(t),geometry:r};return t.geometry&&t.geometry.type==="TEXT"&&(i.properties.texts=t.geometry.texts,i.properties.textStyle=t.geometry.textStyle),t.fid&&(i.id=t.fid),t.ID&&(i.id=t.ID),i},geometry:function(t){if(t==null)return null;!t.parts&&t.points&&(t.parts=[t.points.length]);var r=t.hasOwnProperty("geometryType")?t:new q(t).toGeometry()||t,i=r.geometryType||r.type,o;i==="LinearRing"&&(i="LineString"),i==="LINEM"&&(i="MultiLineString"),o=this.extract[i.toLowerCase()].apply(this,[r]),i=i==="TEXT"?"Point":i;var a;return i==="Collection"?a={type:"GeometryCollection",geometries:o}:a={type:i,coordinates:o},a},point:function(t){var r=[t.x,t.y];for(var i in t)i!=="x"&&i!=="y"&&t[i]!==null&&!isNaN(t[i])&&r.push(t[i]);return r},text:function(t){return[t.points[0].x,t.points[0].y]},multipoint:function(t){for(var r=[],i=0,o=t.components.length;i<o;++i)r.push(this.extract.point.apply(this,[t.components[i]]));return r},linestring:function(t){for(var r=[],i=0,o=t.components.length;i<o;++i)r.push(this.extract.point.apply(this,[t.components[i]]));return r},multilinestring:function(t){for(var r=[],i=0,o=t.components.length;i<o;++i)r.push(this.extract.linestring.apply(this,[t.components[i]]));return r},polygon:function(t){for(var r=[],i=0,o=t.components.length;i<o;++i)r.push(this.extract.linestring.apply(this,[t.components[i]]));return r},multipolygon:function(t){for(var r=[],i=0,o=t.components.length;i<o;++i)r.push(this.extract.polygon.apply(this,[t.components[i]]));return r},collection:function(t){for(var r=t.components.length,i=new Array(r),o=0;o<r;++o)i[o]=this.extract.geometry.apply(this,[t.components[o]]);return i}}}read(e,t,r){t=t||"FeatureCollection";var i=null,o=null;if(typeof e=="string"?o=super.read(e,r):o=e,o){if(typeof o.type=="string"){if(this.isValidType(o,t))switch(t){case"Geometry":try{i=this.parseGeometry(o)}catch(E){}break;case"Feature":try{i=this.parseFeature(o),i.type="Feature"}catch(E){}break;case"FeatureCollection":switch(i=[],o.type){case"Feature":try{i.push(this.parseFeature(o))}catch(E){i=null}break;case"FeatureCollection":for(var a=0,u=o.features.length;a<u;++a)try{i.push(this.parseFeature(o.features[a]))}catch(E){i=null}break;default:try{var c=this.parseGeometry(o);i.push(new j(c))}catch(E){i=null}}break}}}return i}write(e,t){return super.write(this.toGeoJSON(e),t)}fromGeoJSON(e,t,r){let i=this.read(e,t,r);return T.isArray(i)?i.map(o=>this._toiSevrerFeature(o)):this._toiSevrerFeature(i)}toGeoJSON(e){var t={type:null};if(T.isArray(e)){t.type="FeatureCollection";var r=e.length;t.features=new Array(r);for(var i=0;i<r;++i){var o=e[i];if(a(o)){let u={};u.geometry=o,t.features[i]=this.extract.feature.apply(this,[u])}else t.features[i]=this.extract.feature.apply(this,[o])}}else if(a(e)){let u={};u.geometry=e,t=this.extract.feature.apply(this,[u])}else t=this.extract.feature.apply(this,[e]);function a(u){return u.hasOwnProperty("parts")&&u.hasOwnProperty("points")||u.hasOwnProperty("geoParts")}return t}isValidType(e,t){var r=!1;switch(t){case"Geometry":T.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],e.type)==-1||(r=!0);break;case"FeatureCollection":r=!0;break;default:e.type==t&&(r=!0)}return r}parseFeature(e){var t,r,i,o;i=e.properties?e.properties:{},o=e.geometry&&e.geometry.bbox||e.bbox;try{r=this.parseGeometry(e.geometry)}catch(a){throw a}return t=new j(r,i),o&&(t.bounds=D.fromArray(o)),e.id&&(t.fid=e.id),t}parseGeometry(e){if(e==null)return null;var t;if(e.type=="GeometryCollection"){if(!T.isArray(e.geometries))throw"GeometryCollection must have geometries array: "+e;for(var r=e.geometries.length,i=new Array(r),o=0;o<r;++o)i[o]=this.parseGeometry.apply(this,[e.geometries[o]]);t=new W(i)}else{if(!T.isArray(e.coordinates))throw"Geometry must have coordinates array: "+e;if(!this.parseCoords[e.type.toLowerCase()])throw"Unsupported geometry type: "+e.type;try{t=this.parseCoords[e.type.toLowerCase()].apply(this,[e.coordinates])}catch(a){throw a}}return t}createCRSObject(e){var t=e.layer.projection.toString(),r={};if(t.match(/epsg:/i)){var i=parseInt(t.substring(t.indexOf(":")+1));i==4326?r={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:r={type:"name",properties:{name:"EPSG:"+i}}}return r}_toiSevrerFeature(e){const t=e.attributes,r=[],i=[];for(var o in t)r.push(o),i.push(t[o]);const a={fieldNames:r,fieldValues:i,geometry:q.fromGeometry(e.geometry)};return a.geometry.id=e.fid,a}createAttributes(e){if(!e)return null;var t={};o(e,t);var r=["fieldNames","fieldValues","geometry","stringID","ID"];for(var i in e)r.indexOf(i)>-1||(t[i]=e[i]);function o(a,u){if(!!(a.hasOwnProperty("fieldNames")&&a.hasOwnProperty("fieldValues"))){var c=a.fieldNames,E=a.fieldValues;for(var f in c)u[c[f]]=E[f]}}return t}}s.Format.GeoJSON=de;var je=function(n){var e=6378137,t;if(n===z.METER)t=1;else if(n===z.DEGREE)t=Math.PI*2*e/360;else if(n===z.KILOMETER)t=.001;else if(n===z.INCH)t=1/.025399999918;else if(n===z.FOOT)t=.3048;else return t;return t},et={};P.Util.supermap_callbacks=et;var tt=function(n){return n&&new de().toGeoJSON(n)},_e=function(n){if(!n)return n;let e;const t=new de;if(["FeatureCollection","Feature","Geometry"].indexOf(n.type)!=-1)e=t.read(n,n.type);else if(typeof n.toGeoJSON=="function"){const i=n.toGeoJSON();e=i?t.read(i,i.type):n}let r=e||n;return P.Util.isArray(e)&&(e.length===1?r=e[0]:e.length>1&&(r=[],e.map(function(i){return r.push(i.geometry),i}))),r&&r.geometry?r.geometry:r},ye=je,Pe=function(n,e,t){const r=1/.0254,i=ye(t);let o=n*e*r*i;return o=1/o,o},rt=function(n,e,t){const r=1/.0254,i=ye(t);let o=n*e*r*i;return o=1/o,o},nt=function(n,e,t,r){let i=null;const o=1e4;return r=r||6378137,t=t||"",n>0&&e>0?(n=P.Util.NormalizeScale(n),t.toLowerCase()==="degree"||t.toLowerCase()==="degrees"||t.toLowerCase()==="dd"?(i=.0254*o/e/n/(Math.PI*2*r/360)/o,i):(i=.0254*o/e/n/o,i)):-1},it=function(n){return n>1?1/n:n};P.Util.toGeoJSON=tt;P.Util.toSuperMapGeometry=_e;P.Util.resolutionToScale=Pe;P.Util.scaleToResolution=rt;P.Util.getMeterPerMapUnit=ye;P.Util.GetResolutionFromScaleDpi=nt;P.Util.NormalizeScale=it;const ot=P.TileLayer.extend({options:{layersID:null,redirect:!1,transparent:!0,cacheEnabled:!0,clipRegionEnabled:!1,clipRegion:null,prjCoordSys:null,overlapDisplayed:!1,overlapDisplayedOptions:null,tileversion:null,crs:null,format:"png",tileProxy:null,attribution:"Map Data <span>\xA9 <a href='http://support.supermap.com.cn/product/iServer.aspx' title='SuperMap iServer' target='_blank'>SuperMap iServer</a></span>",subdomains:null},initialize:function(n,e){this._url=n,P.TileLayer.prototype.initialize.apply(this,arguments),P.setOptions(this,e),P.stamp(this),this.tileSetsIndex=-1,this.tempIndex=-1},onAdd:function(n){this._crs=this.options.crs||n.options.crs,P.TileLayer.prototype.onAdd.call(this,n)},getTileUrl:function(n){const e=this.getScaleFromCoords(n);let r=this._getLayerUrl()+"&scale="+e+"&x="+n.x+"&y="+n.y;return this.options.tileProxy&&(r=this.options.tileProxy+encodeURIComponent(r)),this.options.cacheEnabled||(r+="&_t="+new Date().getTime()),this.options.subdomains&&(r=P.Util.template(r,{s:this._getSubdomain(n)})),r},getScale:function(n){const e=this,t=n||e._map.getZoom();return e.scales[t]},getScaleFromCoords:function(n){const e=this;if(e.scales&&e.scales[n.z])return e.scales[n.z];e.scales=e.scales||{};const t=e.getDefaultScale(n);return e.scales[n.z]=t,t},getDefaultScale:function(n){const e=this,t=e._crs;if(t.scales)return t.scales[n.z];{const r=e._tileCoordsToBounds(n),i=t.project(r.getNorthEast()),o=t.project(r.getSouthWest()),a=e.options.tileSize,u=Math.max(Math.abs(i.x-o.x)/a,Math.abs(i.y-o.y)/a);let c=z.METER;if(t.code){const E=t.code.split(":");if(E&&E.length>1){const f=parseInt(E[1]);c=f&&f>=4e3&&f<=5e3?z.DEGREE:z.METER}}return Pe(u,96,c)}},setTileSetsInfo:function(n){this.tileSets=n,P.Util.isArray(this.tileSets)&&(this.tileSets=this.tileSets[0]),!!this.tileSets&&(this.fire("tilesetsinfoloaded",{tileVersions:this.tileSets.tileVersions}),this.changeTilesVersion())},lastTilesVersion:function(){this.tempIndex=this.tileSetsIndex-1,this.changeTilesVersion()},nextTilesVersion:function(){this.tempIndex=this.tileSetsIndex+1,this.changeTilesVersion()},changeTilesVersion:function(){const n=this;if(n.tileSets==null||n.tempIndex===n.tileSetsIndex||this.tempIndex<0)return;const e=n.tileSets.tileVersions;if(e&&n.tempIndex<e.length&&n.tempIndex>=0){const t=e[n.tempIndex].name;n.mergeTileVersionParam(t)&&(n.tileSetsIndex=n.tempIndex,n.fire("tileversionschanged",{tileVersion:e[n.tempIndex]}))}},updateCurrentTileSetsIndex:function(n){this.tempIndex=n},mergeTileVersionParam:function(n){return n?(this.requestParams.tileversion=n,this._paramsChanged=!0,this.redraw(),this._paramsChanged=!1,!0):!1},_getLayerUrl:function(){return this._paramsChanged&&(this._layerUrl=this._createLayerUrl()),this._layerUrl||this._createLayerUrl()},_createLayerUrl:function(){let n=T.urlPathAppend(this._url,`tileImage.${this.options.format}`);return this.requestParams=this.requestParams||this._getAllRequestParams(),n=T.urlAppend(n,G.exports.Util.getParamString(this.requestParams)),n=Y.appendCredential(n),this._layerUrl=n,n},_getAllRequestParams:function(){const n=this,e=n.options||{},t={};let r=this.options.tileSize;r instanceof P.Point||(r=P.point(r,r)),t.width=r.x,t.height=r.y,t.redirect=e.redirect===!0,t.transparent=e.transparent===!0,t.cacheEnabled=e.cacheEnabled!==!1,e.prjCoordSys&&(t.prjCoordSys=JSON.stringify(e.prjCoordSys)),e.layersID&&(t.layersID=e.layersID.toString()),e.clipRegionEnabled&&e.clipRegion&&(e.clipRegion=q.fromGeometry(_e(e.clipRegion)),t.clipRegionEnabled=e.clipRegionEnabled,t.clipRegion=JSON.stringify(e.clipRegion));const i=n._crs;if(i.options&&i.options.origin)t.origin=JSON.stringify({x:i.options.origin[0],y:i.options.origin[1]});else if(i.projection&&i.projection.bounds){const o=i.projection.bounds,a=P.point(o.min.x,o.max.y);t.origin=JSON.stringify({x:a.x,y:a.y})}return e.overlapDisplayed===!1?(t.overlapDisplayed=!1,e.overlapDisplayedOptions&&(t.overlapDisplayedOptions=n.overlapDisplayedOptions.toString())):t.overlapDisplayed=!0,t.cacheEnabled===!0&&e.tileversion&&(t.tileversion=e.tileversion.toString()),e.rasterfunction&&(t.rasterfunction=JSON.stringify(e.rasterfunction)),t}}),st=function(n,e){return new ot(n,e)};const{TabPane:at}=me,{Item:lt}=Se,{Option:ut}=Te;let Le;const ht=Ue({name:"geoJson",components:{Container:we,Tabs:me,TabPane:at,Table:De,Empty:xe,Form:Se,Item:lt,Input:Ge,Select:Te,SelectOption:ut,Button:Be},data:()=>({map:void 0,editor:void 0,geoJson:{type:"FeatureCollection",features:[]},geoJsonLayer:void 0,selectedFeature:void 0,editorUpdated:!1,editorUpdateTimeout:void 0,editableData:{},tdtToken:"bed806b1ccb34b268ab1c0700123d444",gaodeToken:"868d6830a7409520ae283cde3a3f84d1",service:{url:"",type:"supermap_rest"}}),computed:{tableColumns(){if(this.propertyList&&this.propertyList.length>0){const e=Object.keys(this.propertyList[0]).map(t=>({title:t,dataIndex:t,key:t,slots:{customRender:"property"}}));return e.push({title:"\u64CD\u4F5C",dataIndex:"operation",width:40,fixed:"right",slots:{customRender:"operation"}}),e}else return null},propertyList(){return this.features?this.features.map(n=>n.properties):null},features(){if(this.geoJsonLayer)try{return this.geoJsonLayer.toGeoJSON().features}catch(n){return null}return null}},mounted(){this.editor=ge(new Ke(this.$refs.geoJsonContainer,{mode:"code",onChangeText:()=>{this.editorUpdated=!0,this.editorUpdateTimeout&&(clearTimeout(this.editorUpdateTimeout),this.editorUpdateTimeout=void 0),this.editorUpdateTimeout=setTimeout(()=>{this.updateGeoJsonLayer(),this.editorUpdated=!1,this.editorUpdateTimeout=void 0},5e3)},onBlur:()=>{this.editorUpdateTimeout&&(clearTimeout(this.editorUpdateTimeout),this.editorUpdateTimeout=void 0),this.editorUpdated&&(this.updateGeoJsonLayer(),this.editorUpdated=!1)}},this.geoJson)),this.initMap()},methods:{initMap(){this.map=ge(G.exports.map(this.$refs.mapContainer,{attributionControl:!0,zoomControl:!1})),this.map.setView([35,105],4),this.geoJsonLayer=G.exports.geoJSON(void 0,{onEachFeature:this.onEachFeature}).addTo(this.map),Le=G.exports.control.layers({\u9AD8\u5FB7\u77E2\u91CF:J("GaoDe.Normal.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}).addTo(this.map),\u9AD8\u5FB7\u5F71\u50CF:G.exports.layerGroup([J("GaoDe.Satellite.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20}),J("GaoDe.Satellite.Annotation",{minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u77E2\u91CF:G.exports.layerGroup([J("TianDiTu.Normal.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20}),J("TianDiTu.Normal.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5F71\u50CF:G.exports.layerGroup([J("TianDiTu.Satellite.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20}),J("TianDiTu.Satellite.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5730\u5F62:G.exports.layerGroup([J("TianDiTu.Terrain.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:14,maxZoom:20}),J("TianDiTu.Terrain.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),OpenStreetMap:J("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> \u8D21\u732E\u8005'})},{\u56FE\u5F62:be(this.geoJsonLayer)},{hideSingleBase:!0,position:"topright"}).addTo(this.map),G.exports.control.scale({imperial:!1,position:"bottomleft"}).addTo(this.map),G.exports.control.zoom({zoomInTitle:"\u653E\u5927",zoomOutTitle:"\u7F29\u5C0F",position:"bottomright"}).addTo(this.map)},updateGeoJsonLayer(){this.geoJsonLayer&&this.geoJsonLayer instanceof G.exports.GeoJSON&&this.geoJsonLayer.clearLayers();try{this.geoJson=this.editor.get();try{this.geoJsonLayer.addData(this.geoJson);const n=this.geoJsonLayer.getBounds(),e=n.getCenter(),t=this.map.getBoundsZoom(n);this.map.setView(e,t)}catch(n){}}catch(n){this.geoJson=void 0}},locationGeo(n){try{const t=G.exports.geoJSON(n).getBounds(),r=t.getCenter(),i=this.map.getBoundsZoom(t);this.map.setView(r,i)}catch(e){}},onEachFeature(n,e){n.properties&&e.bindPopup(this.$refs.propertyPopup).on("popupopen",()=>{this.selectedFeature=n,e.setStyle({color:"#ff7800",weight:5,opacity:.65})}).on("popupclose",()=>{this.selectedFeature=void 0,this.geoJsonLayer.resetStyle()})},saveToEditor(n,e,t){if(n instanceof InputEvent&&e&&t)try{e.properties[t]=JSON.parse(n.currentTarget.value)}catch(r){e.properties[t]=n.currentTarget.value}this.geoJson=this.geoJsonLayer.toGeoJSON(),this.editor.update(this.geoJson)},saveToEditableData(n,e,t){if(n instanceof InputEvent&&e&&t)try{e[t]=JSON.parse(n.currentTarget.value)}catch(r){e[t]=n.currentTarget.value}},edit(n){this.editableData[n]=He(this.propertyList[n])},save(n){Object.assign(this.propertyList[n],this.editableData[n]),delete this.editableData[n]},cancel(n){delete this.editableData[n]},addService(){const n=this.service.url,e=this.service.type;switch(this.service.url=this.$options.data().service.url,this.service.type=this.$options.data().service.type,e){case"supermap_rest":case"supermap_tile":{try{const t=st(n,{prjCoordSys:{epsgCode:3857},crs:G.exports.CRS.EPSG3857}).addTo(this.map);Le.addOverlay(t,"\u6D4B\u8BD5")}catch(t){this.$msg.error("\u6DFB\u52A0\u670D\u52A1\u5931\u8D25")}break}}},rowEvents(n,e){return{onClick:()=>{this.locationGeo(this.features[e])}}}},beforeUnmount(){this.map&&(this.map.remove(),this.map=void 0),this.editor&&(this.editor.destroy(),this.editor=void 0)}}),pt={class:"container"},ft={class:"mapContainer",ref:"mapContainer"},ct={class:"propertyPopup",ref:"propertyPopup"},Et={class:"geoJsonContainer",ref:"geoJsonContainer"},dt={key:0,class:"editable-cell-input-wrapper"},yt={key:1,class:"editable-cell-text-wrapper"},mt={key:0},St=["onClick"],Tt=["onClick"],gt={key:1},Nt=["onClick"],vt=ce("\u8D85\u56FE\u52A8\u6001"),It=ce("\u8D85\u56FE\u5207\u7247"),Rt=ce("\u6DFB\u52A0");function Ct(n,e,t,r,i,o){const a=H("Input"),u=H("Item"),c=H("Form"),E=H("TabPane"),f=H("Table"),m=H("Empty"),S=H("SelectOption"),g=H("Select"),N=H("Button"),R=H("Tabs"),h=H("container");return w(),F(h,null,{default:M(()=>{var d;return[X("div",pt,[X("div",ft,null,512),Fe(X("div",ct,[((d=n.selectedFeature)==null?void 0:d.properties)?(w(),F(c,{key:0,"label-col":{span:6},"wrapper-col":{span:18},colon:!1},{default:M(()=>[(w(!0),te(Je,null,ke(n.selectedFeature.properties,(l,p,y)=>(w(),F(u,{label:p,key:"prop"+y},{default:M(()=>[typeof n.selectedFeature.properties[p]=="string"?(w(),F(a,{key:0,value:n.selectedFeature.properties[p],"onUpdate:value":I=>n.selectedFeature.properties[p]=I,onChange:n.saveToEditor},null,8,["value","onUpdate:value","onChange"])):typeof n.selectedFeature.properties[p]=="number"?(w(),F(a,{key:1,value:n.selectedFeature.properties[p],"onUpdate:value":I=>n.selectedFeature.properties[p]=I,valueModifiers:{number:!0},onChange:n.saveToEditor},null,8,["value","onUpdate:value","onChange"])):(w(),F(a,{key:2,value:JSON.stringify(l),onChange:I=>n.saveToEditor(I,n.selectedFeature,p)},null,8,["value","onChange"]))]),_:2},1032,["label"]))),128))]),_:1})):We("",!0)],512),[[qe,!1]]),B(R,{type:"card"},{default:M(()=>[B(E,{key:"geoJson",tab:"GeoJSON"},{default:M(()=>[X("div",Et,null,512)]),_:1}),B(E,{key:"table",tab:"\u8868\u683C"},{default:M(()=>[n.tableColumns?(w(),F(f,{key:0,class:"ant-table-striped",columns:n.tableColumns,"data-source":n.propertyList,rowKey:(l,p)=>p,pagination:!1,bordered:"",size:"small",scroll:{x:!0},rowClassName:(l,p)=>p%2==1?"table-striped":null,customRow:n.rowEvents},{property:M(({text:l,column:p,index:y})=>[n.editableData[y]?(w(),te("div",dt,[typeof n.editableData[y][p.dataIndex]=="string"?(w(),F(a,{key:0,value:n.editableData[y][p.dataIndex],"onUpdate:value":I=>n.editableData[y][p.dataIndex]=I,onChange:n.saveToEditor},null,8,["value","onUpdate:value","onChange"])):typeof n.editableData[y][p.dataIndex]=="number"?(w(),F(a,{key:1,value:n.editableData[y][p.dataIndex],"onUpdate:value":I=>n.editableData[y][p.dataIndex]=I,valueModifiers:{number:!0},onChange:n.saveToEditor},null,8,["value","onUpdate:value","onChange"])):(w(),F(a,{key:2,value:JSON.stringify(n.editableData[y][p.dataIndex]),onChange:I=>n.saveToEditableData(I,n.editableData[y],p.dataIndex)},null,8,["value","onChange"]))])):(w(),te("div",yt,Ve(typeof l=="object"?JSON.stringify(l):l),1))]),operation:M(({index:l})=>[n.editableData[l]?(w(),te("span",mt,[X("a",{onClick:fe(p=>n.save(l),["stop"])}," \u4FDD\u5B58\u5C5E\u6027 ",8,St),X("a",{onClick:fe(p=>n.cancel(l),["stop"])}," \u53D6\u6D88\u7F16\u8F91 ",8,Tt)])):(w(),te("span",gt,[X("a",{onClick:fe(p=>n.edit(l),["stop"])}," \u7F16\u8F91\u5C5E\u6027 ",8,Nt)]))]),_:1},8,["columns","data-source","rowKey","rowClassName","customRow"])):(w(),F(m,{key:1}))]),_:1}),B(E,{key:"addService",tab:"\u6DFB\u52A0\u670D\u52A1"},{default:M(()=>[B(c,{colon:!1,class:"addService"},{default:M(()=>[B(u,{label:"\u670D\u52A1\u5730\u5740"},{default:M(()=>[B(a,{value:n.service.url,"onUpdate:value":e[0]||(e[0]=l=>n.service.url=l)},null,8,["value"])]),_:1}),B(u,{label:"\u670D\u52A1\u7C7B\u578B"},{default:M(()=>[B(g,{value:n.service.type,"onUpdate:value":e[1]||(e[1]=l=>n.service.type=l)},{default:M(()=>[B(S,{value:"supermap_rest"},{default:M(()=>[vt]),_:1}),B(S,{value:"supermap_tile"},{default:M(()=>[It]),_:1})]),_:1},8,["value"])]),_:1}),B(u,{class:"formBtnItem"},{default:M(()=>[B(N,{onClick:n.addService,type:"primary"},{default:M(()=>[Rt]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})])]}),_:1})}var Jt=Ye(ht,[["render",Ct],["__scopeId","data-v-5f5e8340"]]);export{Jt as default};
