var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(a,t,n)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,l=(e,a)=>{for(var t in a||(a={}))o.call(a,t)&&i(e,t,a[t]);if(n)for(var t of n(a))r.call(a,t)&&i(e,t,a[t]);return e},s=(e,n)=>a(e,t(n));import{c}from"./createFile.793739e8.js";import{E as d,a3 as p,_ as f,$ as u,a0 as m,a8 as g,af as h,T as v,a9 as C,b0 as y,l as b,a as P,o as j,f as _,b as x,w as U,J as w,e as k,P as O,Q as T,p as S,h as $,g as A,ac as I,c as q,O as F}from"./vendor.588f181b.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{u as D}from"./index.18e8bfc5.js";import{_ as J}from"./index.9f3f2677.js";var K=".ant-divider[data-v-0f39a7eb] {\n  margin: 0.8rem 0;\n}\n.configPanel .configOperator[data-v-0f39a7eb] {\n  text-align: right;\n  margin-top: 0.8rem;\n}\n.ant-form-item[data-v-0f39a7eb] {\n  margin-bottom: 0.8rem;\n}\n.ant-form-item[data-v-0f39a7eb]:last-child {\n  margin-bottom: 0;\n}";const{TabPane:B}=p,{Item:E}=f,{Password:H}=u,{mapGetters:N,mapState:z,mapActions:G}=d("imgHosting"),Q={name:"settings",components:{Tabs:p,TabPane:B,Form:f,Item:E,Input:u,Password:H,Button:m,Switch:g,Space:h,Typography:v,Divider:C,Popconfirm:y},data:()=>({uploaders:D,currentUploader:"aliyun",currentConfig:[],currentCommonConfig:{renameTimeStamp:!0}}),computed:l(l({},N(["config"])),z(["uploader","commonConfig"])),mounted(){this.uploader&&(this.currentUploader=this.uploader),this.changeUploader(),this.currentCommonConfig=b(this.commonConfig||{})},methods:s(l({},G(["saveConfig","saveCommonConfig","importConfig"])),{changeUploader(){this.currentConfig=b(D[this.currentUploader].config(this.config(this.currentUploader)))},save(){const e={};for(const a of this.currentConfig){if(a.required&&(null==a.default||""===a.default))return void this.$msg.warn("必填项未填写完整");e[a.name]=a.default}this.saveConfig({uploader:this.currentUploader,config:e}),this.$msg.success("保存成功")},exportAll(){const e=JSON.stringify(this.$store.state.imgHosting);c(e,"allConfig.json")},importAll(){if(!this.$refs.file.value||!this.$refs.file.files||!this.$refs.file.files.length)return;const e=this.$refs.file.files[0];if("application/json"===e.type||"text/plain"===e.type){const a=new FileReader;a.onload=async()=>{if(a.result)try{const e=JSON.parse(a.result);await this.importConfig(e),this.$msg.success("导入成功")}catch(e){this.$msg.error("导入失败")}},a.readAsText(e)}},handler(){this.$refs.file.click()},getPopupContainer:()=>document.body})},R=e=>(S("data-v-0f39a7eb"),e=e(),$(),e),L=R((()=>k("h4",null,"导入导出",-1))),M=A("导出所有"),V=A("导入所有"),W=R((()=>k("h4",null,"通用配置",-1))),X={class:"commonConfigPanel"},Y=R((()=>k("h4",null,"图床设置",-1))),Z={class:"configPanel"},ee={class:"configTable"},ae={class:"configOperator"},te=A("保存");function ne(e,a,t,n,o,r){const i=P("Typography"),l=P("Button"),s=P("Popconfirm"),c=P("Space"),d=P("Divider"),p=P("Switch"),f=P("Item"),u=P("Form"),m=P("Input"),g=P("Password"),h=P("TabPane"),v=P("Tabs");return j(),_(O,null,[x(i,null,{default:U((()=>[L])),_:1}),x(c,{size:8},{default:U((()=>[x(l,{type:"primary",onClick:r.exportAll},{default:U((()=>[M])),_:1},8,["onClick"]),x(s,{onConfirm:r.handler,title:"是否导入所有配置？将会完全覆盖此功能记录","ok-text":"是","cancel-text":"否",getPopupContainer:r.getPopupContainer},{default:U((()=>[x(l,{type:"primary"},{default:U((()=>[V])),_:1})])),_:1},8,["onConfirm","getPopupContainer"]),w(k("input",{type:"file",ref:"file",onClick:a[0]||(a[0]=e=>{e.target.value=""}),onChange:a[1]||(a[1]=(...e)=>r.importAll&&r.importAll(...e))},null,544),[[I,!1]])])),_:1}),x(d),x(i,null,{default:U((()=>[W])),_:1}),k("div",X,[x(u,{layout:"vertical"},{default:U((()=>[x(f,{label:"重命名时间戳"},{default:U((()=>[x(p,{checked:e.currentCommonConfig.renameTimeStamp,"onUpdate:checked":a[2]||(a[2]=a=>e.currentCommonConfig.renameTimeStamp=a),onChange:a[3]||(a[3]=a=>e.saveCommonConfig(e.currentCommonConfig))},null,8,["checked"])])),_:1})])),_:1})]),x(d),x(i,null,{default:U((()=>[Y])),_:1}),x(v,{activeKey:e.currentUploader,"onUpdate:activeKey":a[4]||(a[4]=a=>e.currentUploader=a),type:"card",onChange:r.changeUploader},{default:U((()=>[(j(!0),_(O,null,T(e.uploaders,((a,t)=>(j(),q(h,{key:t,tab:a.name},{default:U((()=>[k("div",Z,[k("div",ee,[e.currentUploader===t?(j(),q(u,{key:0,layout:"vertical"},{default:U((()=>[(j(!0),_(O,null,T(e.currentConfig,(e=>(j(),q(f,{key:e.name,label:e.label,required:e.required},{default:U((()=>["input"===e.type?(j(),q(m,{key:0,value:e.default,"onUpdate:value":a=>e.default=a,"allow-clear":"",placeholder:e.hint},null,8,["value","onUpdate:value","placeholder"])):"password"===e.type?(j(),q(g,{key:1,value:e.default,"onUpdate:value":a=>e.default=a,"allow-clear":"",placeholder:e.hint},null,8,["value","onUpdate:value","placeholder"])):F("",!0)])),_:2},1032,["label","required"])))),128))])),_:2},1024)):F("",!0)]),k("div",ae,[x(l,{type:"primary",onClick:r.save},{default:U((()=>[te])),_:1},8,["onClick"])])])])),_:2},1032,["tab"])))),128))])),_:1},8,["activeKey","onChange"])],64)}var oe=J(Q,[["render",ne],["__scopeId","data-v-0f39a7eb"]]);export{oe as default};
