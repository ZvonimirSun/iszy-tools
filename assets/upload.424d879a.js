var x=Object.defineProperty,I=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var d=(e,t,s)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,i=(e,t)=>{for(var s in t||(t={}))v.call(t,s)&&d(e,s,t[s]);if(p)for(var s of p(t))w.call(t,s)&&d(e,s,t[s]);return e},r=(e,t)=>I(e,b(t));import{u as y}from"./index.137def2e.js";import{a5 as U,bn as $,bo as R,h as S,y as m,aI as j,r as n,o as C,f as u,a as o,p as D,b as T,K as l}from"./vendor.a14e91db.js";/* empty css              *//* empty css               */import{_ as q}from"./index.907b2bb2.js";const{Dragger:F}=j,{mapGetters:L,mapActions:O}=U("imgHosting"),N={name:"upload",components:{Dragger:F,UploadOne:$,Spin:R},props:["activeKey"],data:()=>({spinning:!1,timeoutIndex:void 0}),computed:i({},L(["config","uploader","commonConfig"])),mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:r(i({},O(["addImage"])),{async customRequest({file:e}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const t=e.name||"";e=new File([e],(new Date().getTime()+t.substring(t.lastIndexOf("."))).toLowerCase(),{type:e.type,lastModified:e.lastModified})}try{const t=await y[this.uploader].handle(this.config(this.uploader),e);if(this.addImage(t),this.commonConfig.copyUrlAfterUpload)try{await navigator.clipboard.writeText(t.url),this.$msg.success("\u4E0A\u4F20\u6210\u529F\uFF0C\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch{this.$msg.error("\u4E0A\u4F20\u6210\u529F\uFF0C\u4F46\u5730\u5740\u590D\u5236\u5931\u8D25")}else this.$msg.success("\u4E0A\u4F20\u6210\u529F")}catch(t){console.log(t),this.$msg.error("\u4E0A\u4F20\u5931\u8D25")}}else this.$msg.warn("\u8BF7\u5148\u8FDB\u884C\u8BBE\u7F6E");this.spinning=!1},rejectFile(){this.$msg.warning("\u4E0D\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B\uFF01")},paste(e){if(this.activeKey==="home"&&!this.spinning&&!this.timeoutIndex){this.timeoutIndex=setTimeout(()=>{this.timeoutIndex=void 0},500);const t=e.clipboardData&&e.clipboardData.items;let s;if(t&&t.length)for(const a of t)a.type.indexOf("image")!==-1&&(s=a.getAsFile());s?this.customRequest({file:s}):(this.rejectFile(),clearTimeout(this.timeoutIndex),this.timeoutIndex=void 0)}}})},g=e=>(D("data-v-3cf5915e"),e=e(),T(),e),A={class:"ant-upload-drag-icon"},B=g(()=>o("p",{class:"ant-upload-text"},[l("\u76F4\u63A5\u7C98\u8D34\u56FE\u7247\u6216\u62D6\u62FD\u56FE\u7247\u5230\u8FD9\u91CC\u4E0A\u4F20"),o("br"),l("\u6216\u8005\u76F4\u63A5\u70B9\u51FB\u9009\u62E9\u6587\u4EF6\u4E0A\u4F20")],-1)),K=g(()=>o("p",{class:"ant-upload-hint"}," \u6682\u65F6\u4EC5\u652F\u6301\u5355\u6587\u4EF6\u4E0A\u4F20\u3002 ",-1));function V(e,t,s,a,k,c){const h=n("UploadOne"),f=n("Dragger"),_=n("Spin");return C(),S(_,{spinning:e.spinning},{default:m(()=>[u(f,{fileList:[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp",onReject:c.rejectFile,showUploadList:!1,customRequest:c.customRequest},{default:m(()=>[o("p",A,[u(h)]),B,K]),_:1},8,["onReject","customRequest"])]),_:1},8,["spinning"])}var P=q(N,[["render",V],["__scopeId","data-v-3cf5915e"]]);export{P as default};
