import{_ as h,d as f,o as i,L as p,a as v,w as b,c as d,a0 as k,bw as n,a2 as g,M as m,I as D,bx as C}from"./index.357cc62b.js";/* empty css               */import{_ as w}from"./index.5babf5a6.js";import"./index.9eb20582.js";import"./index.128dbe84.js";import"./index.ac6f6a68.js";import"./index.04aeadd7.js";import"./index.9de652ba.js";import"./index.b9480d64.js";import"./index.f036416c.js";import"./css.1dd79e5e.js";import"./useState.b00c61a5.js";import"./toArray.a347eb6c.js";import"./DownOutlined.08a5c6ad.js";import"./index.4ce0c74f.js";import"./index.fc549c81.js";import"./index.1514c349.js";import"./Menu.f652d2d9.js";import"./shallowequal.fd562f2c.js";import"./_arrayIncludesWith.91d14080.js";import"./_baseFindIndex.10ef1a58.js";import"./Overflow.0703196e.js";import"./collapseMotion.557f1869.js";import"./SearchOutlined.d1da9669.js";import"./index.361be55f.js";import"./Password.1e3ed705.js";import"./EyeOutlined.fd09a944.js";import"./Checkbox.13c33bf0.js";import"./responsiveObserve.89320e84.js";import"./isMobile.481c1aec.js";const I=f({name:"PropertyTable",props:{geoJsonLayer:{type:Object,default:void 0}},data:()=>({editableData:{}}),computed:{tableScroll(){return this.$refs.table?(parseFloat(getComputedStyle(this.$refs.table).height),{x:!0}):{x:!0}},features(){if(this.geoJsonLayer)try{return this.geoJsonLayer.toGeoJSON().features}catch{return null}return null},propertyList(){return this.features?this.features.map(e=>e.properties):null},tableColumns(){if(this.propertyList&&this.propertyList.length>0){const t=this.getArrayKeys(this.propertyList).map(o=>({title:o,dataIndex:o,key:o,slots:{customRender:"property"}}));return t.push({title:"\u64CD\u4F5C",dataIndex:"operation",width:40,fixed:"right",slots:{customRender:"operation"}}),t}else return null}},methods:{getArrayKeys(e){return[...e.reduce((t,o)=>(Object.keys(o).forEach(u=>t.add(u)),t),new Set)]},saveToEditableData(e,t,o){if(e instanceof InputEvent&&t&&o)try{t[o]=JSON.parse(e.currentTarget.value)}catch{t[o]=e.currentTarget.value}},edit(e){this.editableData[e]=k(this.propertyList[e])},save(e){Object.assign(this.propertyList[e],this.editableData[e]),delete this.editableData[e],this.$eventBus.emit("updateEditor")},cancel(e){delete this.editableData[e]},rowEvents(e,t){return{onClick:()=>{this.$eventBus.emit("locationGeo",this.features[t])}}}}}),L={key:0,ref:"table"},$={key:0,class:"editable-cell-input-wrapper"},S={key:1,class:"editable-cell-text-wrapper"},E={key:0},T=["onClick"],J=["onClick"],O={key:1},B=["onClick"];function N(e,t,o,u,j,U){const c=D,y=w,_=C;return e.tableColumns?(i(),p("div",L,[v(y,{class:"ant-table-striped",columns:e.tableColumns,"data-source":e.propertyList,"row-key":(r,a)=>a,pagination:!1,bordered:"",size:"small",scroll:e.tableScroll,"row-class-name":(r,a)=>a%2===1?"table-striped":null,"custom-row":e.rowEvents},{property:b(({text:r,column:a,index:s})=>[e.editableData[s]?(i(),p("div",$,[typeof e.editableData[s][a.dataIndex]=="string"?(i(),d(c,{key:0,value:e.editableData[s][a.dataIndex],"onUpdate:value":l=>e.editableData[s][a.dataIndex]=l,onClick:t[0]||(t[0]=n(()=>{},["stop"]))},null,8,["value","onUpdate:value"])):typeof e.editableData[s][a.dataIndex]=="number"?(i(),d(c,{key:1,value:e.editableData[s][a.dataIndex],"onUpdate:value":l=>e.editableData[s][a.dataIndex]=l,valueModifiers:{number:!0},onClick:t[1]||(t[1]=n(()=>{},["stop"]))},null,8,["value","onUpdate:value"])):(i(),d(c,{key:2,value:JSON.stringify(e.editableData[s][a.dataIndex]),onClick:t[2]||(t[2]=n(()=>{},["stop"])),onChange:l=>e.saveToEditableData(l,e.editableData[s],a.dataIndex)},null,8,["value","onChange"]))])):(i(),p("div",S,g(typeof r=="object"?JSON.stringify(r):r),1))]),operation:b(({index:r})=>[e.editableData[r]?(i(),p("span",E,[m("a",{onClick:n(a=>e.save(r),["stop"])}," \u4FDD\u5B58\u5C5E\u6027 ",8,T),m("a",{onClick:n(a=>e.cancel(r),["stop"])}," \u53D6\u6D88\u7F16\u8F91 ",8,J)])):(i(),p("span",O,[m("a",{onClick:n(a=>e.edit(r),["stop"])}," \u7F16\u8F91\u5C5E\u6027 ",8,B)]))]),_:1},8,["columns","data-source","row-key","scroll","row-class-name","custom-row"])],512)):(i(),d(_,{key:1}))}const me=h(I,[["render",N],["__scopeId","data-v-57e1b01c"]]);export{me as default};
