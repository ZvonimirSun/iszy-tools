import{_ as X,j as F,r as N,aq as Y,H as ee,a8 as oe,af as te,bv as ae,o as i,L as w,M as _,b0 as ne,k as n,c as g,w as p,a1 as S,a as c,F as M,au as re,T as A,b as L,bw as se,U as ie,V as pe,I as le,B as ue,b1 as ce}from"./index.357cc62b.js";/* empty css              *//* empty css               */import{m as E,c as l}from"./marker-shadow.f833fd4d.js";import{l as o}from"./leaflet-src.3333f9bc.js";import{F as me}from"./Form.9755f2f4.js";import{_ as de}from"./FormItem.f3b403ae.js";import"./_arrayIncludesWith.91d14080.js";import"./_baseFindIndex.10ef1a58.js";import"./Col.58897bd3.js";import"./responsiveObserve.89320e84.js";import"./useFlexGapSupport.9cead8e6.js";import"./toArray.a347eb6c.js";import"./get.933edb6b.js";import"./hasIn.c522f803.js";import"./toInteger.545ff798.js";import"./toFinite.d09f0183.js";import"./collapseMotion.557f1869.js";const P=b=>(ie("data-v-29e66e1e"),b=b(),pe(),b),fe=P(()=>_("div",{class:"title"},[_("span",null,"\u5C5E\u6027")],-1)),_e={class:"content"},ve=P(()=>_("span",{class:"i-icon-park-outline-add-one"},null,-1)),he={class:"btn-container"},ye={__name:"leafletMap",props:{geoJsonLayer:{type:o.exports.GeoJSON,default:void 0}},emits:["update:geoJsonLayer","getMap"],setup(b,{emit:J}){const m=b,B=new o.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-blue.png",shadowUrl:E,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),V=new o.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-yellow.png",shadowUrl:E,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),v="bed806b1ccb34b268ab1c0700123d444";let r;const h=F("$eventBus"),$=F("$msg"),a=N(void 0),G=N(),z=N(),d=Y({properties:[]}),q=t=>{t.properties.forEach(e=>{e.label&&e.value&&(a.value.properties[e.label]!=null?$.warn("\u5B57\u6BB5 [ "+e.label+" ] \u5B58\u5728\uFF0C\u5DF2\u8DF3\u8FC7"):a.value.properties[e.label]=isNaN(e.value)?e.value:parseFloat(e.value))}),C(),h.emit("updateEditor")};function R(){d.properties.push({label:"",value:"",id:Date.now()})}function C(){d.properties=[]}ee(()=>{h.on("locationGeo",I),h.on("updateGeojsonLayer",U),H(),oe(()=>{K(),Q()})}),te(()=>{h.off("locationGeo",I),h.off("updateGeojsonLayer",U),r&&(r.remove(),r=void 0)});function H(){r=ae(o.exports.map(G.value,{attributionControl:!0,zoomControl:!1})),J("getMap",r),r.setView([35,105],4),J("update:geoJsonLayer",o.exports.geoJSON(void 0,{onEachFeature:W,pointToLayer:(t,e)=>o.exports.marker(e,{icon:B})}).addTo(r))}function K(){o.exports.control.layers({\u9AD8\u5FB7\u77E2\u91CF:l("GaoDe.Normal.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}).addTo(r),\u9AD8\u5FB7\u5F71\u50CF:o.exports.layerGroup([l("GaoDe.Satellite.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20}),l("GaoDe.Satellite.Annotation",{minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u77E2\u91CF:o.exports.layerGroup([l("TianDiTu.Normal.Map",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20}),l("TianDiTu.Normal.Annotation",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5F71\u50CF:o.exports.layerGroup([l("TianDiTu.Satellite.Map",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20}),l("TianDiTu.Satellite.Annotation",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5730\u5F62:o.exports.layerGroup([l("TianDiTu.Terrain.Map",{key:v,minZoom:3,maxNativeZoom:14,maxZoom:20}),l("TianDiTu.Terrain.Annotation",{key:v,minZoom:3,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),OpenStreetMap:l("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> \u8D21\u732E\u8005',minZoom:3,maxNativeZoom:19,maxZoom:20})},{\u56FE\u5F62:re(m.geoJsonLayer)},{hideSingleBase:!0,position:"bottomleft"}).addTo(r)}function Q(){o.exports.control.scale({imperial:!1,position:"bottomright"}).addTo(r),o.exports.control.zoom({zoomInTitle:"\u653E\u5927",zoomOutTitle:"\u7F29\u5C0F",position:"topright"}).addTo(r)}function W(t,e){t.properties||(t.properties={}),e.bindPopup(z.value).on("popupopen",()=>{a.value=t,e instanceof o.exports.Marker?e.setIcon(V):e.setStyle({color:"#ffff00",weight:5,opacity:.65})}).on("popupclose",()=>{a.value=void 0,d.properties=[],e instanceof o.exports.Marker?e.setIcon(B):m.geoJsonLayer.resetStyle(e)})}function Z(t,e,u){if(t instanceof InputEvent&&e&&u)try{e.properties[u]=JSON.parse(t.currentTarget.value)}catch{e.properties[u]=t.currentTarget.value}h.emit("updateEditor")}function I(t){try{const e=o.exports.geoJSON(t);r.fitBounds(e.getBounds())}catch{}}function U(t){if(m.geoJsonLayer&&m.geoJsonLayer instanceof o.exports.GeoJSON){m.geoJsonLayer.clearLayers();try{m.geoJsonLayer.addData(t),r.fitBounds(m.geoJsonLayer.getBounds())}catch(e){console.log(e)}}}return(t,e)=>{var D,j;const u=le,y=de,O=me,T=ue;return i(),w(M,null,[_("div",{ref_key:"mapContainer",ref:G,class:"map-container"},null,512),ne(_("div",{ref_key:"propertyPopup",ref:z,class:"property-popup"},[fe,_("div",_e,[((D=n(a))==null?void 0:D.properties)&&Object.keys((j=n(a))==null?void 0:j.properties).length?(i(),g(O,{key:0,name:"selected-feature-form","label-col":{span:8},"wrapper-col":{span:16},colon:!1},{default:p(()=>[(i(!0),w(M,null,A(n(a).properties,(f,s,x)=>(i(),g(y,{key:"prop"+x,label:s},{default:p(()=>[typeof n(a).properties[s]=="string"?(i(),g(u,{key:0,value:n(a).properties[s],"onUpdate:value":k=>n(a).properties[s]=k,onChange:Z},null,8,["value","onUpdate:value"])):typeof n(a).properties[s]=="number"?(i(),g(u,{key:1,value:n(a).properties[s],"onUpdate:value":k=>n(a).properties[s]=k,valueModifiers:{number:!0},onChange:Z},null,8,["value","onUpdate:value"])):(i(),g(u,{key:2,value:JSON.stringify(f),onChange:k=>Z(k,n(a),s)},null,8,["value","onChange"]))]),_:2},1032,["label"]))),128))]),_:1})):S("",!0),c(O,{name:"add-property-form",model:n(d),onFinish:q},{default:p(()=>[Object.keys(n(d).properties).length?(i(!0),w(M,{key:0},A(n(d).properties,(f,s)=>(i(),w("div",{key:f.id,class:"form-item-container"},[c(y,{name:["properties",s,"label"],rules:{required:!0,message:"\u5C5E\u6027\u540D\u79F0\u7F3A\u5931"}},{default:p(()=>[c(u,{value:f.label,"onUpdate:value":x=>f.label=x,placeholder:"\u5C5E\u6027\u540D\u79F0"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),c(y,{name:["properties",s,"value"],rules:{required:!0,message:"\u5C5E\u6027\u503C\u7F3A\u5931"}},{default:p(()=>[c(u,{value:f.value,"onUpdate:value":x=>f.value=x,placeholder:"\u5C5E\u6027\u503C"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]))),128)):S("",!0),c(y,null,{default:p(()=>[c(T,{type:"dashed",block:"",onClick:R},{default:p(()=>[ve,L("\u65B0\u589E\u5C5E\u6027 ")]),_:1})]),_:1}),Object.keys(n(d).properties).length?(i(),g(y,{key:1},{default:p(()=>[_("div",he,[c(T,{type:"primary","html-type":"submit"},{default:p(()=>[L(" \u786E\u8BA4 ")]),_:1}),c(T,{onClick:se(C,["stop"])},{default:p(()=>[L(" \u53D6\u6D88 ")]),_:1},8,["onClick"])])]),_:1})):S("",!0)]),_:1},8,["model"])])],512),[[ce,!1]])],64)}}},Oe=X(ye,[["__scopeId","data-v-29e66e1e"]]);export{Oe as default};
