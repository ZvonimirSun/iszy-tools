import{K as a,L as m,N as n,Y as N,k as C,a4 as y,T as F,aW as p,ax as f,aA as u,E as v,r as _,q as Y,G as $,w as E,H as h,x as D,a0 as M}from"./index-CNzdGqTQ.js";import"./el-empty-Bf0CbOR1.js";import{F as V,a as R,E as H}from"./el-table-v2-BEwvEx4-.js";import{E as K,a as O}from"./el-breadcrumb-item-BLHp7L8Y.js";import{d as w}from"./dayjs.min-D7hBwLbq.js";/* empty css               */import{E as j}from"./el-popover-5gY-Uqq4.js";import"./el-popper-QVlflJlA.js";import{E as g}from"./index-CRQXUnIz.js";import"./castArray-D9e7mwfO.js";import"./raf-JgjDsWHs.js";import"./memoize-one.esm-BdPwpGay.js";import"./index-Bm6qctQA.js";import"./isUndefined-DCTLXrZ8.js";var c=function(r){return r[r.DELETED=-1]="DELETED",r[r.DEACTIVATED=0]="DEACTIVATED",r[r.ENABLED=1]="ENABLED",r[r.DISABLED=2]="DISABLED",r}(c||{});function G(r){return[{key:"userId",dataKey:"userId",width:150,hidden:!0},{key:"userName",dataKey:"userName",title:"用户名",width:150,align:"center"},{key:"nickName",dataKey:"nickName",title:"昵称",width:150,align:"center"},{key:"email",dataKey:"email",title:"邮箱",width:150,align:"center"},{key:"roles",title:"角色",width:150,align:"center",cellRenderer:({rowData:t})=>{var d;const i=((d=t.roles)==null?void 0:d.map(o=>o.name).join(", "))||"";return a("span",null,[i])}},{key:"status",title:"状态",width:100,align:"center",cellRenderer:({rowData:t})=>{switch(t.status){case c.ENABLED:return a(g,{type:"success"},{default:()=>[n("正常")]});case c.DISABLED:return a(g,{type:"info"},{default:()=>[n("禁用")]});case c.DEACTIVATED:return a(g,{type:"info"},{default:()=>[n("待激活")]});default:return a(g,{type:"warning"},{default:()=>[n("未知")]})}}},{key:"createdAt",title:"创建时间",width:200,align:"center",cellRenderer:({rowData:t})=>a("span",null,[w(t.createdAt).format("YYYY-MM-DD HH:mm:ss")])},{key:"updatedAt",title:"更新时间",width:200,align:"center",cellRenderer:({rowData:t})=>a("span",null,[w(t.updatedAt).format("YYYY-MM-DD HH:mm:ss")])},{key:"operations",title:"操作",width:200,fixed:V.RIGHT,cellRenderer:({rowData:t})=>a(N,null,[a(m,{size:"small",plain:!0,onClick:()=>r(t,"edit")},{default:()=>[n("修改")]}),t.status===c.DEACTIVATED||t.status===c.DISABLED?a(m,{size:"small",plain:!0,onClick:()=>r(t,"activate")},{default:()=>[n("启用")]}):a(m,{size:"small",plain:!0,onClick:()=>r(t,"disable")},{default:()=>[n("禁用")]}),a(j,{title:"确定要删除吗？",onConfirm:()=>r(t,"delete")},{reference:()=>a(m,{size:"small",plain:!0,type:"danger"},{default:()=>[n("删除")]})})])}]}const q={"h-full":"","w-full":"",flex:"","flex-col":"","gap-4":"","pa-4":""},P=C({__name:"userManager",setup(r){const t=y([]),i=y({index:1,size:10}),d=G(A);F(()=>{o(1,i.size)});async function o(s,e){try{const l=(await p.get(`${f.apiOrigin}/user/list`,{params:{pageIndex:s,pageSize:e}})).data;if(l.success)t.splice(0,t.length,...l.data);else throw new Error(l.message)}catch(l){u.error(l.message)}}function A(s,e){switch(e){case"edit":break;case"disable":k(s);break;case"activate":I(s);break;case"delete":b(s);break}}async function k(s){try{const e=(await p.put(`${f.apiOrigin}/user/ban`,null,{params:{id:s.userId}})).data;if(e.success)u.success(e.message),await o(i.index,i.size);else throw new Error(e.message)}catch(e){u.error(e.message)}}async function I(s){try{const e=(await p.put(`${f.apiOrigin}/user/activate`,null,{params:{id:s.userId}})).data;if(e.success)u.success(e.message),await o(i.index,i.size);else throw new Error(e.message)}catch(e){u.error(e.message)}}async function b(s){try{const e=(await p.delete(`${f.apiOrigin}/user/${s.userId}`)).data;if(e.success)u.success(e.message),await o(i.index,i.size);else throw new Error(e.message)}catch(e){u.error(e.message)}}return(s,e)=>{const l=K,B=O,T=R,x=H;return _(),v("div",q,[s.$route.meta.parentInfo?(_(),Y(B,{key:0},{default:E(()=>[a(l,{to:s.$route.meta.parentInfo.link},{default:E(()=>[n(h(s.$route.meta.parentInfo.name),1)]),_:1},8,["to"]),a(l,null,{default:E(()=>[n(h(s.$route.name),1)]),_:1})]),_:1})):$("",!0),a(x,{"flex-1":""},{default:E(({width:z,height:L})=>[a(T,{columns:D(d),data:D(t),width:z,height:L,fixed:""},null,8,["columns","data","width","height"])]),_:1})])}}}),le=M(P,[["__scopeId","data-v-8f7eef95"]]);export{le as default};
