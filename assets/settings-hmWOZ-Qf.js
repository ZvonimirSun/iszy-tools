import{k as A,aw as I,J as M,n as j,s as J,G as O,x as s,aB as K,R as B,a4 as F,E as S,r as b,Y as $,K as t,F as p,w as o,N as r,H as U,L as G,X as L,W as Q,aA as R,a0 as H,P as W,at as X,bl as Y,Q as z,q as D}from"./index-BnVvX7-X.js";import{E as Z}from"./el-checkbox-BQNB1-8S.js";import{E as h,a as ee}from"./el-radio-group-Bi3zPz24.js";/* empty css                 */import{E as te}from"./el-space-R4dyk40-.js";import{E as oe}from"./el-divider-BW5S2Hok.js";import{E as le}from"./el-popover-CR0Oh9Kv.js";import"./el-popper-DdNCOOvz.js";import{u as se,T as q}from"./Router-CDhhOxJv.js";import{E as ae}from"./el-dialog-RKYl4eCI.js";import{a as ne,E as re}from"./el-form-item-Bd9ykJoN.js";import"./index-aeNPmGjh.js";import"./isUndefined-DCTLXrZ8.js";import"./castArray-DaOcXusk.js";const de=A({inheritAttrs:!1,__name:"HaveAccess",props:{auth:{type:[Boolean,Object],default:!1},link:{default:""}},setup(w){const n=w,_=I(),y=se(),a=M(),c=j(()=>n.auth?typeof n.auth=="boolean"?_.logged:_.checkAccess(n.auth):n.link?_.checkAccess(y.getAuth(n.link)):!0);function d(){n.link&&a.push(n.link)}return(v,P)=>s(c)?J(v.$slots,"default",K({key:0},v.$attrs,{goto:d})):O("",!0)}}),ie={flex:"","flex-col":"","items-start":"","gap-4":"","text-7":""},ue={flex:""},pe={flex:""},me={flex:""},fe={class:"dialog-footer"},_e=A({__name:"personalInfo",setup(w){const n=I(),_=B(!1),y=B(),a=F({nickName:"",email:"",passwd:"",rePasswd:"",oldPasswd:""}),c=F({rePasswd:[{validator:(k,l,i)=>{l&&l!==a.passwd?i(new Error("两次输入的密码不一致")):i()}}],oldPasswd:[{validator:(k,l,i)=>{!l&&(a.passwd||a.rePasswd)?i(new Error("请输入旧密码")):i()}}]});function d(){a.nickName=n.profile.nickName??"",a.email=n.profile.email??"",a.passwd="",a.rePasswd="",a.oldPasswd="",_.value=!0}function v(){_.value=!1}async function P(k){k&&await k.validate(async l=>{if(l){const i={};if(a.nickName&&(i.nickName=a.nickName),a.email&&(i.email=a.email),a.passwd&&(i.passwd=a.passwd,i.oldPasswd=a.oldPasswd),Object.keys(i).length===0){R.warning("没有需要修改的信息");return}try{await n.updateUser(i)}catch(e){R.error(e.message)}_.value=!1}else R.warning("请检查输入")})}return(k,l)=>{var x,V,E;const i=q,e=G,m=Q,g=re,T=ne,N=ae;return b(),S($,null,[t(i,{level:4},{default:o(()=>l[7]||(l[7]=[r(" 账户信息 ")])),_:1}),p("div",ie,[p("div",ue,[l[8]||(l[8]=p("div",{"w-32":""}," 昵称: ",-1)),p("div",null,U(s(n).profile.nickName),1)]),p("div",pe,[l[9]||(l[9]=p("div",{"w-32":""}," 邮箱: ",-1)),p("div",null,U(s(n).profile.email),1)]),p("div",me,[l[10]||(l[10]=p("div",{"w-32":""}," 角色 ",-1)),p("div",null,U(((E=(V=(x=s(n).profile)==null?void 0:x.roles)==null?void 0:V[0])==null?void 0:E.alias)??"注册用户"),1)]),t(e,{onClick:d},{default:o(()=>l[11]||(l[11]=[r(" 修改信息 ")])),_:1})]),t(N,{modelValue:s(_),"onUpdate:modelValue":l[6]||(l[6]=u=>L(_)?_.value=u:null),title:"修改信息","before-close":v},{footer:o(()=>[p("span",fe,[t(e,{onClick:v},{default:o(()=>l[12]||(l[12]=[r("取消")])),_:1}),t(e,{type:"primary",onClick:l[5]||(l[5]=u=>P(s(y)))},{default:o(()=>l[13]||(l[13]=[r(" 保存 ")])),_:1})])]),default:o(()=>[t(T,{ref_key:"ruleFormRef",ref:y,model:s(a),rules:s(c),"label-width":"8rem","label-position":"left"},{default:o(()=>[t(g,{label:"昵称",prop:"nickName"},{default:o(()=>[t(m,{modelValue:s(a).nickName,"onUpdate:modelValue":l[0]||(l[0]=u=>s(a).nickName=u)},null,8,["modelValue"])]),_:1}),t(g,{label:"邮箱",prop:"email"},{default:o(()=>[t(m,{modelValue:s(a).email,"onUpdate:modelValue":l[1]||(l[1]=u=>s(a).email=u)},null,8,["modelValue"])]),_:1}),t(g,{label:"旧密码",prop:"oldPasswd"},{default:o(()=>[t(m,{modelValue:s(a).oldPasswd,"onUpdate:modelValue":l[2]||(l[2]=u=>s(a).oldPasswd=u),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(g,{label:"新密码",prop:"passwd"},{default:o(()=>[t(m,{modelValue:s(a).passwd,"onUpdate:modelValue":l[3]||(l[3]=u=>s(a).passwd=u),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(g,{label:"确认密码",prop:"rePasswd"},{default:o(()=>[t(m,{modelValue:s(a).rePasswd,"onUpdate:modelValue":l[4]||(l[4]=u=>s(a).rePasswd=u),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}}}),ge=H(_e,[["__scopeId","data-v-9eb04cae"]]),we=W("main",{persist:!0,state:()=>({_cache:{},clearOfflineCacheTag:!1}),getters:{getData:w=>n=>{if(n)return(w._cache||{})[n]}},actions:{setData({key:w,val:n}={}){w&&(this._cache=this._cache||{},this._cache[w]=n)},clear(){this._cache={}},clearOfflineCache(){console.log("clearOfflineCache"),this.clearOfflineCacheTag=!0}}}),ve={flex:"","items-center":"","gap-4":""},Ve={flex:"","flex-wrap":"","items-start":"","gap-4":"","text-7":"",class:"settings-container"},ce={class:"settings-wrapper"},ke={key:0,class:"settings-wrapper"},ye=A({__name:"settings",setup(w){const n=M(),_=X(),y=Y(),a=I(),c=z(),d=j(()=>c.general),v=()=>we().clearOfflineCache();function P(){n.push({path:"/login",query:{redirect:_.fullPath}})}function k(){n.push("/register")}function l(){n.push("/logout")}return(i,e)=>{const m=q,g=G,T=de,N=le,x=oe,V=te,E=ee,u=h,C=Z;return b(),S($,null,[s(a).logged?(b(),D(m,{key:0,level:3},{default:o(()=>[r(U(s(a).profile.nickName)+" 欢迎你~ ",1)]),_:1})):O("",!0),s(a).logged?(b(),S($,{key:1},[p("div",ve,[t(g,{type:"primary",onClick:l},{default:o(()=>e[6]||(e[6]=[r(" 登出 ")])),_:1}),t(T,{link:"/userManager"},{default:o(({goto:f})=>[t(g,{onClick:f},{default:o(()=>e[7]||(e[7]=[r(" 用户权限中心 ")])),_:2},1032,["onClick"])]),_:1}),t(N,{title:"您是否确定要清空本地缓存？","confirm-button-text":"清空",onConfirm:v},{reference:o(()=>[t(g,{type:"danger",plain:""},{default:o(()=>e[8]||(e[8]=[r(" 清空本地缓存 ")])),_:1})]),_:1})]),t(x),t(ge)],64)):(b(),D(V,{key:2,"mt-4":""},{default:o(()=>[t(g,{type:"primary",onClick:P},{default:o(()=>e[9]||(e[9]=[r(" 登录 ")])),_:1}),t(g,{onClick:k},{default:o(()=>e[10]||(e[10]=[r(" 注册 ")])),_:1}),t(N,{title:"您是否确定要清空本地缓存？","confirm-button-text":"清空",onConfirm:v},{reference:o(()=>[t(g,{type:"danger",plain:""},{default:o(()=>e[11]||(e[11]=[r(" 清空本地缓存 ")])),_:1})]),_:1})]),_:1})),t(x),p("div",Ve,[p("div",ce,[t(m,{level:4},{default:o(()=>e[12]||(e[12]=[r(" 全局设置 ")])),_:1}),t(m,{level:5},{default:o(()=>e[13]||(e[13]=[r(" 外观 ")])),_:1}),t(V,null,{default:o(()=>[t(u,{"model-value":s(d).theme.mode,onChange:s(y).setTheme},{default:o(()=>[t(E,{value:"auto",label:"跟随系统"}),t(E,{value:"light",label:"浅色"}),t(E,{value:"dark",label:"深色"})]),_:1},8,["model-value","onChange"])]),_:1}),t(m,{level:5},{default:o(()=>e[14]||(e[14]=[r(" 访问统计 ")])),_:1}),t(V,null,{default:o(()=>[t(C,{modelValue:s(d).showMost,"onUpdate:modelValue":e[0]||(e[0]=f=>s(d).showMost=f)},{default:o(()=>e[15]||(e[15]=[r(" 最常访问 ")])),_:1},8,["modelValue"]),t(C,{modelValue:s(d).showRecent,"onUpdate:modelValue":e[1]||(e[1]=f=>s(d).showRecent=f)},{default:o(()=>e[16]||(e[16]=[r(" 最近访问 ")])),_:1},8,["modelValue"])]),_:1}),t(m,{level:5},{default:o(()=>e[17]||(e[17]=[r(" 其他设置 ")])),_:1}),t(V,null,{default:o(()=>[t(C,{modelValue:s(d).showSearch,"onUpdate:modelValue":e[2]||(e[2]=f=>s(d).showSearch=f)},{default:o(()=>e[18]||(e[18]=[r(" 显示搜索 ")])),_:1},8,["modelValue"]),t(C,{modelValue:s(d).showType,"onUpdate:modelValue":e[3]||(e[3]=f=>s(d).showType=f)},{default:o(()=>e[19]||(e[19]=[r(" 显示分类 ")])),_:1},8,["modelValue"]),t(C,{modelValue:s(d).openInNewTab,"onUpdate:modelValue":e[4]||(e[4]=f=>s(d).openInNewTab=f)},{default:o(()=>e[20]||(e[20]=[r(" 新标签页打开工具 ")])),_:1},8,["modelValue"])]),_:1})]),s(a).logged?(b(),S("div",ke,[t(m,{level:4},{default:o(()=>e[21]||(e[21]=[r(" 应用设置 ")])),_:1}),t(m,{level:5},{default:o(()=>e[22]||(e[22]=[r(" JSON 编辑器 ")])),_:1}),t(V,null,{default:o(()=>[t(C,{modelValue:s(c).modules.jsonEditor.syncCloud,"onUpdate:modelValue":e[5]||(e[5]=f=>s(c).modules.jsonEditor.syncCloud=f)},{default:o(()=>e[23]||(e[23]=[r(" 从云端获取 ")])),_:1},8,["modelValue"])]),_:1})])):O("",!0)])],64)}}}),Be=H(ye,[["__scopeId","data-v-54fc6cac"]]);export{Be as default};
