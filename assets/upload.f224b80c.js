var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,r=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&o(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&o(e,a,t[a]);return e},d=(e,n)=>t(e,a(n));import{u as p}from"./index.18e8bfc5.js";import{E as c,b1 as m,b2 as g,a as l,o as h,c as f,w as u,b,e as v,au as j,p as w,h as y,g as O}from"./vendor.588f181b.js";/* empty css              *//* empty css              */import{_ as x}from"./index.5ccb8b04.js";var D=".container[data-v-62ed2f23] {\n  width: 100%;\n  height: 100%;\n}\n[data-v-62ed2f23] .ant-upload-drag-icon .i-icon {\n  font-size: 4.8rem;\n}\n.ant-spin-nested-loading[data-v-62ed2f23] {\n  height: 100% !important;\n}\n.ant-spin-nested-loading[data-v-62ed2f23] .ant-spin {\n  height: 100%;\n  max-height: unset;\n}\n.ant-spin-nested-loading[data-v-62ed2f23] .ant-spin-container {\n  height: 100%;\n}";const{Dragger:R}=j,{mapGetters:q,mapState:F,mapActions:I}=c("imgHosting"),L={name:"upload",components:{Dragger:R,UploadOne:m,Spin:g},props:["activeKey"],data:()=>({spinning:!1}),computed:r(r({},q(["config"])),F(["uploader","commonConfig"])),mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:d(r({},I(["addImage"])),{async customRequest({file:e}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const t=e.name||"";e=new File([e],((new Date).getTime()+t.substring(t.lastIndexOf("."))).toLowerCase(),{type:e.type,lastModified:e.lastModified})}try{const a=await p[this.uploader].handle(this.config(this.uploader),e);this.addImage(a);try{await navigator.clipboard.writeText(a.url),this.$msg.success("上传成功，地址已复制到剪贴板")}catch(t){this.$msg.error("上传成功，但地址复制失败")}}catch(t){this.$msg.error("上传失败")}}else this.$msg.warn("请先进行设置");this.spinning=!1},rejectFile(){this.$msg.warning("不支持的文件类型！")},paste(e){if("home"===this.activeKey){const t=e.clipboardData&&e.clipboardData.items;let a;t&&t.length&&(-1!==t[0].type.indexOf("image")?(a=t[0].getAsFile(),this.customRequest({file:a})):this.rejectFile())}}})},P=e=>(w("data-v-62ed2f23"),e=e(),y(),e),S={class:"ant-upload-drag-icon"},$=P((()=>v("p",{class:"ant-upload-text"},[O("直接粘贴图片或拖拽图片到这里上传"),v("br"),O("或者直接点击选择文件上传")],-1))),_=P((()=>v("p",{class:"ant-upload-hint"}," 暂时仅支持单文件上传。 ",-1)));function E(e,t,a,n,i,s){const o=l("UploadOne"),r=l("Dragger"),d=l("Spin");return h(),f(d,{spinning:e.spinning},{default:u((()=>[b(r,{fileList:[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp",onReject:s.rejectFile,showUploadList:!1,customRequest:s.customRequest},{default:u((()=>[v("p",S,[b(o)]),$,_])),_:1},8,["onReject","customRequest"])])),_:1},8,["spinning"])}var U=x(L,[["render",E],["__scopeId","data-v-62ed2f23"]]);export{U as default};
