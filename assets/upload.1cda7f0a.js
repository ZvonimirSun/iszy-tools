var x=Object.defineProperty,b=Object.defineProperties;var v=Object.getOwnPropertyDescriptors;var c=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var p=(e,t,s)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,a=(e,t)=>{for(var s in t||(t={}))w.call(t,s)&&p(e,s,t[s]);if(c)for(var s of c(t))I.call(t,s)&&p(e,s,t[s]);return e},r=(e,t)=>b(e,v(t));import{u as y}from"./index.a3ea5dc6.js";import{q as j,b5 as S,b6 as U,r as n,o as $,u as R,w as m,f as u,a as i,az as q,p as C,b as D,y as l}from"./vendor.db920537.js";/* empty css              *//* empty css                */import{_ as T}from"./index.c26a5e36.js";const{Dragger:F}=q,{mapGetters:L,mapState:O,mapActions:N}=j("imgHosting"),A={name:"upload",components:{Dragger:F,UploadOne:S,Spin:U},props:["activeKey"],data:()=>({spinning:!1,timeoutIndex:void 0}),computed:a(a({},L(["config"])),O(["uploader","commonConfig"])),mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:r(a({},N(["addImage"])),{async customRequest({file:e}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const t=e.name||"";e=new File([e],(new Date().getTime()+t.substring(t.lastIndexOf("."))).toLowerCase(),{type:e.type,lastModified:e.lastModified})}try{const t=await y[this.uploader].handle(this.config(this.uploader),e);if(this.addImage(t),this.commonConfig.copyUrlAfterUpload)try{await navigator.clipboard.writeText(t.url),this.$msg.success("\u4E0A\u4F20\u6210\u529F\uFF0C\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch{this.$msg.error("\u4E0A\u4F20\u6210\u529F\uFF0C\u4F46\u5730\u5740\u590D\u5236\u5931\u8D25")}else this.$msg.success("\u4E0A\u4F20\u6210\u529F")}catch(t){console.log(t),this.$msg.error("\u4E0A\u4F20\u5931\u8D25")}}else this.$msg.warn("\u8BF7\u5148\u8FDB\u884C\u8BBE\u7F6E");this.spinning=!1},rejectFile(){this.$msg.warning("\u4E0D\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B\uFF01")},paste(e){if(this.activeKey==="home"&&!this.spinning&&!this.timeoutIndex){this.timeoutIndex=setTimeout(()=>{this.timeoutIndex=void 0},500);const t=e.clipboardData&&e.clipboardData.items;let s;if(t&&t.length)for(const o of t)o.type.indexOf("image")!==-1&&(s=o.getAsFile());s?this.customRequest({file:s}):(this.rejectFile(),clearTimeout(this.timeoutIndex),this.timeoutIndex=void 0)}}})},g=e=>(C("data-v-2b66aed2"),e=e(),D(),e),B={class:"ant-upload-drag-icon"},V=g(()=>i("p",{class:"ant-upload-text"},[l("\u76F4\u63A5\u7C98\u8D34\u56FE\u7247\u6216\u62D6\u62FD\u56FE\u7247\u5230\u8FD9\u91CC\u4E0A\u4F20"),i("br"),l("\u6216\u8005\u76F4\u63A5\u70B9\u51FB\u9009\u62E9\u6587\u4EF6\u4E0A\u4F20")],-1)),k=g(()=>i("p",{class:"ant-upload-hint"}," \u6682\u65F6\u4EC5\u652F\u6301\u5355\u6587\u4EF6\u4E0A\u4F20\u3002 ",-1));function E(e,t,s,o,H,d){const h=n("UploadOne"),f=n("Dragger"),_=n("Spin");return $(),R(_,{spinning:e.spinning},{default:m(()=>[u(f,{fileList:[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp",onReject:d.rejectFile,showUploadList:!1,customRequest:d.customRequest},{default:m(()=>[i("p",B,[u(h)]),V,k]),_:1},8,["onReject","customRequest"])]),_:1},8,["spinning"])}var Q=T(A,[["render",E],["__scopeId","data-v-2b66aed2"]]);export{Q as default};
