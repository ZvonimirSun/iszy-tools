import{G as ee,J as ae,d as te,P as y,e as ie,K as O,b7 as I,g as oe,h as C,a as t,as as re,a0 as se,X as ne,ad as le,s as W,ac as G,Y as K,cg as de,C as ce,ch as ue,i as pe,E as he,ci as me,cj as ve,ck as fe,cl as ge,_ as be,o as g,m as H,w as o,q as l,F as j,n as T,c as M,a2 as ke,a1 as Ce,y as w,b as u,B as we}from"./index.6b075e9a.js";/* empty css              *//* empty css              */import{_ as _e}from"./index.edd0b283.js";/* empty css              */import{_ as ye}from"./index.930a66b8.js";import{_ as Ee}from"./index.9aae888d.js";import{F as Se}from"./Form.119ef02f.js";import{_ as Me}from"./FormItem.b9ef37ce.js";import"./toArray.9b72b86f.js";import"./Overflow.72920c68.js";import"./isMobile.6491fde5.js";import"./useState.3249211e.js";import"./DownOutlined.4912edc5.js";import"./SearchOutlined.9b969b07.js";import"./useFlexGapSupport.961efcb4.js";import"./_arrayIncludesWith.91d14080.js";import"./_baseFindIndex.10ef1a58.js";import"./debounce.548054c3.js";import"./Col.a9a9e3f5.js";import"./responsiveObserve.b9846712.js";import"./get.0e345cac.js";import"./hasIn.eadcf762.js";import"./toInteger.8027272a.js";import"./toFinite.24189daa.js";import"./collapseMotion.4df58250.js";var xe={success:ce,info:ue,error:pe,warning:he},Re={success:me,info:ve,error:fe,warning:ge},De=ae("success","info","warning","error"),Ae=function(){return{type:y.oneOf(De),closable:{type:Boolean,default:void 0},closeText:y.any,message:y.any,description:y.any,afterClose:Function,showIcon:{type:Boolean,default:void 0},prefixCls:String,banner:{type:Boolean,default:void 0},icon:y.any,closeIcon:y.any,onClose:Function}},ze=te({name:"AAlert",inheritAttrs:!1,props:Ae(),setup:function(a,d){var r=d.slots,_=d.emit,i=d.attrs,b=d.expose,h=ie("alert",a),V=h.prefixCls,x=h.direction,k=O(!1),m=O(!1),v=O(),L=function(p){p.preventDefault();var f=v.value;f.style.height="".concat(f.offsetHeight,"px"),f.style.height="".concat(f.offsetHeight,"px"),k.value=!0,_("close",p)},R=function(){var p;k.value=!1,m.value=!0,(p=a.afterClose)===null||p===void 0||p.call(a)};b({animationEnd:R});var n=O({});return function(){var c,p,f=a.banner,F=a.closeIcon,P=F===void 0?(p=r.closeIcon)===null||p===void 0?void 0:p.call(r):F,U=a.closable,E=a.type,S=a.showIcon,B=I(r,a,"closeText"),D=I(r,a,"description"),N=I(r,a,"message"),A=I(r,a,"icon");S=f&&S===void 0?!0:S,E=f&&E===void 0?"warning":E||"info";var q=(D?Re:xe)[E]||null;B&&(U=!0);var s=V.value,J=oe(s,(c={},C(c,"".concat(s,"-").concat(E),!0),C(c,"".concat(s,"-closing"),k.value),C(c,"".concat(s,"-with-description"),!!D),C(c,"".concat(s,"-no-icon"),!S),C(c,"".concat(s,"-banner"),!!f),C(c,"".concat(s,"-closable"),U),C(c,"".concat(s,"-rtl"),x.value==="rtl"),c)),X=U?t("button",{type:"button",onClick:L,class:"".concat(s,"-close-icon"),tabindex:0},[B?t("span",{class:"".concat(s,"-close-text")},[B]):P===void 0?t(re,null,null):P]):null,Q=A&&(se(A)?ne(A,{class:"".concat(s,"-icon")}):t("span",{class:"".concat(s,"-icon")},[A]))||t(q,{class:"".concat(s,"-icon")},null),$=le("".concat(s,"-motion"),{appear:!1,css:!0,onAfterLeave:R,onBeforeLeave:function(z){z.style.maxHeight="".concat(z.offsetHeight,"px")},onLeave:function(z){z.style.maxHeight="0px"}});return m.value?null:t(de,$,{default:function(){return[W(t("div",K(K({role:"alert"},i),{},{style:[i.style,n.value],class:[i.class,J],"data-show":!k.value,ref:v}),[S?Q:null,t("div",{class:"".concat(s,"-content")},[N?t("div",{class:"".concat(s,"-message")},[N]):null,D?t("div",{class:"".concat(s,"-description")},[D]):null]),X]),[[G,!k.value]])]}})}}}),Oe=ee(ze);const Ie="unstart",Z="recording",Te="paused",Ve="stopped",Le={name:"ScreenRecord",data:()=>({recorder:null,screenShareVideoElement:null,localScreenShareStream:null,disabled:{open:!1,start:!0,pause:!0,resume:!0,stop:!0,download:!0},status:Ie,chunks:[],blobUrl:"",recordAudio:"never",recordAudioOptions:[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],recordMicro:"never",recordMicroOptions:[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],aspectRatio:"default",aspectRatioList:[{label:"\u9ED8\u8BA4",value:"default"},{label:"16:9",value:1.77},{label:"4:3",value:1.33},{label:"21:9",value:2.35},{label:"14:10",value:1.4},{label:"19:10",value:1.9}],frameRate:"default",frameRateList:[{label:"\u9ED8\u8BA4",value:"default"},{label:"60",value:60},{label:"30",value:30},{label:"25",value:25},{label:"15",value:15},{label:"5",value:5}],resolutions:"default",resolutionsList:[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u5C4F\u5E55\u5C3A\u5BF8",value:"fit-screen"},{label:"4K",value:"4k"},{label:"1080p",value:"1080p"},{label:"720p",value:"720p"}],cursor:"default",cursorList:[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u603B\u662F\u663E\u793A",value:"always"},{label:"\u79FB\u52A8\u65F6\u663E\u793A",value:"motion"},{label:"\u4ECE\u4E0D\u663E\u793A",value:"never"}]}),computed:{supportedConstraints(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?navigator.mediaDevices.getSupportedConstraints():{}},isScreenShareSupported(){return Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)},isWebRTCSupported(){return Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)},isSupported(){return this.isScreenShareSupported&&this.isWebRTCSupported},showREC(){return this.status===Z},displayMediaOptions(){const e={};return this.aspectRatio!=="default"&&(e.aspectRatio=this.aspectRatio),this.frameRate!=="default"&&(e.frameRate=this.frameRate),this.cursor!=="default"&&(e.cursor=this.cursor),this.resolutions!=="default"&&(this.resolutions==="fit-screen"&&(e.width=screen.width,e.height=screen.height),this.resolutions==="4K"&&(e.width=3840,e.height=2160),this.resolutions==="1080p"&&(e.width=1920,e.height=1080),this.resolutions==="720p"&&(e.width=1280,e.height=720)),{video:e,audio:this.recordAudio==="always"}},currentDisplayMediaOptions(){if(this.localScreenShareStream){const e=this.localScreenShareStream.getVideoTracks();if(e.length>0){const a=e[0].getSettings(),d={recordAudio:this.recordAudioOptions.find(r=>this.recordAudio===r.value).label,recordMicro:this.recordMicroOptions.find(r=>this.recordMicro===r.value).label,frameRate:a.frameRate,width:a.width,height:a.height};if(a.aspectRatio){const r=this.aspectRatioList.find(_=>a.aspectRatio-_.value<=.1);r?d.aspectRatio=r.label:d.aspectRatio="\u9ED8\u8BA4"}if(a.cursor){const r=this.cursorList.find(_=>a.cursor===_.value);r?d.cursor=r.label:d.cursor="\u9ED8\u8BA4"}return{video:d}}}return{video:{},audio:{}}}},mounted(){this.screenShareVideoElement=this.$refs.screenShare},beforeUnmount(){this.stop()},methods:{async openScreenShare(){try{if(this.localScreenShareStream=await navigator.mediaDevices.getDisplayMedia(this.displayMediaOptions),this.recordMicro==="always"){const a=await navigator.mediaDevices.getUserMedia({audio:!0});this.localScreenShareStream.addTrack(a.getAudioTracks()[0])}const e=this.localScreenShareStream.getVideoTracks()[0];e&&(e.onended=this.onScreenShareEnded,e.onmute=this.onScreenShareEnded),this.recorder=new MediaRecorder(this.localScreenShareStream),this.recorder.onstop=this.onRecordStopped,this.recorder.ondataavailable=this.onDataAvailable,this.screenShareVideoElement.srcObject=this.localScreenShareStream,this.screenShareVideoElement.muted=!0,this.disabled.open=!0,this.disabled.start=!1}catch(e){this.$msg.error(e.message)}},start(){this.recorder.start(),this.status=Z,this.disabled.start=!0,this.disabled.pause=!1,this.disabled.stop=!1},pause(){this.recorder.pause(),this.status=Te,this.disabled.pause=!0,this.disabled.resume=!1},resume(){this.recorder.resume(),this.status=Z,this.disabled.pause=!1,this.disabled.resume=!0},stop(){this.recorder&&this.recorder.state!=="inactive"&&this.recorder.stop(),this.status=Ve,this.disabled.start=!1,this.disabled.pause=!0,this.disabled.resume=!0,this.disabled.stop=!0},download(){if(this.blobUrl){const e=document.createElement("a");e.href=this.blobUrl,e.download="screen-record.mp4",e.click()}},onScreenShareEnded(){if(this.stop(),this.localScreenShareStream)this.localScreenShareStream.getTracks().forEach(a=>{a.stop()});else return;this.$msg.info("\u5C4F\u5E55\u5206\u4EAB\u7ED3\u675F"),this.localScreenShareStream=null,this.screenShareVideoElement.srcObject=null,this.disabled.open=!1,this.disabled.start=!0},onRecordStopped(){const e=new Blob(this.chunks,{type:"video/mp4"});this.blobUrl=URL.createObjectURL(e),this.disabled.download=!1,this.chunks=[]},onDataAvailable(e){this.chunks.push(e.data)},selectAudio(){this.recordAudio&&this.recordMicro&&(this.recordMicro="never")},selectMicro(){this.recordAudio&&this.recordMicro&&(this.recordAudio="never")}}},Ue=u(" \u5B9E\u65F6\u9884\u89C8 "),Be={class:"previewVideo"},He={ref:"screenShare",autoplay:""},je={class:"rec"},Ze=u(" \u5F00\u542F\u5C4F\u5E55\u5171\u4EAB "),Fe=u(" \u5F00\u59CB\u5F55\u5236 "),Pe=u(" \u6682\u505C "),Ne=u(" \u7EE7\u7EED "),Ye=u(" \u505C\u6B62 "),Ke=u(" \u4E0B\u8F7D "),We=u(" \u7ED3\u679C "),Ge={class:"previewVideo"},qe=["src"],Je=u(" \u8BBE\u7F6E "),Xe=u(" \u5F53\u524D\u8BBE\u7F6E "),Qe=u(" \u4F60\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301WebRTC\uFF0C\u8BF7\u5B89\u88C5\u6700\u65B0\u7248\u672CChrome\u540E\u91CD\u8BD5\u3002 ");function $e(e,a,d,r,_,i){const b=ke,h=we,V=Ee,x=ye,k=Oe,m=_e,v=Me,L=Se,R=Ce;return i.isSupported?(g(),H(j,{key:0},[t(b,{level:3},{default:o(()=>[Ue]),_:1}),l("div",Be,[l("video",He,null,512),W(l("span",je,"REC",512),[[G,i.showREC]])]),t(V,{size:8,class:"operations",align:"center"},{default:o(()=>[t(h,{type:"primary",disabled:e.disabled.open,onClick:i.openScreenShare},{default:o(()=>[Ze]),_:1},8,["disabled","onClick"]),t(h,{type:"primary",disabled:e.disabled.start,onClick:i.start},{default:o(()=>[Fe]),_:1},8,["disabled","onClick"]),t(h,{type:"primary",disabled:e.disabled.pause,onClick:i.pause},{default:o(()=>[Pe]),_:1},8,["disabled","onClick"]),t(h,{type:"primary",disabled:e.disabled.resume,onClick:i.resume},{default:o(()=>[Ne]),_:1},8,["disabled","onClick"]),t(h,{type:"primary",disabled:e.disabled.stop,onClick:i.stop},{default:o(()=>[Ye]),_:1},8,["disabled","onClick"]),t(h,{type:"primary",disabled:e.disabled.download,onClick:i.download},{default:o(()=>[Ke]),_:1},8,["disabled","onClick"])]),_:1}),e.blobUrl?(g(),H(j,{key:0},[t(x),t(b,{level:3},{default:o(()=>[We]),_:1}),l("div",Ge,[l("video",{controls:"",src:e.blobUrl},null,8,qe)])],64)):T("",!0),t(x),t(b,{level:3},{default:o(()=>[Je]),_:1}),t(k,{message:"\u7531\u4E8E\u6D4F\u89C8\u5668\u9650\u5236\uFF0C\u90E8\u5206\u8BBE\u7F6E\u53EF\u80FD\u65E0\u6CD5\u751F\u6548",type:"warning","show-icon":"",closable:"",style:{"margin-bottom":".8rem"}}),e.disabled.open?(g(),H(j,{key:2},[t(b,{level:4},{default:o(()=>[Xe]),_:1}),t(R,null,{default:o(()=>[l("ul",null,[l("li",null,"\u7CFB\u7EDF\u97F3\u9891: "+w(i.currentDisplayMediaOptions.video.recordAudio),1),l("li",null,"\u9EA6\u514B\u98CE: "+w(i.currentDisplayMediaOptions.video.recordMicro),1),l("li",null,"\u957F\u5BBD\u6BD4: "+w(i.currentDisplayMediaOptions.video.aspectRatio),1),l("li",null,"\u5E27\u7387: "+w(i.currentDisplayMediaOptions.video.frameRate),1),l("li",null,"\u89C6\u9891\u5BBD\u5EA6: "+w(i.currentDisplayMediaOptions.video.width),1),l("li",null,"\u89C6\u9891\u9AD8\u5EA6: "+w(i.currentDisplayMediaOptions.video.height),1),l("li",null,"\u663E\u793A\u9F20\u6807: "+w(i.currentDisplayMediaOptions.video.cursor),1)])]),_:1})],64)):(g(),M(L,{key:1,"label-col":{sm:{span:5},md:{span:4},lg:{span:3},xxl:{span:2}}},{default:o(()=>[t(v,{label:"\u7CFB\u7EDF\u97F3\u9891"},{default:o(()=>[t(m,{value:e.recordAudio,"onUpdate:value":a[0]||(a[0]=n=>e.recordAudio=n),options:e.recordAudioOptions,onChange:i.selectAudio},null,8,["value","options","onChange"])]),_:1}),t(v,{label:"\u9EA6\u514B\u98CE"},{default:o(()=>[t(m,{value:e.recordMicro,"onUpdate:value":a[1]||(a[1]=n=>e.recordMicro=n),options:e.recordMicroOptions,onChange:i.selectMicro},null,8,["value","options","onChange"])]),_:1}),i.supportedConstraints.aspectRatio?(g(),M(v,{key:0,label:"\u9009\u62E9\u957F\u5BBD\u6BD4"},{default:o(()=>[t(m,{value:e.aspectRatio,"onUpdate:value":a[2]||(a[2]=n=>e.aspectRatio=n),options:e.aspectRatioList},null,8,["value","options"])]),_:1})):T("",!0),i.supportedConstraints.frameRate?(g(),M(v,{key:1,label:"\u9009\u62E9\u5E27\u7387"},{default:o(()=>[t(m,{value:e.frameRate,"onUpdate:value":a[3]||(a[3]=n=>e.frameRate=n),options:e.frameRateList},null,8,["value","options"])]),_:1})):T("",!0),i.supportedConstraints.width&&i.supportedConstraints.height?(g(),M(v,{key:2,label:"\u9009\u62E9\u5206\u8FA8\u7387"},{default:o(()=>[t(m,{value:e.resolutions,"onUpdate:value":a[4]||(a[4]=n=>e.resolutions=n),options:e.resolutionsList},null,8,["value","options"])]),_:1})):T("",!0),t(v,{label:"\u662F\u5426\u663E\u793A\u5149\u6807"},{default:o(()=>[t(m,{value:e.cursor,"onUpdate:value":a[5]||(a[5]=n=>e.cursor=n),options:e.cursorList},null,8,["value","options"])]),_:1})]),_:1}))],64)):(g(),M(b,{key:1,level:3},{default:o(()=>[Qe]),_:1}))}var Ma=be(Le,[["render",$e],["__scopeId","data-v-0a027926"]]);export{Ma as default};
