var h=Object.defineProperty,_=Object.defineProperties;var f=Object.getOwnPropertyDescriptors;var r=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,y=Object.prototype.propertyIsEnumerable;var m=(t,e,i)=>e in t?h(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,a=(t,e)=>{for(var i in e||(e={}))x.call(e,i)&&m(t,i,e[i]);if(r)for(var i of r(e))y.call(e,i)&&m(t,i,e[i]);return t},c=(t,e)=>_(t,f(e));import{_ as b,j as v,o as w,c as I,w as d,a as C,bx as $,by as j,q as o,b as u}from"./index.61660877.js";import{S}from"./index.3ccc7e18.js";import{U as T}from"./index.72a23b78.js";import"./index.337eff32.js";import{u as q}from"./index.8c5e7796.js";import"./debounce.976c9443.js";import"./FormItem.7d2319ce.js";import"./Col.2109c27b.js";import"./responsiveObserve.511b2fe5.js";import"./useFlexGapSupport.644e21c6.js";import"./toArray.931cf000.js";import"./get.f013e001.js";import"./hasIn.6b1d0295.js";import"./toInteger.2ce1e508.js";import"./toFinite.b3f38981.js";import"./_baseFindIndex.10ef1a58.js";import"./collapseMotion.17ce4c63.js";import"./EyeOutlined.fec9d595.js";import"./useMergedState.f855d8f1.js";import"./index.c2b25ad1.js";import"./Form.af96abd9.js";import"./_arrayIncludesWith.91d14080.js";import"./useRefs.7c014982.js";const{mapGetters:U,mapActions:F}=v("imgHosting"),R={name:"ImgHostingUpload",props:{activeKey:{type:String,default:""}},data:()=>({spinning:!1,timeoutIndex:void 0}),computed:a({},U(["config","uploader","commonConfig"])),mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:c(a({},F(["addImage"])),{async customRequest({file:t}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const e=t.name||"";t=new File([t],(new Date().getTime()+e.substring(e.lastIndexOf("."))).toLowerCase(),{type:t.type,lastModified:t.lastModified})}try{const e=await q[this.uploader].handle(this.config(this.uploader),t);if(this.addImage(e),this.commonConfig.copyUrlAfterUpload)try{this.commonConfig.customCopyContent?await navigator.clipboard.writeText(this.commonConfig.customCopyContent.replace(/\$url/g,e.url)):await navigator.clipboard.writeText(e.url),this.$msg.success("\u4E0A\u4F20\u6210\u529F\uFF0C\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch{this.$msg.error("\u4E0A\u4F20\u6210\u529F\uFF0C\u4F46\u5730\u5740\u590D\u5236\u5931\u8D25")}else this.$msg.success("\u4E0A\u4F20\u6210\u529F")}catch(e){console.log(e),this.$msg.error("\u4E0A\u4F20\u5931\u8D25")}}else this.$msg.warn("\u8BF7\u5148\u8FDB\u884C\u8BBE\u7F6E");this.spinning=!1},rejectFile(){this.$msg.warning("\u4E0D\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B\uFF01")},paste(t){if(this.activeKey==="home"&&!this.spinning&&!this.timeoutIndex){this.timeoutIndex=setTimeout(()=>{this.timeoutIndex=void 0},500);const e=t.clipboardData&&t.clipboardData.items;let i;if(e&&e.length)for(const s of e)s.type.indexOf("image")!==-1&&(i=s.getAsFile());i?this.customRequest({file:i}):(this.rejectFile(),clearTimeout(this.timeoutIndex),this.timeoutIndex=void 0)}}})},n=t=>($("data-v-de1b1a0e"),t=t(),j(),t),D=n(()=>o("p",{class:"ant-upload-drag-icon"},[o("span",{class:"i-icon-park-upload-one"})],-1)),N=n(()=>o("p",{class:"ant-upload-text"},[u(" \u76F4\u63A5\u7C98\u8D34\u56FE\u7247\u6216\u62D6\u62FD\u56FE\u7247\u5230\u8FD9\u91CC\u4E0A\u4F20"),o("br"),u("\u6216\u8005\u76F4\u63A5\u70B9\u51FB\u9009\u62E9\u6587\u4EF6\u4E0A\u4F20 ")],-1)),k=n(()=>o("p",{class:"ant-upload-hint"}," \u6682\u65F6\u4EC5\u652F\u6301\u5355\u6587\u4EF6\u4E0A\u4F20\u3002 ",-1));function A(t,e,i,s,B,p){const l=T,g=S;return w(),I(g,{spinning:t.spinning},{default:d(()=>[C(l,{"file-list":[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp","show-upload-list":!1,"custom-request":p.customRequest,onReject:p.rejectFile},{default:d(()=>[D,N,k]),_:1},8,["custom-request","onReject"])]),_:1},8,["spinning"])}var re=b(R,[["render",A],["__scopeId","data-v-de1b1a0e"]]);export{re as default};
