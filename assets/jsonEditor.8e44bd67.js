var N=Object.defineProperty;var _=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var C=(e,t,o)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,p=(e,t)=>{for(var o in t||(t={}))x.call(t,o)&&C(e,o,t[o]);if(_)for(var o of _(t))O.call(t,o)&&C(e,o,t[o]);return e};import{E as B,a0 as q,aj as J,ak as T,al as U,am as V,an as A,ao as W,ap as M,a9 as k,l as v,aq as j,ar as H,as as P,at as F,a as n,o as y,c as L,w as a,au as G,e as f,b as i,O as I,g as r}from"./vendor.3bd2b7e4.js";import{C as z}from"./vue-codemirror.48cde332.js";import{J as R}from"./jsoneditor.min.255f8499.js";import{c as K}from"./createFile.43ce4571.js";/* empty css                *//* empty css                */import{_ as Q}from"./index.28336b27.js";const{mapGetters:X,mapActions:Y}=B("cache"),Z={name:"JsonEditor",components:{Container:z,Button:q,Space:J,Checkbox:T,Right:U,Left:V,CodeDownload:A,Save:W,Clear:M},data:()=>({editorLeft:null,editorRight:null,codeLeft:{Array:[1,2,3],Boolean:!0,Null:null,Number:123,Object:{a:"b",c:"d"},String:"Hello World"},codeRight:{Array:[1,2,3],Boolean:!0,Null:null,Number:123,Object:{a:"b",c:"d"},String:"Hello World"},autoSave:!1,diff:!0}),computed:p({},X(["getData"])),mounted(){this.init()},methods:p({init(){this.getData("jsonEditor")&&(this.getData("jsonEditor").left&&(this.codeLeft=this.getData("jsonEditor").left),this.getData("jsonEditor").right&&(this.codeRight=this.getData("jsonEditor").right)),this.editorLeft=k(new R(this.$refs.jsonEditorLeft,{mode:"code",modes:["code","tree"],onClassName:this.onClassName,onChangeText:e=>{try{this.codeLeft=JSON.parse(e),this.editorRight.refresh(),this.autoSave&&this.save()}catch(t){}},autocomplete:{applyTo:["value"],filter:"contain",trigger:"focus",getOptions:(e,t,o,h)=>new Promise((l,s)=>{const d=this.extractUniqueWords(h.get());d.length>0?l(d):s(new Error("noOptions"))})}},this.codeLeft)),this.editorRight=k(new R(this.$refs.jsonEditorRight,{mode:"tree",modes:["code","tree"],onClassName:this.onClassName,onChangeText:e=>{try{this.codeRight=JSON.parse(e),this.editorLeft.refresh(),this.autoSave&&this.save()}catch(t){}},autocomplete:{applyTo:["value"],filter:"contain",trigger:"focus",getOptions:(e,t,o,h)=>new Promise((l,s)=>{const d=this.extractUniqueWords(h.get());d.length>0?l(d):s(new Error("noOptions"))})}},this.codeRight))},copyRight(){this.codeRight=v(this.codeLeft),this.editorRight.update(this.codeRight),this.editorLeft.refresh()},copyLeft(){this.codeLeft=v(this.codeRight),this.editorLeft.update(this.codeLeft),this.editorRight.refresh()},async save(){try{await this.setData({key:"jsonEditor",val:{left:this.editorLeft.get(),right:this.editorRight.get()}})}catch(e){this.$msg.warn("JSON\u5B58\u5728\u9519\u8BEF\uFF0C\u4FDD\u5B58\u5931\u8D25")}},async clear(){await this.setData({key:"jsonEditor",val:void 0}),this.$msg.success("\u6E05\u9664\u6210\u529F")},download(){K(this.editorLeft.getText(),"left.json")},changeDiff(){this.editorLeft.refresh(),this.editorRight.refresh()},changeAutoSave(){this.autoSave&&this.save()},onClassName({path:e}){const t=j(this.codeLeft,e),o=j(this.codeRight,e);return this.diff?H(t,o)?"":"differentElement":""},extractUniqueWords(e){return P(F(e,function(t,o){return G(t)?[o]:[o,String(t)]}))}},Y(["setData"])),beforeUnmount(){this.editorLeft&&this.editorLeft.destroy(),this.editorRight&&this.editorRight.destroy()}},$={class:"editorPanel"},ee={ref:"jsonEditorLeft",class:"jsonEditor jsonEditorLeft"},te={class:"controller noShowMobile"},oe=r(" \u590D\u5236 "),ie=r(" \u590D\u5236 "),se=r(" \u4FDD\u5B58 "),ae=r("\u81EA\u52A8"),ne=r(" \u6E05\u9664 "),re=r(" \u4E0B\u8F7D "),de=r("Diff"),ce={ref:"jsonEditorRight",class:"jsonEditor jsonEditorRight noShowMobile"},he=r(" \u4E0B\u8F7D ");function le(e,t,o,h,l,s){const d=n("Right"),c=n("Button"),E=n("Left"),b=n("Save"),g=n("Checkbox"),S=n("Clear"),w=n("CodeDownload"),m=n("Space"),D=n("container");return y(),L(D,null,{default:a(()=>[f("div",$,[f("div",ee,null,512),f("div",te,[i(m,{direction:"vertical"},{default:a(()=>[i(c,{type:"primary",onClick:s.copyRight,block:""},{default:a(()=>[i(d,{theme:"outline"}),oe]),_:1},8,["onClick"]),i(c,{type:"primary",onClick:s.copyLeft,block:""},{default:a(()=>[i(E,{theme:"outline"}),ie]),_:1},8,["onClick"]),i(c,{type:"primary",onClick:s.save,block:""},{default:a(()=>[i(b,{theme:"outline"}),se]),_:1},8,["onClick"]),i(g,{checked:e.autoSave,"onUpdate:checked":t[0]||(t[0]=u=>e.autoSave=u),onChange:s.changeAutoSave},{default:a(()=>[ae]),_:1},8,["checked","onChange"]),e.getData("jsonEditor")?(y(),L(c,{key:0,type:"primary",onClick:s.clear,block:""},{default:a(()=>[i(S,{theme:"outline"}),ne]),_:1},8,["onClick"])):I("",!0),i(c,{type:"primary",onClick:s.download,block:""},{default:a(()=>[i(w,{theme:"outline"}),re]),_:1},8,["onClick"]),i(g,{checked:e.diff,"onUpdate:checked":t[1]||(t[1]=u=>e.diff=u),onChange:s.changeDiff},{default:a(()=>[de]),_:1},8,["checked","onChange"])]),_:1})]),f("div",ce,null,512)]),i(m,{class:"showMobile",align:"center"},{default:a(()=>[i(c,{type:"primary",onClick:s.download},{default:a(()=>[he]),_:1},8,["onClick"])]),_:1})]),_:1})}var ve=Q(Z,[["render",le],["__scopeId","data-v-358d5848"]]);export{ve as default};
