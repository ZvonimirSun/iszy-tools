import{H as ae,K as se,e as oe,P as w,f as re,L as I,b8 as L,h as ie,i as _,b as a,aP as le,a0 as ne,Y as ce,ab as de,v as Z,ad as q,Z as Y,c6 as ue,C as pe,c7 as he,j as ve,E as me,c8 as fe,c9 as be,ca as Se,cb as ge,_ as ye,B as _e,r as f,o as S,n as j,w as o,s as n,F as H,p as B,c as A,a2 as Ce,z as C,d as u}from"./index.41cdb11f.js";/* empty css               *//* empty css               *//* empty css               *//* empty css               *//* empty css                *//* empty css                *//* empty css                */import{S as Re}from"./index.6850d136.js";import{S as we}from"./index.680070f3.js";import{D as ke}from"./index.63996187.js";import{F as J}from"./Form.308e1db7.js";import"./toArray.09ef8734.js";import"./Overflow.00a4787a.js";import"./isMobile.6491fde5.js";import"./useMergedState.37c962af.js";import"./useState.57baf64c.js";import"./DownOutlined.f6bbac97.js";import"./SearchOutlined.636d4a7d.js";import"./useFlexGapSupport.07774eee.js";import"./Col.02153a99.js";import"./responsiveObserve.4a2d86ec.js";import"./get.01c3a585.js";import"./hasIn.c3b88e88.js";import"./_arrayIncludesWith.15e56e3a.js";import"./toFinite.44c8dd4a.js";import"./collapseMotion.e6bf9a06.js";import"./debounce.d67c9d94.js";var De={success:pe,info:he,error:ve,warning:me},Ae={success:fe,info:be,error:Se,warning:ge},Oe=se("success","info","warning","error"),Te=function(){return{type:w.oneOf(Oe),closable:{type:Boolean,default:void 0},closeText:w.any,message:w.any,description:w.any,afterClose:Function,showIcon:{type:Boolean,default:void 0},prefixCls:String,banner:{type:Boolean,default:void 0},icon:w.any,closeIcon:w.any,onClose:Function}},Me=oe({name:"AAlert",inheritAttrs:!1,props:Te(),setup:function(t,c){var r=c.slots,R=c.emit,s=c.attrs,g=c.expose,h=re("alert",t),F=h.prefixCls,O=h.direction,y=I(!1),v=I(!1),m=I(),P=function(p){p.preventDefault();var b=m.value;b.style.height="".concat(b.offsetHeight,"px"),b.style.height="".concat(b.offsetHeight,"px"),y.value=!0,R("close",p)},T=function(){var p;y.value=!1,v.value=!0,(p=t.afterClose)===null||p===void 0||p.call(t)};g({animationEnd:T});var l=I({});return function(){var d,p,b=t.banner,W=t.closeIcon,x=W===void 0?(p=r.closeIcon)===null||p===void 0?void 0:p.call(r):W,V=t.closable,k=t.type,D=t.showIcon,N=L(r,t,"closeText"),M=L(r,t,"description"),z=L(r,t,"message"),E=L(r,t,"icon");D=b&&D===void 0?!0:D,k=b&&k===void 0?"warning":k||"info";var Q=(M?Ae:De)[k]||null;N&&(V=!0);var i=F.value,X=ie(i,(d={},_(d,"".concat(i,"-").concat(k),!0),_(d,"".concat(i,"-closing"),y.value),_(d,"".concat(i,"-with-description"),!!M),_(d,"".concat(i,"-no-icon"),!D),_(d,"".concat(i,"-banner"),!!b),_(d,"".concat(i,"-closable"),V),_(d,"".concat(i,"-rtl"),O.value==="rtl"),d)),$=V?a("button",{type:"button",onClick:P,class:"".concat(i,"-close-icon"),tabindex:0},[N?a("span",{class:"".concat(i,"-close-text")},[N]):x===void 0?a(le,null,null):x]):null,ee=E&&(ne(E)?ce(E,{class:"".concat(i,"-icon")}):a("span",{class:"".concat(i,"-icon")},[E]))||a(Q,{class:"".concat(i,"-icon")},null),te=de("".concat(i,"-motion"),{appear:!1,css:!0,onAfterLeave:T,onBeforeLeave:function(U){U.style.maxHeight="".concat(U.offsetHeight,"px")},onLeave:function(U){U.style.maxHeight="0px"}});return v.value?null:a(ue,te,{default:function(){return[Z(a("div",Y(Y({role:"alert"},s),{},{style:[s.style,l.value],class:[s.class,X],"data-show":!y.value,ref:m}),[D?ee:null,a("div",{class:"".concat(i,"-content")},[z?a("div",{class:"".concat(i,"-message")},[z]):null,M?a("div",{class:"".concat(i,"-description")},[M]):null]),$]),[[q,!y.value]])]}})}}}),Ee=ae(Me);const{Title:Ue,Paragraph:Ie}=Ce,{Item:Le}=J,Be="unstart",K="recording",Fe="paused",Pe="stopped",Ve={name:"ScreenRecord",components:{Title:Ue,Paragraph:Ie,Space:we,Button:_e,Divider:ke,Form:J,FormItem:Le,Select:Re,Alert:Ee},data:()=>({recorder:null,screenShareVideoElement:null,localScreenShareStream:null,disabled:{open:!1,start:!0,pause:!0,resume:!0,stop:!0,download:!0},status:Be,chunks:[],blobUrl:"",recordAudio:"never",recordAudioOptions:[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],recordMicro:"never",recordMicroOptions:[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],aspectRatio:"default",aspectRatioList:[{label:"\u9ED8\u8BA4",value:"default"},{label:"16:9",value:1.77},{label:"4:3",value:1.33},{label:"21:9",value:2.35},{label:"14:10",value:1.4},{label:"19:10",value:1.9}],frameRate:"default",frameRateList:[{label:"\u9ED8\u8BA4",value:"default"},{label:"60",value:60},{label:"30",value:30},{label:"25",value:25},{label:"15",value:15},{label:"5",value:5}],resolutions:"default",resolutionsList:[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u5C4F\u5E55\u5C3A\u5BF8",value:"fit-screen"},{label:"4K",value:"4k"},{label:"1080p",value:"1080p"},{label:"720p",value:"720p"}],cursor:"default",cursorList:[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u603B\u662F\u663E\u793A",value:"always"},{label:"\u79FB\u52A8\u65F6\u663E\u793A",value:"motion"},{label:"\u4ECE\u4E0D\u663E\u793A",value:"never"}]}),computed:{supportedConstraints(){return navigator&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?navigator.mediaDevices.getSupportedConstraints():{}},isScreenShareSupported(){return Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)},isWebRTCSupported(){return Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)},isSupported(){return this.isScreenShareSupported&&this.isWebRTCSupported},showREC(){return this.status===K},displayMediaOptions(){const e={};return this.aspectRatio!=="default"&&(e.aspectRatio=this.aspectRatio),this.frameRate!=="default"&&(e.frameRate=this.frameRate),this.cursor!=="default"&&(e.cursor=this.cursor),this.resolutions!=="default"&&(this.resolutions==="fit-screen"&&(e.width=screen.width,e.height=screen.height),this.resolutions==="4K"&&(e.width=3840,e.height=2160),this.resolutions==="1080p"&&(e.width=1920,e.height=1080),this.resolutions==="720p"&&(e.width=1280,e.height=720)),{video:e,audio:this.recordAudio==="always"}},currentDisplayMediaOptions(){if(this.localScreenShareStream){const e=this.localScreenShareStream.getVideoTracks();if(e.length>0){const t=e[0].getSettings(),c={recordAudio:this.recordAudioOptions.find(r=>this.recordAudio===r.value).label,recordMicro:this.recordMicroOptions.find(r=>this.recordMicro===r.value).label,frameRate:t.frameRate,width:t.width,height:t.height};if(t.aspectRatio){const r=this.aspectRatioList.find(R=>t.aspectRatio-R.value<=.1);r?c.aspectRatio=r.label:c.aspectRatio="\u9ED8\u8BA4"}if(t.cursor){const r=this.cursorList.find(R=>t.cursor===R.value);r?c.cursor=r.label:c.cursor="\u9ED8\u8BA4"}return{video:c}}}return{video:{},audio:{}}}},mounted(){this.screenShareVideoElement=this.$refs.screenShare},beforeUnmount(){this.stop()},methods:{async openScreenShare(){try{if(this.localScreenShareStream=await navigator.mediaDevices.getDisplayMedia(this.displayMediaOptions),this.recordMicro==="always"){const t=await navigator.mediaDevices.getUserMedia({audio:!0});this.localScreenShareStream.addTrack(t.getAudioTracks()[0])}const e=this.localScreenShareStream.getVideoTracks()[0];e&&(e.onended=this.onScreenShareEnded,e.onmute=this.onScreenShareEnded),this.recorder=new MediaRecorder(this.localScreenShareStream),this.recorder.onstop=this.onRecordStopped,this.recorder.ondataavailable=this.onDataAvailable,this.screenShareVideoElement.srcObject=this.localScreenShareStream,this.screenShareVideoElement.muted=!0,this.disabled.open=!0,this.disabled.start=!1}catch(e){this.$msg.error(e.message)}},start(){this.recorder.start(),this.status=K,this.disabled.start=!0,this.disabled.pause=!1,this.disabled.stop=!1},pause(){this.recorder.pause(),this.status=Fe,this.disabled.pause=!0,this.disabled.resume=!1},resume(){this.recorder.resume(),this.status=K,this.disabled.pause=!1,this.disabled.resume=!0},stop(){this.recorder&&this.recorder.state!=="inactive"&&this.recorder.stop(),this.status=Pe,this.disabled.start=!1,this.disabled.pause=!0,this.disabled.resume=!0,this.disabled.stop=!0},download(){if(this.blobUrl){const e=document.createElement("a");e.href=this.blobUrl,e.download="screen-record.mp4",e.click()}},onScreenShareEnded(){if(this.stop(),this.localScreenShareStream)this.localScreenShareStream.getTracks().forEach(t=>{t.stop()});else return;this.$msg.info("\u5C4F\u5E55\u5206\u4EAB\u7ED3\u675F"),this.localScreenShareStream=null,this.screenShareVideoElement.srcObject=null,this.disabled.open=!1,this.disabled.start=!0},onRecordStopped(){const e=new Blob(this.chunks,{type:"video/mp4"});this.blobUrl=URL.createObjectURL(e),this.disabled.download=!1,this.chunks=[]},onDataAvailable(e){this.chunks.push(e.data)},selectAudio(){this.recordAudio&&this.recordMicro&&(this.recordMicro="never")},selectMicro(){this.recordAudio&&this.recordMicro&&(this.recordAudio="never")}}},Ne=u(" \u5B9E\u65F6\u9884\u89C8 "),je={class:"previewVideo"},He={ref:"screenShare",autoplay:""},Ke={class:"rec"},We=u(" \u5F00\u542F\u5C4F\u5E55\u5171\u4EAB "),xe=u(" \u5F00\u59CB\u5F55\u5236 "),ze=u(" \u6682\u505C "),Ge=u(" \u7EE7\u7EED "),Ye=u(" \u505C\u6B62 "),Ze=u(" \u4E0B\u8F7D "),qe=u(" \u7ED3\u679C "),Je={class:"previewVideo"},Qe=["src"],Xe=u(" \u8BBE\u7F6E "),$e=u(" \u5F53\u524D\u8BBE\u7F6E "),et=u(" \u4F60\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301WebRTC\uFF0C\u8BF7\u5B89\u88C5\u6700\u65B0\u7248\u672CChrome\u540E\u91CD\u8BD5\u3002 ");function tt(e,t,c,r,R,s){const g=f("Title"),h=f("Button"),F=f("Space"),O=f("Divider"),y=f("Alert"),v=f("Select"),m=f("FormItem"),P=f("Form"),T=f("Paragraph");return s.isSupported?(S(),j(H,{key:0},[a(g,{level:3},{default:o(()=>[Ne]),_:1}),n("div",je,[n("video",He,null,512),Z(n("span",Ke,"REC",512),[[q,s.showREC]])]),a(F,{size:8,class:"operations",align:"center"},{default:o(()=>[a(h,{type:"primary",disabled:e.disabled.open,onClick:s.openScreenShare},{default:o(()=>[We]),_:1},8,["disabled","onClick"]),a(h,{type:"primary",disabled:e.disabled.start,onClick:s.start},{default:o(()=>[xe]),_:1},8,["disabled","onClick"]),a(h,{type:"primary",disabled:e.disabled.pause,onClick:s.pause},{default:o(()=>[ze]),_:1},8,["disabled","onClick"]),a(h,{type:"primary",disabled:e.disabled.resume,onClick:s.resume},{default:o(()=>[Ge]),_:1},8,["disabled","onClick"]),a(h,{type:"primary",disabled:e.disabled.stop,onClick:s.stop},{default:o(()=>[Ye]),_:1},8,["disabled","onClick"]),a(h,{type:"primary",disabled:e.disabled.download,onClick:s.download},{default:o(()=>[Ze]),_:1},8,["disabled","onClick"])]),_:1}),e.blobUrl?(S(),j(H,{key:0},[a(O),a(g,{level:3},{default:o(()=>[qe]),_:1}),n("div",Je,[n("video",{controls:"",src:e.blobUrl},null,8,Qe)])],64)):B("",!0),a(O),a(g,{level:3},{default:o(()=>[Xe]),_:1}),a(y,{message:"\u7531\u4E8E\u6D4F\u89C8\u5668\u9650\u5236\uFF0C\u90E8\u5206\u8BBE\u7F6E\u53EF\u80FD\u65E0\u6CD5\u751F\u6548",type:"warning","show-icon":"",closable:"",style:{"margin-bottom":".8rem"}}),e.disabled.open?(S(),j(H,{key:2},[a(g,{level:4},{default:o(()=>[$e]),_:1}),a(T,null,{default:o(()=>[n("ul",null,[n("li",null,"\u7CFB\u7EDF\u97F3\u9891: "+C(s.currentDisplayMediaOptions.video.recordAudio),1),n("li",null,"\u9EA6\u514B\u98CE: "+C(s.currentDisplayMediaOptions.video.recordMicro),1),n("li",null,"\u957F\u5BBD\u6BD4: "+C(s.currentDisplayMediaOptions.video.aspectRatio),1),n("li",null,"\u5E27\u7387: "+C(s.currentDisplayMediaOptions.video.frameRate),1),n("li",null,"\u89C6\u9891\u5BBD\u5EA6: "+C(s.currentDisplayMediaOptions.video.width),1),n("li",null,"\u89C6\u9891\u9AD8\u5EA6: "+C(s.currentDisplayMediaOptions.video.height),1),n("li",null,"\u663E\u793A\u9F20\u6807: "+C(s.currentDisplayMediaOptions.video.cursor),1)])]),_:1})],64)):(S(),A(P,{key:1,"label-col":{sm:{span:5},md:{span:4},lg:{span:3},xxl:{span:2}}},{default:o(()=>[a(m,{label:"\u7CFB\u7EDF\u97F3\u9891"},{default:o(()=>[a(v,{value:e.recordAudio,"onUpdate:value":t[0]||(t[0]=l=>e.recordAudio=l),options:e.recordAudioOptions,onChange:s.selectAudio},null,8,["value","options","onChange"])]),_:1}),a(m,{label:"\u9EA6\u514B\u98CE"},{default:o(()=>[a(v,{value:e.recordMicro,"onUpdate:value":t[1]||(t[1]=l=>e.recordMicro=l),options:e.recordMicroOptions,onChange:s.selectMicro},null,8,["value","options","onChange"])]),_:1}),s.supportedConstraints.aspectRatio?(S(),A(m,{key:0,label:"\u9009\u62E9\u957F\u5BBD\u6BD4"},{default:o(()=>[a(v,{value:e.aspectRatio,"onUpdate:value":t[2]||(t[2]=l=>e.aspectRatio=l),options:e.aspectRatioList},null,8,["value","options"])]),_:1})):B("",!0),s.supportedConstraints.frameRate?(S(),A(m,{key:1,label:"\u9009\u62E9\u5E27\u7387"},{default:o(()=>[a(v,{value:e.frameRate,"onUpdate:value":t[3]||(t[3]=l=>e.frameRate=l),options:e.frameRateList},null,8,["value","options"])]),_:1})):B("",!0),s.supportedConstraints.width&&s.supportedConstraints.height?(S(),A(m,{key:2,label:"\u9009\u62E9\u5206\u8FA8\u7387"},{default:o(()=>[a(v,{value:e.resolutions,"onUpdate:value":t[4]||(t[4]=l=>e.resolutions=l),options:e.resolutionsList},null,8,["value","options"])]),_:1})):B("",!0),a(m,{label:"\u662F\u5426\u663E\u793A\u5149\u6807"},{default:o(()=>[a(v,{value:e.cursor,"onUpdate:value":t[5]||(t[5]=l=>e.cursor=l),options:e.cursorList},null,8,["value","options"])]),_:1})]),_:1}))],64)):(S(),A(g,{key:1,level:3},{default:o(()=>[et]),_:1}))}var Mt=ye(Ve,[["render",tt],["__scopeId","data-v-65dc4b10"]]);export{Mt as default};
