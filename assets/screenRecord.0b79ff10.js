import{n as Fe,v as De,d as me,e as Be,r as v,ab as ae,g as ke,h as O,a as t,bg as we,K as Ae,D as Re,bq as Se,b1 as Q,b2 as X,s as pe,br as Te,P as K,C as xe,cE as Ie,i as Oe,E as Ue,cF as Me,cG as Ne,cH as Ve,cI as Le,f as se,k as e,o as F,L as te,M as d,a2 as T,w as s,b as D,c as G,F as ie,a1 as le,l as W,cJ as fe,B as Pe,N as je,cj as He,_ as $e}from"./index.1595fae7.js";/* empty css              *//* empty css               */import{_ as Ke}from"./index.b0bed1a1.js";/* empty css               */import{_ as Ge,F as We}from"./Form.7c64049a.js";import"./toArray.3076f305.js";import"./Overflow.cb04ea46.js";import"./isMobile.481c1aec.js";import"./useState.64f5a0f0.js";import"./DownOutlined.050f13ed.js";import"./SearchOutlined.2357bd1c.js";import"./Col.10c35842.js";import"./responsiveObserve.caa81809.js";import"./useFlexGapSupport.beef0379.js";import"./get.7370d67b.js";import"./hasIn.fbee4f96.js";import"./toInteger.23140640.js";import"./toFinite.4916c8ec.js";import"./_arrayIncludesWith.15e56e3a.js";import"./collapseMotion.814ccee5.js";var qe={success:xe,info:Ie,error:Oe,warning:Ue},Je={success:Me,info:Ne,error:Ve,warning:Le},ze=De("success","info","warning","error"),Qe=function(){return{type:K.oneOf(ze),closable:{type:Boolean,default:void 0},closeText:K.any,message:K.any,description:K.any,afterClose:Function,showIcon:{type:Boolean,default:void 0},prefixCls:String,banner:{type:Boolean,default:void 0},icon:K.any,closeIcon:K.any,onClose:Function}},Xe=me({compatConfig:{MODE:3},name:"AAlert",inheritAttrs:!1,props:Qe(),setup:function(r,U){var p=U.slots,M=U.emit,N=U.attrs,V=U.expose,A=Be("alert",r),f=A.prefixCls,i=A.direction,o=v(!1),L=v(!1),b=v(),q=function(l){l.preventDefault();var E=b.value;E.style.height="".concat(E.offsetHeight,"px"),E.style.height="".concat(E.offsetHeight,"px"),o.value=!0,M("close",l)},J=function(){var l;o.value=!1,L.value=!0,(l=r.afterClose)===null||l===void 0||l.call(r)};V({animationEnd:J});var y=v({});return function(){var R,l,E=r.banner,S=r.closeIcon,Y=S===void 0?(R=p.closeIcon)===null||R===void 0?void 0:R.call(p):S,B=r.closable,x=r.type,C=r.showIcon,P=ae(p,r,"closeText"),h=ae(p,r,"description"),I=ae(p,r,"message"),j=ae(p,r,"icon");C=E&&C===void 0?!0:C,x=E&&x===void 0?"warning":x||"info";var ne=(h?Je:qe)[x]||null;P&&(B=!0);var u=f.value,Z=ke(u,(l={},O(l,"".concat(u,"-").concat(x),!0),O(l,"".concat(u,"-closing"),o.value),O(l,"".concat(u,"-with-description"),!!h),O(l,"".concat(u,"-no-icon"),!C),O(l,"".concat(u,"-banner"),!!E),O(l,"".concat(u,"-closable"),B),O(l,"".concat(u,"-rtl"),i.value==="rtl"),l)),oe=B?t("button",{type:"button",onClick:q,class:"".concat(u,"-close-icon"),tabindex:0},[P?t("span",{class:"".concat(u,"-close-text")},[P]):Y===void 0?t(we,null,null):Y]):null,k=j&&(Ae(j)?Re(j,{class:"".concat(u,"-icon")}):t("span",{class:"".concat(u,"-icon")},[j]))||t(ne,{class:"".concat(u,"-icon")},null),ue=Se("".concat(u,"-motion"),{appear:!1,css:!0,onAfterLeave:J,onBeforeLeave:function(H){H.style.maxHeight="".concat(H.offsetHeight,"px")},onLeave:function(H){H.style.maxHeight="0px"}});return L.value?null:t(Te,ue,{default:function(){return[Q(t("div",pe(pe({role:"alert"},N),{},{style:[N.style,y.value],class:[N.class,Z],"data-show":!o.value,ref:b}),[C?k:null,t("div",{class:"".concat(u,"-content")},[I?t("div",{class:"".concat(u,"-message")},[I]):null,h?t("div",{class:"".concat(u,"-description")},[h]):null]),oe]),[[X,!o.value]])]}})}}});const Ye=Fe(Xe);const Ze={key:0,class:"wrapper"},ea={class:"video-wrapper"},aa={class:"previewVideo"},ta=["src"],la={class:"operations"},na={class:"settings-wrapper"},oa=me({__name:"screenRecord",setup(re){const r="unshare",U="unstart",p="recording",M="paused",N="stopped",V=v(),A=v();let f=null,i=null;const o=v(r);let L=[];const b=v(""),q=v(!1),J=[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],y=v("never"),R=[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],l=v("never"),E=[{label:"\u9ED8\u8BA4",value:"default"},{label:"16:9",value:1.77},{label:"4:3",value:1.33},{label:"21:9",value:2.35},{label:"14:10",value:1.4},{label:"19:10",value:1.9}],S=v("default"),Y=[{label:"\u9ED8\u8BA4",value:"default"},{label:"60",value:60},{label:"30",value:30},{label:"25",value:25},{label:"15",value:15},{label:"5",value:5}],B=v("default"),x=[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u5C4F\u5E55\u5C3A\u5BF8",value:"fit-screen"},{label:"4K",value:"4k"},{label:"1080p",value:"1080p"},{label:"720p",value:"720p"}],C=v("default"),P=[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u603B\u662F\u663E\u793A",value:"always"},{label:"\u79FB\u52A8\u65F6\u663E\u793A",value:"motion"},{label:"\u4ECE\u4E0D\u663E\u793A",value:"never"}],h=v("default"),I=(()=>navigator&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?navigator.mediaDevices.getSupportedConstraints():{})(),j=(()=>Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia))(),ne=(()=>Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia))(),u=j&&ne,Z=se(()=>{switch(o.value){case p:return"REC";case M:return"PAUSE";default:return!1}}),oe=se(()=>{const a={};switch(typeof S.value=="number"&&(a.aspectRatio=S.value),typeof B.value=="number"&&(a.frameRate=B.value),h.value!=="default"&&(a.cursor=h.value),C.value){case"fit-screen":a.width=screen.width,a.height=screen.height;break;case"4K":a.width=3840,a.height=2160;break;case"1080p":a.width=1920,a.height=1080;break;case"720p":a.width=1280,a.height=720;break}return{video:a,audio:y.value==="always"}}),k=se(()=>{var a,n;if(f){const g=f.getVideoTracks();if(g.length>0){const w=g[0].getSettings(),m={recordAudio:(a=J.find(c=>y.value===c.value))==null?void 0:a.label,recordMicro:(n=R.find(c=>l.value===c.value))==null?void 0:n.label,frameRate:w.frameRate,width:w.width,height:w.height,aspectRatio:"\u9ED8\u8BA4",cursor:""};if(w.aspectRatio){const c=w.aspectRatio,$=E.find(z=>typeof z.value=="number"?c-z.value<=.1:!1);$?m.aspectRatio=$.label:m.aspectRatio="\u9ED8\u8BA4"}if(w.cursor){const c=P.find($=>w.cursor===$.value);c?m.cursor=c.label:m.cursor="\u9ED8\u8BA4"}return{video:m}}}return{video:{},audio:{}}});async function ue(){try{if(f=await navigator.mediaDevices.getDisplayMedia(oe.value),l.value==="always"){const n=await navigator.mediaDevices.getUserMedia({audio:!0});f.addTrack(n.getAudioTracks()[0])}const a=f.getVideoTracks()[0];a&&(a.onended=ve,a.onmute=ve),i=new MediaRecorder(f),i.onstop=Ee,i.ondataavailable=ge,V.value.srcObject=f,V.value.muted=!0,o.value="unstart"}catch(a){fe.error(a.message)}}function ee(){de(),i==null||i.start(),o.value=p}function H(){i==null||i.pause(),o.value=M}function _e(){i==null||i.resume(),o.value=p}function ce(){i&&i.state!=="inactive"&&i.stop(),o.value=N}function de(){b.value=""}function be(){if(b.value){const a=document.createElement("a");a.href=b.value,a.download="screen-record.mp4",a.click()}}function ve(){if(ce(),f)f.getTracks().forEach(n=>{n.stop()});else return;fe.info("\u5C4F\u5E55\u5206\u4EAB\u7ED3\u675F"),f=null,V.value.srcObject=null,o.value="unshare"}function Ee(){const a=new Blob(L,{type:"video/mp4"});b.value=URL.createObjectURL(a),L=[];const n=setInterval(async()=>{A.value.readyState>0&&(A.value.duration===1/0?A.value.currentTime=1e7*Math.random():(clearInterval(n),A.value.currentTime=0))},200)}function ge(a){L.push(a.data)}function ye(){y.value&&l.value&&(l.value="never")}function Ce(){y.value&&l.value&&(y.value="never")}return(a,n)=>{const g=Pe,w=Ye,m=Ke,c=Ge,$=We,z=je,he=He;return e(u)?(F(),te("div",Ze,[d("div",ea,[d("div",aa,[Q(d("video",{ref_key:"screenShareVideoElement",ref:V,autoplay:""},null,512),[[X,!e(b)]]),Q(d("video",{ref_key:"recordVideoElement",ref:A,controls:"",src:e(b)},null,8,ta),[[X,e(b)]]),Q(d("span",{class:"rec"},T(e(Z)),513),[[X,e(Z)]])]),d("div",la,[t(g,{type:"primary",onClick:n[0]||(n[0]=_=>q.value=!e(q))},{default:s(()=>[D(" \u8BBE\u7F6E ")]),_:1}),e(o)===r?(F(),G(g,{key:0,type:"primary",onClick:ue},{default:s(()=>[D(" \u5F00\u542F\u5C4F\u5E55\u5171\u4EAB ")]),_:1})):(F(),te(ie,{key:1},[t(g,{type:"primary",disabled:e(o)===p||e(o)===M,onClick:ee},{default:s(()=>[D(" \u5F00\u59CB\u5F55\u5236 ")]),_:1},8,["disabled"]),t(g,{type:"primary",disabled:e(o)!==p,onClick:H},{default:s(()=>[D(" \u6682\u505C ")]),_:1},8,["disabled"]),t(g,{type:"primary",disabled:e(o)!==M,onClick:_e},{default:s(()=>[D(" \u7EE7\u7EED ")]),_:1},8,["disabled"]),t(g,{type:"primary",disabled:e(o)===U||e(o)===N,onClick:ce},{default:s(()=>[D(" \u505C\u6B62 ")]),_:1},8,["disabled"])],64)),e(b)?(F(),te(ie,{key:2},[t(g,{type:"primary",onClick:de},{default:s(()=>[D(" \u6E05\u9664 ")]),_:1}),t(g,{type:"primary",onClick:be},{default:s(()=>[D(" \u4E0B\u8F7D ")]),_:1})],64)):le("",!0)])]),Q(d("div",na,[t(w,{message:"\u7531\u4E8E\u6D4F\u89C8\u5668\u9650\u5236\uFF0C\u90E8\u5206\u8BBE\u7F6E\u53EF\u80FD\u65E0\u6CD5\u751F\u6548",type:"warning","show-icon":"",closable:"",style:{"margin-bottom":".8rem"}}),e(o)==="unshare"?(F(),G($,{key:0,layout:"vertical"},{default:s(()=>[t(c,{label:"\u7CFB\u7EDF\u97F3\u9891"},{default:s(()=>[t(m,{value:e(y),"onUpdate:value":n[1]||(n[1]=_=>W(y)?y.value=_:null),options:J,onChange:ye},null,8,["value"])]),_:1}),t(c,{label:"\u9EA6\u514B\u98CE"},{default:s(()=>[t(m,{value:e(l),"onUpdate:value":n[2]||(n[2]=_=>W(l)?l.value=_:null),options:R,onChange:Ce},null,8,["value"])]),_:1}),e(I).aspectRatio?(F(),G(c,{key:0,label:"\u9009\u62E9\u957F\u5BBD\u6BD4"},{default:s(()=>[t(m,{value:e(S),"onUpdate:value":n[3]||(n[3]=_=>W(S)?S.value=_:null),options:E},null,8,["value"])]),_:1})):le("",!0),e(I).frameRate?(F(),G(c,{key:1,label:"\u9009\u62E9\u5E27\u7387"},{default:s(()=>[t(m,{value:e(B),"onUpdate:value":n[4]||(n[4]=_=>W(B)?B.value=_:null),options:Y},null,8,["value"])]),_:1})):le("",!0),e(I).width&&e(I).height?(F(),G(c,{key:2,label:"\u9009\u62E9\u5206\u8FA8\u7387"},{default:s(()=>[t(m,{value:e(C),"onUpdate:value":n[5]||(n[5]=_=>W(C)?C.value=_:null),options:x},null,8,["value"])]),_:1})):le("",!0),t(c,{label:"\u662F\u5426\u663E\u793A\u5149\u6807"},{default:s(()=>[t(m,{value:e(h),"onUpdate:value":n[6]||(n[6]=_=>W(h)?h.value=_:null),options:P},null,8,["value"])]),_:1})]),_:1})):(F(),te(ie,{key:1},[t(z,{level:4},{default:s(()=>[D(" \u5F53\u524D\u8BBE\u7F6E ")]),_:1}),t(he,null,{default:s(()=>[d("ul",null,[d("li",null,"\u7CFB\u7EDF\u97F3\u9891: "+T(e(k).video.recordAudio),1),d("li",null,"\u9EA6\u514B\u98CE: "+T(e(k).video.recordMicro),1),d("li",null,"\u957F\u5BBD\u6BD4: "+T(e(k).video.aspectRatio),1),d("li",null,"\u5E27\u7387: "+T(e(k).video.frameRate),1),d("li",null,"\u89C6\u9891\u5BBD\u5EA6: "+T(e(k).video.width),1),d("li",null,"\u89C6\u9891\u9AD8\u5EA6: "+T(e(k).video.height),1),d("li",null,"\u663E\u793A\u9F20\u6807: "+T(e(k).video.cursor),1)])]),_:1})],64))],512),[[X,e(q)]])])):(F(),G(z,{key:1,level:3},{default:s(()=>[D(" \u4F60\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301WebRTC\uFF0C\u8BF7\u5B89\u88C5\u6700\u65B0\u7248\u672CChrome\u540E\u91CD\u8BD5\u3002 ")]),_:1}))}}});const wa=$e(oa,[["__scopeId","data-v-a7fef659"]]);export{wa as default};
