import{f as S,H as Me,ax as Fe,ay as Ve,az as Ee,aA as ue,aB as Ce,aC as Se,K as be,k as re,at as Y,aD as qe,aE as Ae,S as J,O as N,aF as ke,aw as Re,au as oe,aG as ye,a8 as G,d as Te,aa as Le,P as te,J as se,e as We,g as _e,h as Z,a as Be,Y as de,aH as ne,M as Ie}from"./index.61660877.js";import{v as Ne,d as we,_ as He,u as xe,c as fe,t as ee,g as ce,a as ze}from"./FormItem.7d2319ce.js";import{a as De,b as $e}from"./_arrayIncludesWith.91d14080.js";import{d as Ye}from"./debounce.976c9443.js";var Ue=Symbol("SizeProvider"),Xe=function(e){var t=e?S(function(){return e.size}):Me(Ue,S(function(){return"default"}));return t};function Pe(r){var e=!1,t=r.length,u=[];return r.length?new Promise(function(n,i){r.forEach(function(d,y){d.catch(function(O){return e=!0,O}).then(function(O){t-=1,u[y]=O,!(t>0)&&(e&&i(u),n(u))})})}):Promise.resolve([])}function ve(r){return typeof r=="object"&&r!=null&&r.nodeType===1}function he(r,e){return(!e||r!=="hidden")&&r!=="visible"&&r!=="clip"}function ae(r,e){if(r.clientHeight<r.scrollHeight||r.clientWidth<r.scrollWidth){var t=getComputedStyle(r,null);return he(t.overflowY,e)||he(t.overflowX,e)||function(u){var n=function(i){if(!i.ownerDocument||!i.ownerDocument.defaultView)return null;try{return i.ownerDocument.defaultView.frameElement}catch{return null}}(u);return!!n&&(n.clientHeight<u.scrollHeight||n.clientWidth<u.scrollWidth)}(r)}return!1}function K(r,e,t,u,n,i,d,y){return i<r&&d>e||i>r&&d<e?0:i<=r&&y<=t||d>=e&&y>=t?i-r-u:d>e&&y<t||i<r&&y>t?d-e+n:0}function me(r,e){var t=window,u=e.scrollMode,n=e.block,i=e.inline,d=e.boundary,y=e.skipOverflowHiddenElements,O=typeof d=="function"?d:function(Q){return Q!==d};if(!ve(r))throw new TypeError("Invalid target");for(var q=document.scrollingElement||document.documentElement,j=[],F=r;ve(F)&&O(F);){if((F=F.parentElement)===q){j.push(F);break}F!=null&&F===document.body&&ae(F)&&!ae(document.documentElement)||F!=null&&ae(F,y)&&j.push(F)}for(var A=t.visualViewport?t.visualViewport.width:innerWidth,M=t.visualViewport?t.visualViewport.height:innerHeight,E=window.scrollX||pageXOffset,L=window.scrollY||pageYOffset,I=r.getBoundingClientRect(),W=I.height,k=I.width,V=I.top,l=I.right,o=I.bottom,h=I.left,c=n==="start"||n==="nearest"?V:n==="end"?o:V+W/2,v=i==="center"?h+k/2:i==="end"?l:h,g=[],_=0;_<j.length;_++){var p=j[_],b=p.getBoundingClientRect(),z=b.height,H=b.width,s=b.top,a=b.right,f=b.bottom,m=b.left;if(u==="if-needed"&&V>=0&&h>=0&&o<=M&&l<=A&&V>=s&&o<=f&&h>=m&&l<=a)return g;var w=getComputedStyle(p),P=parseInt(w.borderLeftWidth,10),B=parseInt(w.borderTopWidth,10),x=parseInt(w.borderRightWidth,10),R=parseInt(w.borderBottomWidth,10),C=0,T=0,U="offsetWidth"in p?p.offsetWidth-p.clientWidth-P-x:0,X="offsetHeight"in p?p.offsetHeight-p.clientHeight-B-R:0;if(q===p)C=n==="start"?c:n==="end"?c-M:n==="nearest"?K(L,L+M,M,B,R,L+c,L+c+W,W):c-M/2,T=i==="start"?v:i==="center"?v-A/2:i==="end"?v-A:K(E,E+A,A,P,x,E+v,E+v+k,k),C=Math.max(0,C+L),T=Math.max(0,T+E);else{C=n==="start"?c-s-B:n==="end"?c-f+R+X:n==="nearest"?K(s,f,z,B,R+X,c,c+W,W):c-(s+z/2)+X/2,T=i==="start"?v-m-P:i==="center"?v-(m+H/2)+U/2:i==="end"?v-a+x+U:K(m,a,H,P,x+U,v,v+k,k);var D=p.scrollLeft,$=p.scrollTop;c+=$-(C=Math.max(0,Math.min($+C,p.scrollHeight-z+X))),v+=D-(T=Math.max(0,Math.min(D+T,p.scrollWidth-H+U)))}g.push({el:p,top:C,left:T})}return g}function Oe(r){return r===Object(r)&&Object.keys(r).length!==0}function Qe(r,e){e===void 0&&(e="auto");var t="scrollBehavior"in document.body.style;r.forEach(function(u){var n=u.el,i=u.top,d=u.left;n.scroll&&t?n.scroll({top:i,left:d,behavior:e}):(n.scrollTop=i,n.scrollLeft=d)})}function Ze(r){return r===!1?{block:"end",inline:"nearest"}:Oe(r)?r:{block:"start",inline:"nearest"}}function Ke(r,e){var t=r.isConnected||r.ownerDocument.documentElement.contains(r);if(Oe(e)&&typeof e.behavior=="function")return e.behavior(t?me(r,e):[]);if(!!t){var u=Ze(e);return Qe(me(r,u),u.behavior)}}var Je=Math.min;function Ge(r,e,t){for(var u=t?De:$e,n=r[0].length,i=r.length,d=i,y=Array(i),O=1/0,q=[];d--;){var j=r[d];d&&e&&(j=Fe(j,Ve(e))),O=Je(j.length,O),y[d]=!t&&(e||n>=120&&j.length>=120)?new Ee(d&&j):void 0}j=r[0];var F=-1,A=y[0];e:for(;++F<n&&q.length<O;){var M=j[F],E=e?e(M):M;if(M=t||M!==0?M:0,!(A?ue(A,E):u(q,E,t))){for(d=i;--d;){var L=y[d];if(!(L?ue(L,E):u(r[d],E,t)))continue e}A&&A.push(E),q.push(M)}}return q}function er(r){return Ce(r)?r:[]}var rr=Se(function(r){var e=Fe(r,er);return e.length&&e[0]===r[0]?Ge(e):[]}),tr=rr;function ge(r){var e=!1;return r&&r.length&&r.every(function(t){return t.required?(e=!0,!1):!0}),e}function pe(r){return r==null?[]:Array.isArray(r)?r:[r]}function ie(r,e,t){var u=r;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var n=e.split("."),i=0,d=n.length;i<d-1&&!(!u&&!t);++i){var y=n[i];if(y in u)u=u[y];else{if(t)throw new Error("please transfer a valid name path to validate!");break}}return{o:u,k:n[i],v:u?u[n[i]]:null,isValid:u&&n[i]in u}}function nr(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:be({}),t=arguments.length>2?arguments[2]:void 0,u=re(Y(r)),n=qe({}),i=Ae([]),d=function(l){N(Y(r),N(N({},re(u)),l)),Re(function(){Object.keys(n).forEach(function(o){n[o]={autoLink:!1,required:ge(Y(e)[o])}})})},y=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=arguments.length>1?arguments[1]:void 0;return o.length?l.filter(function(h){var c=pe(h.trigger||"change");return tr(c,o).length}):l},O=null,q=function(l){for(var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=arguments.length>2?arguments[2]:void 0,c=[],v={},g=function(s){var a=l[s],f=ie(Y(r),a,h);if(!f.isValid)return"continue";v[a]=f.v;var m=y(Y(e)[a],pe(o&&o.trigger));m.length&&c.push(j(a,f.v,m,o||{}).then(function(){return{name:a,errors:[],warnings:[]}}).catch(function(w){var P=[],B=[];return w.forEach(function(x){var R=x.rule.warningOnly,C=x.errors;R?B.push.apply(B,G(C)):P.push.apply(P,G(C))}),P.length?Promise.reject({name:a,errors:P,warnings:B}):{name:a,errors:P,warnings:B}}))},_=0;_<l.length;_++)var p=g(_);var b=Pe(c);O=b;var z=b.then(function(){return O===b?Promise.resolve(v):Promise.reject([])}).catch(function(H){var s=H.filter(function(a){return a&&a.errors.length});return Promise.reject({values:v,errorFields:s,outOfDate:O!==b})});return z.catch(function(H){return H}),z},j=function(l,o,h){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},v=Ne([l],o,h,N({validateMessages:we},c),!!c.validateFirst);return n[l]?(n[l].validateStatus="validating",v.catch(function(g){return g}).then(function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_;if(n[l].validateStatus==="validating"){var p=g.filter(function(b){return b&&b.errors.length});n[l].validateStatus=p.length?"error":"success",n[l].help=p.length?p.map(function(b){return b.errors}):"",(_=t==null?void 0:t.onValidate)===null||_===void 0||_.call(t,l,!p.length,p.length?oe(n[l].help[0]):null)}}),v):v.catch(function(g){return g})},F=function(l,o){var h=[],c=!0;l?Array.isArray(l)?h=l:h=[l]:(c=!1,h=i.value);var v=q(h,o||{},c);return v.catch(function(g){return g}),v},A=function(l){var o=[];l?Array.isArray(l)?o=l:o=[l]:o=i.value,o.forEach(function(h){n[h]&&N(n[h],{validateStatus:"",help:""})})},M=function(l){for(var o={autoLink:!1},h=[],c=Array.isArray(l)?l:[l],v=0;v<c.length;v++){var g=c[v];(g==null?void 0:g.validateStatus)==="error"&&(o.validateStatus="error",g.help&&h.push(g.help)),o.required=o.required||(g==null?void 0:g.required)}return o.help=h,o},E=u,L=!0,I=function(l){var o=[];i.value.forEach(function(h){var c=ie(l,h,!1),v=ie(E,h,!1),g=L&&(t==null?void 0:t.immediate)&&c.isValid;(g||!ye(c.v,v.v))&&o.push(h)}),F(o,{trigger:"change"}),L=!1,E=re(oe(l))},W=t==null?void 0:t.debounce,k=!0;return J(e,function(){i.value=e?Object.keys(Y(e)):[],!k&&t&&t.validateOnRuleChange&&F(),k=!1},{deep:!0,immediate:!0}),J(i,function(){var V={};i.value.forEach(function(o){V[o]=N({},n[o],{autoLink:!1,required:ge(Y(e)[o])}),delete n[o]});for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&delete n[l];N(n,V)},{immediate:!0}),J(r,W&&W.wait?Ye(I,W.wait,ke(W,["wait"])):I,{immediate:t&&!!t.immediate,deep:!0}),{modelRef:r,rulesRef:e,initialModel:u,validateInfos:n,resetFields:d,validate:F,validateField:j,mergeValidateInfo:M,clearValidate:A}}var ar=function(){return{layout:te.oneOf(se("horizontal","inline","vertical")),labelCol:{type:Object},wrapperCol:{type:Object},colon:{type:Boolean,default:void 0},labelAlign:te.oneOf(se("left","right")),labelWrap:{type:Boolean,default:void 0},prefixCls:String,requiredMark:{type:[String,Boolean],default:void 0},hideRequiredMark:{type:Boolean,default:void 0},model:te.object,rules:{type:Object},validateMessages:{type:Object,default:void 0},validateOnRuleChange:{type:Boolean,default:void 0},scrollToFirstError:{type:[Boolean,Object]},onSubmit:Function,name:String,validateTrigger:{type:[String,Array]},size:{type:String},onValuesChange:{type:Function},onFieldsChange:{type:Function},onFinish:{type:Function},onFinishFailed:{type:Function},onValidate:{type:Function}}};function ir(r,e){return ye(ee(r),ee(e))}var lr=Te({name:"AForm",inheritAttrs:!1,props:Le(ar(),{layout:"horizontal",hideRequiredMark:!1,colon:!0}),Item:He,useForm:nr,setup:function(e,t){var u=t.emit,n=t.slots,i=t.expose,d=t.attrs,y=Xe(e),O=We("form",e),q=O.prefixCls,j=O.direction,F=O.form,A=S(function(){return e.requiredMark===""||e.requiredMark}),M=S(function(){var s;return A.value!==void 0?A.value:F&&((s=F.value)===null||s===void 0?void 0:s.requiredMark)!==void 0?F.value.requiredMark:!e.hideRequiredMark}),E=S(function(){var s,a;return(s=e.colon)!==null&&s!==void 0?s:(a=F.value)===null||a===void 0?void 0:a.colon}),L=S(function(){return N(N({},we),e.validateMessages)}),I=S(function(){var s;return _e(q.value,(s={},Z(s,"".concat(q.value,"-").concat(e.layout),!0),Z(s,"".concat(q.value,"-hide-required-mark"),M.value===!1),Z(s,"".concat(q.value,"-rtl"),j.value==="rtl"),Z(s,"".concat(q.value,"-").concat(y.value),y.value),s))}),W=be(),k={},V=function(a,f){k[a]=f},l=function(a){delete k[a]},o=function(a){var f=!!a,m=f?ee(a).map(ce):[];return f?Object.values(k).filter(function(w){return m.findIndex(function(P){return ir(P,w.fieldName.value)})>-1}):Object.values(k)},h=function(a){if(!e.model){ne(!1,"Form","model is required for resetFields to work.");return}o(a?[a]:void 0).forEach(function(f){f.resetField()})},c=function(a){o(a?[a]:void 0).forEach(function(f){f.clearValidate()})},v=function(a){var f=e.scrollToFirstError;if(u("finishFailed",a),f&&a.errorFields.length){var m={};Ie(f)==="object"&&(m=f),_(a.errorFields[0].name,m)}},g=function(){return z.apply(void 0,arguments)},_=function(a){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},m=o(a?[a]:void 0);if(m.length){var w=m[0].fieldId.value,P=w?document.getElementById(w):null;P&&Ke(P,N({scrollMode:"if-needed",block:"nearest"},f))}},p=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(a===!0){var f=[];return Object.values(k).forEach(function(m){var w=m.namePath;f.push(w.value)}),fe(e.model,f)}else return fe(e.model,a)},b=function(a,f){if(ne(!(a instanceof Function),"Form","validateFields/validateField/validate not support callback, please use promise instead"),!e.model)return ne(!1,"Form","model is required for validateFields to work."),Promise.reject("Form `model` is required for validateFields to work.");var m=!!a,w=m?ee(a).map(ce):[],P=[];Object.values(k).forEach(function(R){var C;if(m||w.push(R.namePath.value),!!(!((C=R.rules)===null||C===void 0)&&C.value.length)){var T=R.namePath.value;if(!m||ze(w,T)){var U=R.validateRules(N({validateMessages:L.value},f));P.push(U.then(function(){return{name:T,errors:[],warnings:[]}}).catch(function(X){var D=[],$=[];return X.forEach(function(Q){var je=Q.rule.warningOnly,le=Q.errors;je?$.push.apply($,G(le)):D.push.apply(D,G(le))}),D.length?Promise.reject({name:T,errors:D,warnings:$}):{name:T,errors:D,warnings:$}}))}}});var B=Pe(P);W.value=B;var x=B.then(function(){return W.value===B?Promise.resolve(p(w)):Promise.reject([])}).catch(function(R){var C=R.filter(function(T){return T&&T.errors.length});return Promise.reject({values:p(w),errorFields:C,outOfDate:W.value!==B})});return x.catch(function(R){return R}),x},z=function(){return b.apply(void 0,arguments)},H=function(a){if(a.preventDefault(),a.stopPropagation(),u("submit",a),e.model){var f=b();f.then(function(m){u("finish",m)}).catch(function(m){v(m)})}};return i({resetFields:h,clearValidate:c,validateFields:b,getFieldsValue:p,validate:g,scrollToField:_}),xe({model:S(function(){return e.model}),name:S(function(){return e.name}),labelAlign:S(function(){return e.labelAlign}),labelCol:S(function(){return e.labelCol}),labelWrap:S(function(){return e.labelWrap}),wrapperCol:S(function(){return e.wrapperCol}),vertical:S(function(){return e.layout==="vertical"}),colon:E,requiredMark:M,validateTrigger:S(function(){return e.validateTrigger}),rules:S(function(){return e.rules}),addField:V,removeField:l,onValidate:function(a,f,m){u("validate",a,f,m)},validateMessages:L}),J(function(){return e.rules},function(){e.validateOnRuleChange&&b()}),function(){var s;return Be("form",de(de({},d),{},{onSubmit:H,class:[I.value,d.class]}),[(s=n.default)===null||s===void 0?void 0:s.call(n)])}}}),fr=lr;export{fr as F};
