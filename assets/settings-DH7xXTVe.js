import{k as A,aw as I,J as M,n as j,s as J,G as U,x as l,aB as K,R as B,a4 as F,E as P,r as g,Y as T,K as t,F as p,w as o,N as r,q as O,H as S,L as D,W as L,aA as $,a0 as G,P as Q,at as W,bl as Y,Q as z}from"./index-4zcg70xJ.js";import{E as X}from"./el-checkbox-DtqOYB2k.js";import{E as Z,a as h}from"./el-radio-group-C6TIa4Dj.js";/* empty css                 */import{E as ee}from"./el-space-lqDLQwmw.js";import{E as te}from"./el-divider-Bw7pnZKk.js";import{E as oe}from"./el-popover-B5bdvvOK.js";import"./el-popper-zQeOk-sq.js";import{u as le,T as H}from"./Router-CSPb2wj2.js";import{E as se,a as ae}from"./el-form-item-BwFfFN9y.js";import"./index-Dyv15RqS.js";import"./isUndefined-DCTLXrZ8.js";import"./castArray-Bo4Gsk8j.js";const ne=A({inheritAttrs:!1,__name:"HaveAccess",props:{auth:{type:[Boolean,Object],default:!1},link:{default:""}},setup(v){const n=v,w=I(),C=le(),a=M(),c=j(()=>n.auth?typeof n.auth=="boolean"?w.logged:w.checkAccess(n.auth):n.link?w.checkAccess(C.getAuth(n.link)):!0);function d(){n.link&&a.push(n.link)}return(V,N)=>l(c)?J(V.$slots,"default",K({key:0},V.$attrs,{goto:d})):U("",!0)}}),re={flex:"","flex-col":"","items-start":"","gap-4":"","text-7":""},de={flex:""},ie={flex:""},ue={flex:""},pe={flex:"","gap-4":""},me=A({__name:"personalInfo",setup(v){const n=I(),w=B(!1),C=B(),a=F({nickName:"",email:"",passwd:"",rePasswd:"",oldPasswd:""}),c=F({rePasswd:[{validator:(y,s,i)=>{s&&s!==a.passwd?i(new Error("两次输入的密码不一致")):i()}}],oldPasswd:[{validator:(y,s,i)=>{!s&&(a.passwd||a.rePasswd)?i(new Error("请输入旧密码")):i()}}]});function d(){a.nickName=n.profile.nickName??"",a.email=n.profile.email??"",a.passwd="",a.rePasswd="",a.oldPasswd="",w.value=!0}function V(){w.value=!1}async function N(y){y&&await y.validate(async s=>{if(s){const i={};if(a.nickName&&(i.nickName=a.nickName),a.email&&(i.email=a.email),a.passwd&&(i.passwd=a.passwd,i.oldPasswd=a.oldPasswd),Object.keys(i).length===0){$.warning("没有需要修改的信息");return}try{await n.updateUser(i)}catch(e){$.error(e.message)}w.value=!1}else $.warning("请检查输入")})}return(y,s)=>{var b,x,k;const i=H,e=D,m=L,_=se,R=ae;return g(),P(T,null,[t(i,{level:4},{default:o(()=>s[6]||(s[6]=[r(" 账户信息 ")])),_:1}),p("div",re,[p("div",de,[s[7]||(s[7]=p("div",{"w-32":""}," 昵称: ",-1)),p("div",null,S(l(n).profile.nickName),1)]),p("div",ie,[s[8]||(s[8]=p("div",{"w-32":""}," 邮箱: ",-1)),p("div",null,S(l(n).profile.email),1)]),p("div",ue,[s[9]||(s[9]=p("div",{"w-32":""}," 角色 ",-1)),p("div",null,S(((k=(x=(b=l(n).profile)==null?void 0:b.roles)==null?void 0:x[0])==null?void 0:k.alias)??"注册用户"),1)]),p("div",pe,[l(w)?(g(),P(T,{key:1},[t(e,{type:"primary",onClick:s[0]||(s[0]=u=>N(l(C)))},{default:o(()=>s[11]||(s[11]=[r(" 保存 ")])),_:1}),t(e,{onClick:V},{default:o(()=>s[12]||(s[12]=[r(" 取消 ")])),_:1})],64)):(g(),O(e,{key:0,onClick:d},{default:o(()=>s[10]||(s[10]=[r(" 修改信息 ")])),_:1}))]),l(w)?(g(),O(R,{key:0,ref_key:"ruleFormRef",ref:C,model:l(a),rules:l(c),"label-width":"8rem","label-position":"left"},{default:o(()=>[t(_,{label:"昵称",prop:"nickName"},{default:o(()=>[t(m,{modelValue:l(a).nickName,"onUpdate:modelValue":s[1]||(s[1]=u=>l(a).nickName=u)},null,8,["modelValue"])]),_:1}),t(_,{label:"邮箱",prop:"email"},{default:o(()=>[t(m,{modelValue:l(a).email,"onUpdate:modelValue":s[2]||(s[2]=u=>l(a).email=u)},null,8,["modelValue"])]),_:1}),t(_,{label:"旧密码",prop:"oldPasswd"},{default:o(()=>[t(m,{modelValue:l(a).oldPasswd,"onUpdate:modelValue":s[3]||(s[3]=u=>l(a).oldPasswd=u),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(_,{label:"新密码",prop:"passwd"},{default:o(()=>[t(m,{modelValue:l(a).passwd,"onUpdate:modelValue":s[4]||(s[4]=u=>l(a).passwd=u),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(_,{label:"确认密码",prop:"rePasswd"},{default:o(()=>[t(m,{modelValue:l(a).rePasswd,"onUpdate:modelValue":s[5]||(s[5]=u=>l(a).rePasswd=u),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])):U("",!0)])],64)}}}),fe=G(me,[["__scopeId","data-v-0a06eab8"]]),_e=Q("main",{persist:!0,state:()=>({_cache:{},clearOfflineCacheTag:!1}),getters:{getData:v=>n=>{if(n)return(v._cache||{})[n]}},actions:{setData({key:v,val:n}={}){v&&(this._cache=this._cache||{},this._cache[v]=n)},clear(){this._cache={}},clearOfflineCache(){console.log("clearOfflineCache"),this.clearOfflineCacheTag=!0}}}),we={flex:"","items-center":"","gap-4":""},ge={flex:"","flex-wrap":"","items-start":"","gap-4":"","text-7":"",class:"settings-container"},ve={class:"settings-wrapper"},ke={key:0,class:"settings-wrapper"},ce=A({__name:"settings",setup(v){const n=M(),w=W(),C=Y(),a=I(),c=z(),d=j(()=>c.general),V=()=>_e().clearOfflineCache();function N(){n.push({path:"/login",query:{redirect:w.fullPath}})}function y(){n.push("/register")}function s(){n.push("/logout")}return(i,e)=>{const m=H,_=D,R=ne,b=oe,x=te,k=ee,u=h,q=Z,E=X;return g(),P(T,null,[l(a).logged?(g(),O(m,{key:0,level:3},{default:o(()=>[r(S(l(a).profile.nickName)+" 欢迎你~ ",1)]),_:1})):U("",!0),l(a).logged?(g(),P(T,{key:1},[p("div",we,[t(_,{type:"primary",onClick:s},{default:o(()=>e[6]||(e[6]=[r(" 登出 ")])),_:1}),t(R,{link:"/userManager"},{default:o(({goto:f})=>[t(_,{onClick:f},{default:o(()=>e[7]||(e[7]=[r(" 用户权限中心 ")])),_:2},1032,["onClick"])]),_:1}),t(b,{title:"您是否确定要清空本地缓存？","confirm-button-text":"清空",onConfirm:V},{reference:o(()=>[t(_,{type:"danger",plain:""},{default:o(()=>e[8]||(e[8]=[r(" 清空本地缓存 ")])),_:1})]),_:1})]),t(x),t(fe)],64)):(g(),O(k,{key:2,"mt-4":""},{default:o(()=>[t(_,{type:"primary",onClick:N},{default:o(()=>e[9]||(e[9]=[r(" 登录 ")])),_:1}),t(_,{onClick:y},{default:o(()=>e[10]||(e[10]=[r(" 注册 ")])),_:1}),t(b,{title:"您是否确定要清空本地缓存？","confirm-button-text":"清空",onConfirm:V},{reference:o(()=>[t(_,{type:"danger",plain:""},{default:o(()=>e[11]||(e[11]=[r(" 清空本地缓存 ")])),_:1})]),_:1})]),_:1})),t(x),p("div",ge,[p("div",ve,[t(m,{level:4},{default:o(()=>e[12]||(e[12]=[r(" 全局设置 ")])),_:1}),t(m,{level:5},{default:o(()=>e[13]||(e[13]=[r(" 外观 ")])),_:1}),t(k,null,{default:o(()=>[t(q,{"model-value":l(d).theme.mode,onChange:l(C).setTheme},{default:o(()=>[t(u,{value:"auto",label:"跟随系统"}),t(u,{value:"light",label:"浅色"}),t(u,{value:"dark",label:"深色"})]),_:1},8,["model-value","onChange"])]),_:1}),t(m,{level:5},{default:o(()=>e[14]||(e[14]=[r(" 访问统计 ")])),_:1}),t(k,null,{default:o(()=>[t(E,{modelValue:l(d).showMost,"onUpdate:modelValue":e[0]||(e[0]=f=>l(d).showMost=f)},{default:o(()=>e[15]||(e[15]=[r(" 最常访问 ")])),_:1},8,["modelValue"]),t(E,{modelValue:l(d).showRecent,"onUpdate:modelValue":e[1]||(e[1]=f=>l(d).showRecent=f)},{default:o(()=>e[16]||(e[16]=[r(" 最近访问 ")])),_:1},8,["modelValue"])]),_:1}),t(m,{level:5},{default:o(()=>e[17]||(e[17]=[r(" 其他设置 ")])),_:1}),t(k,null,{default:o(()=>[t(E,{modelValue:l(d).showSearch,"onUpdate:modelValue":e[2]||(e[2]=f=>l(d).showSearch=f)},{default:o(()=>e[18]||(e[18]=[r(" 显示搜索 ")])),_:1},8,["modelValue"]),t(E,{modelValue:l(d).showType,"onUpdate:modelValue":e[3]||(e[3]=f=>l(d).showType=f)},{default:o(()=>e[19]||(e[19]=[r(" 显示分类 ")])),_:1},8,["modelValue"]),t(E,{modelValue:l(d).openInNewTab,"onUpdate:modelValue":e[4]||(e[4]=f=>l(d).openInNewTab=f)},{default:o(()=>e[20]||(e[20]=[r(" 新标签页打开工具 ")])),_:1},8,["modelValue"])]),_:1})]),l(a).logged?(g(),P("div",ke,[t(m,{level:4},{default:o(()=>e[21]||(e[21]=[r(" 应用设置 ")])),_:1}),t(m,{level:5},{default:o(()=>e[22]||(e[22]=[r(" JSON 编辑器 ")])),_:1}),t(k,null,{default:o(()=>[t(E,{modelValue:l(c).modules.jsonEditor.syncCloud,"onUpdate:modelValue":e[5]||(e[5]=f=>l(c).modules.jsonEditor.syncCloud=f)},{default:o(()=>e[23]||(e[23]=[r(" 从云端获取 ")])),_:1},8,["modelValue"])]),_:1})])):U("",!0)])],64)}}}),$e=G(ce,[["__scopeId","data-v-54fc6cac"]]);export{$e as default};
