import{_ as W,j as U,r as T,ap as X,D as Y,a6 as ee,ad as oe,bv as te,o as s,J as w,K as f,a$ as ae,c as y,w as i,$ as N,a as u,F as S,at as ne,R as j,b as M,bw as re,S as se,T as ie,I as pe,B as le,b0 as ue}from"./index.57719a67.js";/* empty css              *//* empty css               */import{m as F,c as p}from"./marker-shadow.df82f367.js";import{l as o}from"./leaflet-src.de004c37.js";import{F as ce}from"./Form.9ed4d695.js";import{_ as me}from"./FormItem.f50e0196.js";import"./_arrayIncludesWith.91d14080.js";import"./_baseFindIndex.10ef1a58.js";import"./Col.ff8ea2d4.js";import"./responsiveObserve.5f14401b.js";import"./useFlexGapSupport.bbfe3d8b.js";import"./toArray.54441267.js";import"./get.cbaece4e.js";import"./hasIn.57a82748.js";import"./toInteger.74c3718f.js";import"./toFinite.47b4a8b2.js";import"./collapseMotion.620796b1.js";const A=g=>(se("data-v-e8f35a05"),g=g(),ie(),g),de=A(()=>f("div",{class:"title"},[f("span",null,"\u5C5E\u6027")],-1)),fe={class:"content"},ve=A(()=>f("span",{class:"i-icon-park-outline-add-one"},null,-1)),_e={class:"btn-container"},he={__name:"leafletMap",props:{geoJsonLayer:{type:o.exports.GeoJSON,default:void 0}},emits:["update:geoJsonLayer"],setup(g,{emit:E}){const c=g,J=new o.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-blue.png",shadowUrl:F,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),P=new o.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-yellow.png",shadowUrl:F,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),v="bed806b1ccb34b268ab1c0700123d444";let n;const _=U("$eventBus"),$=U("$msg"),a=T(void 0),L=T(),B=T(),m=X({properties:[]}),V=t=>{t.properties.forEach(e=>{e.label&&e.value&&(a.value.properties[e.label]!=null?$.warn("\u5B57\u6BB5 [ "+e.label+" ] \u5B58\u5728\uFF0C\u5DF2\u8DF3\u8FC7"):a.value.properties[e.label]=isNaN(e.value)?e.value:parseFloat(e.value))}),G(),_.emit("updateEditor")};function R(){m.properties.push({label:"",value:"",id:Date.now()})}function G(){m.properties=[]}Y(()=>{_.on("locationGeo",z),_.on("updateGeojsonLayer",C),q(),ee(()=>{K(),H()})}),oe(()=>{_.off("locationGeo",z),_.off("updateGeojsonLayer",C),n&&(n.remove(),n=void 0)});function q(){n=te(o.exports.map(L.value,{attributionControl:!0,zoomControl:!1})),n.setView([35,105],4),E("update:geoJsonLayer",o.exports.geoJSON(void 0,{onEachFeature:Q,pointToLayer:(t,e)=>o.exports.marker(e,{icon:J})}).addTo(n))}function K(){o.exports.control.layers({\u9AD8\u5FB7\u77E2\u91CF:p("GaoDe.Normal.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}).addTo(n),\u9AD8\u5FB7\u5F71\u50CF:o.exports.layerGroup([p("GaoDe.Satellite.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20}),p("GaoDe.Satellite.Annotation",{minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u77E2\u91CF:o.exports.layerGroup([p("TianDiTu.Normal.Map",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20}),p("TianDiTu.Normal.Annotation",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5F71\u50CF:o.exports.layerGroup([p("TianDiTu.Satellite.Map",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20}),p("TianDiTu.Satellite.Annotation",{key:v,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5730\u5F62:o.exports.layerGroup([p("TianDiTu.Terrain.Map",{key:v,minZoom:3,maxNativeZoom:14,maxZoom:20}),p("TianDiTu.Terrain.Annotation",{key:v,minZoom:3,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),OpenStreetMap:p("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> \u8D21\u732E\u8005',minZoom:3,maxNativeZoom:19,maxZoom:20})},{\u56FE\u5F62:ne(c.geoJsonLayer)},{hideSingleBase:!0,position:"bottomleft"}).addTo(n)}function H(){o.exports.control.scale({imperial:!1,position:"bottomright"}).addTo(n),o.exports.control.zoom({zoomInTitle:"\u653E\u5927",zoomOutTitle:"\u7F29\u5C0F",position:"topright"}).addTo(n)}function Q(t,e){t.properties||(t.properties={}),e.bindPopup(B.value).on("popupopen",()=>{a.value=t,e instanceof o.exports.Marker?e.setIcon(P):e.setStyle({color:"#ffff00",weight:5,opacity:.65})}).on("popupclose",()=>{a.value=void 0,m.properties=[],e instanceof o.exports.Marker?e.setIcon(J):c.geoJsonLayer.resetStyle(e)})}function k(t,e,l){if(t instanceof InputEvent&&e&&l)try{e.properties[l]=JSON.parse(t.currentTarget.value)}catch{e.properties[l]=t.currentTarget.value}_.emit("updateEditor")}function z(t){try{const e=o.exports.geoJSON(t);n.fitBounds(e.getBounds())}catch{}}function C(t){if(c.geoJsonLayer&&c.geoJsonLayer instanceof o.exports.GeoJSON){c.geoJsonLayer.clearLayers();try{c.geoJsonLayer.addData(t),n.fitBounds(c.geoJsonLayer.getBounds())}catch(e){console.log(e)}}}return(t,e)=>{var D,O;const l=pe,h=me,I=ce,Z=le;return s(),w(S,null,[f("div",{ref_key:"mapContainer",ref:L,class:"map-container"},null,512),ae(f("div",{ref_key:"propertyPopup",ref:B,class:"property-popup"},[de,f("div",fe,[((D=a.value)==null?void 0:D.properties)&&Object.keys((O=a.value)==null?void 0:O.properties).length?(s(),y(I,{key:0,name:"selected-feature-form","label-col":{span:8},"wrapper-col":{span:16},colon:!1},{default:i(()=>[(s(!0),w(S,null,j(a.value.properties,(d,r,b)=>(s(),y(h,{key:"prop"+b,label:r},{default:i(()=>[typeof a.value.properties[r]=="string"?(s(),y(l,{key:0,value:a.value.properties[r],"onUpdate:value":x=>a.value.properties[r]=x,onChange:k},null,8,["value","onUpdate:value"])):typeof a.value.properties[r]=="number"?(s(),y(l,{key:1,value:a.value.properties[r],"onUpdate:value":x=>a.value.properties[r]=x,valueModifiers:{number:!0},onChange:k},null,8,["value","onUpdate:value"])):(s(),y(l,{key:2,value:JSON.stringify(d),onChange:x=>k(x,a.value,r)},null,8,["value","onChange"]))]),_:2},1032,["label"]))),128))]),_:1})):N("",!0),u(I,{name:"add-property-form",model:m,onFinish:V},{default:i(()=>[Object.keys(m.properties).length?(s(!0),w(S,{key:0},j(m.properties,(d,r)=>(s(),w("div",{key:d.id,class:"form-item-container"},[u(h,{name:["properties",r,"label"],rules:{required:!0,message:"\u5C5E\u6027\u540D\u79F0\u7F3A\u5931"}},{default:i(()=>[u(l,{value:d.label,"onUpdate:value":b=>d.label=b,placeholder:"\u5C5E\u6027\u540D\u79F0"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),u(h,{name:["properties",r,"value"],rules:{required:!0,message:"\u5C5E\u6027\u503C\u7F3A\u5931"}},{default:i(()=>[u(l,{value:d.value,"onUpdate:value":b=>d.value=b,placeholder:"\u5C5E\u6027\u503C"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]))),128)):N("",!0),u(h,null,{default:i(()=>[u(Z,{type:"dashed",block:"",onClick:R},{default:i(()=>[ve,M("\u65B0\u589E\u5C5E\u6027 ")]),_:1})]),_:1}),Object.keys(m.properties).length?(s(),y(h,{key:1},{default:i(()=>[f("div",_e,[u(Z,{type:"primary","html-type":"submit"},{default:i(()=>[M(" \u786E\u8BA4 ")]),_:1}),u(Z,{onClick:re(G,["stop"])},{default:i(()=>[M(" \u53D6\u6D88 ")]),_:1},8,["onClick"])])]),_:1})):N("",!0)]),_:1},8,["model"])])],512),[[ue,!1]])],64)}}},De=W(he,[["__scopeId","data-v-e8f35a05"]]);export{De as default};
