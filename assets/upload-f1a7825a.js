import{h as x,y as g,R as b,Z as C,o as I,c as T,w as S,A as o,J as E,K as U,m as a,b as v,_ as k}from"./index.js";import{E as B}from"./el-upload-b93cd640.js";import"./el-progress-0182b153.js";import{u as F}from"./index-488f54d4.js";import{u as y}from"./imgHosting-ab46f0ed.js";import"./isEqual-16073b58.js";import"./v4-fcc3550a.js";const u=s=>(E("data-v-38ff2484"),s=s(),U(),s),M=u(()=>a("div",{class:"el-icon--upload"},[a("span",{class:"i-icon-park-upload-one?mask"})],-1)),A=u(()=>a("div",{class:"el-upload__text"},[v(" 直接粘贴图片或拖拽图片到这里上传"),a("br"),v("或者"),a("em",null,"直接点击选择文件上传")],-1)),D=u(()=>a("div",{class:"el-upload__tip"}," 暂时仅支持单文件上传。 ",-1)),K=x({__name:"upload",props:{activeKey:{default:""}},setup(s){const h=s,r=g(!1),i=g(),p=y(),m=p.config,l=p.uploader,c=p.commonConfig;b(()=>{document.addEventListener("paste",_)}),C(()=>{document.removeEventListener("paste",_)});async function f(n){let t=n;if(r.value=!0,l&&m(l)){if(c.renameTimeStamp){const e=t.name||"";t=new File([t],(new Date().getTime()+e.substring(e.lastIndexOf("."))).toLowerCase(),{type:t.type,lastModified:t.lastModified})}try{const e=await F[l].handle(m(l),t);if(y().addImage(e),c.copyUrlAfterUpload)try{c.customCopyContent?await navigator.clipboard.writeText(c.customCopyContent.replace(/\$url/g,e.url)):await navigator.clipboard.writeText(e.url),o.success("上传成功，地址已复制到剪贴板")}catch{o.error("上传成功，但地址复制失败")}else o.success("上传成功")}catch(e){console.log(e),o.error("上传失败")}}else o.warning("请先进行设置");return r.value=!1,!1}function w(){o.warning("不支持的文件类型！")}function _(n){if(h.activeKey==="home"&&!r.value&&!i.value){i.value=setTimeout(()=>{i.value=void 0},500);const t=n.clipboardData&&n.clipboardData.items;let e;if(t&&t.length)for(const d of t)d.type.indexOf("image")!==-1&&(e=d.getAsFile());e?f(e):(w(),clearTimeout(i.value),i.value=void 0)}}return(n,t)=>{const e=B;return I(),T(e,{style:{height:"100%"},drag:"",accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp","show-file-list":!1,"before-upload":f},{default:S(()=>[M,A,D]),_:1})}}});const q=k(K,[["__scopeId","data-v-38ff2484"]]);export{q as default};
