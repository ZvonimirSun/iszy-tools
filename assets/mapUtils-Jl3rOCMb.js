import{l as i}from"./leaflet-src-DjEip7F7.js";import{aY as b,bd as f}from"./index-H2_rx4Ff.js";const d=i.TileLayer.extend({initialize(t,e={}){const a=this.providers,o=t.split("."),n=o[0],s=o[1],r=o[2],l=a[n][s][r];e.subdomains=a[n].Subdomains,"tms"in a[n]&&(e.tms=a[n].tms),i.TileLayer.prototype.initialize.call(this,l,e)}});function _(t,e={}){return e.csysType=a(t),new d(t,e);function a(o){const s=o.split(".")[0];let r="wgs84";switch(s){case"Geoq":case"GaoDe":case"Google":r="gcj02";break;case"Baidu":r="bd09";break;case"OSM":case"TianDiTu":r="wgs84";break}return r}}const c=Math.PI,h=6378245,y=.006693421622965943,g=c*3e3/180;d.include({providers:{TianDiTu:{Normal:{Map:"//t{s}.tianditu.gov.cn/DataServer?T=vec_w&X={x}&Y={y}&L={z}&tk={key}",Annotation:"//t{s}.tianditu.gov.cn/DataServer?T=cva_w&X={x}&Y={y}&L={z}&tk={key}"},Satellite:{Map:"//t{s}.tianditu.gov.cn/DataServer?T=img_w&X={x}&Y={y}&L={z}&tk={key}",Annotation:"//t{s}.tianditu.gov.cn/DataServer?T=cia_w&X={x}&Y={y}&L={z}&tk={key}"},Terrain:{Map:"//t{s}.tianditu.gov.cn/DataServer?T=ter_w&X={x}&Y={y}&L={z}&tk={key}",Annotation:"//t{s}.tianditu.gov.cn/DataServer?T=cta_w&X={x}&Y={y}&L={z}&tk={key}"},Subdomains:["0","1","2","3","4","5","6","7"],key:""},GaoDe:{Normal:{Map:"//webrd0{s}.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}"},Satellite:{Map:"//webst0{s}.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",Annotation:"//webst0{s}.is.autonavi.com/appmaptile?style=8&x={x}&y={y}&z={z}"},Subdomains:["1","2","3","4"]},Google:{Normal:{Map:"//www.google.com/maps/vt?lyrs=m@189&gl=cn&x={x}&y={y}&z={z}"},Satellite:{Map:"//www.google.com/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}",Annotation:"//www.google.com/maps/vt?lyrs=y@189&gl=cn&x={x}&y={y}&z={z}"},Subdomains:[]},Geoq:{Normal:{Map:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",PurplishBlue:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",Gray:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",Warm:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetWarm/MapServer/tile/{z}/{y}/{x}"},Theme:{Hydro:"//thematic.geoq.cn/arcgis/rest/services/ThematicMaps/WorldHydroMap/MapServer/tile/{z}/{y}/{x}"},Subdomains:[]},OSM:{Normal:{Map:"//{s}.tile.osm.org/{z}/{x}/{y}.png"},Subdomains:["a","b","c"]},Baidu:{Normal:{Map:"//online{s}.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles=pl&scaler=1&p=1"},Satellite:{Map:"//shangetu{s}.map.bdimg.com/it/u=x={x};y={y};z={z};v=009;type=sate&fm=46",Annotation:"//online{s}.map.bdimg.com/tile/?qt=tile&x={x}&y={y}&z={z}&styles=sl&v=020"},Subdomains:"0123456789",tms:!0}},csysConvert:{bd09_To_gps84(t,e){const a=this.bd09_To_gcj02(t,e);return this.gcj02_To_gps84(a.lng,a.lat)},gps84_To_bd09(t,e){const a=this.gps84_To_gcj02(t,e);return this.gcj02_To_bd09(a.lng,a.lat)},gps84_To_gcj02(t,e){let a=T(t-105,e-35),o=w(t-105,e-35);const n=e/180*c;let s=Math.sin(n);s=1-y*s*s;const r=Math.sqrt(s);a=a*180/(h*(1-y)/(s*r)*c),o=o*180/(h/r*Math.cos(n)*c);const l=e+a;return{lng:t+o,lat:l}},gcj02_To_gps84(t,e){const a=S(t,e),o=t*2-a.lng,n=e*2-a.lat;return{lng:o,lat:n}},gcj02_To_bd09(t,e){const a=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*g),o=Math.atan2(e,t)+3e-6*Math.cos(t*g),n=a*Math.cos(o)+.0065,s=a*Math.sin(o)+.006;return{lng:n,lat:s}},bd09_To_gcj02(t,e){const a=t-.0065,o=e-.006,n=Math.sqrt(a*a+o*o)-2e-5*Math.sin(o*g),s=Math.atan2(o,a)-3e-6*Math.cos(a*g),r=n*Math.cos(s),l=n*Math.sin(s);return{lng:r,lat:l}}},_setZoomTransform(t,e,a){let o=e;o!=null&&this.options&&(this.options.csysType==="gcj02"?o=this.csysConvert.gps84_To_gcj02(e.lng,e.lat):this.options.csysType==="bd09"&&(o=this.csysConvert.gps84_To_bd09(e.lng,e.lat)));const n=this._map.getZoomScale(a,t.zoom),s=t.origin.multiplyBy(n).subtract(this._map._getNewPixelOrigin(o,a)).round();i.Browser.any3d?i.DomUtil.setTransform(t.el,s,n):i.DomUtil.setPosition(t.el,s)},_getTiledPixelBounds(t){let e=t;e!=null&&this.options&&(this.options.csysType==="gcj02"?e=this.csysConvert.gps84_To_gcj02(t.lng,t.lat):this.options.csysType==="bd09"&&(e=this.csysConvert.gps84_To_bd09(t.lng,t.lat)));const a=this._map,o=a._animatingZoom?Math.max(a._animateToZoom,a.getZoom()):a.getZoom(),n=a.getZoomScale(o,this._tileZoom),s=a.project(e,this._tileZoom).floor(),r=a.getSize().divideBy(n*2);return new i.Bounds(s.subtract(r),s.add(r))}});function S(t,e){let a=T(t-105,e-35),o=w(t-105,e-35);const n=e/180*c;let s=Math.sin(n);s=1-y*s*s;const r=Math.sqrt(s);a=a*180/(h*(1-y)/(s*r)*c),o=o*180/(h/r*Math.cos(n)*c);const l=e+a;return{lng:t+o,lat:l}}function T(t,e){let a=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return a+=(20*Math.sin(6*t*c)+20*Math.sin(2*t*c))*2/3,a+=(20*Math.sin(e*c)+40*Math.sin(e/3*c))*2/3,a+=(160*Math.sin(e/12*c)+320*Math.sin(e*c/30))*2/3,a}function w(t,e){let a=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return a+=(20*Math.sin(6*t*c)+20*Math.sin(2*t*c))*2/3,a+=(20*Math.sin(t*c)+40*Math.sin(t/3*c))*2/3,a+=(150*Math.sin(t/12*c)+300*Math.sin(t/30*c))*2/3,a}i.Icon.Default.prototype.options.iconUrl=`https://jsdelivr.${b.cdnHost}/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-blue.png`;i.Icon.Default.prototype.options.iconRetinaUrl=`https://jsdelivr.${b.cdnHost}/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-blue.png`;i.Icon.Default.prototype.options.shadowUrl=`https://jsdelivr.${b.cdnHost}/gh/zvonimirsun/leaflet-color-markers@master/img/marker-shadow.png`;const M={attributionControl:!0,zoomControl:!1,minZoom:4,trackResize:!0},k="bed806b1ccb34b268ab1c0700123d444",v="868d6830a7409520ae283cde3a3f84d1",z=new WeakMap;function C(t){var o,n,s,r,l,m;const e=L(t.dom,t.options);e.setView(t.view.center,t.view.zoom);const a={};return z.set(e,{controls:a}),(o=t.controls)!=null&&o.layers&&(a.layers=i.control.layers({高德矢量:u({type:"GaoDe.Normal.Map",chinese:!0,options:{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">高德地图</a> 贡献者'}}).addTo(e),高德影像:i.layerGroup(p([{type:"GaoDe.Satellite.Map",chinese:!0},{type:"GaoDe.Satellite.Annotation",chinese:!0}]),{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">高德地图</a> 贡献者'}),谷歌矢量:u({type:"Google.Normal.Map",chinese:!0,options:{attribution:'&copy; <a href="https://www.google.com/maps" target="_blank">谷歌地图</a> 贡献者'}}),谷歌影像:i.layerGroup(p([{type:"Google.Satellite.Map",chinese:!0},{type:"Google.Satellite.Annotation",chinese:!0}]),{attribution:'&copy; <a href="https://www.google.com/maps" target="_blank">谷歌地图</a> 贡献者'}),OpenStreetMap:u({type:"OSM.Normal.Map",chinese:!0,options:{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> 贡献者'}}),天地图矢量:i.layerGroup(p([{type:"TianDiTu.Normal.Map",chinese:!0},{type:"TianDiTu.Normal.Annotation",chinese:!0}]),{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'}),天地图影像:i.layerGroup(p([{type:"TianDiTu.Satellite.Map",chinese:!0},{type:"TianDiTu.Satellite.Annotation",chinese:!0}]),{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'}),天地图地形:i.layerGroup(p([{type:"TianDiTu.Terrain.Map",chinese:!0},{type:"TianDiTu.Terrain.Annotation",chinese:!0}]),{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'})},{},{hideSingleBase:!0,position:typeof((n=t.controls)==null?void 0:n.layers)=="string"?t.controls.layers:"bottomleft"}).addTo(e)),((s=t.controls)==null?void 0:s.scale)!==!1&&(a.scale=i.control.scale({imperial:!1,position:typeof((r=t.controls)==null?void 0:r.scale)=="string"?t.controls.scale:"bottomright"}).addTo(e)),((l=t.controls)==null?void 0:l.zoom)!==!1&&(a.zoom=i.control.zoom({zoomInTitle:"放大",zoomOutTitle:"缩小",position:typeof((m=t.controls)==null?void 0:m.zoom)=="string"?t.controls.zoom:"topright"}).addTo(e)),e}function L(t,e=M){return i.map(t,{...M,...e})}function u(t){if(t.chinese)return x(t);throw new Error("not support")}function p(t){return t.map(e=>u(e))}function x(t){const e={},a=t.type;switch(a.split(".")[0]){case"GaoDe":Object.assign(e,{maxNativeZoom:18,maxZoom:20});break;case"Google":Object.assign(e,{maxZoom:20});break;case"OSM":Object.assign(e,{maxNativeZoom:19,maxZoom:20});break;case"TianDiTu":Object.assign(e,{key:k,maxNativeZoom:18,maxZoom:20}),a.includes("Terrain")&&Object.assign(e,{maxNativeZoom:14});break}return _(a,{...e,...t.options})}function j(t){t=Math.abs(t);const e=Math.floor(t),a=Math.floor((t-e)*60),o=((t-e)*3600%60).toFixed(2);return`${e}° ${a<10?`0${a}`:a}' ${Number.parseFloat(o)<10?`0${o}`:o}" `}async function D(t){const e=await f.get("https://amap.api.iszy.xyz/v3/geocode/geo",{params:{address:t,key:v}});if(e.data.status==="1"&&Number(e.data.count)>0){const a=e.data.geocodes[0],o=d.prototype.csysConvert.gcj02_To_gps84(Number.parseFloat(a.location.split(",")[0]),Number.parseFloat(a.location.split(",")[1]));return{latLng:new i.LatLng(o.lat,o.lng),address:a.formatted_address}}else throw new Error("未找到相关地址。")}async function N(t){const e=d.prototype.csysConvert.gps84_To_gcj02(t.lng,t.lat),a=await f.get("https://amap.api.iszy.xyz/v3/geocode/regeo",{params:{location:`${e.lng},${e.lat}`,output:"json",key:v,homeorcorp:1}});if(a.data.status==="1"&&a.data.regeocode.formatted_address)return a.data.regeocode.formatted_address;throw new Error("未找到相关地址。")}function O(t){const e=z.get(t);if(!e)throw new Error("map not found");return e}const q={formatDegree:j,getAddress:N,getLocation:D};export{C as c,O as g,q as u};
