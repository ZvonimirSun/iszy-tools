import"./default-5df60f68.js";import"./index-7db2b7cc.js";import{h as H,y as m,k as Q,R as X,D as V,at as Y,A as Z,o as ee,l as te,m as t,t as U,n as i,a as n,w as o,b as r,T as w,z as W,U as x,E as ne,B as oe,J as ae,K as se,_ as le}from"./index-2d447dfc.js";import{E as ie}from"./el-dialog-40d623b8.js";import{E as ce}from"./el-space-6e8332a4.js";import{a as ue,b as re,E as de}from"./el-dropdown-815f461a.js";import"./el-popper-5f85067b.js";import"./el-scrollbar-0b9d1b3f.js";import{f as pe}from"./formatBytes-f3c6eb77.js";import{J as _e}from"./jsoneditor.min-d7b2847f.js";import{c as fe}from"./createFile-4f7bf6cd.js";import{_ as me}from"./Paragraph-d3fb1d07.js";import{_ as ve}from"./Text-5b5e5745.js";import"./ResizeObserver.es-0f9f8adb.js";import"./isEqual-a7019869.js";import"./refs-b556ea2f.js";const c=E=>(ae("data-v-5f0a439f"),E=E(),se(),E),he={class:"editorController"},ge={class:"editorTitle"},ye=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-file-addition-one"}),r(" 新建")],-1)),ke=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-history"}),r(" 打开最近记录")],-1)),we=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-computer"}),r(" 打开本地文件")],-1)),xe=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-link-three"}),r(" 打开URL")],-1)),Ee=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-folder-open"}),r(" 打开"),t("span",{class:"i-icon-park-outline-down"})],-1)),be=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-save"}),r(" 保存")],-1)),Ie={class:"buttonWithIcon"},Ce=c(()=>t("span",{class:"i-icon-park-outline-indent-right"},null,-1)),Se=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-info"}),r(" 文档属性")],-1)),Te=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-delete"}),r(" 删除文档")],-1)),Ve=c(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-setting-two"}),r(" 选项"),t("span",{class:"i-icon-park-outline-down"})],-1)),We={class:"dialog-footer"},Ne=c(()=>t("strong",null,"名称：",-1)),je=c(()=>t("strong",null,"存储：",-1)),ze=c(()=>t("strong",null,"更新：",-1)),Be=c(()=>t("strong",null,"内容：",-1)),De=c(()=>t("strong",null,"大小：",-1)),Je=H({__name:"json-editor-extend",props:{name:{},code:{},mode:{}},emits:["update:name","update:code","create","blur","focus"],setup(E,{expose:A,emit:b}){const h=E;let v;const N=m(),j=m(),z=m(),s=m(""),_=m("code"),f=m(2),g=m(""),y=m(!1),I=m(!1),p=Q(()=>{if(I){let e;return typeof s.value=="string"?e="字符串类型":Array.isArray(s.value)?e=`数组类型，包含 ${s.value.length} 个对象`:typeof s.value=="object"?e=`对象类型，包含 ${Object.keys(s.value).length} 个属性`:e="其他类型",{name:g.value,storage:"",updated:"",content:e,size:pe(typeof s.value=="string"?s.value.length:JSON.stringify(s.value,null,f.value).length)}}else return{}});X(()=>{h.name!==void 0&&(g.value=h.name),h.code!==void 0&&(s.value=h.code),h.mode!==void 0&&(_.value=h.mode),F()}),V(()=>h.code,e=>{e!==void 0&&e!==s.value&&C(v,_.value,e)}),V(()=>s.value,e=>{b("update:code",e)}),V(()=>g.value,e=>{b("update:name",e)}),A({container:z});function F(){v=new _e(N.value,{mode:_.value,modes:["code","tree"],onChangeText:Y(e=>{if(_.value==="tree")try{s.value=JSON.parse(e)}catch{s.value=e}else s.value=e},100),onModeChange:e=>{_.value=e,s.value=C(v,e,s.value)},onError:e=>{Z.error(e.message)},onFocus:()=>{b("focus")},onBlur:()=>{b("blur")}}),s.value=C(v,_.value,s.value,!0)}function C(e,u,a,l=!1){if(u==="tree")if(typeof a=="string")try{const d=JSON.parse(a);return l?e.set(d):e.update(d),d}catch{return e.setMode("code"),l?e.setText(a):e.updateText(a),_.value="code",a}else return l?e.set(a):e.update(a),a;else{if(typeof a=="string")return l?e.setText(a):e.updateText(a),a;{const d=JSON.stringify(a,null,f.value);return l?e.setText(d):e.updateText(d),d}}}function B(){b("create"),v.set({})}function P(e){switch(e){case"file":j.value.click()}}function R(e){const u=e.target;if(u.files&&u.files.length){const a=u.files[0],l=new FileReader;l.onload=()=>{l.result&&(B(),s.value=C(v,_.value,l.result,!0),g.value=a.name)},l.readAsText(a)}u.value=""}function $(){fe(v.getText(),g.value||"未命名.json")}let D=f.value;function K(e){switch(e){case"indentation":D=f.value,y.value=!0;break;case"properties":I.value=!0;break}}function J(){f.value=D,y.value=!1}function L(){if(typeof s.value=="string")try{s.value=C(v,_.value,JSON.parse(s.value))}catch{}y.value=!1}return(e,u)=>{const a=ne,l=ue,d=re,O=de,q=ce,k=me,G=oe,M=ie,S=ve;return ee(),te("div",{ref_key:"container",ref:z,class:"editorPanelContainer"},[t("div",he,[t("div",ge,U(i(g)),1),n(q,{class:"editorControlButtons"},{default:o(()=>[n(a,{size:"small",type:"primary",onClick:B},{default:o(()=>[ye]),_:1}),n(O,{onCommand:P},{dropdown:o(()=>[n(d,null,{default:o(()=>[n(l,{command:"recent"},{default:o(()=>[ke]),_:1}),n(l,{command:"file"},{default:o(()=>[we]),_:1}),n(l,{command:"url"},{default:o(()=>[xe]),_:1})]),_:1})]),default:o(()=>[n(a,{size:"small",type:"primary"},{default:o(()=>[Ee]),_:1})]),_:1}),n(a,{size:"small",type:"primary",onClick:$},{default:o(()=>[be]),_:1}),n(O,{onCommand:K},{dropdown:o(()=>[n(d,null,{default:o(()=>[n(l,{command:"indentation"},{default:o(()=>[t("span",Ie,[Ce,r(" 缩进("+U(i(f))+")",1)])]),_:1}),n(l,{command:"properties"},{default:o(()=>[Se]),_:1}),n(l,{command:"delete"},{default:o(()=>[Te]),_:1})]),_:1})]),default:o(()=>[n(a,{size:"small",type:"primary"},{default:o(()=>[Ve]),_:1})]),_:1})]),_:1})]),t("div",{ref_key:"editorWrapper",ref:N,class:"jsonEditor"},null,512),w(t("input",{ref_key:"uploader",ref:j,type:"file",accept:".json,.geojson,.txt",onChange:R},null,544),[[x,!1]]),n(M,{modelValue:i(y),"onUpdate:modelValue":u[1]||(u[1]=T=>W(y)?y.value=T:null),title:"设置缩进","before-close":J},{footer:o(()=>[t("span",We,[n(a,{onClick:J},{default:o(()=>[r("取消")]),_:1}),n(a,{type:"primary",onClick:L},{default:o(()=>[r(" 确定 ")]),_:1})])]),default:o(()=>[n(k,null,{default:o(()=>[r("配置代码模式下用于缩进的空格数。 缩进同时应用于两个面板。")]),_:1}),n(G,{modelValue:i(f),"onUpdate:modelValue":u[0]||(u[0]=T=>W(f)?f.value=T:null),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["modelValue"]),n(M,{modelValue:i(I),"onUpdate:modelValue":u[2]||(u[2]=T=>W(I)?I.value=T:null),title:"文档属性",class:"documentProperties"},{default:o(()=>[n(k,null,{default:o(()=>[Ne,w(n(S,{content:i(p).name},null,8,["content"]),[[x,i(p).name]])]),_:1}),n(k,null,{default:o(()=>[je,w(n(S,{content:i(p).storage},null,8,["content"]),[[x,i(p).storage]])]),_:1}),n(k,null,{default:o(()=>[ze,w(n(S,{content:i(p).updated},null,8,["content"]),[[x,i(p).updated]])]),_:1}),n(k,null,{default:o(()=>[Be,w(n(S,{content:i(p).content},null,8,["content"]),[[x,i(p).content]])]),_:1}),n(k,null,{default:o(()=>[De,w(n(S,{content:i(p).size},null,8,["content"]),[[x,i(p).size]])]),_:1})]),_:1},8,["modelValue"])],512)}}});const Ze=le(Je,[["__scopeId","data-v-5f0a439f"]]);export{Ze as default};
