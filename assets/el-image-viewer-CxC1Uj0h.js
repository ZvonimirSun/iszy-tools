import{n as $,cj as ze,bl as Ee,A as ye,j as F,aj as be,B as ue,D as ne,bN as pe,di as Se,dj as Ne,bb as he,F as ke,a3 as xe,r as k,dk as Oe,s as Te,k as p,w as de,aN as _e,o as Ie,H as h,Z as fe,$ as I,V as f,ab as Ae,ao as b,J as m,u as a,K as ge,ay as Re,a1 as E,b5 as T,bC as $e,I as N,Q as te,bA as Be,bB as Me,dl as Ve,bZ as Pe,ai as Xe,dm as Ye,dn as De,ax as je,L as Fe,ac as He,E as ae,_ as Ce,b9 as B,a7 as R,dd as Ke,a6 as Le,dp as We,t as Ze,dq as qe,dr as Ge,ah as Je,a0 as we,X as Qe,b8 as Ue,ds as ea}from"./index-AbLOts5N.js";import{ae as aa}from"./Router-C2dwVSTg.js";const ta=(r,v)=>{if(!$||!r||!v)return!1;const n=r.getBoundingClientRect();let d;return v instanceof Element?d=v.getBoundingClientRect():d={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<d.bottom&&n.bottom>d.top&&n.right>d.left&&n.left<d.right};var na="Expected a function";function ce(r,v,n){var d=!0,l=!0;if(typeof r!="function")throw new TypeError(na);return ze(n)&&(d="leading"in n?!!n.leading:d,l="trailing"in n?!!n.trailing:l),Ee(r,v,{leading:d,maxWait:v,trailing:l})}const sa=ye({urlList:{type:F(Array),default:()=>be([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:F(String)}}),la={close:()=>!0,switch:r=>ue(r),rotate:r=>ue(r)},oa=ne({name:"ElImageViewer"}),ra=ne({...oa,props:sa,emits:la,setup(r,{expose:v,emit:n}){var d;const l=r,g={CONTAIN:{name:"contain",icon:pe(Se)},ORIGINAL:{name:"original",icon:pe(Ne)}},{t:se}=he(),o=ke("image-viewer"),{nextZIndex:le}=xe(),A=k(),x=k([]),S=Oe(),C=k(!0),w=k(l.initialIndex),y=Te(g.CONTAIN),i=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),M=k((d=l.zIndex)!=null?d:le()),V=p(()=>{const{urlList:t}=l;return t.length<=1}),H=p(()=>w.value===0),K=p(()=>w.value===l.urlList.length-1),P=p(()=>l.urlList[w.value]),oe=p(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!l.infinite&&H.value)]),W=p(()=>[o.e("btn"),o.e("next"),o.is("disabled",!l.infinite&&K.value)]),X=p(()=>{const{scale:t,deg:u,offsetX:s,offsetY:_,enableTransition:L}=i.value;let z=s/t,O=_/t;const j=u*Math.PI/180,ve=Math.cos(j),me=Math.sin(j);z=z*ve+O*me,O=O*ve-s/t*me;const ie={transform:`scale(${t}) rotate(${u}deg) translate(${z}px, ${O}px)`,transition:L?"transform .3s":""};return y.value.name===g.CONTAIN.name&&(ie.maxWidth=ie.maxHeight="100%"),ie});function Y(){Z(),n("close")}function re(){const t=ce(s=>{switch(s.code){case R.esc:l.closeOnPressEscape&&Y();break;case R.space:U();break;case R.left:ee();break;case R.up:c("zoomIn");break;case R.right:e();break;case R.down:c("zoomOut");break}}),u=ce(s=>{const _=s.deltaY||s.deltaX;c(_<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});S.run(()=>{B(document,"keydown",t),B(document,"wheel",u)})}function Z(){S.stop()}function q(){C.value=!1}function G(t){C.value=!1,t.target.alt=se("el.image.error")}function J(t){if(C.value||t.button!==0||!A.value)return;i.value.enableTransition=!1;const{offsetX:u,offsetY:s}=i.value,_=t.pageX,L=t.pageY,z=ce(j=>{i.value={...i.value,offsetX:u+j.pageX-_,offsetY:s+j.pageY-L}}),O=B(document,"mousemove",z);B(document,"mouseup",()=>{O()}),t.preventDefault()}function Q(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function U(){if(C.value)return;const t=Ke(g),u=Object.values(g),s=y.value.name,L=(u.findIndex(z=>z.name===s)+1)%t.length;y.value=g[t[L]],Q()}function D(t){const u=l.urlList.length;w.value=(t+u)%u}function ee(){H.value&&!l.infinite||D(w.value-1)}function e(){K.value&&!l.infinite||D(w.value+1)}function c(t,u={}){if(C.value)return;const{minScale:s,maxScale:_}=l,{zoomRate:L,rotateDeg:z,enableTransition:O}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...u};switch(t){case"zoomOut":i.value.scale>s&&(i.value.scale=Number.parseFloat((i.value.scale/L).toFixed(3)));break;case"zoomIn":i.value.scale<_&&(i.value.scale=Number.parseFloat((i.value.scale*L).toFixed(3)));break;case"clockwise":i.value.deg+=z,n("rotate",i.value.deg);break;case"anticlockwise":i.value.deg-=z,n("rotate",i.value.deg);break}i.value.enableTransition=O}return de(P,()=>{_e(()=>{const t=x.value[0];t!=null&&t.complete||(C.value=!0)})}),de(w,t=>{Q(),n("switch",t)}),Ie(()=>{var t,u;re(),(u=(t=A.value)==null?void 0:t.focus)==null||u.call(t)}),v({setActiveItem:D}),(t,u)=>(h(),fe(a(aa),{to:"body",disabled:!t.teleported},{default:I(()=>[f(Ae,{name:"viewer-fade",appear:""},{default:I(()=>[b("div",{ref_key:"wrapper",ref:A,tabindex:-1,class:m(a(o).e("wrapper")),style:ge({zIndex:M.value})},[b("div",{class:m(a(o).e("mask")),onClick:Re(s=>t.hideOnClickModal&&Y(),["self"])},null,10,["onClick"]),E(" CLOSE "),b("span",{class:m([a(o).e("btn"),a(o).e("close")]),onClick:Y},[f(a(T),null,{default:I(()=>[f(a($e))]),_:1})],2),E(" ARROW "),a(V)?E("v-if",!0):(h(),N(te,{key:0},[b("span",{class:m(a(oe)),onClick:ee},[f(a(T),null,{default:I(()=>[f(a(Be))]),_:1})],2),b("span",{class:m(a(W)),onClick:e},[f(a(T),null,{default:I(()=>[f(a(Me))]),_:1})],2)],64)),E(" ACTIONS "),b("div",{class:m([a(o).e("btn"),a(o).e("actions")])},[b("div",{class:m(a(o).e("actions__inner"))},[f(a(T),{onClick:s=>c("zoomOut")},{default:I(()=>[f(a(Ve))]),_:1},8,["onClick"]),f(a(T),{onClick:s=>c("zoomIn")},{default:I(()=>[f(a(Pe))]),_:1},8,["onClick"]),b("i",{class:m(a(o).e("actions__divider"))},null,2),f(a(T),{onClick:U},{default:I(()=>[(h(),fe(Xe(a(y).icon)))]),_:1}),b("i",{class:m(a(o).e("actions__divider"))},null,2),f(a(T),{onClick:s=>c("anticlockwise")},{default:I(()=>[f(a(Ye))]),_:1},8,["onClick"]),f(a(T),{onClick:s=>c("clockwise")},{default:I(()=>[f(a(De))]),_:1},8,["onClick"])],2)],2),E(" CANVAS "),b("div",{class:m(a(o).e("canvas"))},[(h(!0),N(te,null,je(t.urlList,(s,_)=>Fe((h(),N("img",{ref_for:!0,ref:L=>x.value[_]=L,key:s,src:s,style:ge(a(X)),class:m(a(o).e("img")),crossorigin:t.crossorigin,onLoad:q,onError:G,onMousedown:J},null,46,["src","crossorigin"])),[[He,_===w.value]])),128))],2),ae(t.$slots,"default")],6)]),_:3})]),_:3},8,["disabled"]))}});var ia=Ce(ra,[["__file","image-viewer.vue"]]);const ca=Le(ia),ua=ye({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:F([String,Object])},previewSrcList:{type:F(Array),default:()=>be([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:F(String)}}),da={load:r=>r instanceof Event,error:r=>r instanceof Event,switch:r=>ue(r),close:()=>!0,show:()=>!0},fa=ne({name:"ElImage",inheritAttrs:!1}),va=ne({...fa,props:ua,emits:da,setup(r,{emit:v}){const n=r;let d="";const{t:l}=he(),g=ke("image"),se=We(),o=p(()=>Ze(Object.entries(se).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),le=qe({excludeListeners:!0,excludeKeys:p(()=>Object.keys(o.value))}),A=k(),x=k(!1),S=k(!0),C=k(!1),w=k(),y=k(),i=$&&"loading"in HTMLImageElement.prototype;let M,V;const H=p(()=>[g.e("inner"),P.value&&g.e("preview"),S.value&&g.is("loading")]),K=p(()=>{const{fit:e}=n;return $&&e?{objectFit:e}:{}}),P=p(()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0}),oe=p(()=>{const{previewSrcList:e,initialIndex:c}=n;let t=c;return c>e.length-1&&(t=0),t}),W=p(()=>n.loading==="eager"?!1:!i&&n.loading==="lazy"||n.lazy),X=()=>{$&&(S.value=!0,x.value=!1,A.value=n.src)};function Y(e){S.value=!1,x.value=!1,v("load",e)}function re(e){S.value=!1,x.value=!0,v("error",e)}function Z(){ta(w.value,y.value)&&(X(),J())}const q=Ge(Z,200,!0);async function G(){var e;if(!$)return;await _e();const{scrollContainer:c}=n;Qe(c)?y.value=c:Ue(c)&&c!==""?y.value=(e=document.querySelector(c))!=null?e:void 0:w.value&&(y.value=ea(w.value)),y.value&&(M=B(y,"scroll",q),setTimeout(()=>Z(),100))}function J(){!$||!y.value||!q||(M==null||M(),y.value=void 0)}function Q(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function U(){P.value&&(V=B("wheel",Q,{passive:!1}),d=document.body.style.overflow,document.body.style.overflow="hidden",C.value=!0,v("show"))}function D(){V==null||V(),document.body.style.overflow=d,C.value=!1,v("close")}function ee(e){v("switch",e)}return de(()=>n.src,()=>{W.value?(S.value=!0,x.value=!1,J(),G()):X()}),Ie(()=>{W.value?G():X()}),(e,c)=>(h(),N("div",we({ref_key:"container",ref:w},a(o),{class:[a(g).b(),e.$attrs.class]}),[x.value?ae(e.$slots,"error",{key:0},()=>[b("div",{class:m(a(g).e("error"))},Je(a(l)("el.image.error")),3)]):(h(),N(te,{key:1},[A.value!==void 0?(h(),N("img",we({key:0},a(le),{src:A.value,loading:e.loading,style:a(K),class:a(H),crossorigin:e.crossorigin,onClick:U,onLoad:Y,onError:re}),null,16,["src","loading","crossorigin"])):E("v-if",!0),S.value?(h(),N("div",{key:1,class:m(a(g).e("wrapper"))},[ae(e.$slots,"placeholder",{},()=>[b("div",{class:m(a(g).e("placeholder"))},null,2)])],2)):E("v-if",!0)],64)),a(P)?(h(),N(te,{key:2},[C.value?(h(),fe(a(ca),{key:0,"z-index":e.zIndex,"initial-index":a(oe),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:D,onSwitch:ee},{default:I(()=>[e.$slots.viewer?(h(),N("div",{key:0},[ae(e.$slots,"viewer")])):E("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):E("v-if",!0)],64)):E("v-if",!0)],16))}});var ma=Ce(va,[["__file","image.vue"]]);const wa=Le(ma);export{wa as E};
