import{_ as Y,j as A,r as M,aL as ee,H as oe,a8 as te,af as ae,bv as re,o as i,L as k,M as _,b0 as ne,k as r,c as y,w as l,a1 as Z,a as c,F as G,aF as se,T as E,b as L,bw as pe,U as ie,V as le,I as ue,B as ce,b1 as me}from"./index.1467a21b.js";/* empty css              *//* empty css               */import{m as P,c as s}from"./marker-shadow.006345f0.js";import{l as o}from"./leaflet-src.ae6309f0.js";import{F as de,_ as fe}from"./Form.6fe69b90.js";import"./Col.c37abaa5.js";import"./responsiveObserve.de63f7f4.js";import"./useFlexGapSupport.492ea448.js";import"./toArray.bad0c157.js";import"./get.8ddc54f7.js";import"./hasIn.6a514662.js";import"./toInteger.c9d8dd81.js";import"./toFinite.2dc4e127.js";import"./_arrayIncludesWith.15e56e3a.js";import"./collapseMotion.e05c3cc9.js";const V=b=>(ie("data-v-02622034"),b=b(),le(),b),_e=V(()=>_("div",{class:"title"},[_("span",null,"\u5C5E\u6027")],-1)),ve={class:"content"},ge=V(()=>_("span",{class:"i-icon-park-outline-add-one"},null,-1)),he={class:"btn-container"},ye={__name:"leafletMap",props:{geoJsonLayer:{type:o.exports.GeoJSON,default:void 0}},emits:["update:geoJsonLayer","getMap","getControl"],setup(b,{emit:T}){const m=b,C=new o.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-blue.png",shadowUrl:P,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),$=new o.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-yellow.png",shadowUrl:P,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),v="bed806b1ccb34b268ab1c0700123d444";let J,n;const g=A("$eventBus"),q=A("$msg"),a=M(void 0),B=M(),z=M(),d=ee({properties:[]}),R=t=>{t.properties.forEach(e=>{e.label&&e.value&&(a.value.properties[e.label]!=null?q.warn("\u5B57\u6BB5 [ "+e.label+" ] \u5B58\u5728\uFF0C\u5DF2\u8DF3\u8FC7"):a.value.properties[e.label]=isNaN(e.value)?e.value:parseFloat(e.value))}),I(),g.emit("updateEditor")};function H(){d.properties.push({label:"",value:"",id:Date.now()})}function I(){d.properties=[]}oe(()=>{g.on("locationGeo",U),g.on("updateGeojsonLayer",O),K(),te(()=>{Q(),W()})}),ae(()=>{g.off("locationGeo",U),g.off("updateGeojsonLayer",O),n&&(n.remove(),n=void 0)});function K(){n=re(o.exports.map(B.value,{attributionControl:!0,zoomControl:!1,minZoom:4})),T("getMap",n),n.setView([35,105],4),T("update:geoJsonLayer",o.exports.geoJSON(void 0,{onEachFeature:X,pointToLayer:(t,e)=>o.exports.marker(e,{icon:C})}).addTo(n))}function Q(){J=o.exports.control.layers({\u9AD8\u5FB7\u77E2\u91CF:s("GaoDe.Normal.Map",{maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}).addTo(n),\u9AD8\u5FB7\u5F71\u50CF:o.exports.layerGroup([s("GaoDe.Satellite.Map",{maxNativeZoom:18,maxZoom:20}),s("GaoDe.Satellite.Annotation",{maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u8C37\u6B4C\u77E2\u91CF:o.exports.layerGroup([s("Google.Normal.Map",{maxZoom:20})],{attribution:'&copy; <a href="https://www.google.com/maps" target="_blank">\u8C37\u6B4C\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u8C37\u6B4C\u5F71\u50CF:o.exports.layerGroup([s("Google.Satellite.Map",{maxZoom:20}),s("Google.Satellite.Annotation",{maxZoom:20})],{attribution:'&copy; <a href="https://www.google.com/maps" target="_blank">\u8C37\u6B4C\u5730\u56FE</a> \u8D21\u732E\u8005'}),OpenStreetMap:s("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> \u8D21\u732E\u8005',maxNativeZoom:19,maxZoom:20}),\u5929\u5730\u56FE\u77E2\u91CF:o.exports.layerGroup([s("TianDiTu.Normal.Map",{key:v,maxNativeZoom:18,maxZoom:20}),s("TianDiTu.Normal.Annotation",{key:v,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5F71\u50CF:o.exports.layerGroup([s("TianDiTu.Satellite.Map",{key:v,maxNativeZoom:18,maxZoom:20}),s("TianDiTu.Satellite.Annotation",{key:v,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5730\u5F62:o.exports.layerGroup([s("TianDiTu.Terrain.Map",{key:v,maxNativeZoom:14,maxZoom:20}),s("TianDiTu.Terrain.Annotation",{key:v,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'})},{\u56FE\u5F62:se(m.geoJsonLayer)},{hideSingleBase:!0,position:"bottomleft"}).addTo(n),T("getControl",J)}function W(){o.exports.control.scale({imperial:!1,position:"bottomright"}).addTo(n),o.exports.control.zoom({zoomInTitle:"\u653E\u5927",zoomOutTitle:"\u7F29\u5C0F",position:"topright"}).addTo(n)}function X(t,e){t.properties||(t.properties={}),e.bindPopup(z.value).on("popupopen",()=>{a.value=t,e instanceof o.exports.Marker?e.setIcon($):e.setStyle({color:"#ffff00",weight:5,opacity:.65})}).on("popupclose",()=>{a.value=void 0,d.properties=[],e instanceof o.exports.Marker?e.setIcon(C):m.geoJsonLayer.resetStyle(e)})}function N(t,e,u){if(t instanceof InputEvent&&e&&u)try{e.properties[u]=JSON.parse(t.currentTarget.value)}catch{e.properties[u]=t.currentTarget.value}g.emit("updateEditor")}function U(t){try{const e=o.exports.geoJSON(t);n.fitBounds(e.getBounds())}catch{}}function O(t){if(m.geoJsonLayer&&m.geoJsonLayer instanceof o.exports.GeoJSON){m.geoJsonLayer.clearLayers();try{m.geoJsonLayer.addData(t),n.fitBounds(m.geoJsonLayer.getBounds())}catch(e){console.log(e)}}}return(t,e)=>{var F,j;const u=ue,h=fe,D=de,S=ce;return i(),k(G,null,[_("div",{ref_key:"mapContainer",ref:B,class:"map-container"},null,512),ne(_("div",{ref_key:"propertyPopup",ref:z,class:"property-popup"},[_e,_("div",ve,[((F=r(a))==null?void 0:F.properties)&&Object.keys((j=r(a))==null?void 0:j.properties).length?(i(),y(D,{key:0,name:"selected-feature-form","label-col":{span:8},"wrapper-col":{span:16},colon:!1},{default:l(()=>[(i(!0),k(G,null,E(r(a).properties,(f,p,x)=>(i(),y(h,{key:"prop"+x,label:p},{default:l(()=>[typeof r(a).properties[p]=="string"?(i(),y(u,{key:0,value:r(a).properties[p],"onUpdate:value":w=>r(a).properties[p]=w,onChange:N},null,8,["value","onUpdate:value"])):typeof r(a).properties[p]=="number"?(i(),y(u,{key:1,value:r(a).properties[p],"onUpdate:value":w=>r(a).properties[p]=w,valueModifiers:{number:!0},onChange:N},null,8,["value","onUpdate:value"])):(i(),y(u,{key:2,value:JSON.stringify(f),onChange:w=>N(w,r(a),p)},null,8,["value","onChange"]))]),_:2},1032,["label"]))),128))]),_:1})):Z("",!0),c(D,{name:"add-property-form",model:r(d),onFinish:R},{default:l(()=>[Object.keys(r(d).properties).length?(i(!0),k(G,{key:0},E(r(d).properties,(f,p)=>(i(),k("div",{key:f.id,class:"form-item-container"},[c(h,{name:["properties",p,"label"],rules:{required:!0,message:"\u5C5E\u6027\u540D\u79F0\u7F3A\u5931"}},{default:l(()=>[c(u,{value:f.label,"onUpdate:value":x=>f.label=x,placeholder:"\u5C5E\u6027\u540D\u79F0"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),c(h,{name:["properties",p,"value"],rules:{required:!0,message:"\u5C5E\u6027\u503C\u7F3A\u5931"}},{default:l(()=>[c(u,{value:f.value,"onUpdate:value":x=>f.value=x,placeholder:"\u5C5E\u6027\u503C"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"])]))),128)):Z("",!0),c(h,null,{default:l(()=>[c(S,{type:"dashed",block:"",onClick:H},{default:l(()=>[ge,L("\u65B0\u589E\u5C5E\u6027 ")]),_:1})]),_:1}),Object.keys(r(d).properties).length?(i(),y(h,{key:1},{default:l(()=>[_("div",he,[c(S,{type:"primary","html-type":"submit"},{default:l(()=>[L(" \u786E\u8BA4 ")]),_:1}),c(S,{onClick:pe(I,["stop"])},{default:l(()=>[L(" \u53D6\u6D88 ")]),_:1},8,["onClick"])])]),_:1})):Z("",!0)]),_:1},8,["model"])])],512),[[me,!1]])],64)}}},Ue=Y(ye,[["__scopeId","data-v-02622034"]]);export{Ue as default};
