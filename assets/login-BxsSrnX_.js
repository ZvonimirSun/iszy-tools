import{j as x,a4 as h,R as f,J as q,at as z,au as B,a7 as C,T as K,o as F,F as I,G as _,K as o,w as a,m as t,bi as v,L as N,aB as R,aA as g,$ as U,N as L,a0 as M}from"./index-BBGb7ztx.js";import{a as Q,E as S}from"./el-form-item-eFJ3ILWX.js";import"./castArray-DD9_FAvF.js";const T={class:"login-container"},j={class:"main"},A=x({__name:"login",setup(G){const s=h({userName:"",password:""}),u=f(),i=f({}),n=f(!1),d=q(),k=z(),w=B();C(k,r=>{const e=r.query;e&&(typeof e.redirect=="string"&&(u.value=e.redirect),i.value=b(e))},{immediate:!0}),K(()=>{w.logged&&d.push({path:u.value||"/",query:i.value})});async function p(){if(!navigator.onLine){g.warning("已离线！");return}if(s.userName!=null&&s.password!=null){n.value=!0;try{await w.login({userName:s.userName,password:s.password}),g.success("登录成功！"),d.push({path:u.value||"/",query:i.value})}catch(r){r instanceof Error&&g.error(r.message)}n.value=!1}}function V(){d.push("/register")}function b(r){const{redirect:e,...l}=r;return l}return(r,e)=>{const l=U,c=Q,y=L,E=S;return F(),I("div",T,[_("div",j,[o(E,R({layout:"horizontal",model:t(s)},{wrapperCol:{span:24}}),{default:a(()=>[o(c,{required:""},{default:a(()=>[o(l,{modelValue:t(s).userName,"onUpdate:modelValue":e[0]||(e[0]=m=>t(s).userName=m),placeholder:"账户",size:"large",onKeypress:v(p,["enter"])},{prefix:a(()=>e[2]||(e[2]=[_("span",{class:"i-icon-park-outline-user"},null,-1)])),_:1},8,["modelValue"])]),_:1}),o(c,{required:""},{default:a(()=>[o(l,{modelValue:t(s).password,"onUpdate:modelValue":e[1]||(e[1]=m=>t(s).password=m),type:"password",placeholder:"密码",size:"large","show-password":"",onKeypress:v(p,["enter"])},{prefix:a(()=>e[3]||(e[3]=[_("span",{class:"i-icon-park-outline-lock"},null,-1)])),_:1},8,["modelValue"])]),_:1}),o(c,null,{default:a(()=>[o(y,{type:"primary",block:"",size:"large",loading:t(n),onClick:p},{default:a(()=>e[4]||(e[4]=[N(" 登录 ")])),_:1},8,["loading"]),o(y,{block:"",size:"large",disabled:t(n),onClick:V},{default:a(()=>e[5]||(e[5]=[N(" 注册 ")])),_:1},8,["disabled"])]),_:1})]),_:1},16,["model"])])])}}}),$=M(A,[["__scopeId","data-v-ababdcc1"]]);export{$ as default};
