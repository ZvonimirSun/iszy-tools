import{V as Re,D as b,h as x,j as E,k as T,l as re,S as L,F as pe,m as Oe,C as S,n as m,P as Pe,o as We,p as Z,q as ut,r as y,u as _,v as dt,R as qt,w as Nt,g as me,x as ge,y as Ut,z as Ht,A as pt,B as Me,M as Ie,G as jt,H as Vt,T as zt,J as Kt,K as _t,W as Qt,O as Gt,Q as Xt,U as Yt,X as Zt,Y as Jt,Z as mt,_ as en,$ as tn,a0 as K,a1 as nn,a2 as sn,a3 as on,a4 as rn,a5 as ln,a6 as an,a7 as cn,a8 as hn,a9 as Le,aa as fn,ab as un,t as u,ac as dn,ad as ze}from"./index-9Z17Oi6L.js";import{D as pn,l as mn,cy as ye,n as gn,ay as xn,Z as bn,o as yn,h as Cn,g as vn}from"./index-NRSlkBGe.js";const Ke=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class H{constructor(e,t,i=0,s=e.length,o,r){this.test=r,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(i,s),this.bufferStart=i,this.normalize=o?l=>o(Ke(l)):Ke,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return E(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=We(e),i=this.bufferStart+this.bufferPos;this.bufferPos+=T(e);let s=this.normalize(t);for(let o=0,r=i;;o++){let l=s.charCodeAt(o),a=this.match(l,r);if(o==s.length-1){if(a)return this.value=a,this;break}r==i&&o<t.length&&t.charCodeAt(o)==l&&r++}}}match(e,t){let i=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],r=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?i={from:this.matches[s+1],to:t+1}:(this.matches[s]++,r=!0)),r||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:t+1}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(H.prototype[Symbol.iterator]=function(){return this});const gt={from:-1,to:-1,match:/.*/.exec("")},Fe="gm"+(/x/.unicode==null?"":"u");class xt{constructor(e,t,i,s=0,o=e.length){if(this.text=e,this.to=o,this.curLine="",this.done=!1,this.value=gt,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new bt(e,t,i,s,o);this.re=new RegExp(t,Fe+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=e.iter();let r=e.lineAt(s);this.curLineStart=r.from,this.matchPos=le(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let i=this.curLineStart+t.index,s=i+t[0].length;if(this.matchPos=le(this.text,s+(i==s?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<s||i>this.value.to)&&(!this.test||this.test(i,s,t)))return this.value={from:i,to:s,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Ce=new WeakMap;class N{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,i){let s=Ce.get(e);if(!s||s.from>=i||s.to<=t){let l=new N(t,e.sliceString(t,i));return Ce.set(e,l),l}if(s.from==t&&s.to==i)return s;let{text:o,from:r}=s;return r>t&&(o=e.sliceString(t,r)+o,r=t),s.to<i&&(o+=e.sliceString(s.to,i)),Ce.set(e,new N(r,o)),new N(t,o.slice(t-r,i-r))}}class bt{constructor(e,t,i,s,o){this.text=e,this.to=o,this.done=!1,this.value=gt,this.matchPos=le(e,s),this.re=new RegExp(t,Fe+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=N.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let i=this.flat.from+t.index,s=i+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,s,t)))return this.value={from:i,to:s,match:t},this.matchPos=le(this.text,s+(i==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=N.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(xt.prototype[Symbol.iterator]=bt.prototype[Symbol.iterator]=function(){return this});function Sn(n){try{return new RegExp(n,Fe),!0}catch{return!1}}function le(n,e){if(e>=n.length)return e;let t=n.lineAt(e),i;for(;e<t.to&&(i=t.text.charCodeAt(e-t.from))>=56320&&i<57344;)e++;return e}function Ee(n){let e=String(n.state.doc.lineAt(n.state.selection.main.head).number),t=y("input",{class:"cm-textfield",name:"line",value:e}),i=y("form",{class:"cm-gotoLine",onkeydown:o=>{o.keyCode==27?(o.preventDefault(),n.dispatch({effects:ae.of(!1)}),n.focus()):o.keyCode==13&&(o.preventDefault(),s())},onsubmit:o=>{o.preventDefault(),s()}},y("label",n.state.phrase("Go to line"),": ",t)," ",y("button",{class:"cm-button",type:"submit"},n.state.phrase("go")));function s(){let o=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!o)return;let{state:r}=n,l=r.doc.lineAt(r.selection.main.head),[,a,c,h,f]=o,d=h?+h.slice(1):0,p=c?+c:l.number;if(c&&f){let P=p/100;a&&(P=P*(a=="-"?-1:1)+l.number/r.doc.lines),p=Math.round(r.doc.lines*P)}else c&&a&&(p=p*(a=="-"?-1:1)+l.number);let v=r.doc.line(Math.max(1,Math.min(r.doc.lines,p))),D=m.cursor(v.from+Math.max(0,Math.min(d,v.length)));n.dispatch({effects:[ae.of(!1),x.scrollIntoView(D.from,{y:"center"})],selection:D}),n.focus()}return{dom:i}}const ae=L.define(),_e=Z.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(ae)&&(n=t.value);return n},provide:n=>ut.from(n,e=>e?Ee:null)}),wn=n=>{let e=re(n,Ee);if(!e){let t=[ae.of(!0)];n.state.field(_e,!1)==null&&t.push(L.appendConfig.of([_e,kn])),n.dispatch({effects:t}),e=re(n,Ee)}return e&&e.dom.querySelector("input").select(),!0},kn=x.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Mn={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},yt=pe.define({combine(n){return Oe(n,Mn,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function In(n){let e=[Tn,An];return n&&e.push(yt.of(n)),e}const Ln=b.mark({class:"cm-selectionMatch"}),En=b.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function Qe(n,e,t,i){return(t==0||n(e.sliceDoc(t-1,t))!=S.Word)&&(i==e.doc.length||n(e.sliceDoc(i,i+1))!=S.Word)}function Dn(n,e,t,i){return n(e.sliceDoc(t,t+1))==S.Word&&n(e.sliceDoc(i-1,i))==S.Word}const An=Re.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(yt),{state:t}=n,i=t.selection;if(i.ranges.length>1)return b.none;let s=i.main,o,r=null;if(s.empty){if(!e.highlightWordAroundCursor)return b.none;let a=t.wordAt(s.head);if(!a)return b.none;r=t.charCategorizer(s.head),o=t.sliceDoc(a.from,a.to)}else{let a=s.to-s.from;if(a<e.minSelectionLength||a>200)return b.none;if(e.wholeWords){if(o=t.sliceDoc(s.from,s.to),r=t.charCategorizer(s.head),!(Qe(r,t,s.from,s.to)&&Dn(r,t,s.from,s.to)))return b.none}else if(o=t.sliceDoc(s.from,s.to).trim(),!o)return b.none}let l=[];for(let a of n.visibleRanges){let c=new H(t.doc,o,a.from,a.to);for(;!c.next().done;){let{from:h,to:f}=c.value;if((!r||Qe(r,t,h,f))&&(s.empty&&h<=s.from&&f>=s.to?l.push(En.range(h,f)):(h>=s.to||f<=s.from)&&l.push(Ln.range(h,f)),l.length>e.maxMatches))return b.none}}return b.set(l)}},{decorations:n=>n.decorations}),Tn=x.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Rn=({state:n,dispatch:e})=>{let{selection:t}=n,i=m.create(t.ranges.map(s=>n.wordAt(s.head)||m.cursor(s.head)),t.mainIndex);return i.eq(t)?!1:(e(n.update({selection:i})),!0)};function On(n,e){let{main:t,ranges:i}=n.selection,s=n.wordAt(t.head),o=s&&s.from==t.from&&s.to==t.to;for(let r=!1,l=new H(n.doc,e,i[i.length-1].to);;)if(l.next(),l.done){if(r)return null;l=new H(n.doc,e,0,Math.max(0,i[i.length-1].from-1)),r=!0}else{if(r&&i.some(a=>a.from==l.value.from))continue;if(o){let a=n.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const Pn=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(o=>o.from===o.to))return Rn({state:n,dispatch:e});let i=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(o=>n.sliceDoc(o.from,o.to)!=i))return!1;let s=On(n,i);return s?(e(n.update({selection:n.selection.addRange(m.range(s.from,s.to),!1),effects:x.scrollIntoView(s.to)})),!0):!1},j=pe.define({combine(n){return Oe(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new Kn(e),scrollToMatch:e=>x.scrollIntoView(e)})}});class Ct{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||Sn(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new $n(this):new Fn(this)}getCursor(e,t=0,i){let s=e.doc?e:_.create({doc:e});return i==null&&(i=s.doc.length),this.regexp?$(this,s,t,i):B(this,s,t,i)}}class vt{constructor(e){this.spec=e}}function B(n,e,t,i){return new H(e.doc,n.unquoted,t,i,n.caseSensitive?void 0:s=>s.toLowerCase(),n.wholeWord?Wn(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function Wn(n,e){return(t,i,s,o)=>((o>t||o+s.length<i)&&(o=Math.max(0,t-2),s=n.sliceString(o,Math.min(n.length,i+2))),(e(ce(s,t-o))!=S.Word||e(he(s,t-o))!=S.Word)&&(e(he(s,i-o))!=S.Word||e(ce(s,i-o))!=S.Word))}class Fn extends vt{constructor(e){super(e)}nextMatch(e,t,i){let s=B(this.spec,e,i,e.doc.length).nextOverlapping();return s.done&&(s=B(this.spec,e,0,t).nextOverlapping()),s.done?null:s.value}prevMatchInRange(e,t,i){for(let s=i;;){let o=Math.max(t,s-1e4-this.spec.unquoted.length),r=B(this.spec,e,o,s),l=null;for(;!r.nextOverlapping().done;)l=r.value;if(l)return l;if(o==t)return null;s-=1e4}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let i=B(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let o=B(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,e.doc.length));for(;!o.next().done;)s(o.value.from,o.value.to)}}function $(n,e,t,i){return new xt(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?Bn(e.charCategorizer(e.selection.main.head)):void 0},t,i)}function ce(n,e){return n.slice(dt(n,e,!1),e)}function he(n,e){return n.slice(e,dt(n,e))}function Bn(n){return(e,t,i)=>!i[0].length||(n(ce(i.input,i.index))!=S.Word||n(he(i.input,i.index))!=S.Word)&&(n(he(i.input,i.index+i[0].length))!=S.Word||n(ce(i.input,i.index+i[0].length))!=S.Word)}class $n extends vt{nextMatch(e,t,i){let s=$(this.spec,e,i,e.doc.length).next();return s.done&&(s=$(this.spec,e,0,t).next()),s.done?null:s.value}prevMatchInRange(e,t,i){for(let s=1;;s++){let o=Math.max(t,i-s*1e4),r=$(this.spec,e,o,i),l=null;for(;!r.next().done;)l=r.value;if(l&&(o==t||l.from>o+10))return l;if(o==t)return null}}prevMatch(e,t,i){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,i,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(t,i)=>i=="$"?"$":i=="&"?e.match[0]:i!="0"&&+i<e.match.length?e.match[i]:t)}matchAll(e,t){let i=$(this.spec,e,0,e.doc.length),s=[];for(;!i.next().done;){if(s.length>=t)return null;s.push(i.value)}return s}highlight(e,t,i,s){let o=$(this.spec,e,Math.max(0,t-250),Math.min(i+250,e.doc.length));for(;!o.next().done;)s(o.value.from,o.value.to)}}const Q=L.define(),Be=L.define(),R=Z.define({create(n){return new ve(De(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Q)?n=new ve(t.value.create(),n.panel):t.is(Be)&&(n=new ve(n.query,t.value?$e:null));return n},provide:n=>ut.from(n,e=>e.panel)});class ve{constructor(e,t){this.query=e,this.panel=t}}const qn=b.mark({class:"cm-searchMatch"}),Nn=b.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Un=Re.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(R))}update(n){let e=n.state.field(R);(e!=n.startState.field(R)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return b.none;let{view:t}=this,i=new qt;for(let s=0,o=t.visibleRanges,r=o.length;s<r;s++){let{from:l,to:a}=o[s];for(;s<r-1&&a>o[s+1].from-2*250;)a=o[++s].to;n.highlight(t.state,l,a,(c,h)=>{let f=t.state.selection.ranges.some(d=>d.from==c&&d.to==h);i.add(c,h,f?Nn:qn)})}return i.finish()}},{decorations:n=>n.decorations});function J(n){return e=>{let t=e.state.field(R,!1);return t&&t.query.spec.valid?n(e,t):kt(e)}}const fe=J((n,{query:e})=>{let{to:t}=n.state.selection.main,i=e.nextMatch(n.state,t,t);if(!i)return!1;let s=m.single(i.from,i.to),o=n.state.facet(j);return n.dispatch({selection:s,effects:[qe(n,i),o.scrollToMatch(s.main,n)],userEvent:"select.search"}),wt(n),!0}),ue=J((n,{query:e})=>{let{state:t}=n,{from:i}=t.selection.main,s=e.prevMatch(t,i,i);if(!s)return!1;let o=m.single(s.from,s.to),r=n.state.facet(j);return n.dispatch({selection:o,effects:[qe(n,s),r.scrollToMatch(o.main,n)],userEvent:"select.search"}),wt(n),!0}),Hn=J((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:m.create(t.map(i=>m.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),jn=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:i,to:s}=t.main,o=[],r=0;for(let l=new H(n.doc,n.sliceDoc(i,s));!l.next().done;){if(o.length>1e3)return!1;l.value.from==i&&(r=o.length),o.push(m.range(l.value.from,l.value.to))}return e(n.update({selection:m.create(o,r),userEvent:"select.search.matches"})),!0},Ge=J((n,{query:e})=>{let{state:t}=n,{from:i,to:s}=t.selection.main;if(t.readOnly)return!1;let o=e.nextMatch(t,i,i);if(!o)return!1;let r=[],l,a,c=[];if(o.from==i&&o.to==s&&(a=t.toText(e.getReplacement(o)),r.push({from:o.from,to:o.to,insert:a}),o=e.nextMatch(t,o.from,o.to),c.push(x.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(i).number)+"."))),o){let h=r.length==0||r[0].from>=o.to?0:o.to-o.from-a.length;l=m.single(o.from-h,o.to-h),c.push(qe(n,o)),c.push(t.facet(j).scrollToMatch(l.main,n))}return n.dispatch({changes:r,selection:l,effects:c,userEvent:"input.replace"}),!0}),Vn=J((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(s=>{let{from:o,to:r}=s;return{from:o,to:r,insert:e.getReplacement(s)}});if(!t.length)return!1;let i=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:x.announce.of(i),userEvent:"input.replace.all"}),!0});function $e(n){return n.state.facet(j).createPanel(n)}function De(n,e){var t,i,s,o,r;let l=n.selection.main,a=l.empty||l.to>l.from+100?"":n.sliceDoc(l.from,l.to);if(e&&!a)return e;let c=n.facet(j);return new Ct({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:c.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(i=e==null?void 0:e.caseSensitive)!==null&&i!==void 0?i:c.caseSensitive,literal:(s=e==null?void 0:e.literal)!==null&&s!==void 0?s:c.literal,regexp:(o=e==null?void 0:e.regexp)!==null&&o!==void 0?o:c.regexp,wholeWord:(r=e==null?void 0:e.wholeWord)!==null&&r!==void 0?r:c.wholeWord})}function St(n){let e=re(n,$e);return e&&e.dom.querySelector("[main-field]")}function wt(n){let e=St(n);e&&e==n.root.activeElement&&e.select()}const kt=n=>{let e=n.state.field(R,!1);if(e&&e.panel){let t=St(n);if(t&&t!=n.root.activeElement){let i=De(n.state,e.query.spec);i.valid&&n.dispatch({effects:Q.of(i)}),t.focus(),t.select()}}else n.dispatch({effects:[Be.of(!0),e?Q.of(De(n.state,e.query.spec)):L.appendConfig.of(Qn)]});return!0},Mt=n=>{let e=n.state.field(R,!1);if(!e||!e.panel)return!1;let t=re(n,$e);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:Be.of(!1)}),!0},zn=[{key:"Mod-f",run:kt,scope:"editor search-panel"},{key:"F3",run:fe,shift:ue,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:fe,shift:ue,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Mt,scope:"editor search-panel"},{key:"Mod-Shift-l",run:jn},{key:"Mod-Alt-g",run:wn},{key:"Mod-d",run:Pn,preventDefault:!0}];class Kn{constructor(e){this.view=e;let t=this.query=e.state.field(R).query.spec;this.commit=this.commit.bind(this),this.searchField=y("input",{value:t.search,placeholder:M(e,"Find"),"aria-label":M(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=y("input",{value:t.replace,placeholder:M(e,"Replace"),"aria-label":M(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=y("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=y("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=y("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function i(s,o,r){return y("button",{class:"cm-button",name:s,onclick:o,type:"button"},r)}this.dom=y("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,i("next",()=>fe(e),[M(e,"next")]),i("prev",()=>ue(e),[M(e,"previous")]),i("select",()=>Hn(e),[M(e,"all")]),y("label",null,[this.caseField,M(e,"match case")]),y("label",null,[this.reField,M(e,"regexp")]),y("label",null,[this.wordField,M(e,"by word")]),...e.state.readOnly?[]:[y("br"),this.replaceField,i("replace",()=>Ge(e),[M(e,"replace")]),i("replaceAll",()=>Vn(e),[M(e,"replace all")])],y("button",{name:"close",onclick:()=>Mt(e),"aria-label":M(e,"close"),type:"button"},["×"])])}commit(){let e=new Ct({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Q.of(e)}))}keydown(e){Nt(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?ue:fe)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),Ge(this.view))}update(e){for(let t of e.transactions)for(let i of t.effects)i.is(Q)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(j).top}}function M(n,e){return n.state.phrase(e)}const ne=30,ie=/[\s\.,:;?!]/;function qe(n,{from:e,to:t}){let i=n.state.doc.lineAt(e),s=n.state.doc.lineAt(t).to,o=Math.max(i.from,e-ne),r=Math.min(s,t+ne),l=n.state.sliceDoc(o,r);if(o!=i.from){for(let a=0;a<ne;a++)if(!ie.test(l[a+1])&&ie.test(l[a])){l=l.slice(a);break}}if(r!=s){for(let a=l.length-1;a>l.length-ne;a--)if(!ie.test(l[a-1])&&ie.test(l[a])){l=l.slice(0,a);break}}return x.announce.of(`${n.state.phrase("current match")}. ${l} ${n.state.phrase("on line")} ${i.number}.`)}const _n=x.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Qn=[R,Pe.low(Un),_n];class It{constructor(e,t,i){this.state=e,this.pos=t,this.explicit=i,this.abortListeners=[]}tokenBefore(e){let t=me(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),i=Math.max(t.from,this.pos-250),s=t.text.slice(i-t.from,this.pos-t.from),o=s.search(Lt(e,!1));return o<0?null:{from:i+o,to:this.pos,text:s.slice(o)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}}function Xe(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Gn(n){let e=Object.create(null),t=Object.create(null);for(let{label:s}of n){e[s[0]]=!0;for(let o=1;o<s.length;o++)t[s[o]]=!0}let i=Xe(e)+Xe(t)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function Xn(n){let e=n.map(s=>typeof s=="string"?{label:s}:s),[t,i]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:Gn(e);return s=>{let o=s.matchBefore(i);return o||s.explicit?{from:o?o.from:s.pos,options:e,validFor:t}:null}}function ns(n,e){return t=>{for(let i=me(t.state).resolveInner(t.pos,-1);i;i=i.parent){if(n.indexOf(i.name)>-1)return null;if(i.type.isTop)break}return e(t)}}class Ye{constructor(e,t,i,s){this.completion=e,this.source=t,this.match=i,this.score=s}}function O(n){return n.selection.main.from}function Lt(n,e){var t;let{source:i}=n,s=e&&i[0]!="^",o=i[i.length-1]!="$";return!s&&!o?n:new RegExp(`${s?"^":""}(?:${i})${o?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const Et=Kt.define();function Yn(n,e,t,i){let{main:s}=n.selection,o=t-s.from,r=i-s.from;return Object.assign(Object.assign({},n.changeByRange(l=>l!=s&&t!=i&&n.sliceDoc(l.from+o,l.from+r)!=n.sliceDoc(t,i)?{range:l}:{changes:{from:l.from+o,to:i==s.from?l.to:l.from+r,insert:e},range:m.cursor(l.from+o+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const Ze=new WeakMap;function Zn(n){if(!Array.isArray(n))return n;let e=Ze.get(n);return e||Ze.set(n,e=Xn(n)),e}const Ne=L.define(),G=L.define();class Jn{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let i=E(e,t),s=T(i);this.chars.push(i);let o=e.slice(t,t+s),r=o.toUpperCase();this.folded.push(E(r==o?o.toLowerCase():r,0)),t+=s}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,!0}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return!1;let{chars:t,folded:i,any:s,precise:o,byWord:r}=this;if(t.length==1){let g=E(e,0),F=T(g),A=F==e.length?0:-100;if(g!=t[0])if(g==i[0])A+=-200;else return!1;return this.ret(A,[0,F])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,c=0;if(l<0){for(let g=0,F=Math.min(e.length,200);g<F&&c<a;){let A=E(e,g);(A==t[c]||A==i[c])&&(s[c++]=g),g+=T(A)}if(c<a)return!1}let h=0,f=0,d=!1,p=0,v=-1,D=-1,P=/[a-z]/.test(e),z=!0;for(let g=0,F=Math.min(e.length,200),A=0;g<F&&f<a;){let w=E(e,g);l<0&&(h<a&&w==t[h]&&(o[h++]=g),p<a&&(w==t[p]||w==i[p]?(p==0&&(v=g),D=g+1,p++):p=0));let te,be=w<255?w>=48&&w<=57||w>=97&&w<=122?2:w>=65&&w<=90?1:0:(te=We(w))!=te.toLowerCase()?1:te!=te.toUpperCase()?2:0;(!g||be==1&&P||A==0&&be!=0)&&(t[f]==w||i[f]==w&&(d=!0)?r[f++]=g:r.length&&(z=!1)),A=be,g+=T(w)}return f==a&&r[0]==0&&z?this.result(-100+(d?-200:0),r,e):p==a&&v==0?this.ret(-200-e.length+(D==e.length?0:-100),[0,D]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):p==a?this.ret(-900-e.length,[v,D]):f==a?this.result(-100+(d?-200:0)+-700+(z?0:-1100),r,e):t.length==2?!1:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,t,i){let s=[],o=0;for(let r of t){let l=r+(this.astral?T(E(i,r)):1);o&&s[o-1]==r?s[o-1]=l:(s[o++]=r,s[o++]=l)}return this.ret(e-i.length,s)}}const C=pe.define({combine(n){return Oe(n,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:ei,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>i=>Je(e(i),t(i)),optionClass:(e,t)=>i=>Je(e(i),t(i)),addToOptions:(e,t)=>e.concat(t)})}});function Je(n,e){return n?e?n+" "+e:n:e}function ei(n,e,t,i,s,o){let r=n.textDirection==Ut.RTL,l=r,a=!1,c="top",h,f,d=e.left-s.left,p=s.right-e.right,v=i.right-i.left,D=i.bottom-i.top;if(l&&d<Math.min(v,p)?l=!1:!l&&p<Math.min(v,d)&&(l=!0),v<=(l?d:p))h=Math.max(s.top,Math.min(t.top,s.bottom-D))-e.top,f=Math.min(400,l?d:p);else{a=!0,f=Math.min(400,(r?e.right:s.right-e.left)-30);let g=s.bottom-e.bottom;g>=D||g>e.top?h=t.bottom-e.top:(c="bottom",h=e.bottom-t.top)}let P=(e.bottom-e.top)/o.offsetHeight,z=(e.right-e.left)/o.offsetWidth;return{style:`${c}: ${h/P}px; max-width: ${f/z}px`,class:"cm-completionInfo-"+(a?r?"left-narrow":"right-narrow":l?"left":"right")}}function ti(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),t.type&&i.classList.add(...t.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),i.setAttribute("aria-hidden","true"),i},position:20}),e.push({render(t,i,s,o){let r=document.createElement("span");r.className="cm-completionLabel";let l=t.displayLabel||t.label,a=0;for(let c=0;c<o.length;){let h=o[c++],f=o[c++];h>a&&r.appendChild(document.createTextNode(l.slice(a,h)));let d=r.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(l.slice(h,f))),d.className="cm-completionMatchedText",a=f}return a<l.length&&r.appendChild(document.createTextNode(l.slice(a))),r},position:50},{render(t){if(!t.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=t.detail,i},position:80}),e.sort((t,i)=>t.position-i.position).map(t=>t.render)}function Se(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let s=Math.floor(e/t);return{from:s*t,to:(s+1)*t}}let i=Math.floor((n-e)/t);return{from:n-(i+1)*t,to:n-i*t}}class ni{constructor(e,t,i){this.view=e,this.stateField=t,this.applyCompletion=i,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let s=e.state.field(t),{options:o,selected:r}=s.open,l=e.state.facet(C);this.optionContent=ti(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=Se(o.length,r,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(t).open;for(let h=a.target,f;h&&h!=this.dom;h=h.parentNode)if(h.nodeName=="LI"&&(f=/-(\d+)$/.exec(h.id))&&+f[1]<c.length){this.applyCompletion(e,c[+f[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(C).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:G.of(null)})}),this.showOptions(o,s.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let i=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),i!=s){let{options:o,selected:r,disabled:l}=i.open;(!s.open||s.open.options!=o)&&(this.range=Se(o.length,r,e.state.facet(C).maxRenderedOptions),this.showOptions(o,i.id)),this.updateSel(),l!=((t=s.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let i of this.currentClass.split(" "))i&&this.dom.classList.remove(i);for(let i of t.split(" "))i&&this.dom.classList.add(i);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=Se(t.options.length,t.selected,this.view.state.facet(C).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:i}=t.options[t.selected],{info:s}=i;if(!s)return;let o=typeof s=="string"?document.createTextNode(s):s(i);if(!o)return;"then"in o?o.then(r=>{r&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(r,i)}).catch(r=>Me(this.view.state,r,"completion info")):this.addInfoPane(o,i)}}addInfoPane(e,t){this.destroyInfo();let i=this.info=document.createElement("div");if(i.className="cm-tooltip cm-completionInfo",e.nodeType!=null)i.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:o}=e;i.appendChild(s),this.infoDestroy=o||null}this.dom.appendChild(i),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let i=this.list.firstChild,s=this.range.from;i;i=i.nextSibling,s++)i.nodeName!="LI"||!i.id?s--:s==e?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),t=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return t&&si(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),o=this.space;if(!o){let r=this.dom.ownerDocument.defaultView||window;o={left:0,top:0,right:r.innerWidth,bottom:r.innerHeight}}return s.top>Math.min(o.bottom,t.bottom)-10||s.bottom<Math.max(o.top,t.top)+10?null:this.view.state.facet(C).positionInfo(this.view,t,s,i,o,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,i){const s=document.createElement("ul");s.id=t,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions"));let o=null;for(let r=i.from;r<i.to;r++){let{completion:l,match:a}=e[r],{section:c}=l;if(c){let d=typeof c=="string"?c:c.name;if(d!=o&&(r>i.from||i.from==0))if(o=d,typeof c!="string"&&c.header)s.appendChild(c.header(c));else{let p=s.appendChild(document.createElement("completion-section"));p.textContent=d}}const h=s.appendChild(document.createElement("li"));h.id=t+"-"+r,h.setAttribute("role","option");let f=this.optionClass(l);f&&(h.className=f);for(let d of this.optionContent){let p=d(l,this.view.state,this.view,a);p&&h.appendChild(p)}}return i.from&&s.classList.add("cm-completionListIncompleteTop"),i.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function ii(n,e){return t=>new ni(t,n,e)}function si(n,e){let t=n.getBoundingClientRect(),i=e.getBoundingClientRect(),s=t.height/n.offsetHeight;i.top<t.top?n.scrollTop-=(t.top-i.top)/s:i.bottom>t.bottom&&(n.scrollTop+=(i.bottom-t.bottom)/s)}function et(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function oi(n,e){let t=[],i=null,s=a=>{t.push(a);let{section:c}=a.completion;if(c){i||(i=[]);let h=typeof c=="string"?c:c.name;i.some(f=>f.name==h)||i.push(typeof c=="string"?{name:h}:c)}};for(let a of n)if(a.hasResult()){let c=a.result.getMatch;if(a.result.filter===!1)for(let h of a.result.options)s(new Ye(h,a.source,c?c(h):[],1e9-t.length));else{let h=new Jn(e.sliceDoc(a.from,a.to));for(let f of a.result.options)if(h.match(f.label)){let d=f.displayLabel?c?c(f,h.matched):[]:h.matched;s(new Ye(f,a.source,d,h.score+(f.boost||0)))}}}if(i){let a=Object.create(null),c=0,h=(f,d)=>{var p,v;return((p=f.rank)!==null&&p!==void 0?p:1e9)-((v=d.rank)!==null&&v!==void 0?v:1e9)||(f.name<d.name?-1:1)};for(let f of i.sort(h))c-=1e5,a[f.name]=c;for(let f of t){let{section:d}=f.completion;d&&(f.score+=a[typeof d=="string"?d:d.name])}}let o=[],r=null,l=e.facet(C).compareCompletions;for(let a of t.sort((c,h)=>h.score-c.score||l(c.completion,h.completion))){let c=a.completion;!r||r.label!=c.label||r.detail!=c.detail||r.type!=null&&c.type!=null&&r.type!=c.type||r.apply!=c.apply||r.boost!=c.boost?o.push(a):et(a.completion)>et(r)&&(o[o.length-1]=a),r=a.completion}return o}class q{constructor(e,t,i,s,o,r){this.options=e,this.attrs=t,this.tooltip=i,this.timestamp=s,this.selected=o,this.disabled=r}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new q(this.options,tt(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,i,s,o){let r=oi(e,t);if(!r.length)return s&&e.some(a=>a.state==1)?new q(s.options,s.attrs,s.tooltip,s.timestamp,s.selected,!0):null;let l=t.facet(C).selectOnOpen?0:-1;if(s&&s.selected!=l&&s.selected!=-1){let a=s.options[s.selected].completion;for(let c=0;c<r.length;c++)if(r[c].completion==a){l=c;break}}return new q(r,tt(i,l),{pos:e.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:hi,above:o.aboveCursor},s?s.timestamp:Date.now(),l,!1)}map(e){return new q(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class de{constructor(e,t,i){this.active=e,this.id=t,this.open=i}static start(){return new de(ai,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,i=t.facet(C),o=(i.override||t.languageDataAt("autocomplete",O(t)).map(Zn)).map(l=>(this.active.find(c=>c.source==l)||new k(l,this.active.some(c=>c.state!=0)?1:0)).update(e,i));o.length==this.active.length&&o.every((l,a)=>l==this.active[a])&&(o=this.active);let r=this.open;r&&e.docChanged&&(r=r.map(e.changes)),e.selection||o.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!ri(o,this.active)?r=q.build(o,t,this.id,r,i):r&&r.disabled&&!o.some(l=>l.state==1)&&(r=null),!r&&o.every(l=>l.state!=1)&&o.some(l=>l.hasResult())&&(o=o.map(l=>l.hasResult()?new k(l.source,0):l));for(let l of e.effects)l.is(At)&&(r=r&&r.setSelected(l.value,this.id));return o==this.active&&r==this.open?this:new de(o,this.id,r)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:li}}function ri(n,e){if(n==e)return!0;for(let t=0,i=0;;){for(;t<n.length&&!n[t].hasResult;)t++;for(;i<e.length&&!e[i].hasResult;)i++;let s=t==n.length,o=i==e.length;if(s||o)return s==o;if(n[t++].result!=e[i++].result)return!1}}const li={"aria-autocomplete":"list"};function tt(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const ai=[];function Ae(n){return n.isUserEvent("input.type")?"input":n.isUserEvent("delete.backward")?"delete":null}class k{constructor(e,t,i=-1){this.source=e,this.state=t,this.explicitPos=i}hasResult(){return!1}update(e,t){let i=Ae(e),s=this;i?s=s.handleUserEvent(e,i,t):e.docChanged?s=s.handleChange(e):e.selection&&s.state!=0&&(s=new k(s.source,0));for(let o of e.effects)if(o.is(Ne))s=new k(s.source,1,o.value?O(e.state):-1);else if(o.is(G))s=new k(s.source,0);else if(o.is(Dt))for(let r of o.value)r.source==s.source&&(s=r);return s}handleUserEvent(e,t,i){return t=="delete"||!i.activateOnTyping?this.map(e.changes):new k(this.source,1)}handleChange(e){return e.changes.touchesRange(O(e.startState))?new k(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new k(this.source,this.state,e.mapPos(this.explicitPos))}}class U extends k{constructor(e,t,i,s,o){super(e,2,t),this.result=i,this.from=s,this.to=o}hasResult(){return!0}handleUserEvent(e,t,i){var s;let o=e.changes.mapPos(this.from),r=e.changes.mapPos(this.to,1),l=O(e.state);if((this.explicitPos<0?l<=o:l<this.from)||l>r||t=="delete"&&O(e.startState)==this.from)return new k(this.source,t=="input"&&i.activateOnTyping?1:0);let a=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),c;return ci(this.result.validFor,e.state,o,r)?new U(this.source,a,this.result,o,r):this.result.update&&(c=this.result.update(this.result,o,r,new It(e.state,l,a>=0)))?new U(this.source,a,c,c.from,(s=c.to)!==null&&s!==void 0?s:O(e.state)):new k(this.source,1,a)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new k(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new U(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function ci(n,e,t,i){if(!n)return!1;let s=e.sliceDoc(t,i);return typeof n=="function"?n(s,t,i,e):Lt(n,!0).test(s)}const Dt=L.define({map(n,e){return n.map(t=>t.map(e))}}),At=L.define(),I=Z.define({create(){return de.start()},update(n,e){return n.update(e)},provide:n=>[Ht.from(n,e=>e.tooltip),x.contentAttributes.from(n,e=>e.attrs)]});function Tt(n,e){const t=e.completion.apply||e.completion.label;let i=n.state.field(I).active.find(s=>s.source==e.source);return i instanceof U?(typeof t=="string"?n.dispatch(Object.assign(Object.assign({},Yn(n.state,t,i.from,i.to)),{annotations:Et.of(e.completion)})):t(n,e.completion,i.from,i.to),!0):!1}const hi=ii(I,Tt);function se(n,e="option"){return t=>{let i=t.state.field(I,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<t.state.facet(C).interactionDelay)return!1;let s=1,o;e=="page"&&(o=pt(t,i.open.tooltip))&&(s=Math.max(2,Math.floor(o.dom.offsetHeight/o.dom.querySelector("li").offsetHeight)-1));let{length:r}=i.open.options,l=i.open.selected>-1?i.open.selected+s*(n?1:-1):n?0:r-1;return l<0?l=e=="page"?0:r-1:l>=r&&(l=e=="page"?r-1:0),t.dispatch({effects:At.of(l)}),!0}}const fi=n=>{let e=n.state.field(I,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(C).interactionDelay?!1:Tt(n,e.open.options[e.open.selected])},ui=n=>n.state.field(I,!1)?(n.dispatch({effects:Ne.of(!0)}),!0):!1,di=n=>{let e=n.state.field(I,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:G.of(null)}),!0)};class pi{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const mi=50,gi=1e3,xi=Re.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let e of n.state.field(I).active)e.state==1&&this.startQuery(e)}update(n){let e=n.state.field(I);if(!n.selectionSet&&!n.docChanged&&n.startState.field(I)==e)return;let t=n.transactions.some(i=>(i.selection||i.docChanged)&&!Ae(i));for(let i=0;i<this.running.length;i++){let s=this.running[i];if(t||s.updates.length+n.transactions.length>mi&&Date.now()-s.time>gi){for(let o of s.context.abortListeners)try{o()}catch(r){Me(this.view.state,r)}s.context.abortListeners=null,this.running.splice(i--,1)}else s.updates.push(...n.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=e.active.some(i=>i.state==1&&!this.running.some(s=>s.active.source==i.source))?setTimeout(()=>this.startUpdate(),50):-1,this.composing!=0)for(let i of n.transactions)Ae(i)=="input"?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:n}=this.view,e=n.field(I);for(let t of e.active)t.state==1&&!this.running.some(i=>i.active.source==t.source)&&this.startQuery(t)}startQuery(n){let{state:e}=this.view,t=O(e),i=new It(e,t,n.explicitPos==t),s=new pi(n,i);this.running.push(s),Promise.resolve(n.source(i)).then(o=>{s.context.aborted||(s.done=o||null,this.scheduleAccept())},o=>{this.view.dispatch({effects:G.of(null)}),Me(this.view.state,o)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(C).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(C);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let r=new U(s.active.source,s.active.explicitPos,s.done,s.done.from,(n=s.done.to)!==null&&n!==void 0?n:O(s.updates.length?s.updates[0].startState:this.view.state));for(let l of s.updates)r=r.update(l,t);if(r.hasResult()){e.push(r);continue}}let o=this.view.state.field(I).active.find(r=>r.source==s.active.source);if(o&&o.state==1)if(s.done==null){let r=new k(s.active.source,0);for(let l of s.updates)r=r.update(l,t);r.state!=1&&e.push(r)}else this.startQuery(o)}e.length&&this.view.dispatch({effects:Dt.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(I,!1);if(e&&e.tooltip&&this.view.state.facet(C).closeOnBlur){let t=e.open&&pt(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&this.view.dispatch({effects:G.of(null)})}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Ne.of(!1)}),20),this.composing=0}}}),Rt=x.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class bi{constructor(e,t,i,s){this.field=e,this.line=t,this.from=i,this.to=s}}class Ue{constructor(e,t,i){this.field=e,this.from=t,this.to=i}map(e){let t=e.mapPos(this.from,-1,Ie.TrackDel),i=e.mapPos(this.to,1,Ie.TrackDel);return t==null||i==null?null:new Ue(this.field,t,i)}}class He{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let i=[],s=[t],o=e.doc.lineAt(t),r=/^\s*/.exec(o.text)[0];for(let a of this.lines){if(i.length){let c=r,h=/^\t*/.exec(a)[0].length;for(let f=0;f<h;f++)c+=e.facet(_t);s.push(t+c.length-h),a=c+a.slice(h)}i.push(a),t+=a.length+1}let l=this.fieldPositions.map(a=>new Ue(a.field,s[a.line]+a.from,s[a.line]+a.to));return{text:i,ranges:l}}static parse(e){let t=[],i=[],s=[],o;for(let r of e.split(/\r\n?|\n/)){for(;o=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(r);){let l=o[1]?+o[1]:null,a=o[2]||o[3]||"",c=-1;for(let h=0;h<t.length;h++)(l!=null?t[h].seq==l:a&&t[h].name==a)&&(c=h);if(c<0){let h=0;for(;h<t.length&&(l==null||t[h].seq!=null&&t[h].seq<l);)h++;t.splice(h,0,{seq:l,name:a}),c=h;for(let f of s)f.field>=c&&f.field++}s.push(new bi(c,i.length,o.index,o.index+a.length)),r=r.slice(0,o.index)+a+r.slice(o.index+o[0].length)}for(let l;l=/\\([{}])/.exec(r);){r=r.slice(0,l.index)+l[1]+r.slice(l.index+l[0].length);for(let a of s)a.line==i.length&&a.from>l.index&&(a.from--,a.to--)}i.push(r)}return new He(i,s)}}let yi=b.widget({widget:new class extends Qt{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),Ci=b.mark({class:"cm-snippetField"});class V{constructor(e,t){this.ranges=e,this.active=t,this.deco=b.set(e.map(i=>(i.from==i.to?yi:Ci).range(i.from,i.to)))}map(e){let t=[];for(let i of this.ranges){let s=i.map(e);if(!s)return null;t.push(s)}return new V(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(i=>i.field==this.active&&i.from<=t.from&&i.to>=t.to))}}const ee=L.define({map(n,e){return n&&n.map(e)}}),vi=L.define(),X=Z.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(ee))return t.value;if(t.is(vi)&&n)return new V(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>x.decorations.from(n,e=>e?e.deco:b.none)});function je(n,e){return m.create(n.filter(t=>t.field==e).map(t=>m.range(t.from,t.to)))}function Si(n){let e=He.parse(n);return(t,i,s,o)=>{let{text:r,ranges:l}=e.instantiate(t.state,s),a={changes:{from:s,to:o,insert:zt.of(r)},scrollIntoView:!0,annotations:i?Et.of(i):void 0};if(l.length&&(a.selection=je(l,0)),l.length>1){let c=new V(l,0),h=a.effects=[ee.of(c)];t.state.field(X,!1)===void 0&&h.push(L.appendConfig.of([X,Li,Ei,Rt]))}t.dispatch(t.state.update(a))}}function Ot(n){return({state:e,dispatch:t})=>{let i=e.field(X,!1);if(!i||n<0&&i.active==0)return!1;let s=i.active+n,o=n>0&&!i.ranges.some(r=>r.field==s+n);return t(e.update({selection:je(i.ranges,s),effects:ee.of(o?null:new V(i.ranges,s)),scrollIntoView:!0})),!0}}const wi=({state:n,dispatch:e})=>n.field(X,!1)?(e(n.update({effects:ee.of(null)})),!0):!1,ki=Ot(1),Mi=Ot(-1),Ii=[{key:"Tab",run:ki,shift:Mi},{key:"Escape",run:wi}],nt=pe.define({combine(n){return n.length?n[0]:Ii}}),Li=Pe.highest(ge.compute([nt],n=>n.facet(nt)));function is(n,e){return Object.assign(Object.assign({},e),{apply:Si(n)})}const Ei=x.domEventHandlers({mousedown(n,e){let t=e.state.field(X,!1),i;if(!t||(i=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let s=t.ranges.find(o=>o.from<=i&&o.to>=i);return!s||s.field==t.active?!1:(e.dispatch({selection:je(t.ranges,s.field),effects:ee.of(t.ranges.some(o=>o.field>s.field)?new V(t.ranges,s.field):null),scrollIntoView:!0}),!0)}}),Y={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},W=L.define({map(n,e){let t=e.mapPos(n,-1,Ie.TrackAfter);return t??void 0}}),Ve=new class extends jt{};Ve.startSide=1;Ve.endSide=-1;const Pt=Z.define({create(){return Vt.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:i=>i>=t.from&&i<=t.to})}for(let t of e.effects)t.is(W)&&(n=n.update({add:[Ve.range(t.value,t.value+1)]}));return n}});function Di(){return[Ti,Pt]}const we="()[]{}<>";function Wt(n){for(let e=0;e<we.length;e+=2)if(we.charCodeAt(e)==n)return we.charAt(e+1);return We(n<128?n:n+1)}function Ft(n,e){return n.languageDataAt("closeBrackets",e)[0]||Y}const Ai=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Ti=x.inputHandler.of((n,e,t,i)=>{if((Ai?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let s=n.state.selection.main;if(i.length>2||i.length==2&&T(E(i,0))==1||e!=s.from||t!=s.to)return!1;let o=Pi(n.state,i);return o?(n.dispatch(o),!0):!1}),Ri=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let i=Ft(n,n.selection.main.head).brackets||Y.brackets,s=null,o=n.changeByRange(r=>{if(r.empty){let l=Wi(n.doc,r.head);for(let a of i)if(a==l&&xe(n.doc,r.head)==Wt(E(a,0)))return{changes:{from:r.head-a.length,to:r.head+a.length},range:m.cursor(r.head-a.length)}}return{range:s=r}});return s||e(n.update(o,{scrollIntoView:!0,userEvent:"delete.backward"})),!s},Oi=[{key:"Backspace",run:Ri}];function Pi(n,e){let t=Ft(n,n.selection.main.head),i=t.brackets||Y.brackets;for(let s of i){let o=Wt(E(s,0));if(e==s)return o==s?$i(n,s,i.indexOf(s+s+s)>-1,t):Fi(n,s,o,t.before||Y.before);if(e==o&&Bt(n,n.selection.main.from))return Bi(n,s,o)}return null}function Bt(n,e){let t=!1;return n.field(Pt).between(0,n.doc.length,i=>{i==e&&(t=!0)}),t}function xe(n,e){let t=n.sliceString(e,e+2);return t.slice(0,T(E(t,0)))}function Wi(n,e){let t=n.sliceString(e-2,e);return T(E(t,0))==t.length?t:t.slice(1)}function Fi(n,e,t,i){let s=null,o=n.changeByRange(r=>{if(!r.empty)return{changes:[{insert:e,from:r.from},{insert:t,from:r.to}],effects:W.of(r.to+e.length),range:m.range(r.anchor+e.length,r.head+e.length)};let l=xe(n.doc,r.head);return!l||/\s/.test(l)||i.indexOf(l)>-1?{changes:{insert:e+t,from:r.head},effects:W.of(r.head+e.length),range:m.cursor(r.head+e.length)}:{range:s=r}});return s?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function Bi(n,e,t){let i=null,s=n.changeByRange(o=>o.empty&&xe(n.doc,o.head)==t?{changes:{from:o.head,to:o.head+t.length,insert:t},range:m.cursor(o.head+t.length)}:i={range:o});return i?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function $i(n,e,t,i){let s=i.stringPrefixes||Y.stringPrefixes,o=null,r=n.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:W.of(l.to+e.length),range:m.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=xe(n.doc,a),h;if(c==e){if(it(n,a))return{changes:{insert:e+e,from:a},effects:W.of(a+e.length),range:m.cursor(a+e.length)};if(Bt(n,a)){let d=t&&n.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+d.length,insert:d},range:m.cursor(a+d.length)}}}else{if(t&&n.sliceDoc(a-2*e.length,a)==e+e&&(h=st(n,a-2*e.length,s))>-1&&it(n,h))return{changes:{insert:e+e+e+e,from:a},effects:W.of(a+e.length),range:m.cursor(a+e.length)};if(n.charCategorizer(a)(c)!=S.Word&&st(n,a,s)>-1&&!qi(n,a,e,s))return{changes:{insert:e+e,from:a},effects:W.of(a+e.length),range:m.cursor(a+e.length)}}return{range:o=l}});return o?null:n.update(r,{scrollIntoView:!0,userEvent:"input.type"})}function it(n,e){let t=me(n).resolveInner(e+1);return t.parent&&t.from==e}function qi(n,e,t,i){let s=me(n).resolveInner(e,-1),o=i.reduce((r,l)=>Math.max(r,l.length),0);for(let r=0;r<5;r++){let l=n.sliceDoc(s.from,Math.min(s.to,s.from+t.length+o)),a=l.indexOf(t);if(!a||a>-1&&i.indexOf(l.slice(0,a))>-1){let h=s.firstChild;for(;h&&h.from==s.from&&h.to-h.from>t.length+a;){if(n.sliceDoc(h.to-t.length,h.to)==t)return!1;h=h.firstChild}return!0}let c=s.to==e&&s.parent;if(!c)break;s=c}return!1}function st(n,e,t){let i=n.charCategorizer(e);if(i(n.sliceDoc(e-1,e))!=S.Word)return e;for(let s of t){let o=e-s.length;if(n.sliceDoc(o,e)==s&&i(n.sliceDoc(o-1,o))!=S.Word)return o}return-1}function Ni(n={}){return[I,C.of(n),xi,Ui,Rt]}const $t=[{key:"Ctrl-Space",run:ui},{key:"Escape",run:di},{key:"ArrowDown",run:se(!0)},{key:"ArrowUp",run:se(!1)},{key:"PageDown",run:se(!0,"page")},{key:"PageUp",run:se(!1,"page")},{key:"Enter",run:fi}],Ui=Pe.highest(ge.computeN([C],n=>n.facet(C).defaultKeymap?[$t]:[])),Hi=[Gt(),Xt(),Yt(),Zt(),Jt(),mt(),en(),_.allowMultipleSelections.of(!0),tn(),K(Le,{fallback:!0}),nn(),Di(),Ni(),sn(),on(),rn(),In(),ge.of([...Oi,...ln,...zn,...an,...cn,...$t,...hn])],ji={"Control character":"控制字符","Selection deleted":"删除所选内容","Folded lines":"折叠行","Unfolded lines":"展开行",to:"至","folded code":"折叠的代码",unfold:"展开","Fold line":"折叠行","Unfold line":"展开行","Go to line":"跳转至行",go:"确定",Find:"查找",Replace:"替换",next:"下一个",previous:"上一个",all:"全部","match case":"匹配大小写","by word":"按单词",replace:"替换","replace all":"全部替换",close:"关闭","current match":"当前匹配项","replaced $ matches":"替换了 $ 个匹配项","replaced match on line $":"替换了行 $ 的匹配项","on line":"在行",Completions:"自动完成",Diagnostics:"诊断","No diagnostics":"无诊断信息"},Vi={extensions:[Hi,_.phrases.of(ji),ge.of([fn]),mt()]},zi="#e5c07b",ot="#e06c75",Ki="#56b6c2",_i="#ffffff",oe="#abb2bf",Te="#7d8799",Qi="#61afef",Gi="#98c379",rt="#d19a66",Xi="#c678dd",Yi="#21252b",lt="#2c313a",at="#282c34",ke="#353a42",Zi="#3E4451",ct="#528bff",ht=x.theme({"&":{color:oe,backgroundColor:at},".cm-content":{caretColor:ct},".cm-cursor, .cm-dropCursor":{borderLeftColor:ct},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Zi},".cm-panels":{backgroundColor:Yi,color:oe},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:at,color:Te,border:"none"},".cm-activeLineGutter":{backgroundColor:lt},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:ke},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:ke,borderBottomColor:ke},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:lt,color:oe}}},{dark:!0}),ft=un.define([{tag:u.keyword,color:Xi},{tag:[u.name,u.deleted,u.character,u.propertyName,u.macroName],color:ot},{tag:[u.function(u.variableName),u.labelName],color:Qi},{tag:[u.color,u.constant(u.name),u.standard(u.name)],color:rt},{tag:[u.definition(u.name),u.separator],color:oe},{tag:[u.typeName,u.className,u.number,u.changed,u.annotation,u.modifier,u.self,u.namespace],color:zi},{tag:[u.operator,u.operatorKeyword,u.url,u.escape,u.regexp,u.link,u.special(u.string)],color:Ki},{tag:[u.meta,u.comment],color:Te},{tag:u.strong,fontWeight:"bold"},{tag:u.emphasis,fontStyle:"italic"},{tag:u.strikethrough,textDecoration:"line-through"},{tag:u.link,color:Te,textDecoration:"underline"},{tag:u.heading,fontWeight:"bold",color:ot},{tag:[u.atom,u.bool,u.special(u.variableName)],color:rt},{tag:[u.processingInstruction,u.string,u.inserted],color:Gi},{tag:u.invalid,color:_i}]),Ji=pn({__name:"EditorMini",props:{inputDefault:{default:""},plugin:{default:void 0},placeholder:{default:""},readonly:{type:Boolean,default:!1}},emits:["change"],setup(n,{expose:e,emit:t}){const i=n,s=t;e({getView:d,setInput:f});const o=mn();let r;const l=new ze,a=new ze,c=[Vi.extensions,i.plugin?i.plugin.miniExtensions||i.plugin.extensions:[],x.updateListener.of(h),l.of(ye().isDark?ht:x.theme({},{dark:!1})),a.of(ye().isDark?K(ft,{fallback:!0}):K(Le))];i.placeholder&&c.push(dn(i.placeholder)),i.readonly&&c.push(_.readOnly.of(!0)),gn(()=>{r=new x({state:_.create({extensions:c,doc:i.inputDefault}),parent:o.value})}),xn(()=>{r==null||r.destroy()}),bn(()=>ye().isDark,p=>{r.dispatch({effects:[l.reconfigure(p?ht:x.theme({},{dark:!1})),a.reconfigure(p?K(ft,{fallback:!0}):K(Le))]})});function h(p){p.docChanged&&s("change",p.state.doc.toString())}function f(p){r.dispatch({changes:{from:0,to:r.state.doc.length,insert:p}})}function d(){return r}return(p,v)=>(yn(),Cn("div",{ref_key:"editor",ref:o,class:"editor","w-full":""},null,512))}}),ss=vn(Ji,[["__scopeId","data-v-d03261e5"]]);export{ss as _,Xn as c,ns as i,is as s};
