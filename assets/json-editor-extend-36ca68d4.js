import"./index-00255b5a.js";import{h as X,y as v,k as Y,at as M,R as Z,a9 as ee,ag as te,D as R,A as ne,o as oe,l as ae,m as t,t as U,n as i,a as n,w as o,b as r,T as w,z as V,U as E,E as se,B as le,J as ce,K as ie,_ as ue}from"./index-9e6d6e86.js";import{E as re}from"./el-dialog-bd35a0dc.js";import{E as de}from"./el-space-596fde3e.js";import{a as pe,b as _e,E as fe}from"./el-dropdown-930c1b64.js";import"./el-popper-e0711f57.js";import"./el-scrollbar-abf118c0.js";import{f as me}from"./formatBytes-f3c6eb77.js";import{J as ve}from"./jsoneditor.min-b3ae0942.js";import{c as he}from"./createFile-61841ce0.js";import{_ as ge}from"./Paragraph-d5ff77c6.js";import{_ as ye}from"./Text-90b257da.js";import"./ResizeObserver.es-0f9f8adb.js";import"./isEqual-442c5152.js";import"./refs-fe343877.js";const u=x=>(ce("data-v-4f8ea845"),x=x(),ie(),x),ke={class:"editorController"},be={class:"editorTitle"},we=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-file-addition-one"}),r(" 新建")],-1)),Ee=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-history"}),r(" 打开最近记录")],-1)),xe=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-computer"}),r(" 打开本地文件")],-1)),Ie=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-link-three"}),r(" 打开URL")],-1)),Ce=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-folder-open"}),r(" 打开"),t("span",{class:"i-icon-park-outline-down"})],-1)),Se=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-save"}),r(" 保存")],-1)),Te={class:"buttonWithIcon"},Ve=u(()=>t("span",{class:"i-icon-park-outline-indent-right"},null,-1)),We=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-info"}),r(" 文档属性")],-1)),Be=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-delete"}),r(" 删除文档")],-1)),Ne=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-setting-two"}),r(" 选项"),t("span",{class:"i-icon-park-outline-down"})],-1)),je={class:"dialog-footer"},ze=u(()=>t("strong",null,"名称：",-1)),De=u(()=>t("strong",null,"存储：",-1)),Je=u(()=>t("strong",null,"更新：",-1)),Oe=u(()=>t("strong",null,"内容：",-1)),Me=u(()=>t("strong",null,"大小：",-1)),Re=X({__name:"json-editor-extend",props:{name:{},code:{},mode:{}},emits:["update:name","update:code","create","blur","focus","openRecent"],setup(x,{expose:A,emit:y}){const h=x;let d;const W=v(),B=v(),N=v(),a=v(""),f=v("code"),m=v(2),g=v(""),k=v(!1),I=v(!1),_=Y(()=>{if(I){let e;return typeof a.value=="string"?e="字符串类型":Array.isArray(a.value)?e=`数组类型，包含 ${a.value.length} 个对象`:typeof a.value=="object"?e=`对象类型，包含 ${Object.keys(a.value).length} 个属性`:e="其他类型",{name:g.value,storage:"",updated:"",content:e,size:me(typeof a.value=="string"?a.value.length:JSON.stringify(a.value,null,m.value).length)}}else return{}}),F=M(function({name:e,code:l}){e!=null&&e!==g.value&&(g.value=e),l!=null&&l!==a.value&&(a.value=l),d&&C(d,f.value,a.value)},100);Z(()=>{h.name!==void 0&&(g.value=h.name),h.code!==void 0&&(a.value=h.code),h.mode!==void 0&&(f.value=h.mode),P()}),ee(()=>{d&&d.destroy()}),te(()=>{F({name:h.name,code:h.code})}),R(()=>a.value,e=>{y("update:code",e)}),R(()=>g.value,e=>{y("update:name",e)}),A({container:N});function P(){d=new ve(W.value,{mode:f.value,modes:["code","tree"],onChangeText:M(e=>{if(f.value==="tree")try{a.value=JSON.parse(e)}catch{a.value=e}else a.value=e},100),onModeChange:e=>{f.value=e,a.value=C(d,e,a.value)},onError:e=>{ne.error(e.message)},onFocus:()=>{y("focus")},onBlur:()=>{y("blur")}}),a.value=C(d,f.value,a.value,!0)}function C(e,l,s,c=!1){if(l==="tree")if(typeof s=="string")try{const p=JSON.parse(s);return c?e.set(p):e.update(p),p}catch{return e.setMode("code"),c?e.setText(s):e.updateText(s),f.value="code",s}else return c?e.set(s):e.update(s),s;else{if(typeof s=="string")return c?e.setText(s):e.updateText(s),s;{const p=JSON.stringify(s,null,m.value);return c?e.setText(p):e.updateText(p),p}}}function j(){y("create"),d.set({})}function $(e){switch(e){case"file":B.value.click();break;case"recent":y("openRecent");break}}function K(e){const l=e.target;if(l.files&&l.files.length){const s=l.files[0],c=new FileReader;c.onload=()=>{c.result&&(j(),a.value=C(d,f.value,c.result,!0),g.value=s.name)},c.readAsText(s)}l.value=""}function L(){he(d.getText(),g.value||"未命名.json")}let z=m.value;function q(e){switch(e){case"indentation":z=m.value,k.value=!0;break;case"properties":I.value=!0;break}}function D(){m.value=z,k.value=!1}function G(){if(typeof a.value=="string")try{a.value=C(d,f.value,JSON.parse(a.value))}catch{}k.value=!1}return(e,l)=>{const s=se,c=pe,p=_e,J=fe,H=de,b=ge,Q=le,O=re,S=ye;return oe(),ae("div",{ref_key:"container",ref:N,class:"editorPanelContainer"},[t("div",ke,[t("div",be,U(i(g)),1),n(H,{class:"editorControlButtons"},{default:o(()=>[n(s,{size:"small",type:"primary",onClick:j},{default:o(()=>[we]),_:1}),n(J,{onCommand:$},{dropdown:o(()=>[n(p,null,{default:o(()=>[n(c,{command:"recent"},{default:o(()=>[Ee]),_:1}),n(c,{command:"file"},{default:o(()=>[xe]),_:1}),n(c,{command:"url"},{default:o(()=>[Ie]),_:1})]),_:1})]),default:o(()=>[n(s,{size:"small",type:"primary"},{default:o(()=>[Ce]),_:1})]),_:1}),n(s,{size:"small",type:"primary",onClick:L},{default:o(()=>[Se]),_:1}),n(J,{onCommand:q},{dropdown:o(()=>[n(p,null,{default:o(()=>[n(c,{command:"indentation"},{default:o(()=>[t("span",Te,[Ve,r(" 缩进("+U(i(m))+")",1)])]),_:1}),n(c,{command:"properties"},{default:o(()=>[We]),_:1}),n(c,{command:"delete"},{default:o(()=>[Be]),_:1})]),_:1})]),default:o(()=>[n(s,{size:"small",type:"primary"},{default:o(()=>[Ne]),_:1})]),_:1})]),_:1})]),t("div",{ref_key:"editorWrapper",ref:W,class:"jsonEditor"},null,512),w(t("input",{ref_key:"uploader",ref:B,type:"file",accept:".json,.geojson,.txt",onChange:K},null,544),[[E,!1]]),n(O,{modelValue:i(k),"onUpdate:modelValue":l[1]||(l[1]=T=>V(k)?k.value=T:null),title:"设置缩进","before-close":D},{footer:o(()=>[t("span",je,[n(s,{onClick:D},{default:o(()=>[r("取消")]),_:1}),n(s,{type:"primary",onClick:G},{default:o(()=>[r(" 确定 ")]),_:1})])]),default:o(()=>[n(b,null,{default:o(()=>[r("配置代码模式下用于缩进的空格数。 缩进同时应用于两个面板。")]),_:1}),n(Q,{modelValue:i(m),"onUpdate:modelValue":l[0]||(l[0]=T=>V(m)?m.value=T:null),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["modelValue"]),n(O,{modelValue:i(I),"onUpdate:modelValue":l[2]||(l[2]=T=>V(I)?I.value=T:null),title:"文档属性",class:"documentProperties"},{default:o(()=>[n(b,null,{default:o(()=>[ze,w(n(S,{content:i(_).name},null,8,["content"]),[[E,i(_).name]])]),_:1}),n(b,null,{default:o(()=>[De,w(n(S,{content:i(_).storage},null,8,["content"]),[[E,i(_).storage]])]),_:1}),n(b,null,{default:o(()=>[Je,w(n(S,{content:i(_).updated},null,8,["content"]),[[E,i(_).updated]])]),_:1}),n(b,null,{default:o(()=>[Oe,w(n(S,{content:i(_).content},null,8,["content"]),[[E,i(_).content]])]),_:1}),n(b,null,{default:o(()=>[Me,w(n(S,{content:i(_).size},null,8,["content"]),[[E,i(_).size]])]),_:1})]),_:1},8,["modelValue"])],512)}}});const tt=ue(Re,[["__scopeId","data-v-4f8ea845"]]);export{tt as default};
