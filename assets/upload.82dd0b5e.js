import{_ as d,j as u,o as l,c as g,w as p,a as h,bz as _,bA as f,q as o,b as r}from"./index.3856a4d5.js";import{S as x}from"./index.dac54b33.js";import{U as b}from"./index.06c16d41.js";import"./index.a9f8a832.js";import{u as y}from"./index.5dfde998.js";import"./debounce.44ad6d4e.js";import"./FormItem.2f0ebe3d.js";import"./Col.b2d43946.js";import"./responsiveObserve.7dede465.js";import"./useFlexGapSupport.b9656fe1.js";import"./toArray.b6a7c471.js";import"./get.b0bd0764.js";import"./hasIn.9dc6a54b.js";import"./toInteger.b14de12a.js";import"./toFinite.ec13784c.js";import"./_baseFindIndex.10ef1a58.js";import"./collapseMotion.ac71c482.js";import"./EyeOutlined.30aa94cd.js";import"./index.aef95fc1.js";import"./Form.30ab4c79.js";import"./_arrayIncludesWith.91d14080.js";import"./useRefs.6e5fccf3.js";const{mapGetters:v,mapActions:w}=u("imgHosting"),I={name:"ImgHostingUpload",props:{activeKey:{type:String,default:""}},data:()=>({spinning:!1,timeoutIndex:void 0}),computed:{...v(["config","uploader","commonConfig"])},mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:{...w(["addImage"]),async customRequest({file:e}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const t=e.name||"";e=new File([e],(new Date().getTime()+t.substring(t.lastIndexOf("."))).toLowerCase(),{type:e.type,lastModified:e.lastModified})}try{const t=await y[this.uploader].handle(this.config(this.uploader),e);if(this.addImage(t),this.commonConfig.copyUrlAfterUpload)try{this.commonConfig.customCopyContent?await navigator.clipboard.writeText(this.commonConfig.customCopyContent.replace(/\$url/g,t.url)):await navigator.clipboard.writeText(t.url),this.$msg.success("\u4E0A\u4F20\u6210\u529F\uFF0C\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch{this.$msg.error("\u4E0A\u4F20\u6210\u529F\uFF0C\u4F46\u5730\u5740\u590D\u5236\u5931\u8D25")}else this.$msg.success("\u4E0A\u4F20\u6210\u529F")}catch(t){console.log(t),this.$msg.error("\u4E0A\u4F20\u5931\u8D25")}}else this.$msg.warn("\u8BF7\u5148\u8FDB\u884C\u8BBE\u7F6E");this.spinning=!1},rejectFile(){this.$msg.warning("\u4E0D\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B\uFF01")},paste(e){if(this.activeKey==="home"&&!this.spinning&&!this.timeoutIndex){this.timeoutIndex=setTimeout(()=>{this.timeoutIndex=void 0},500);const t=e.clipboardData&&e.clipboardData.items;let i;if(t&&t.length)for(const s of t)s.type.indexOf("image")!==-1&&(i=s.getAsFile());i?this.customRequest({file:i}):(this.rejectFile(),clearTimeout(this.timeoutIndex),this.timeoutIndex=void 0)}}}},a=e=>(_("data-v-d3adb61a"),e=e(),f(),e),C=a(()=>o("p",{class:"ant-upload-drag-icon"},[o("span",{class:"i-icon-park-upload-one"})],-1)),$=a(()=>o("p",{class:"ant-upload-text"},[r(" \u76F4\u63A5\u7C98\u8D34\u56FE\u7247\u6216\u62D6\u62FD\u56FE\u7247\u5230\u8FD9\u91CC\u4E0A\u4F20"),o("br"),r("\u6216\u8005\u76F4\u63A5\u70B9\u51FB\u9009\u62E9\u6587\u4EF6\u4E0A\u4F20 ")],-1)),j=a(()=>o("p",{class:"ant-upload-hint"}," \u6682\u65F6\u4EC5\u652F\u6301\u5355\u6587\u4EF6\u4E0A\u4F20\u3002 ",-1));function S(e,t,i,s,T,n){const m=b,c=x;return l(),g(c,{spinning:e.spinning},{default:p(()=>[h(m,{"file-list":[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp","show-upload-list":!1,"custom-request":n.customRequest,onReject:n.rejectFile},{default:p(()=>[C,$,j]),_:1},8,["custom-request","onReject"])]),_:1},8,["spinning"])}var X=d(I,[["render",S],["__scopeId","data-v-d3adb61a"]]);export{X as default};
