import{x as E,y as V,z as G,d as p,A as v,B as m,D as I,F as N,G as U,J as j,K as $,M as z,O as q,P as J}from"../../common-HF2gOZ1x.js";import{o as P,a as A}from"../../@codemirror/theme-one-dark-2L59sYOW.js";import{j as K,B as k,l as O,P as R,q as T,o as l,c,a as x,F as y,e as F,g as Q,d as H,a3 as W}from"../../vendor-flbquvym.js";function X(d){const i=document.createElement("div");return i.style.padding="0 .5rem",i.textContent=e(),{dom:i,update(a){a.selectionSet&&(i.textContent=e())}};function e(){const a=d.state.selection.main,u=d.state.doc.lineAt(a.head);let t=`总行数: ${d.state.doc.lines} 行数: ${u.number} 列数: ${a.head-u.from}`;return a.empty||(t+=`选中: ${Math.abs(a.to-a.from)} 字符`),t}}const Y={...E,extensions:[...E.extensions,V.of(X),G()]},Z={flex:"","flex-col":""},tt={class:"controller",flex:""},et=["title","onClick"],ot=K({__name:"Editor",props:{inputDefault:{default:""},plugin:{default:void 0},placeholder:{default:""}},emits:["change"],setup(d,{emit:i}){var B,w;const e=d,a=i,u=k();let t;const C=new $,D=new $,h=k(!1),g=k(!1);O(()=>{var s;const o=[...Y.extensions,...((s=e.plugin)==null?void 0:s.extensions)||[],p.updateListener.of(L),C.of(v().isDark?P:p.theme({},{dark:!1})),D.of(v().isDark?m(A,{fallback:!0}):m(z))];e.placeholder&&o.push(I(e.placeholder)),t=new p({state:N.create({extensions:o,doc:e.inputDefault}),parent:u.value})}),R(()=>{t==null||t.destroy()}),T(()=>v().isDark,o=>{t.dispatch({effects:[C.reconfigure(o?P:p.theme({},{dark:!1})),D.reconfigure(o?m(A,{fallback:!0}):m(z))]})});function L(o){o.docChanged&&(h.value=U(t.state)>0,g.value=j(t.state)>0,a("change",o.state.doc.toString()))}const S=[[{title:"撤销",isDisabled:()=>!h.value,event:function(){h.value&&q(t)},icon:"i-fa6-solid-arrow-rotate-left"},{title:"重做",isDisabled:()=>!g.value,event:function(){g.value&&J(t)},icon:"i-fa6-solid-arrow-rotate-right"}]],f=[];return(B=e.plugin)!=null&&B.formatter&&f.push({title:"格式化",event:function(){var s;if((s=e.plugin)!=null&&s.formatter)try{const n=e.plugin.formatter(t.state.doc.toString());n&&n!==t.state.doc.toString()&&t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n}})}catch{}},icon:"i-iszy-editor-format"}),(w=e.plugin)!=null&&w.compactor&&f.push({title:"压缩",event:function(){var s;if((s=e.plugin)!=null&&s.compactor)try{const n=e.plugin.compactor(t.state.doc.toString());n&&n!==t.state.doc.toString()&&t.dispatch({changes:{from:0,to:t.state.doc.length,insert:n}})}catch{}},icon:"i-iszy-editor-compact"}),f.length&&S.unshift(f),(o,s)=>(l(),c("div",Z,[x("div",tt,[(l(),c(y,null,F(S,(n,_)=>(l(),c(y,null,[_!==0?(l(),c("div",{key:"divider"+_,class:"divider"})):Q("",!0),(l(!0),c(y,null,F(n,(r,M)=>{var b;return l(),c("div",{key:"btn"+_+M,title:r.title,class:H(["controller-btn",{disabled:(b=r.isDisabled)==null?void 0:b.call(r)}]),onClick:r.event},[x("span",{class:H(r.icon)},null,2)],10,et)}),128))],64))),64))]),x("div",{ref_key:"editor",ref:u,class:"editor","w-full":""},null,512)]))}}),it=W(ot,[["__scopeId","data-v-59b17a53"]]);export{it as _};
