import{j as de,B as _,x as pe,l as fe,a7 as $,P as _e,q as me,m as ge,o as D,c as E,y as i,W as r,t as H,a as t,g as M,aH as he,aD as a,X as j,b as o,d as ye,w,f as b,aE as ke,aI as ve,aJ as we,aK as be,aL as Ce,aM as Ie,aN as Ve,aO as Ne,aP as Be,ad as Se}from"../../vendor-e_qgH4qe.js";import{_ as xe,a as De}from"../../ant-design-vue-K8nFJReh.js";import{ay as K,az as je,aA as Q}from"../../common-jZmGe4Rr.js";import{E as ze,g as z}from"../../json-editor-vue-GltGRcbc.js";/* empty css                               */const u=C=>(Ne("data-v-5eb3d97a"),C=C(),Be(),C),We={key:0,class:"json-editor-menu"},Ee={key:0,class:"editorTitle"},Me=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-file-addition-one"}),r(" 新建")],-1)),Pe=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-history"}),r(" 打开最近记录")],-1)),Ue=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-computer"}),r(" 打开本地文件")],-1)),Oe=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-folder-open"}),r(" 打开"),t("span",{class:"i-icon-park-outline-down"})],-1)),Je=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-save"}),r(" 保存")],-1)),Re={class:"buttonWithIcon"},Te=u(()=>t("span",{class:"i-icon-park-outline-indent-right"},null,-1)),Ae=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-info"}),r(" 文档属性")],-1)),Fe=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-delete"}),r(" 删除文档")],-1)),Le=u(()=>t("span",{class:"buttonWithIcon"},[t("span",{class:"i-icon-park-outline-setting-two"}),r(" 选项"),t("span",{class:"i-icon-park-outline-down"})],-1)),qe={class:"dialog-footer"},$e=u(()=>t("strong",null,"名称：",-1)),He=u(()=>t("strong",null,"存储：",-1)),Ke=u(()=>t("strong",null,"更新：",-1)),Qe=u(()=>t("strong",null,"内容：",-1)),Xe=u(()=>t("strong",null,"大小：",-1)),Ge=de({__name:"VanillaJsonEditor",props:{content:{default:void 0},config:{default:()=>({mode:"text"})},showMenuBar:{type:Boolean,default:!1},name:{default:""}},emits:["change","create","changeName","open","openRecent","delete"],setup(C,{expose:X,emit:G}){const P=["content","mode","mainMenuBar","navigationBar","statusBar","readOnly","indentation","tabSize","escapeControlCharacters","escapeUnicodeCharacters","validator","onError","onChange","onChangeMode","onClassName","onRenderValue","onRenderMenu","queryLanguages","queryLanguageId","onChangeQueryLanguage","onFocus","onBlur"],W=_(),U=_(),O=_();let s;const m=_(""),d=_(2),y=_(!1),I=_(!1),V=_(!1),k=_(""),p=pe(()=>{if(I){const e=s.get();let n,l;return z(e)?l=e.json:l=e.text,typeof l=="string"?n="字符串类型":Array.isArray(l)?n=`数组类型，包含 ${l.length} 个对象`:l&&typeof l=="object"?n=`对象类型，包含 ${Object.keys(l).length} 个属性`:n="其他类型",{name:m.value,storage:m.value?"浏览器本地":"",updated:"",content:n,size:je(typeof l=="string"?l.length:JSON.stringify(l,null,d.value).length)}}else return{}}),g=G;let N=!1;X({container:U,update:J,set:ne,refresh:oe,get:te});const f=C;let B={};fe(()=>{W.value&&(B=$(f.config),s=new ze({target:W.value,props:{content:{json:{}},onChange:e=>{N||(z(e)?g("change",e.json):g("change",e.text))},indentation:d.value,...A(B,P)}}),f.config.indentation&&(d.value=f.config.indentation))}),_e(()=>{s==null||s.destroy()}),me(()=>K().isDark,()=>{s==null||s.refresh()}),ge(()=>{let e=!1;for(const n in f.config)if(f.config[n]!==B[n]){e=!0;break}e&&(B=$(f.config),s==null||s.updateProps(A(B,P))),f.content!=null&&J(f.content),m.value=f.name,s==null||s.refresh()});function Y(){s.set({json:{}}),g("create")}function Z(e){var n;switch(e){case"file":(n=O.value)==null||n.click();break;case"recent":g("openRecent");break}}function ee(e){const n=e.target;if(n.files&&n.files.length){const l=n.files[0],c=new FileReader;c.onload=()=>{c.result&&g("open",{name:l.name,content:c.result})},c.readAsText(l)}n.value=""}function J(e){N=!0;let n;e!=null&&(typeof e=="string"?n=e:n=JSON.stringify(e,null,d.value),s.update({text:n})),setTimeout(()=>{N=!1},0)}function ne(e){N=!0,e!=null&&(typeof e=="string"?s.set({text:e}):s.set({json:e})),setTimeout(()=>{N=!1},0)}function te(){const e=s.get();return z(e)?e.json:e.text}function oe(){s==null||s.refresh()}function ae(){const e=s.get(),n=m.value?m.value+".json":"未命名.json";z(e)?Q(JSON.stringify(e.json),n):Q(e.text,n)}let R=d.value;function se(e){switch(e){case"indentation":R=d.value,y.value=!0;break;case"properties":I.value=!0;break;case"delete":g("delete");break}}function T(){d.value=R,y.value=!1}function le(){s.updateProps({indentation:d.value}),y.value=!1}function ie(){k.value=m.value,V.value=!0}function ce(){V.value=!1}function ue(){k.value&&g("changeName",k.value),V.value=!1}function A(e,n){const l={};for(const c of n)e[c]!==void 0&&(l[c]=e[c]);return l}return(e,n)=>{const l=ke,c=ve,S=we,F=be,L=Ce,re=Ie,v=xe,q=Ve,x=De;return D(),E("div",{ref_key:"container",ref:U,class:"json-editor-wrapper"},[e.showMenuBar?(D(),E("div",We,[i(m)&&!i(V)?(D(),E("div",Ee,[r(H(i(m))+" ",1),t("i",{class:"i-icon-park-outline-edit",onClick:ie})])):M("",!0),i(V)?(D(),he(l,{key:1,modelValue:i(k),"onUpdate:modelValue":n[0]||(n[0]=h=>j(k)?k.value=h:null),class:"name-editor",placeholder:"请输入名称"},{suffix:a(()=>[t("i",{class:"i-icon-park-outline-close",onClick:ce}),t("i",{class:"i-icon-park-outline-check",onClick:ue})]),_:1},8,["modelValue"])):M("",!0),o(re,{class:"editorControlButtons"},{default:a(()=>[o(c,{size:"small",type:"primary",onClick:Y},{default:a(()=>[Me]),_:1}),o(L,{onCommand:Z},{dropdown:a(()=>[o(F,null,{default:a(()=>[o(S,{command:"recent"},{default:a(()=>[Pe]),_:1}),o(S,{command:"file"},{default:a(()=>[Ue]),_:1})]),_:1})]),default:a(()=>[o(c,{size:"small",type:"primary"},{default:a(()=>[Oe]),_:1})]),_:1}),o(c,{size:"small",type:"primary",onClick:ae},{default:a(()=>[Je]),_:1}),o(L,{onCommand:se},{dropdown:a(()=>[o(F,null,{default:a(()=>[o(S,{command:"indentation"},{default:a(()=>[t("span",Re,[Te,r(" 缩进("+H(i(d))+")",1)])]),_:1}),o(S,{command:"properties"},{default:a(()=>[Ae]),_:1}),o(S,{command:"delete"},{default:a(()=>[Fe]),_:1})]),_:1})]),default:a(()=>[o(c,{size:"small",type:"primary"},{default:a(()=>[Le]),_:1})]),_:1})]),_:1})])):M("",!0),t("div",{ref_key:"jsonEditorDiv",ref:W,class:ye(["json-editor",{"jse-theme-dark":("useStyleStore"in e?e.useStyleStore:i(K))().isDark}])},null,2),w(t("input",{ref_key:"uploader",ref:O,type:"file",accept:".json,.geojson,.txt",onChange:ee},null,544),[[b,!1]]),o(q,{modelValue:i(y),"onUpdate:modelValue":n[2]||(n[2]=h=>j(y)?y.value=h:null),title:"设置缩进","before-close":T},{footer:a(()=>[t("span",qe,[o(c,{onClick:T},{default:a(()=>[r("取消")]),_:1}),o(c,{type:"primary",onClick:le},{default:a(()=>[r(" 确定 ")]),_:1})])]),default:a(()=>[o(v,null,{default:a(()=>[r("配置代码模式下用于缩进的空格数。 缩进同时应用于两个面板。")]),_:1}),o(l,{modelValue:i(d),"onUpdate:modelValue":n[1]||(n[1]=h=>j(d)?d.value=h:null),modelModifiers:{number:!0}},null,8,["modelValue"])]),_:1},8,["modelValue"]),o(q,{modelValue:i(I),"onUpdate:modelValue":n[3]||(n[3]=h=>j(I)?I.value=h:null),title:"文档属性",class:"documentProperties"},{default:a(()=>[o(v,null,{default:a(()=>[$e,w(o(x,{content:i(p).name},null,8,["content"]),[[b,i(p).name]])]),_:1}),o(v,null,{default:a(()=>[He,w(o(x,{content:i(p).storage},null,8,["content"]),[[b,i(p).storage]])]),_:1}),o(v,null,{default:a(()=>[Ke,w(o(x,{content:i(p).updated},null,8,["content"]),[[b,i(p).updated]])]),_:1}),o(v,null,{default:a(()=>[Qe,w(o(x,{content:i(p).content},null,8,["content"]),[[b,i(p).content]])]),_:1}),o(v,null,{default:a(()=>[Xe,w(o(x,{content:i(p).size},null,8,["content"]),[[b,i(p).size]])]),_:1})]),_:1},8,["modelValue"])],512)}}}),on=Se(Ge,[["__scopeId","data-v-5eb3d97a"]]);export{on as V};
