import{k as x,a4 as h,R as f,J as q,at as z,aw as B,a7 as C,T as K,E as F,r as I,F as _,K as o,w as r,W as R,bk as v,x as t,L as U,N as k,aB as L,aA as g,a0 as M}from"./index-CTtQ8it-.js";import{E as Q,a as S}from"./el-form-item-BESTt965.js";import"./castArray-DJFinwzO.js";const T={class:"login-container"},A={class:"main"},J=x({__name:"login",setup(O){const s=h({userName:"",password:""}),u=f(),i=f({}),n=f(!1),d=q(),N=z(),w=B();C(N,a=>{const e=a.query;e&&(typeof e.redirect=="string"&&(u.value=e.redirect),i.value=V(e))},{immediate:!0}),K(()=>{w.logged&&d.push({path:u.value||"/",query:i.value})});async function p(){if(!navigator.onLine){g.warning("已离线！");return}if(s.userName!=null&&s.password!=null){n.value=!0;try{await w.login({userName:s.userName,password:s.password}),g.success("登录成功！"),d.push({path:u.value||"/",query:i.value})}catch(a){a instanceof Error&&g.error(a.message)}n.value=!1}}function E(){d.push("/register")}function V(a){const{redirect:e,...l}=a;return l}return(a,e)=>{const l=R,c=Q,y=U,b=S;return I(),F("div",T,[_("div",A,[o(b,L({layout:"horizontal",model:t(s)},{wrapperCol:{span:24}}),{default:r(()=>[o(c,{required:""},{default:r(()=>[o(l,{modelValue:t(s).userName,"onUpdate:modelValue":e[0]||(e[0]=m=>t(s).userName=m),placeholder:"账户",size:"large",onKeypress:v(p,["enter"])},{prefix:r(()=>e[2]||(e[2]=[_("span",{class:"i-icon-park-outline-user"},null,-1)])),_:1},8,["modelValue"])]),_:1}),o(c,{required:""},{default:r(()=>[o(l,{modelValue:t(s).password,"onUpdate:modelValue":e[1]||(e[1]=m=>t(s).password=m),type:"password",placeholder:"密码",size:"large","show-password":"",onKeypress:v(p,["enter"])},{prefix:r(()=>e[3]||(e[3]=[_("span",{class:"i-icon-park-outline-lock"},null,-1)])),_:1},8,["modelValue"])]),_:1}),o(c,null,{default:r(()=>[o(y,{type:"primary",block:"",size:"large",loading:t(n),onClick:p},{default:r(()=>e[4]||(e[4]=[k(" 登录 ")])),_:1},8,["loading"]),o(y,{block:"",size:"large",disabled:t(n),onClick:E},{default:r(()=>e[5]||(e[5]=[k(" 注册 ")])),_:1},8,["disabled"])]),_:1})]),_:1},16,["model"])])])}}}),D=M(J,[["__scopeId","data-v-ababdcc1"]]);export{D as default};
