var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(a,t,n)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,l=(e,a)=>{for(var t in a||(a={}))o.call(a,t)&&i(e,t,a[t]);if(n)for(var t of n(a))r.call(a,t)&&i(e,t,a[t]);return e},s=(e,n)=>a(e,t(n));import{c}from"./createFile.793739e8.js";import{E as d,a3 as p,_ as u,$ as f,a0 as m,a8 as g,af as h,T as C,a9 as v,b0 as y,l as b,a as U,o as P,f as j,b as _,w as k,J as x,e as w,P as O,Q as T,p as S,h as $,g as A,ac as I,c as q,O as F}from"./vendor.588f181b.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{u as B}from"./index.18e8bfc5.js";import{_ as D}from"./index.41081cc2.js";var J=".ant-divider[data-v-7ccdc7d2] {\n  margin: 0.8rem 0;\n}\n.configPanel .configOperator[data-v-7ccdc7d2] {\n  text-align: right;\n  margin-top: 0.8rem;\n}\n.ant-form-item[data-v-7ccdc7d2] {\n  margin-bottom: 0.8rem;\n}\n.ant-form-item[data-v-7ccdc7d2]:last-child {\n  margin-bottom: 0;\n}";const{TabPane:K}=p,{Item:E}=u,{Password:H}=f,{mapGetters:N,mapState:R,mapActions:z}=d("imgHosting"),G={name:"settings",components:{Tabs:p,TabPane:K,Form:u,Item:E,Input:f,Password:H,Button:m,Switch:g,Space:h,Typography:C,Divider:v,Popconfirm:y},data:()=>({uploaders:B,currentUploader:"aliyun",currentConfig:[],currentCommonConfig:{renameBeforeUpload:!1,renameTimeStamp:!0,copyUrlAfterUpload:!0}}),computed:l(l({},N(["config"])),R(["uploader","commonConfig"])),mounted(){this.uploader&&(this.currentUploader=this.uploader),this.changeUploader(),this.currentCommonConfig=b(this.commonConfig||{})},methods:s(l({},z(["saveConfig","saveCommonConfig","importConfig"])),{changeUploader(){this.currentConfig=b(B[this.currentUploader].config(this.config(this.currentUploader)))},save(){const e={};for(const a of this.currentConfig){if(a.required&&(null==a.default||""===a.default))return void this.$msg.warn("必填项未填写完整");e[a.name]=a.default}this.saveConfig({uploader:this.currentUploader,config:e}),this.$msg.success("保存成功")},exportAll(){const e=JSON.stringify(this.$store.state.imgHosting);c(e,"allConfig.json")},importAll(){if(!this.$refs.file.value||!this.$refs.file.files||!this.$refs.file.files.length)return;const e=this.$refs.file.files[0];if("application/json"===e.type||"text/plain"===e.type){const a=new FileReader;a.onload=async()=>{if(a.result)try{const e=JSON.parse(a.result);await this.importConfig(e),this.$msg.success("导入成功")}catch(e){this.$msg.error("导入失败")}},a.readAsText(e)}},handler(){this.$refs.file.click()},getPopupContainer:()=>document.body})},L=e=>(S("data-v-7ccdc7d2"),e=e(),$(),e),Q=L((()=>w("h4",null,"导入导出",-1))),M=A("导出所有"),V=A("导入所有"),W=L((()=>w("h4",null,"通用配置",-1))),X={class:"commonConfigPanel"},Y=L((()=>w("h4",null,"图床设置",-1))),Z={class:"configPanel"},ee={class:"configTable"},ae={class:"configOperator"},te=A("保存");function ne(e,a,t,n,o,r){const i=U("Typography"),l=U("Button"),s=U("Popconfirm"),c=U("Space"),d=U("Divider"),p=U("Switch"),u=U("Item"),f=U("Form"),m=U("Input"),g=U("Password"),h=U("TabPane"),C=U("Tabs");return P(),j(O,null,[_(i,null,{default:k((()=>[Q])),_:1}),_(c,{size:8},{default:k((()=>[_(l,{type:"primary",onClick:r.exportAll},{default:k((()=>[M])),_:1},8,["onClick"]),_(s,{onConfirm:r.handler,title:"是否导入所有配置？将会完全覆盖此功能记录","ok-text":"是","cancel-text":"否",getPopupContainer:r.getPopupContainer},{default:k((()=>[_(l,{type:"primary"},{default:k((()=>[V])),_:1})])),_:1},8,["onConfirm","getPopupContainer"]),x(w("input",{type:"file",ref:"file",onClick:a[0]||(a[0]=e=>{e.target.value=""}),onChange:a[1]||(a[1]=(...e)=>r.importAll&&r.importAll(...e))},null,544),[[I,!1]])])),_:1}),_(d),_(i,null,{default:k((()=>[W])),_:1}),w("div",X,[_(f,{layout:"inline"},{default:k((()=>[_(u,{label:"时间戳重命名"},{default:k((()=>[_(p,{checked:e.currentCommonConfig.renameTimeStamp,"onUpdate:checked":a[2]||(a[2]=a=>e.currentCommonConfig.renameTimeStamp=a),onChange:a[3]||(a[3]=a=>e.saveCommonConfig(e.currentCommonConfig))},null,8,["checked"])])),_:1}),_(u,{label:"上传后自动复制URL"},{default:k((()=>[_(p,{checked:e.currentCommonConfig.copyUrlAfterUpload,"onUpdate:checked":a[4]||(a[4]=a=>e.currentCommonConfig.copyUrlAfterUpload=a),onChange:a[5]||(a[5]=a=>e.saveCommonConfig(e.currentCommonConfig))},null,8,["checked"])])),_:1})])),_:1})]),_(d),_(i,null,{default:k((()=>[Y])),_:1}),_(C,{activeKey:e.currentUploader,"onUpdate:activeKey":a[6]||(a[6]=a=>e.currentUploader=a),type:"card",onChange:r.changeUploader},{default:k((()=>[(P(!0),j(O,null,T(e.uploaders,((a,t)=>(P(),q(h,{key:t,tab:a.name},{default:k((()=>[w("div",Z,[w("div",ee,[e.currentUploader===t?(P(),q(f,{key:0,layout:"vertical"},{default:k((()=>[(P(!0),j(O,null,T(e.currentConfig,(e=>(P(),q(u,{key:e.name,label:e.label,required:e.required},{default:k((()=>["input"===e.type?(P(),q(m,{key:0,value:e.default,"onUpdate:value":a=>e.default=a,"allow-clear":"",placeholder:e.hint},null,8,["value","onUpdate:value","placeholder"])):"password"===e.type?(P(),q(g,{key:1,value:e.default,"onUpdate:value":a=>e.default=a,"allow-clear":"",placeholder:e.hint},null,8,["value","onUpdate:value","placeholder"])):F("",!0)])),_:2},1032,["label","required"])))),128))])),_:2},1024)):F("",!0)]),w("div",ae,[_(l,{type:"primary",onClick:r.save},{default:k((()=>[te])),_:1},8,["onClick"])])])])),_:2},1032,["tab"])))),128))])),_:1},8,["activeKey","onChange"])],64)}var oe=D(G,[["render",ne],["__scopeId","data-v-7ccdc7d2"]]);export{oe as default};
