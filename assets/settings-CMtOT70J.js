import{k as C,Q as H,aw as U,E as S,r as b,q as R,G as A,x as l,w as s,N as d,K as t,F as u,a0 as $,J as q,n as Q,s as W,aB as X,R as F,a4 as M,H as P,v as Y,L as J,X as Z,W as ee,aA as E,ax as j,P as te,at as oe,Y as le,bl as se}from"./index-Cgiq8ZMG.js";import{E as z}from"./el-divider-Cqax33cH.js";import{E as D}from"./el-space-CHhYjkfW.js";import{E as K}from"./el-checkbox-CMBf6x91.js";import{T as h,u as ne}from"./Router-CjbSmzHk.js";import{E as ae}from"./el-popover-ButZLJB9.js";import"./el-popper-DZY0h-AM.js";import{E as re}from"./el-dialog-h8NAxDcC.js";import{a as ie,E as de}from"./el-form-item-BqilHf7Z.js";import{E as ue,a as pe}from"./el-radio-group-Dq97ZxFD.js";/* empty css                 */import"./index-BtZZUW0e.js";import"./isUndefined-DCTLXrZ8.js";import"./castArray-BzmMiHFh.js";import"./clone-CQdYFKBA.js";const me=C({__name:"jsonEditor",setup(v){const a=H(),p=U(),i=a.modules.jsonEditor;return(n,o)=>{const _=h,y=K,x=D;return b(),S("div",null,[l(p).logged?(b(),R(_,{key:0,level:5},{default:s(()=>o[1]||(o[1]=[d(" JSON 编辑器 ")])),_:1})):A("",!0),l(p).logged?(b(),R(x,{key:1},{default:s(()=>[t(y,{modelValue:l(i).syncCloud,"onUpdate:modelValue":o[0]||(o[0]=m=>l(i).syncCloud=m)},{default:s(()=>o[2]||(o[2]=[d(" 从云端获取 ")])),_:1},8,["modelValue"])]),_:1})):A("",!0)])}}}),fe={"w-full":"","overflow-auto":""},_e={"gap-4":"",class:"settings-wrapper"},ce=C({__name:"toolSettings",setup(v){return(a,p)=>{const i=h;return b(),S("div",fe,[t(i,{level:4},{default:s(()=>p[0]||(p[0]=[d(" 应用设置 ")])),_:1}),u("div",_e,[t(me)])])}}}),ge=$(ce,[["__scopeId","data-v-730637d2"]]),we=C({inheritAttrs:!1,__name:"HaveAccess",props:{auth:{type:[Boolean,Object],default:!1},link:{default:""}},setup(v){const a=v,p=U(),i=ne(),n=q(),o=Q(()=>a.auth?typeof a.auth=="boolean"?p.logged:p.checkAccess(a.auth):a.link?p.checkAccess(i.getAuth(a.link)):!0);function _(){a.link&&n.push(a.link)}return(y,x)=>l(o)?W(y.$slots,"default",X({key:0},y.$attrs,{goto:_})):A("",!0)}}),ve={flex:"","flex-col":"","items-start":"","gap-4":"","text-7":""},ye={flex:"","items-center":"","gap-4":""},ke={flex:"","items-center":"","gap-4":""},Ve={flex:"","items-center":"","gap-4":""},be={flex:"","items-center":"","gap-4":""},xe={flex:"","items-center":"","gap-4":""},Ne={flex:"","items-center":"","gap-2":""},Ee={class:"dialog-footer"},Ce=C({__name:"personalInfo",setup(v){const a=U(),p=F(!1),i=F(),n=M({userName:"",nickName:"",email:"",passwd:"",rePasswd:"",oldPasswd:""}),o=M({userName:[{trigger:"change",validator:(f,e,r)=>{e&&!e.trim()?r(new Error("用户名无效")):r()}}],nickName:[{trigger:"change",validator:(f,e,r)=>{e&&!e.trim()?r(new Error("昵称无效")):r()}}],rePasswd:[{trigger:"change",validator:(f,e,r)=>{e&&e!==n.passwd?r(new Error("两次输入的密码不一致")):r()}}]}),_=F("");function y(){n.userName=a.profile.userName??"",n.nickName=a.profile.nickName??"",n.email=a.profile.email??"",n.passwd="",n.rePasswd="",n.oldPasswd="",p.value=!0}function x(){p.value=!1}async function m(f){f&&await f.validate(async e=>{if(e){const r={};if(n.userName&&(r.userName=n.userName),n.nickName&&(r.nickName=n.nickName),n.email&&(r.email=n.email),n.passwd&&(r.passwd=n.passwd,n.oldPasswd&&(r.oldPasswd=n.oldPasswd)),Object.keys(r).length===0){E.warning("没有需要修改的信息");return}try{await a.updateUser(r)}catch(k){E.error(k.message)}p.value=!1}else E.warning("请检查输入")})}function w(f,e){if(e){const r=new URL(`${j.apiBaseUrl}/auth/${f}/bind`);r.searchParams.append("access_token",a.access_token),I(f,r.toString())}}async function c(f){var r,k;const e=f.source;if(f.origin===j.apiBaseUrl)if(((r=f.data)==null?void 0:r.type)==="bind_success"){window.removeEventListener("message",c),e.close();try{await a.thirdPartyBind(_.value,f.data.data),E.success("绑定成功")}catch(V){E.error(V.message)}finally{_.value=""}}else((k=f.data)==null?void 0:k.type)==="bind_fail"&&(window.removeEventListener("message",c),e.close(),_.value="",E.error("绑定失败"))}function I(f,e,r="绑定第三方登录",k=500,V=600){if(_.value){E.warning("绑定进行中，请勿重复点击");return}_.value=f,window.addEventListener("message",c);const N=(window.screen.height-k)/2,O=(window.screen.width-V)/2,T=window.open(e,r,`popup,width=${k},height=${V},top=${N},left=${O}`);if(!T){_.value="",E.error("请允许浏览器弹出窗口！");return}const B=window.setInterval(()=>{T.closed&&(window.clearInterval(B),_.value="")},500)}return(f,e)=>{var B,G,L;const r=h,k=J,V=ee,N=de,O=ie,T=re;return b(),S("div",null,[t(r,{level:4},{default:s(()=>e[9]||(e[9]=[d(" 账户信息 ")])),_:1}),u("div",ve,[u("div",ye,[e[10]||(e[10]=u("div",{"w-32":"","text-right":""}," 用户名: ",-1)),u("div",null,P(l(a).profile.userName),1)]),u("div",ke,[e[11]||(e[11]=u("div",{"w-32":"","text-right":""}," 昵称: ",-1)),u("div",null,P(l(a).profile.nickName),1)]),u("div",Ve,[e[12]||(e[12]=u("div",{"w-32":"","text-right":""}," 邮箱: ",-1)),u("div",null,P(l(a).profile.email),1)]),u("div",be,[e[13]||(e[13]=u("div",{"w-32":"","text-right":""}," 角色: ",-1)),u("div",null,P(((L=(G=(B=l(a).profile)==null?void 0:B.roles)==null?void 0:G[0])==null?void 0:L.alias)??"注册用户"),1)]),u("div",xe,[e[15]||(e[15]=u("div",{"w-32":"","text-right":""}," 绑定: ",-1)),u("div",Ne,[u("div",{class:Y(["third-party",{active:l(a).profile.github}]),title:"Github",onClick:e[0]||(e[0]=g=>w("github",!l(a).profile.github))},e[14]||(e[14]=[u("i",{class:"i-icon-park-outline:github"},null,-1)]),2)])]),t(k,{onClick:y},{default:s(()=>e[16]||(e[16]=[d(" 修改信息 ")])),_:1})]),t(T,{modelValue:l(p),"onUpdate:modelValue":e[8]||(e[8]=g=>Z(p)?p.value=g:null),title:"修改信息","before-close":x},{footer:s(()=>[u("span",Ee,[t(k,{onClick:x},{default:s(()=>e[17]||(e[17]=[d("取消")])),_:1}),t(k,{type:"primary",onClick:e[7]||(e[7]=g=>m(l(i)))},{default:s(()=>e[18]||(e[18]=[d(" 保存 ")])),_:1})])]),default:s(()=>[t(O,{ref_key:"ruleFormRef",ref:i,model:l(n),rules:l(o),"label-width":"8rem","label-position":"left"},{default:s(()=>[t(N,{label:"用户名",prop:"userName"},{default:s(()=>[t(V,{modelValue:l(n).userName,"onUpdate:modelValue":e[1]||(e[1]=g=>l(n).userName=g)},null,8,["modelValue"])]),_:1}),t(N,{label:"昵称",prop:"nickName"},{default:s(()=>[t(V,{modelValue:l(n).nickName,"onUpdate:modelValue":e[2]||(e[2]=g=>l(n).nickName=g)},null,8,["modelValue"])]),_:1}),t(N,{label:"邮箱",prop:"email"},{default:s(()=>[t(V,{modelValue:l(n).email,"onUpdate:modelValue":e[3]||(e[3]=g=>l(n).email=g)},null,8,["modelValue"])]),_:1}),t(N,{label:"旧密码",prop:"oldPasswd"},{default:s(()=>[t(V,{modelValue:l(n).oldPasswd,"onUpdate:modelValue":e[4]||(e[4]=g=>l(n).oldPasswd=g),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(N,{label:"新密码",prop:"passwd"},{default:s(()=>[t(V,{modelValue:l(n).passwd,"onUpdate:modelValue":e[5]||(e[5]=g=>l(n).passwd=g),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(N,{label:"确认密码",prop:"rePasswd"},{default:s(()=>[t(V,{modelValue:l(n).rePasswd,"onUpdate:modelValue":e[6]||(e[6]=g=>l(n).rePasswd=g),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),Se=$(Ce,[["__scopeId","data-v-6195a3d0"]]),Pe=te("main",{persist:!0,state:()=>({_cache:{},clearOfflineCacheTag:!1}),getters:{getData:v=>a=>{if(a)return(v._cache||{})[a]}},actions:{setData({key:v,val:a}={}){v&&(this._cache=this._cache||{},this._cache[v]=a)},clear(){this._cache={}},clearOfflineCache(){console.log("clearOfflineCache"),this.clearOfflineCacheTag=!0}}}),Ue={flex:"","items-center":"","gap-4":""},$e=C({__name:"authInfo",setup(v){const a=q(),p=oe(),i=U(),n=()=>Pe().clearOfflineCache();function o(){a.push({path:"/login",query:{redirect:p.fullPath}})}function _(){a.push("/register")}function y(){a.push("/logout")}return(x,m)=>{const w=J,c=we,I=ae,f=z,e=D;return l(i).logged?(b(),S(le,{key:0},[u("div",Ue,[t(w,{type:"primary",onClick:y},{default:s(()=>m[0]||(m[0]=[d(" 登出 ")])),_:1}),t(c,{link:"/userManager"},{default:s(({goto:r})=>[t(w,{onClick:r},{default:s(()=>m[1]||(m[1]=[d(" 用户权限中心 ")])),_:2},1032,["onClick"])]),_:1}),t(I,{title:"您是否确定要清空本地缓存？","confirm-button-text":"清空",onConfirm:n},{reference:s(()=>[t(w,{type:"danger",plain:""},{default:s(()=>m[2]||(m[2]=[d(" 清空本地缓存 ")])),_:1})]),_:1})]),t(f),t(Se)],64)):(b(),R(e,{key:1,"mt-4":""},{default:s(()=>[t(w,{type:"primary",onClick:o},{default:s(()=>m[3]||(m[3]=[d(" 登录 ")])),_:1}),t(w,{onClick:_},{default:s(()=>m[4]||(m[4]=[d(" 注册 ")])),_:1}),t(I,{title:"您是否确定要清空本地缓存？","confirm-button-text":"清空",onConfirm:n},{reference:s(()=>[t(w,{type:"danger",plain:""},{default:s(()=>m[5]||(m[5]=[d(" 清空本地缓存 ")])),_:1})]),_:1})]),_:1}))}}}),he=$($e,[["__scopeId","data-v-304747f8"]]),Ie={class:"settings-wrapper"},Te=C({__name:"globalSettings",setup(v){const a=H(),p=se(),i=a.general;return(n,o)=>{const _=h,y=pe,x=ue,m=D,w=K;return b(),S("div",Ie,[t(_,{level:4},{default:s(()=>o[5]||(o[5]=[d(" 全局设置 ")])),_:1}),t(_,{level:5},{default:s(()=>o[6]||(o[6]=[d(" 外观 ")])),_:1}),t(m,null,{default:s(()=>[t(x,{"model-value":l(i).theme.mode,onChange:l(p).setTheme},{default:s(()=>[t(y,{value:"auto",label:"跟随系统"}),t(y,{value:"light",label:"浅色"}),t(y,{value:"dark",label:"深色"})]),_:1},8,["model-value","onChange"])]),_:1}),t(_,{level:5},{default:s(()=>o[7]||(o[7]=[d(" 访问统计 ")])),_:1}),t(m,null,{default:s(()=>[t(w,{modelValue:l(i).showMost,"onUpdate:modelValue":o[0]||(o[0]=c=>l(i).showMost=c)},{default:s(()=>o[8]||(o[8]=[d(" 最常访问 ")])),_:1},8,["modelValue"]),t(w,{modelValue:l(i).showRecent,"onUpdate:modelValue":o[1]||(o[1]=c=>l(i).showRecent=c)},{default:s(()=>o[9]||(o[9]=[d(" 最近访问 ")])),_:1},8,["modelValue"])]),_:1}),t(_,{level:5},{default:s(()=>o[10]||(o[10]=[d(" 其他设置 ")])),_:1}),t(m,null,{default:s(()=>[t(w,{modelValue:l(i).showSearch,"onUpdate:modelValue":o[2]||(o[2]=c=>l(i).showSearch=c)},{default:s(()=>o[11]||(o[11]=[d(" 显示搜索 ")])),_:1},8,["modelValue"]),t(w,{modelValue:l(i).showType,"onUpdate:modelValue":o[3]||(o[3]=c=>l(i).showType=c)},{default:s(()=>o[12]||(o[12]=[d(" 显示分类 ")])),_:1},8,["modelValue"]),t(w,{modelValue:l(i).openInNewTab,"onUpdate:modelValue":o[4]||(o[4]=c=>l(i).openInNewTab=c)},{default:s(()=>o[13]||(o[13]=[d(" 新标签页打开工具 ")])),_:1},8,["modelValue"])]),_:1})])}}}),Be=$(Te,[["__scopeId","data-v-f2fa67ef"]]),Re={flex:"","flex-wrap":"","items-start":"","gap-4":""},Ae=C({__name:"settings",setup(v){const a=U();return(p,i)=>{const n=h,o=z;return b(),S("div",null,[l(a).logged?(b(),R(n,{key:0,level:3},{default:s(()=>[d(P(l(a).profile.nickName)+" 欢迎你~ ",1)]),_:1})):A("",!0),t(he),t(o),u("div",Re,[t(Be),t(ge,{"flex-1":""})])])}}}),Ye=$(Ae,[["__scopeId","data-v-0add9d51"]]);export{Ye as default};
