import{j as x,B as _,l as b,P as C,o as I,ax as T,ay as S,aa as t,a$ as B,aG as U,aH as k,a as o,W as v,a3 as E}from"./vendor-Ru-BxWlB.js";import{u as w,a as F}from"./imgHosting-dFy36yON.js";import"./common-br7fSpCF.js";import"./ant-design-vue-1fGE3reg.js";import"./vanilla-jsoneditor-_koh3yF9.js";const u=s=>(U("data-v-0ec24ae5"),s=s(),k(),s),M=u(()=>o("div",{class:"el-icon--upload"},[o("span",{class:"i-icon-park-upload-one?mask"})],-1)),j=u(()=>o("div",{class:"el-upload__text"},[v(" 直接粘贴图片或拖拽图片到这里上传"),o("br"),v("或者"),o("em",null,"直接点击选择文件上传")],-1)),D=u(()=>o("div",{class:"el-upload__tip"}," 暂时仅支持单文件上传。 ",-1)),H=x({__name:"upload",props:{activeKey:{default:""}},setup(s){const h=s,r=_(!1),i=_(),p=w(),m=p.config,c=p.uploader,l=p.commonConfig;b(()=>{document.addEventListener("paste",g)}),C(()=>{document.removeEventListener("paste",g)});async function f(n){let a=n;if(r.value=!0,c&&m(c)){if(l.renameTimeStamp){const e=a.name||"";a=new File([a],(new Date().getTime()+e.substring(e.lastIndexOf("."))).toLowerCase(),{type:a.type,lastModified:a.lastModified})}try{const e=await F[c].handle(m(c),a);if(w().addImage(e),l.copyUrlAfterUpload)try{l.customCopyContent?await navigator.clipboard.writeText(l.customCopyContent.replace(/\$url/g,e.url)):await navigator.clipboard.writeText(e.url),t.success("上传成功，地址已复制到剪贴板")}catch{t.error("上传成功，但地址复制失败")}else t.success("上传成功")}catch(e){console.log(e),t.error("上传失败")}}else t.warning("请先进行设置");return r.value=!1,!1}function y(){t.warning("不支持的文件类型！")}function g(n){if(h.activeKey==="home"&&!r.value&&!i.value){i.value=window.setTimeout(()=>{i.value=void 0},500);const a=n.clipboardData&&n.clipboardData.items;let e;if(a&&a.length)for(const d of a)d.type.indexOf("image")!==-1&&(e=d.getAsFile());e?f(e):(y(),clearTimeout(i.value),i.value=void 0)}}return(n,a)=>{const e=B;return I(),T(e,{style:{height:"100%"},drag:"",accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp","show-file-list":!1,"before-upload":f},{default:S(()=>[M,j,D]),_:1})}}}),V=E(H,[["__scopeId","data-v-0ec24ae5"]]);export{V as default};
