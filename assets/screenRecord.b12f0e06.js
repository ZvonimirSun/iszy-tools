import{n as he,v as De,d as me,e as Fe,r as d,aD as Z,g as Be,h as U,a as t,a7 as Ae,K as ke,D as we,af as Re,ah as W,ai as z,s as de,ag as Se,P as M,C as Te,cz as xe,i as Oe,E as Ie,cA as Ue,cB as Me,cC as Ne,cD as Ve,f as se,k as e,o as F,L as ee,M as c,bm as S,w as s,b as B,c as N,F as ie,bl as ae,l as V,$ as ve,B as Le,N as Pe,ch as $e,_ as je}from"./index.471dd628.js";/* empty css              *//* empty css               */import{_ as He}from"./index.421dc287.js";/* empty css               */import{_ as Ke,F as We}from"./Form.9c160e05.js";import"./toArray.a705e64c.js";import"./Overflow.19621af6.js";import"./isMobile.481c1aec.js";import"./useState.6c8bc1d5.js";import"./DownOutlined.28f8b5c9.js";import"./SearchOutlined.6e9c5033.js";import"./Col.09f21538.js";import"./responsiveObserve.d53c7fd2.js";import"./useFlexGapSupport.57bd0a05.js";import"./get.bc547d94.js";import"./_baseGet.1142411f.js";import"./toString.4f5575a3.js";import"./_arrayMap.dc1f124f.js";import"./_flatRest.ae8a6a39.js";import"./toInteger.19e5456f.js";import"./toFinite.185a8c00.js";import"./_arrayIncludesWith.40afec22.js";import"./collapseMotion.18ffd1c5.js";var ze={success:Te,info:xe,error:Oe,warning:Ie},Ge={success:Ue,info:Me,error:Ne,warning:Ve},qe=De("success","info","warning","error"),Je=function(){return{type:M.oneOf(qe),closable:{type:Boolean,default:void 0},closeText:M.any,message:M.any,description:M.any,afterClose:Function,showIcon:{type:Boolean,default:void 0},prefixCls:String,banner:{type:Boolean,default:void 0},icon:M.any,closeIcon:M.any,onClose:Function}},Qe=me({compatConfig:{MODE:3},name:"AAlert",inheritAttrs:!1,props:Je(),setup:function(i,h){var r=h.slots,b=h.emit,n=h.attrs,L=h.expose,g=Fe("alert",i),P=g.prefixCls,G=g.direction,v=d(!1),$=d(!1),y=d(),q=function(u){u.preventDefault();var f=y.value;f.style.height="".concat(f.offsetHeight,"px"),f.style.height="".concat(f.offsetHeight,"px"),v.value=!0,b("close",u)},k=function(){var u;v.value=!1,$.value=!0,(u=i.afterClose)===null||u===void 0||u.call(i)};L({animationEnd:k});var le=d({});return function(){var E,u,f=i.banner,j=i.closeIcon,w=j===void 0?(E=r.closeIcon)===null||E===void 0?void 0:E.call(r):j,R=i.closable,T=i.type,x=i.showIcon,H=Z(r,i,"closeText"),O=Z(r,i,"description"),J=Z(r,i,"message"),m=Z(r,i,"icon");x=f&&x===void 0?!0:x,T=f&&T===void 0?"warning":T||"info";var ne=(O?Ge:ze)[T]||null;H&&(R=!0);var o=P.value,oe=Be(o,(u={},U(u,"".concat(o,"-").concat(T),!0),U(u,"".concat(o,"-closing"),v.value),U(u,"".concat(o,"-with-description"),!!O),U(u,"".concat(o,"-no-icon"),!x),U(u,"".concat(o,"-banner"),!!f),U(u,"".concat(o,"-closable"),R),U(u,"".concat(o,"-rtl"),G.value==="rtl"),u)),ue=R?t("button",{type:"button",onClick:q,class:"".concat(o,"-close-icon"),tabindex:0},[H?t("span",{class:"".concat(o,"-close-text")},[H]):w===void 0?t(Ae,null,null):w]):null,Q=m&&(ke(m)?we(m,{class:"".concat(o,"-icon")}):t("span",{class:"".concat(o,"-icon")},[m]))||t(ne,{class:"".concat(o,"-icon")},null),X=Re("".concat(o,"-motion"),{appear:!1,css:!0,onAfterLeave:k,onBeforeLeave:function(I){I.style.maxHeight="".concat(I.offsetHeight,"px")},onLeave:function(I){I.style.maxHeight="0px"}});return $.value?null:t(Se,X,{default:function(){return[W(t("div",de(de({role:"alert"},n),{},{style:[n.style,le.value],class:[n.class,oe],"data-show":!v.value,ref:y}),[x?Q:null,t("div",{class:"".concat(o,"-content")},[J?t("div",{class:"".concat(o,"-message")},[J]):null,O?t("div",{class:"".concat(o,"-description")},[O]):null]),ue]),[[z,!v.value]])]}})}}});const Xe=he(Qe);const Ye={key:0,class:"wrapper"},Ze={class:"video-wrapper"},ea={class:"previewVideo"},aa=["src"],ta={class:"operations"},la={class:"settings-wrapper"},pe="unshare",na="unstart",K="recording",te="paused",fe="stopped",oa=me({__name:"screenRecord",setup(re){const i=d(),h=d();let r=null,b=null;const n=d(pe);let L=[];const g=d(""),P=d(!1),G=[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],v=d("never"),$=[{label:"\u5426",value:"never"},{label:"\u662F",value:"always"}],y=d("never"),q=[{label:"\u9ED8\u8BA4",value:"default"},{label:"16:9",value:1.77},{label:"4:3",value:1.33},{label:"21:9",value:2.35},{label:"14:10",value:1.4},{label:"19:10",value:1.9}],k=d("default"),le=[{label:"\u9ED8\u8BA4",value:"default"},{label:"60",value:60},{label:"30",value:30},{label:"25",value:25},{label:"15",value:15},{label:"5",value:5}],E=d("default"),u=[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u5C4F\u5E55\u5C3A\u5BF8",value:"fit-screen"},{label:"4K",value:"4k"},{label:"1080p",value:"1080p"},{label:"720p",value:"720p"}],f=d("default"),j=[{label:"\u9ED8\u8BA4",value:"default"},{label:"\u603B\u662F\u663E\u793A",value:"always"},{label:"\u79FB\u52A8\u65F6\u663E\u793A",value:"motion"},{label:"\u4ECE\u4E0D\u663E\u793A",value:"never"}],w=d("default"),R=(()=>navigator&&navigator.mediaDevices&&navigator.mediaDevices.getSupportedConstraints?navigator.mediaDevices.getSupportedConstraints():{})(),T=(()=>Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia))(),x=(()=>Boolean(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia))(),H=T&&x,O=se(()=>{switch(n.value){case K:return"REC";case te:return"PAUSE";default:return!1}}),J=se(()=>{const a={};switch(typeof k.value=="number"&&(a.aspectRatio=k.value),typeof E.value=="number"&&(a.frameRate=E.value),w.value!=="default"&&(a.cursor=w.value),f.value){case"fit-screen":a.width=screen.width,a.height=screen.height;break;case"4K":a.width=3840,a.height=2160;break;case"1080p":a.width=1920,a.height=1080;break;case"720p":a.width=1280,a.height=720;break}return{video:a,audio:v.value==="always"}}),m=se(()=>{if(r){const a=r.getVideoTracks();if(a.length>0){const l=a[0].getSettings(),p={recordAudio:G.find(D=>v.value===D.value)?.label,recordMicro:$.find(D=>y.value===D.value)?.label,frameRate:l.frameRate,width:l.width,height:l.height,aspectRatio:"\u9ED8\u8BA4",cursor:""};if(l.aspectRatio){const D=l.aspectRatio,C=q.find(A=>typeof A.value=="number"?D-A.value<=.1:!1);C?p.aspectRatio=C.label:p.aspectRatio="\u9ED8\u8BA4"}if(l.cursor){const D=j.find(C=>l.cursor===C.value);D?p.cursor=D.label:p.cursor="\u9ED8\u8BA4"}return{video:p}}}return{video:{},audio:{}}});async function ne(){try{if(r=await navigator.mediaDevices.getDisplayMedia(J.value),y.value==="always"){const l=await navigator.mediaDevices.getUserMedia({audio:!0});r.addTrack(l.getAudioTracks()[0])}const a=r.getVideoTracks()[0];a&&(a.onended=I,a.onmute=I),b=new MediaRecorder(r),b.onstop=_e,b.ondataavailable=be,i.value.srcObject=r,i.value.muted=!0,n.value="unstart"}catch(a){ve.error(a.message)}}function o(){X(),b?.start(),n.value=K}function oe(){b?.pause(),n.value=te}function ue(){b?.resume(),n.value=K}function Q(){b&&b.state!=="inactive"&&b.stop(),n.value=fe}function X(){g.value=""}function Y(){if(g.value){const a=document.createElement("a");a.href=g.value,a.download="screen-record.mp4",a.click()}}function I(){if(Q(),r)r.getTracks().forEach(l=>{l.stop()});else return;ve.info("\u5C4F\u5E55\u5206\u4EAB\u7ED3\u675F"),r=null,i.value.srcObject=null,n.value="unshare"}function _e(){const a=new Blob(L,{type:"video/mp4"});g.value=URL.createObjectURL(a),L=[];const l=setInterval(async()=>{h.value.readyState>0&&(h.value.duration===1/0?h.value.currentTime=1e7*Math.random():(clearInterval(l),h.value.currentTime=0))},200)}function be(a){L.push(a.data)}function ge(){v.value&&y.value&&(y.value="never")}function ye(){v.value&&y.value&&(v.value="never")}return(a,l)=>{const p=Le,D=Xe,C=He,A=Ke,Ee=We,ce=Pe,Ce=$e;return e(H)?(F(),ee("div",Ye,[c("div",Ze,[c("div",ea,[W(c("video",{ref_key:"screenShareVideoElement",ref:i,autoplay:""},null,512),[[z,!e(g)]]),W(c("video",{ref_key:"recordVideoElement",ref:h,controls:"",src:e(g)},null,8,aa),[[z,e(g)]]),W(c("span",{class:"rec"},S(e(O)),513),[[z,e(O)]])]),c("div",ta,[t(p,{type:"primary",onClick:l[0]||(l[0]=_=>P.value=!e(P))},{default:s(()=>[B(" \u8BBE\u7F6E ")]),_:1}),e(n)===pe?(F(),N(p,{key:0,type:"primary",onClick:ne},{default:s(()=>[B(" \u5F00\u542F\u5C4F\u5E55\u5171\u4EAB ")]),_:1})):(F(),ee(ie,{key:1},[t(p,{type:"primary",disabled:e(n)===K||e(n)===te,onClick:o},{default:s(()=>[B(" \u5F00\u59CB\u5F55\u5236 ")]),_:1},8,["disabled"]),t(p,{type:"primary",disabled:e(n)!==K,onClick:oe},{default:s(()=>[B(" \u6682\u505C ")]),_:1},8,["disabled"]),t(p,{type:"primary",disabled:e(n)!==te,onClick:ue},{default:s(()=>[B(" \u7EE7\u7EED ")]),_:1},8,["disabled"]),t(p,{type:"primary",disabled:e(n)===na||e(n)===fe,onClick:Q},{default:s(()=>[B(" \u505C\u6B62 ")]),_:1},8,["disabled"])],64)),e(g)?(F(),ee(ie,{key:2},[t(p,{type:"primary",onClick:X},{default:s(()=>[B(" \u6E05\u9664 ")]),_:1}),t(p,{type:"primary",onClick:Y},{default:s(()=>[B(" \u4E0B\u8F7D ")]),_:1})],64)):ae("",!0)])]),W(c("div",la,[t(D,{message:"\u7531\u4E8E\u6D4F\u89C8\u5668\u9650\u5236\uFF0C\u90E8\u5206\u8BBE\u7F6E\u53EF\u80FD\u65E0\u6CD5\u751F\u6548",type:"warning","show-icon":"",closable:"",style:{"margin-bottom":".8rem"}}),e(n)==="unshare"?(F(),N(Ee,{key:0,layout:"vertical"},{default:s(()=>[t(A,{label:"\u7CFB\u7EDF\u97F3\u9891"},{default:s(()=>[t(C,{value:e(v),"onUpdate:value":l[1]||(l[1]=_=>V(v)?v.value=_:null),options:G,onChange:ge},null,8,["value"])]),_:1}),t(A,{label:"\u9EA6\u514B\u98CE"},{default:s(()=>[t(C,{value:e(y),"onUpdate:value":l[2]||(l[2]=_=>V(y)?y.value=_:null),options:$,onChange:ye},null,8,["value"])]),_:1}),e(R).aspectRatio?(F(),N(A,{key:0,label:"\u9009\u62E9\u957F\u5BBD\u6BD4"},{default:s(()=>[t(C,{value:e(k),"onUpdate:value":l[3]||(l[3]=_=>V(k)?k.value=_:null),options:q},null,8,["value"])]),_:1})):ae("",!0),e(R).frameRate?(F(),N(A,{key:1,label:"\u9009\u62E9\u5E27\u7387"},{default:s(()=>[t(C,{value:e(E),"onUpdate:value":l[4]||(l[4]=_=>V(E)?E.value=_:null),options:le},null,8,["value"])]),_:1})):ae("",!0),e(R).width&&e(R).height?(F(),N(A,{key:2,label:"\u9009\u62E9\u5206\u8FA8\u7387"},{default:s(()=>[t(C,{value:e(f),"onUpdate:value":l[5]||(l[5]=_=>V(f)?f.value=_:null),options:u},null,8,["value"])]),_:1})):ae("",!0),t(A,{label:"\u662F\u5426\u663E\u793A\u5149\u6807"},{default:s(()=>[t(C,{value:e(w),"onUpdate:value":l[6]||(l[6]=_=>V(w)?w.value=_:null),options:j},null,8,["value"])]),_:1})]),_:1})):(F(),ee(ie,{key:1},[t(ce,{level:4},{default:s(()=>[B(" \u5F53\u524D\u8BBE\u7F6E ")]),_:1}),t(Ce,null,{default:s(()=>[c("ul",null,[c("li",null,"\u7CFB\u7EDF\u97F3\u9891: "+S(e(m).video.recordAudio),1),c("li",null,"\u9EA6\u514B\u98CE: "+S(e(m).video.recordMicro),1),c("li",null,"\u957F\u5BBD\u6BD4: "+S(e(m).video.aspectRatio),1),c("li",null,"\u5E27\u7387: "+S(e(m).video.frameRate),1),c("li",null,"\u89C6\u9891\u5BBD\u5EA6: "+S(e(m).video.width),1),c("li",null,"\u89C6\u9891\u9AD8\u5EA6: "+S(e(m).video.height),1),c("li",null,"\u663E\u793A\u9F20\u6807: "+S(e(m).video.cursor),1)])]),_:1})],64))],512),[[z,e(P)]])])):(F(),N(ce,{key:1,level:3},{default:s(()=>[B(" \u4F60\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301WebRTC\uFF0C\u8BF7\u5B89\u88C5\u6700\u65B0\u7248\u672CChrome\u540E\u91CD\u8BD5\u3002 ")]),_:1}))}}});const Sa=je(oa,[["__scopeId","data-v-14be4e7a"]]);export{Sa as default};
