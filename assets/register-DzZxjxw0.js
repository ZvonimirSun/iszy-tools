import{a as F,I as v,U as z,B as P,am as U,J as q,t as B,v as u,C as o,w as s,L as K,bi as f,y as a,E as C,D as _,aq as E,o as I,Q as R}from"./index-COHXkc47.js";import{E as M,a as $}from"./el-form-item-D3gZ6lFR.js";import{E as c}from"./el-alert-DEhSi4bU.js";import"./castArray-6iw5AqBK.js";import"./clone-D1_Fwt_o.js";const A=/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\v\f\x0E-\x1F\x21\x23-\x5B\x5D-\x7F]|\\[\x01-\x09\v\f\x0E-\x7F])\*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4]\d|[01]?\d{1,2})\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d{1,2}|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\v\f\x0E-\x1F\x21-\x5A\x53-\x7F]|\\[\x01-\x09\v\f\x0E-\x7F])+)\])$/,L=/^1[3-9]\d{9}$/,D={class:"login-container"},G={class:"main"},O=F({__name:"register",setup(S){const m=v(),r=z({userName:"",nickName:"",passwd:"",rePasswd:"",mobile:"",email:""}),b=z({userName:[{required:!0,trigger:"blur",validator:(i,e,l)=>{!e||!e.trim()?l(new Error("请输入用户名")):l()}}],nickName:[{required:!0,trigger:"blur",validator:(i,e,l)=>{!e||!e.trim()?l(new Error("请输入昵称")):l()}}],passwd:[{trigger:"blur",validator:(i,e,l)=>{if(e==="")l(new Error("请输入密码"));else{if(r.rePasswd!==""){if(!m.value)return;m.value.validateField("rePasswd",()=>{})}l()}}}],rePasswd:[{trigger:"change",validator:(i,e,l)=>{e===""?l(new Error("请再次输入密码")):e!==r.passwd?l("两次输入密码不一致!"):l()}}],mobile:[{trigger:"change",validator:(i,e,l)=>{e===""||L.test(e)?l():l("请输入正确的手机号码")}}],email:[{trigger:"change",validator:(i,e,l)=>{e===""||A.test(e)?l():l("请输入正确的邮箱")}}]}),g=v(!1),x=P(),V=U();q(()=>{V.logged&&x.back()});function n(){m.value&&m.value.validate(i=>{i&&(r.userName=r.userName.trim(),r.nickName=r.nickName.trim(),r.email=r.email.trim(),r.mobile=r.mobile.trim(),g.value=!0,V.register(r).then(e=>{e?(E.success("注册成功，请前往登录"),x.push("/login")):(E.success("注册成功，请等待管理员审批"),x.push("/"))}).catch(e=>{E.error(e.message)}).finally(()=>{g.value=!1}))})}function N(){m.value?.resetFields()}function k(){x.push("/login")}return(i,e)=>{const l=c,p=K,d=M,w=C,y=$;return I(),B("div",D,[u("div",G,[o(l,{title:"注意，本站未开放注册",type:"warning"}),o(y,{ref_key:"registerFormRef",ref:m,layout:"horizontal",model:a(r),rules:a(b),"status-icon":"","label-width":"auto"},{default:s(()=>[o(d,{required:"",label:"用户名",prop:"userName"},{default:s(()=>[o(p,{modelValue:a(r).userName,"onUpdate:modelValue":e[0]||(e[0]=t=>a(r).userName=t),size:"large",onKeydown:f(n,["enter"])},{prefix:s(()=>[...e[6]||(e[6]=[u("span",{class:"i-icon-park-outline-user"},null,-1)])]),_:1},8,["modelValue"])]),_:1}),o(d,{required:"",label:"昵称",prop:"nickName"},{default:s(()=>[o(p,{modelValue:a(r).nickName,"onUpdate:modelValue":e[1]||(e[1]=t=>a(r).nickName=t),size:"large",onKeydown:f(n,["enter"])},{prefix:s(()=>[...e[7]||(e[7]=[u("span",{class:"i-icon-park-outline-user"},null,-1)])]),_:1},8,["modelValue"])]),_:1}),o(d,{required:"",label:"密码",prop:"passwd"},{default:s(()=>[o(p,{modelValue:a(r).passwd,"onUpdate:modelValue":e[2]||(e[2]=t=>a(r).passwd=t),type:"password",size:"large","show-password":"",autocomplete:"off",onKeydown:f(n,["enter"])},{prefix:s(()=>[...e[8]||(e[8]=[u("span",{class:"i-icon-park-outline-lock"},null,-1)])]),_:1},8,["modelValue"])]),_:1}),o(d,{required:"",label:"重复密码",prop:"rePasswd"},{default:s(()=>[o(p,{modelValue:a(r).rePasswd,"onUpdate:modelValue":e[3]||(e[3]=t=>a(r).rePasswd=t),type:"password",size:"large","show-password":"",autocomplete:"off",onKeydown:f(n,["enter"])},{prefix:s(()=>[...e[9]||(e[9]=[u("span",{class:"i-icon-park-outline-lock"},null,-1)])]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"手机号",prop:"mobile"},{default:s(()=>[o(p,{modelValue:a(r).mobile,"onUpdate:modelValue":e[4]||(e[4]=t=>a(r).mobile=t),size:"large",onKeydown:f(n,["enter"])},{prefix:s(()=>[...e[10]||(e[10]=[u("span",{class:"i-icon-park-outline-phone"},null,-1)])]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"邮箱",prop:"email"},{default:s(()=>[o(p,{modelValue:a(r).email,"onUpdate:modelValue":e[5]||(e[5]=t=>a(r).email=t),size:"large",onKeydown:f(n,["enter"])},{prefix:s(()=>[...e[11]||(e[11]=[u("span",{class:"i-icon-park-outline-mail"},null,-1)])]),_:1},8,["modelValue"])]),_:1}),o(d,null,{default:s(()=>[o(w,{type:"primary",block:"",size:"large",loading:a(g),onClick:n},{default:s(()=>[...e[12]||(e[12]=[_(" 注册 ",-1)])]),_:1},8,["loading"]),o(w,{block:"",size:"large",disabled:a(g),onClick:N},{default:s(()=>[...e[13]||(e[13]=[_(" 重置 ",-1)])]),_:1},8,["disabled"]),o(w,{block:"",size:"large",disabled:a(g),onClick:k},{default:s(()=>[...e[14]||(e[14]=[_(" 返回登录 ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])])])}}}),j=R(O,[["__scopeId","data-v-d79b4eea"]]);export{j as default};
