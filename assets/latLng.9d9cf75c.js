import{l as t,c as a,C as e}from"./leaflet.ChineseLayer.310fcb74.js";import{_ as o}from"./container.e990a2aa.js";import{$ as n,_ as i,ad as r,ah as s,p,a as m,b as l,c,w as d,o as h,e as g,aI as u,f as k,h as x}from"./vendor.63c7f986.js";/* empty css              */var f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",C=".ant-space[data-v-759c794e] {\n  margin-bottom: 0.8rem;\n  width: 100%;\n}\n.ant-space[data-v-759c794e] .ant-space-item:first-child {\n  flex: 1;\n}\n.mapContainer[data-v-759c794e] {\n  width: 100%;\n  height: calc(100% - 4rem);\n}\n.mapContainer[data-v-759c794e] .leaflet-popup-content p {\n  font-size: 1.4rem;\n}";const y=new t.exports.Icon({iconUrl:"https://cdn.jsdelivr.net/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-green.png",shadowUrl:f,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),w=new t.exports.Icon({iconUrl:"https://cdn.jsdelivr.net/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-yellow.png",shadowUrl:f,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),v={name:"latLng",components:{Container:o,Button:n,Input:i,Space:r},data:()=>({map:void 0,centerMarker:void 0,clickMarker:void 0,tdtToken:"bed806b1ccb34b268ab1c0700123d444",gaodeToken:"868d6830a7409520ae283cde3a3f84d1",latLng:{lng:"",lat:""},address:"",keyword:""}),mounted(){this.initMap()},methods:{initMap(){this.map=s(t.exports.map(this.$refs.mapContainer,{attributionControl:!0,zoomControl:!1})),this.map.setView([35,105],4),t.exports.control.layers({"高德矢量":a("GaoDe.Normal.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">高德地图</a> 贡献者'}).addTo(this.map),"高德影像":t.exports.layerGroup([a("GaoDe.Satellite.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20}),a("GaoDe.Satellite.Annotation",{minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">高德地图</a> 贡献者'}),"天地图矢量":t.exports.layerGroup([a("TianDiTu.Normal.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20}),a("TianDiTu.Normal.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'}),"天地图影像":t.exports.layerGroup([a("TianDiTu.Satellite.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20}),a("TianDiTu.Satellite.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'}),"天地图地形":t.exports.layerGroup([a("TianDiTu.Terrain.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:14,maxZoom:20}),a("TianDiTu.Terrain.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'}),OpenStreetMap:a("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> 贡献者'})},{},{hideSingleBase:!0,position:"topright"}).addTo(this.map),t.exports.control.scale({imperial:!1,position:"bottomleft"}).addTo(this.map),t.exports.control.zoom({zoomInTitle:"放大",zoomOutTitle:"缩小",position:"bottomright"}).addTo(this.map),this.centerMarker=s(t.exports.marker(this.map.getCenter(),{icon:y})).addTo(this.map).bindPopup(this.getPopupContent(this.map.getCenter()),{autoPan:!1,autoClose:!1,closeOnEscapeKey:!1,closeOnClick:!1}).openPopup(),this.map.on("move",(()=>{this.centerMarker.setLatLng(this.map.getCenter()).getPopup().setContent(this.getPopupContent(this.map.getCenter()))})),this.map.on("click",(t=>{this.locateLatLng(t.latlng,null,!1)})),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((t=>{this.map.setView([t.coords.latitude,t.coords.longitude],18)}))},getPopupContent(t,a){const e=t.lat;let o=t.lng%360;o<=-180&&(o+=360);let n="";return n+=e>=0?`<p>北纬N: ${Math.abs(e)}</p>`:`<p>南纬S: ${Math.abs(e)}</p>`,n+=o>=0?`<p>东经E: ${Math.abs(o)}</p>`:`<p>西经W: ${Math.abs(o)}</p>`,n+=e>=0?`<p>北纬N: ${this.formatDegree(Math.abs(e))}</p>`:`<p>南纬S: ${this.formatDegree(Math.abs(e))}</p>`,n+=o>=0?`<p>东经E: ${this.formatDegree(o)}</p>`:`<p>西经W: ${this.formatDegree(o)}</p>`,a&&(n+=`<p>地址: ${a}</p>`),n},handler(){if(!this.keyword)return;const t=this.keyword.replace(/，/g,",").split(",");if(2===t.length&&!isNaN(parseFloat(t[0].trim()))&&!isNaN(parseFloat(t[1].trim())))return this.latLng.lng=parseFloat(t[0].trim()),this.latLng.lat=parseFloat(t[1].trim()),void this.locateLatLng(this.latLng);this.address=this.keyword,this.locateAddress()},async locateLatLng(a={},o,n=!0){if(null!=a.lng&&null!=a.lat&&""!==a.lng&&""!==a.lat)try{if(!o)try{const t=e.prototype.csysConvert.gps84_To_gcj02(a.lng,a.lat),n=await this.$axios.get("https://amap.api.iszy.xyz/v3/geocode/regeo",{params:{location:`${t.lng},${t.lat}`,output:"json",key:this.gaodeToken,homeorcorp:1}});"1"===n.data.status&&n.data.regeocode.formatted_address?o=n.data.regeocode.formatted_address:this.$msg.warn("未找到相关地址。")}catch(i){this.$msg.error("查询地址失败！")}this.clickMarker?(this.clickMarker.setLatLng(a).getPopup().setContent(this.getPopupContent(a,o)),this.clickMarker.openPopup()):this.clickMarker=s(t.exports.marker(a,{icon:w})).addTo(this.map).bindPopup(this.getPopupContent(a,o),{autoPan:!1,autoClose:!1,closeOnEscapeKey:!1,closeOnClick:!1,maxWidth:350}).openPopup(),n&&this.map.setView(a,18)}catch(i){this.$msg.error("定位失败!")}},async locateAddress(){if(this.address)try{const t=await this.$axios.get("https://amap.api.iszy.xyz/v3/geocode/geo",{params:{address:this.address,key:this.gaodeToken}});if("1"===t.data.status&&Number(t.data.count)>0){const a=t.data.geocodes[0],o=e.prototype.csysConvert.gcj02_To_gps84(parseFloat(a.location.split(",")[0]),parseFloat(a.location.split(",")[1]));await this.locateLatLng({lat:o.lat,lng:o.lng},a.formatted_address)}else this.$msg.warn("未找到相关地址。")}catch(t){this.$msg.error("查询地址失败!")}},formatDegree(t){t=Math.abs(t);const a=Math.floor(t),e=Math.floor(60*(t-a)),o=(3600*(t-a)%60).toFixed(2);return a+"° "+(e<10?"0"+e:e)+"' "+(o<10?"0"+o:o)+'" '}}};p("data-v-759c794e");const A=x("解析"),b={class:"mapContainer",ref:"mapContainer"};function M(t,a,e,o,n,i){const r=l("Input"),s=l("Button"),p=l("Space"),m=l("container");return h(),c(m,null,{default:d((()=>[g(p,{size:8,align:"center"},{default:d((()=>[g(r,{value:t.keyword,"onUpdate:value":a[0]||(a[0]=a=>t.keyword=a),placeholder:"输入经纬度(如'116.4,36.9')或地址(如'北京市政府')",onKeypress:u(i.handler,["enter"]),"allow-clear":""},null,8,["value","onKeypress"]),g(s,{onClick:i.handler,type:"primary"},{default:d((()=>[A])),_:1},8,["onClick"])])),_:1}),k("div",b,null,512)])),_:1})}m(),v.render=M,v.__scopeId="data-v-759c794e";export{v as default};
