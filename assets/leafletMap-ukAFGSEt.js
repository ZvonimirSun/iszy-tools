import{ak as Ce,G as yo,n as ii,q as vo,at as gt,ah as Lo,o as Ee,j as ri,k as Pe,B as bo,v as ai,t as ko,w as Hi,F as qi,r as Mo,I as xo,A as wo,D as Co,a5 as Eo,C as Po,p as So,l as Bo,h as Do}from"./index-0Glyiw05.js";import{E as Ro,a as To}from"./el-descriptions-item-4P0TuKWw.js";/* empty css                */import{m as Oo,c as ft}from"./marker-shadow-nTCLsZwV.js";import{l as nt}from"./leaflet-src-DRHrf0YR.js";const Io="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",Ao="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==";var Ji={};(()=>{var Ft=Object.create,se=Object.defineProperty,Se=Object.getOwnPropertyDescriptor,lt=Object.getOwnPropertyNames,tt=Object.getPrototypeOf,Zt=Object.prototype.hasOwnProperty,D=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Wt=(t,e,i,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of lt(e))!Zt.call(t,a)&&a!==i&&se(t,a,{get:()=>e[a],enumerable:!(r=Se(e,a))||r.enumerable});return t},ut=(t,e,i)=>(i=t!=null?Ft(tt(t)):{},Wt(e||!t||!t.__esModule?se(i,"default",{value:t,enumerable:!0}):i,t)),Be=D((t,e)=>{function i(){this.__data__=[],this.size=0}e.exports=i}),Dt=D((t,e)=>{function i(r,a){return r===a||r!==r&&a!==a}e.exports=i}),Rt=D((t,e)=>{var i=Dt();function r(a,n){for(var o=a.length;o--;)if(i(a[o][0],n))return o;return-1}e.exports=r}),le=D((t,e)=>{var i=Rt(),r=Array.prototype,a=r.splice;function n(o){var l=this.__data__,u=i(l,o);if(u<0)return!1;var p=l.length-1;return u==p?l.pop():a.call(l,u,1),--this.size,!0}e.exports=n}),he=D((t,e)=>{var i=Rt();function r(a){var n=this.__data__,o=i(n,a);return o<0?void 0:n[o][1]}e.exports=r}),ue=D((t,e)=>{var i=Rt();function r(a){return i(this.__data__,a)>-1}e.exports=r}),pe=D((t,e)=>{var i=Rt();function r(a,n){var o=this.__data__,l=i(o,a);return l<0?(++this.size,o.push([a,n])):o[l][1]=n,this}e.exports=r}),Tt=D((t,e)=>{var i=Be(),r=le(),a=he(),n=ue(),o=pe();function l(u){var p=-1,_=u==null?0:u.length;for(this.clear();++p<_;){var f=u[p];this.set(f[0],f[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=n,l.prototype.set=o,e.exports=l}),ce=D((t,e)=>{var i=Tt();function r(){this.__data__=new i,this.size=0}e.exports=r}),Q=D((t,e)=>{function i(r){var a=this.__data__,n=a.delete(r);return this.size=a.size,n}e.exports=i}),$=D((t,e)=>{function i(r){return this.__data__.get(r)}e.exports=i}),De=D((t,e)=>{function i(r){return this.__data__.has(r)}e.exports=i}),de=D((t,e)=>{var i=typeof Ce=="object"&&Ce&&Ce.Object===Object&&Ce;e.exports=i}),Ct=D((t,e)=>{var i=de(),r=typeof self=="object"&&self&&self.Object===Object&&self,a=i||r||Function("return this")();e.exports=a}),Ut=D((t,e)=>{var i=Ct(),r=i.Symbol;e.exports=r}),Re=D((t,e)=>{var i=Ut(),r=Object.prototype,a=r.hasOwnProperty,n=r.toString,o=i?i.toStringTag:void 0;function l(u){var p=a.call(u,o),_=u[o];try{u[o]=void 0;var f=!0}catch{}var B=n.call(u);return f&&(p?u[o]=_:delete u[o]),B}e.exports=l}),Te=D((t,e)=>{var i=Object.prototype,r=i.toString;function a(n){return r.call(n)}e.exports=a}),Ot=D((t,e)=>{var i=Ut(),r=Re(),a=Te(),n="[object Null]",o="[object Undefined]",l=i?i.toStringTag:void 0;function u(p){return p==null?p===void 0?o:n:l&&l in Object(p)?r(p):a(p)}e.exports=u}),It=D((t,e)=>{function i(r){var a=typeof r;return r!=null&&(a=="object"||a=="function")}e.exports=i}),Oe=D((t,e)=>{var i=Ot(),r=It(),a="[object AsyncFunction]",n="[object Function]",o="[object GeneratorFunction]",l="[object Proxy]";function u(p){if(!r(p))return!1;var _=i(p);return _==n||_==o||_==a||_==l}e.exports=u}),Yi=D((t,e)=>{var i=Ct(),r=i["__core-js_shared__"];e.exports=r}),Xi=D((t,e)=>{var i=Yi(),r=function(){var n=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function a(n){return!!r&&r in n}e.exports=a}),Zi=D((t,e)=>{var i=Function.prototype,r=i.toString;function a(n){if(n!=null){try{return r.call(n)}catch{}try{return n+""}catch{}}return""}e.exports=a}),Wi=D((t,e)=>{var i=Oe(),r=Xi(),a=It(),n=Zi(),o=/[\\^$.*+?()[\]{}|]/g,l=/^\[object .+?Constructor\]$/,u=Function.prototype,p=Object.prototype,_=u.toString,f=p.hasOwnProperty,B=RegExp("^"+_.call(f).replace(o,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function P(A){if(!a(A)||r(A))return!1;var z=i(A)?B:l;return z.test(n(A))}e.exports=P}),Qi=D((t,e)=>{function i(r,a){return r==null?void 0:r[a]}e.exports=i}),Ie=D((t,e)=>{var i=Wi(),r=Qi();function a(n,o){var l=r(n,o);return i(l)?l:void 0}e.exports=a}),ni=D((t,e)=>{var i=Ie(),r=Ct(),a=i(r,"Map");e.exports=a}),ge=D((t,e)=>{var i=Ie(),r=i(Object,"create");e.exports=r}),$i=D((t,e)=>{var i=ge();function r(){this.__data__=i?i(null):{},this.size=0}e.exports=r}),tr=D((t,e)=>{function i(r){var a=this.has(r)&&delete this.__data__[r];return this.size-=a?1:0,a}e.exports=i}),er=D((t,e)=>{var i=ge(),r="__lodash_hash_undefined__",a=Object.prototype,n=a.hasOwnProperty;function o(l){var u=this.__data__;if(i){var p=u[l];return p===r?void 0:p}return n.call(u,l)?u[l]:void 0}e.exports=o}),ir=D((t,e)=>{var i=ge(),r=Object.prototype,a=r.hasOwnProperty;function n(o){var l=this.__data__;return i?l[o]!==void 0:a.call(l,o)}e.exports=n}),rr=D((t,e)=>{var i=ge(),r="__lodash_hash_undefined__";function a(n,o){var l=this.__data__;return this.size+=this.has(n)?0:1,l[n]=i&&o===void 0?r:o,this}e.exports=a}),ar=D((t,e)=>{var i=$i(),r=tr(),a=er(),n=ir(),o=rr();function l(u){var p=-1,_=u==null?0:u.length;for(this.clear();++p<_;){var f=u[p];this.set(f[0],f[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=n,l.prototype.set=o,e.exports=l}),nr=D((t,e)=>{var i=ar(),r=Tt(),a=ni();function n(){this.size=0,this.__data__={hash:new i,map:new(a||r),string:new i}}e.exports=n}),or=D((t,e)=>{function i(r){var a=typeof r;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?r!=="__proto__":r===null}e.exports=i}),fe=D((t,e)=>{var i=or();function r(a,n){var o=a.__data__;return i(n)?o[typeof n=="string"?"string":"hash"]:o.map}e.exports=r}),sr=D((t,e)=>{var i=fe();function r(a){var n=i(this,a).delete(a);return this.size-=n?1:0,n}e.exports=r}),lr=D((t,e)=>{var i=fe();function r(a){return i(this,a).get(a)}e.exports=r}),hr=D((t,e)=>{var i=fe();function r(a){return i(this,a).has(a)}e.exports=r}),ur=D((t,e)=>{var i=fe();function r(a,n){var o=i(this,a),l=o.size;return o.set(a,n),this.size+=o.size==l?0:1,this}e.exports=r}),oi=D((t,e)=>{var i=nr(),r=sr(),a=lr(),n=hr(),o=ur();function l(u){var p=-1,_=u==null?0:u.length;for(this.clear();++p<_;){var f=u[p];this.set(f[0],f[1])}}l.prototype.clear=i,l.prototype.delete=r,l.prototype.get=a,l.prototype.has=n,l.prototype.set=o,e.exports=l}),pr=D((t,e)=>{var i=Tt(),r=ni(),a=oi(),n=200;function o(l,u){var p=this.__data__;if(p instanceof i){var _=p.__data__;if(!r||_.length<n-1)return _.push([l,u]),this.size=++p.size,this;p=this.__data__=new a(_)}return p.set(l,u),this.size=p.size,this}e.exports=o}),cr=D((t,e)=>{var i=Tt(),r=ce(),a=Q(),n=$(),o=De(),l=pr();function u(p){var _=this.__data__=new i(p);this.size=_.size}u.prototype.clear=r,u.prototype.delete=a,u.prototype.get=n,u.prototype.has=o,u.prototype.set=l,e.exports=u}),si=D((t,e)=>{var i=Ie(),r=function(){try{var a=i(Object,"defineProperty");return a({},"",{}),a}catch{}}();e.exports=r}),Ae=D((t,e)=>{var i=si();function r(a,n,o){n=="__proto__"&&i?i(a,n,{configurable:!0,enumerable:!0,value:o,writable:!0}):a[n]=o}e.exports=r}),li=D((t,e)=>{var i=Ae(),r=Dt();function a(n,o,l){(l!==void 0&&!r(n[o],l)||l===void 0&&!(o in n))&&i(n,o,l)}e.exports=a}),dr=D((t,e)=>{function i(r){return function(a,n,o){for(var l=-1,u=Object(a),p=o(a),_=p.length;_--;){var f=p[r?_:++l];if(n(u[f],f,u)===!1)break}return a}}e.exports=i}),gr=D((t,e)=>{var i=dr(),r=i();e.exports=r}),fr=D((t,e)=>{var i=Ct(),r=typeof t=="object"&&t&&!t.nodeType&&t,a=r&&typeof e=="object"&&e&&!e.nodeType&&e,n=a&&a.exports===r,o=n?i.Buffer:void 0,l=o?o.allocUnsafe:void 0;function u(p,_){if(_)return p.slice();var f=p.length,B=l?l(f):new p.constructor(f);return p.copy(B),B}e.exports=u}),_r=D((t,e)=>{var i=Ct(),r=i.Uint8Array;e.exports=r}),mr=D((t,e)=>{var i=_r();function r(a){var n=new a.constructor(a.byteLength);return new i(n).set(new i(a)),n}e.exports=r}),yr=D((t,e)=>{var i=mr();function r(a,n){var o=n?i(a.buffer):a.buffer;return new a.constructor(o,a.byteOffset,a.length)}e.exports=r}),vr=D((t,e)=>{function i(r,a){var n=-1,o=r.length;for(a||(a=Array(o));++n<o;)a[n]=r[n];return a}e.exports=i}),Lr=D((t,e)=>{var i=It(),r=Object.create,a=function(){function n(){}return function(o){if(!i(o))return{};if(r)return r(o);n.prototype=o;var l=new n;return n.prototype=void 0,l}}();e.exports=a}),br=D((t,e)=>{function i(r,a){return function(n){return r(a(n))}}e.exports=i}),hi=D((t,e)=>{var i=br(),r=i(Object.getPrototypeOf,Object);e.exports=r}),ui=D((t,e)=>{var i=Object.prototype;function r(a){var n=a&&a.constructor,o=typeof n=="function"&&n.prototype||i;return a===o}e.exports=r}),kr=D((t,e)=>{var i=Lr(),r=hi(),a=ui();function n(o){return typeof o.constructor=="function"&&!a(o)?i(r(o)):{}}e.exports=n}),Vt=D((t,e)=>{function i(r){return r!=null&&typeof r=="object"}e.exports=i}),Mr=D((t,e)=>{var i=Ot(),r=Vt(),a="[object Arguments]";function n(o){return r(o)&&i(o)==a}e.exports=n}),je=D((t,e)=>{var i=Mr(),r=Vt(),a=Object.prototype,n=a.hasOwnProperty,o=a.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(u){return r(u)&&n.call(u,"callee")&&!o.call(u,"callee")};e.exports=l}),Kt=D((t,e)=>{var i=Array.isArray;e.exports=i}),Ge=D((t,e)=>{var i=9007199254740991;function r(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=i}e.exports=r}),ze=D((t,e)=>{var i=Oe(),r=Ge();function a(n){return n!=null&&r(n.length)&&!i(n)}e.exports=a}),xr=D((t,e)=>{var i=ze(),r=Vt();function a(n){return r(n)&&i(n)}e.exports=a}),wr=D((t,e)=>{function i(){return!1}e.exports=i}),pi=D((t,e)=>{var i=Ct(),r=wr(),a=typeof t=="object"&&t&&!t.nodeType&&t,n=a&&typeof e=="object"&&e&&!e.nodeType&&e,o=n&&n.exports===a,l=o?i.Buffer:void 0,u=l?l.isBuffer:void 0,p=u||r;e.exports=p}),Cr=D((t,e)=>{var i=Ot(),r=hi(),a=Vt(),n="[object Object]",o=Function.prototype,l=Object.prototype,u=o.toString,p=l.hasOwnProperty,_=u.call(Object);function f(B){if(!a(B)||i(B)!=n)return!1;var P=r(B);if(P===null)return!0;var A=p.call(P,"constructor")&&P.constructor;return typeof A=="function"&&A instanceof A&&u.call(A)==_}e.exports=f}),Er=D((t,e)=>{var i=Ot(),r=Ge(),a=Vt(),n="[object Arguments]",o="[object Array]",l="[object Boolean]",u="[object Date]",p="[object Error]",_="[object Function]",f="[object Map]",B="[object Number]",P="[object Object]",A="[object RegExp]",z="[object Set]",N="[object String]",q="[object WeakMap]",k="[object ArrayBuffer]",d="[object DataView]",v="[object Float32Array]",x="[object Float64Array]",M="[object Int8Array]",w="[object Int16Array]",E="[object Int32Array]",R="[object Uint8Array]",O="[object Uint8ClampedArray]",b="[object Uint16Array]",S="[object Uint32Array]",C={};C[v]=C[x]=C[M]=C[w]=C[E]=C[R]=C[O]=C[b]=C[S]=!0,C[n]=C[o]=C[k]=C[l]=C[d]=C[u]=C[p]=C[_]=C[f]=C[B]=C[P]=C[A]=C[z]=C[N]=C[q]=!1;function G(V){return a(V)&&r(V.length)&&!!C[i(V)]}e.exports=G}),Pr=D((t,e)=>{function i(r){return function(a){return r(a)}}e.exports=i}),Sr=D((t,e)=>{var i=de(),r=typeof t=="object"&&t&&!t.nodeType&&t,a=r&&typeof e=="object"&&e&&!e.nodeType&&e,n=a&&a.exports===r,o=n&&i.process,l=function(){try{var u=a&&a.require&&a.require("util").types;return u||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l}),ci=D((t,e)=>{var i=Er(),r=Pr(),a=Sr(),n=a&&a.isTypedArray,o=n?r(n):i;e.exports=o}),di=D((t,e)=>{function i(r,a){if(!(a==="constructor"&&typeof r[a]=="function")&&a!="__proto__")return r[a]}e.exports=i}),Br=D((t,e)=>{var i=Ae(),r=Dt(),a=Object.prototype,n=a.hasOwnProperty;function o(l,u,p){var _=l[u];(!(n.call(l,u)&&r(_,p))||p===void 0&&!(u in l))&&i(l,u,p)}e.exports=o}),Dr=D((t,e)=>{var i=Br(),r=Ae();function a(n,o,l,u){var p=!l;l||(l={});for(var _=-1,f=o.length;++_<f;){var B=o[_],P=u?u(l[B],n[B],B,l,n):void 0;P===void 0&&(P=n[B]),p?r(l,B,P):i(l,B,P)}return l}e.exports=a}),Rr=D((t,e)=>{function i(r,a){for(var n=-1,o=Array(r);++n<r;)o[n]=a(n);return o}e.exports=i}),Ne=D((t,e)=>{var i=9007199254740991,r=/^(?:0|[1-9]\d*)$/;function a(n,o){var l=typeof n;return o=o??i,!!o&&(l=="number"||l!="symbol"&&r.test(n))&&n>-1&&n%1==0&&n<o}e.exports=a}),Tr=D((t,e)=>{var i=Rr(),r=je(),a=Kt(),n=pi(),o=Ne(),l=ci(),u=Object.prototype,p=u.hasOwnProperty;function _(f,B){var P=a(f),A=!P&&r(f),z=!P&&!A&&n(f),N=!P&&!A&&!z&&l(f),q=P||A||z||N,k=q?i(f.length,String):[],d=k.length;for(var v in f)(B||p.call(f,v))&&!(q&&(v=="length"||z&&(v=="offset"||v=="parent")||N&&(v=="buffer"||v=="byteLength"||v=="byteOffset")||o(v,d)))&&k.push(v);return k}e.exports=_}),Or=D((t,e)=>{function i(r){var a=[];if(r!=null)for(var n in Object(r))a.push(n);return a}e.exports=i}),Ir=D((t,e)=>{var i=It(),r=ui(),a=Or(),n=Object.prototype,o=n.hasOwnProperty;function l(u){if(!i(u))return a(u);var p=r(u),_=[];for(var f in u)f=="constructor"&&(p||!o.call(u,f))||_.push(f);return _}e.exports=l}),gi=D((t,e)=>{var i=Tr(),r=Ir(),a=ze();function n(o){return a(o)?i(o,!0):r(o)}e.exports=n}),Ar=D((t,e)=>{var i=Dr(),r=gi();function a(n){return i(n,r(n))}e.exports=a}),jr=D((t,e)=>{var i=li(),r=fr(),a=yr(),n=vr(),o=kr(),l=je(),u=Kt(),p=xr(),_=pi(),f=Oe(),B=It(),P=Cr(),A=ci(),z=di(),N=Ar();function q(k,d,v,x,M,w,E){var R=z(k,v),O=z(d,v),b=E.get(O);if(b){i(k,v,b);return}var S=w?w(R,O,v+"",k,d,E):void 0,C=S===void 0;if(C){var G=u(O),V=!G&&_(O),J=!G&&!V&&A(O);S=O,G||V||J?u(R)?S=R:p(R)?S=n(R):V?(C=!1,S=r(O,!0)):J?(C=!1,S=a(O,!0)):S=[]:P(O)||l(O)?(S=R,l(R)?S=N(R):(!B(R)||f(R))&&(S=o(O))):C=!1}C&&(E.set(O,S),M(S,O,x,w,E),E.delete(O)),i(k,v,S)}e.exports=q}),Gr=D((t,e)=>{var i=cr(),r=li(),a=gr(),n=jr(),o=It(),l=gi(),u=di();function p(_,f,B,P,A){_!==f&&a(f,function(z,N){if(A||(A=new i),o(z))n(_,f,N,B,p,P,A);else{var q=P?P(u(_,N),z,N+"",_,f,A):void 0;q===void 0&&(q=z),r(_,N,q)}},l)}e.exports=p}),fi=D((t,e)=>{function i(r){return r}e.exports=i}),zr=D((t,e)=>{function i(r,a,n){switch(n.length){case 0:return r.call(a);case 1:return r.call(a,n[0]);case 2:return r.call(a,n[0],n[1]);case 3:return r.call(a,n[0],n[1],n[2])}return r.apply(a,n)}e.exports=i}),Nr=D((t,e)=>{var i=zr(),r=Math.max;function a(n,o,l){return o=r(o===void 0?n.length-1:o,0),function(){for(var u=arguments,p=-1,_=r(u.length-o,0),f=Array(_);++p<_;)f[p]=u[o+p];p=-1;for(var B=Array(o+1);++p<o;)B[p]=u[p];return B[o]=l(f),i(n,this,B)}}e.exports=a}),Fr=D((t,e)=>{function i(r){return function(){return r}}e.exports=i}),Ur=D((t,e)=>{var i=Fr(),r=si(),a=fi(),n=r?function(o,l){return r(o,"toString",{configurable:!0,enumerable:!1,value:i(l),writable:!0})}:a;e.exports=n}),Vr=D((t,e)=>{var i=800,r=16,a=Date.now;function n(o){var l=0,u=0;return function(){var p=a(),_=r-(p-u);if(u=p,_>0){if(++l>=i)return arguments[0]}else l=0;return o.apply(void 0,arguments)}}e.exports=n}),Kr=D((t,e)=>{var i=Ur(),r=Vr(),a=r(i);e.exports=a}),Hr=D((t,e)=>{var i=fi(),r=Nr(),a=Kr();function n(o,l){return a(r(o,l,i),o+"")}e.exports=n}),qr=D((t,e)=>{var i=Dt(),r=ze(),a=Ne(),n=It();function o(l,u,p){if(!n(p))return!1;var _=typeof u;return(_=="number"?r(p)&&a(u,p.length):_=="string"&&u in p)?i(p[u],l):!1}e.exports=o}),Jr=D((t,e)=>{var i=Hr(),r=qr();function a(n){return i(function(o,l){var u=-1,p=l.length,_=p>1?l[p-1]:void 0,f=p>2?l[2]:void 0;for(_=n.length>3&&typeof _=="function"?(p--,_):void 0,f&&r(l[0],l[1],f)&&(_=p<3?void 0:_,p=1),o=Object(o);++u<p;){var B=l[u];B&&n(o,B,u,_)}return o})}e.exports=a}),Fe=D((t,e)=>{var i=Gr(),r=Jr(),a=r(function(n,o,l){i(n,o,l)});e.exports=a}),Ue=D((t,e)=>{var i=Ot(),r=Vt(),a="[object Symbol]";function n(o){return typeof o=="symbol"||r(o)&&i(o)==a}e.exports=n}),Yr=D((t,e)=>{var i=Kt(),r=Ue(),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function o(l,u){if(i(l))return!1;var p=typeof l;return p=="number"||p=="symbol"||p=="boolean"||l==null||r(l)?!0:n.test(l)||!a.test(l)||u!=null&&l in Object(u)}e.exports=o}),Xr=D((t,e)=>{var i=oi(),r="Expected a function";function a(n,o){if(typeof n!="function"||o!=null&&typeof o!="function")throw new TypeError(r);var l=function(){var u=arguments,p=o?o.apply(this,u):u[0],_=l.cache;if(_.has(p))return _.get(p);var f=n.apply(this,u);return l.cache=_.set(p,f)||_,f};return l.cache=new(a.Cache||i),l}a.Cache=i,e.exports=a}),Zr=D((t,e)=>{var i=Xr(),r=500;function a(n){var o=i(n,function(u){return l.size===r&&l.clear(),u}),l=o.cache;return o}e.exports=a}),Wr=D((t,e)=>{var i=Zr(),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,n=i(function(o){var l=[];return o.charCodeAt(0)===46&&l.push(""),o.replace(r,function(u,p,_,f){l.push(_?f.replace(a,"$1"):p||u)}),l});e.exports=n}),Qr=D((t,e)=>{function i(r,a){for(var n=-1,o=r==null?0:r.length,l=Array(o);++n<o;)l[n]=a(r[n],n,r);return l}e.exports=i}),$r=D((t,e)=>{var i=Ut(),r=Qr(),a=Kt(),n=Ue(),o=1/0,l=i?i.prototype:void 0,u=l?l.toString:void 0;function p(_){if(typeof _=="string")return _;if(a(_))return r(_,p)+"";if(n(_))return u?u.call(_):"";var f=_+"";return f=="0"&&1/_==-o?"-0":f}e.exports=p}),ta=D((t,e)=>{var i=$r();function r(a){return a==null?"":i(a)}e.exports=r}),_i=D((t,e)=>{var i=Kt(),r=Yr(),a=Wr(),n=ta();function o(l,u){return i(l)?l:r(l,u)?[l]:a(n(l))}e.exports=o}),mi=D((t,e)=>{var i=Ue(),r=1/0;function a(n){if(typeof n=="string"||i(n))return n;var o=n+"";return o=="0"&&1/n==-r?"-0":o}e.exports=a}),ea=D((t,e)=>{var i=_i(),r=mi();function a(n,o){o=i(o,n);for(var l=0,u=o.length;n!=null&&l<u;)n=n[r(o[l++])];return l&&l==u?n:void 0}e.exports=a}),_e=D((t,e)=>{var i=ea();function r(a,n,o){var l=a==null?void 0:i(a,n);return l===void 0?o:l}e.exports=r}),ia=D((t,e)=>{var i=Object.prototype,r=i.hasOwnProperty;function a(n,o){return n!=null&&r.call(n,o)}e.exports=a}),ra=D((t,e)=>{var i=_i(),r=je(),a=Kt(),n=Ne(),o=Ge(),l=mi();function u(p,_,f){_=i(_,p);for(var B=-1,P=_.length,A=!1;++B<P;){var z=l(_[B]);if(!(A=p!=null&&f(p,z)))break;p=p[z]}return A||++B!=P?A:(P=p==null?0:p.length,!!P&&o(P)&&n(z,P)&&(a(p)||r(p)))}e.exports=u}),aa=D((t,e)=>{var i=ia(),r=ra();function a(n,o){return n!=null&&r(n,o,i)}e.exports=a}),na=D((t,e)=>{(function(i,r){typeof t=="object"&&typeof e<"u"?e.exports=r():(i=i||self).RBush=r()})(t,function(){function i(k,d,v,x,M){(function w(E,R,O,b,S){for(;b>O;){if(b-O>600){var C=b-O+1,G=R-O+1,V=Math.log(C),J=.5*Math.exp(2*V/3),X=.5*Math.sqrt(V*J*(C-J)/C)*(G-C/2<0?-1:1),rt=Math.max(O,Math.floor(R-G*J/C+X)),Et=Math.min(b,Math.floor(R+(C-G)*J/C+X));w(E,R,rt,Et,S)}var et=E[R],yt=O,Z=b;for(r(E,O,R),S(E[b],et)>0&&r(E,O,b);yt<Z;){for(r(E,yt,Z),yt++,Z--;S(E[yt],et)<0;)yt++;for(;S(E[Z],et)>0;)Z--}S(E[O],et)===0?r(E,O,Z):r(E,++Z,b),Z<=R&&(O=Z+1),R<=Z&&(b=Z-1)}})(k,d,v||0,x||k.length-1,M||a)}function r(k,d,v){var x=k[d];k[d]=k[v],k[v]=x}function a(k,d){return k<d?-1:k>d?1:0}var n=function(k){k===void 0&&(k=9),this._maxEntries=Math.max(4,k),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(k,d,v){if(!v)return d.indexOf(k);for(var x=0;x<d.length;x++)if(v(k,d[x]))return x;return-1}function l(k,d){u(k,0,k.children.length,d,k)}function u(k,d,v,x,M){M||(M=N(null)),M.minX=1/0,M.minY=1/0,M.maxX=-1/0,M.maxY=-1/0;for(var w=d;w<v;w++){var E=k.children[w];p(M,k.leaf?x(E):E)}return M}function p(k,d){return k.minX=Math.min(k.minX,d.minX),k.minY=Math.min(k.minY,d.minY),k.maxX=Math.max(k.maxX,d.maxX),k.maxY=Math.max(k.maxY,d.maxY),k}function _(k,d){return k.minX-d.minX}function f(k,d){return k.minY-d.minY}function B(k){return(k.maxX-k.minX)*(k.maxY-k.minY)}function P(k){return k.maxX-k.minX+(k.maxY-k.minY)}function A(k,d){return k.minX<=d.minX&&k.minY<=d.minY&&d.maxX<=k.maxX&&d.maxY<=k.maxY}function z(k,d){return d.minX<=k.maxX&&d.minY<=k.maxY&&d.maxX>=k.minX&&d.maxY>=k.minY}function N(k){return{children:k,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function q(k,d,v,x,M){for(var w=[d,v];w.length;)if(!((v=w.pop())-(d=w.pop())<=x)){var E=d+Math.ceil((v-d)/x/2)*x;i(k,E,d,v,M),w.push(d,E,E,v)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(k){var d=this.data,v=[];if(!z(k,d))return v;for(var x=this.toBBox,M=[];d;){for(var w=0;w<d.children.length;w++){var E=d.children[w],R=d.leaf?x(E):E;z(k,R)&&(d.leaf?v.push(E):A(k,R)?this._all(E,v):M.push(E))}d=M.pop()}return v},n.prototype.collides=function(k){var d=this.data;if(!z(k,d))return!1;for(var v=[];d;){for(var x=0;x<d.children.length;x++){var M=d.children[x],w=d.leaf?this.toBBox(M):M;if(z(k,w)){if(d.leaf||A(k,w))return!0;v.push(M)}}d=v.pop()}return!1},n.prototype.load=function(k){if(!k||!k.length)return this;if(k.length<this._minEntries){for(var d=0;d<k.length;d++)this.insert(k[d]);return this}var v=this._build(k.slice(),0,k.length-1,0);if(this.data.children.length)if(this.data.height===v.height)this._splitRoot(this.data,v);else{if(this.data.height<v.height){var x=this.data;this.data=v,v=x}this._insert(v,this.data.height-v.height-1,!0)}else this.data=v;return this},n.prototype.insert=function(k){return k&&this._insert(k,this.data.height-1),this},n.prototype.clear=function(){return this.data=N([]),this},n.prototype.remove=function(k,d){if(!k)return this;for(var v,x,M,w=this.data,E=this.toBBox(k),R=[],O=[];w||R.length;){if(w||(w=R.pop(),x=R[R.length-1],v=O.pop(),M=!0),w.leaf){var b=o(k,w.children,d);if(b!==-1)return w.children.splice(b,1),R.push(w),this._condense(R),this}M||w.leaf||!A(w,E)?x?(v++,w=x.children[v],M=!1):w=null:(R.push(w),O.push(v),v=0,x=w,w=w.children[0])}return this},n.prototype.toBBox=function(k){return k},n.prototype.compareMinX=function(k,d){return k.minX-d.minX},n.prototype.compareMinY=function(k,d){return k.minY-d.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(k){return this.data=k,this},n.prototype._all=function(k,d){for(var v=[];k;)k.leaf?d.push.apply(d,k.children):v.push.apply(v,k.children),k=v.pop();return d},n.prototype._build=function(k,d,v,x){var M,w=v-d+1,E=this._maxEntries;if(w<=E)return l(M=N(k.slice(d,v+1)),this.toBBox),M;x||(x=Math.ceil(Math.log(w)/Math.log(E)),E=Math.ceil(w/Math.pow(E,x-1))),(M=N([])).leaf=!1,M.height=x;var R=Math.ceil(w/E),O=R*Math.ceil(Math.sqrt(E));q(k,d,v,O,this.compareMinX);for(var b=d;b<=v;b+=O){var S=Math.min(b+O-1,v);q(k,b,S,R,this.compareMinY);for(var C=b;C<=S;C+=R){var G=Math.min(C+R-1,S);M.children.push(this._build(k,C,G,x-1))}}return l(M,this.toBBox),M},n.prototype._chooseSubtree=function(k,d,v,x){for(;x.push(d),!d.leaf&&x.length-1!==v;){for(var M=1/0,w=1/0,E=void 0,R=0;R<d.children.length;R++){var O=d.children[R],b=B(O),S=(C=k,G=O,(Math.max(G.maxX,C.maxX)-Math.min(G.minX,C.minX))*(Math.max(G.maxY,C.maxY)-Math.min(G.minY,C.minY))-b);S<w?(w=S,M=b<M?b:M,E=O):S===w&&b<M&&(M=b,E=O)}d=E||d.children[0]}var C,G;return d},n.prototype._insert=function(k,d,v){var x=v?k:this.toBBox(k),M=[],w=this._chooseSubtree(x,this.data,d,M);for(w.children.push(k),p(w,x);d>=0&&M[d].children.length>this._maxEntries;)this._split(M,d),d--;this._adjustParentBBoxes(x,M,d)},n.prototype._split=function(k,d){var v=k[d],x=v.children.length,M=this._minEntries;this._chooseSplitAxis(v,M,x);var w=this._chooseSplitIndex(v,M,x),E=N(v.children.splice(w,v.children.length-w));E.height=v.height,E.leaf=v.leaf,l(v,this.toBBox),l(E,this.toBBox),d?k[d-1].children.push(E):this._splitRoot(v,E)},n.prototype._splitRoot=function(k,d){this.data=N([k,d]),this.data.height=k.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(k,d,v){for(var x,M,w,E,R,O,b,S=1/0,C=1/0,G=d;G<=v-d;G++){var V=u(k,0,G,this.toBBox),J=u(k,G,v,this.toBBox),X=(M=V,w=J,E=void 0,R=void 0,O=void 0,b=void 0,E=Math.max(M.minX,w.minX),R=Math.max(M.minY,w.minY),O=Math.min(M.maxX,w.maxX),b=Math.min(M.maxY,w.maxY),Math.max(0,O-E)*Math.max(0,b-R)),rt=B(V)+B(J);X<S?(S=X,x=G,C=rt<C?rt:C):X===S&&rt<C&&(C=rt,x=G)}return x||v-d},n.prototype._chooseSplitAxis=function(k,d,v){var x=k.leaf?this.compareMinX:_,M=k.leaf?this.compareMinY:f;this._allDistMargin(k,d,v,x)<this._allDistMargin(k,d,v,M)&&k.children.sort(x)},n.prototype._allDistMargin=function(k,d,v,x){k.children.sort(x);for(var M=this.toBBox,w=u(k,0,d,M),E=u(k,v-d,v,M),R=P(w)+P(E),O=d;O<v-d;O++){var b=k.children[O];p(w,k.leaf?M(b):b),R+=P(w)}for(var S=v-d-1;S>=d;S--){var C=k.children[S];p(E,k.leaf?M(C):C),R+=P(E)}return R},n.prototype._adjustParentBBoxes=function(k,d,v){for(var x=v;x>=0;x--)p(d[x],k)},n.prototype._condense=function(k){for(var d=k.length-1,v=void 0;d>=0;d--)k[d].children.length===0?d>0?(v=k[d-1].children).splice(v.indexOf(k[d]),1):this.clear():l(k[d],this.toBBox)},n})}),yi=D(t=>{Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=63710088e-1,t.factors={centimeters:t.earthRadius*100,centimetres:t.earthRadius*100,degrees:t.earthRadius/111325,feet:t.earthRadius*3.28084,inches:t.earthRadius*39.37,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:t.earthRadius*1e3,millimetres:t.earthRadius*1e3,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius*1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1.0936133},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function e(b,S,C){C===void 0&&(C={});var G={type:"Feature"};return(C.id===0||C.id)&&(G.id=C.id),C.bbox&&(G.bbox=C.bbox),G.properties=S||{},G.geometry=b,G}t.feature=e;function i(b,S,C){switch(b){case"Point":return r(S).geometry;case"LineString":return l(S).geometry;case"Polygon":return n(S).geometry;case"MultiPoint":return f(S).geometry;case"MultiLineString":return _(S).geometry;case"MultiPolygon":return B(S).geometry;default:throw new Error(b+" is invalid")}}t.geometry=i;function r(b,S,C){if(C===void 0&&(C={}),!b)throw new Error("coordinates is required");if(!Array.isArray(b))throw new Error("coordinates must be an Array");if(b.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!w(b[0])||!w(b[1]))throw new Error("coordinates must contain numbers");var G={type:"Point",coordinates:b};return e(G,S,C)}t.point=r;function a(b,S,C){return C===void 0&&(C={}),p(b.map(function(G){return r(G,S)}),C)}t.points=a;function n(b,S,C){C===void 0&&(C={});for(var G=0,V=b;G<V.length;G++){var J=V[G];if(J.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var X=0;X<J[J.length-1].length;X++)if(J[J.length-1][X]!==J[0][X])throw new Error("First and last Position are not equivalent.")}var rt={type:"Polygon",coordinates:b};return e(rt,S,C)}t.polygon=n;function o(b,S,C){return C===void 0&&(C={}),p(b.map(function(G){return n(G,S)}),C)}t.polygons=o;function l(b,S,C){if(C===void 0&&(C={}),b.length<2)throw new Error("coordinates must be an array of two or more positions");var G={type:"LineString",coordinates:b};return e(G,S,C)}t.lineString=l;function u(b,S,C){return C===void 0&&(C={}),p(b.map(function(G){return l(G,S)}),C)}t.lineStrings=u;function p(b,S){S===void 0&&(S={});var C={type:"FeatureCollection"};return S.id&&(C.id=S.id),S.bbox&&(C.bbox=S.bbox),C.features=b,C}t.featureCollection=p;function _(b,S,C){C===void 0&&(C={});var G={type:"MultiLineString",coordinates:b};return e(G,S,C)}t.multiLineString=_;function f(b,S,C){C===void 0&&(C={});var G={type:"MultiPoint",coordinates:b};return e(G,S,C)}t.multiPoint=f;function B(b,S,C){C===void 0&&(C={});var G={type:"MultiPolygon",coordinates:b};return e(G,S,C)}t.multiPolygon=B;function P(b,S,C){C===void 0&&(C={});var G={type:"GeometryCollection",geometries:b};return e(G,S,C)}t.geometryCollection=P;function A(b,S){if(S===void 0&&(S=0),S&&!(S>=0))throw new Error("precision must be a positive number");var C=Math.pow(10,S||0);return Math.round(b*C)/C}t.round=A;function z(b,S){S===void 0&&(S="kilometers");var C=t.factors[S];if(!C)throw new Error(S+" units is invalid");return b*C}t.radiansToLength=z;function N(b,S){S===void 0&&(S="kilometers");var C=t.factors[S];if(!C)throw new Error(S+" units is invalid");return b/C}t.lengthToRadians=N;function q(b,S){return d(N(b,S))}t.lengthToDegrees=q;function k(b){var S=b%360;return S<0&&(S+=360),S}t.bearingToAzimuth=k;function d(b){var S=b%(2*Math.PI);return S*180/Math.PI}t.radiansToDegrees=d;function v(b){var S=b%360;return S*Math.PI/180}t.degreesToRadians=v;function x(b,S,C){if(S===void 0&&(S="kilometers"),C===void 0&&(C="kilometers"),!(b>=0))throw new Error("length must be a positive number");return z(N(b,S),C)}t.convertLength=x;function M(b,S,C){if(S===void 0&&(S="meters"),C===void 0&&(C="kilometers"),!(b>=0))throw new Error("area must be a positive number");var G=t.areaFactors[S];if(!G)throw new Error("invalid original units");var V=t.areaFactors[C];if(!V)throw new Error("invalid final units");return b/G*V}t.convertArea=M;function w(b){return!isNaN(b)&&b!==null&&!Array.isArray(b)}t.isNumber=w;function E(b){return!!b&&b.constructor===Object}t.isObject=E;function R(b){if(!b)throw new Error("bbox is required");if(!Array.isArray(b))throw new Error("bbox must be an Array");if(b.length!==4&&b.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");b.forEach(function(S){if(!w(S))throw new Error("bbox must only contain numbers")})}t.validateBBox=R;function O(b){if(!b)throw new Error("id is required");if(["string","number"].indexOf(typeof b)===-1)throw new Error("id must be a number or a string")}t.validateId=O}),vi=D(t=>{Object.defineProperty(t,"__esModule",{value:!0});var e=yi();function i(d,v,x){if(d!==null)for(var M,w,E,R,O,b,S,C=0,G=0,V,J=d.type,X=J==="FeatureCollection",rt=J==="Feature",Et=X?d.features.length:1,et=0;et<Et;et++){S=X?d.features[et].geometry:rt?d.geometry:d,V=S?S.type==="GeometryCollection":!1,O=V?S.geometries.length:1;for(var yt=0;yt<O;yt++){var Z=0,Mt=0;if(R=V?S.geometries[yt]:S,R!==null){b=R.coordinates;var xt=R.type;switch(C=x&&(xt==="Polygon"||xt==="MultiPolygon")?1:0,xt){case null:break;case"Point":if(v(b,G,et,Z,Mt)===!1)return!1;G++,Z++;break;case"LineString":case"MultiPoint":for(M=0;M<b.length;M++){if(v(b[M],G,et,Z,Mt)===!1)return!1;G++,xt==="MultiPoint"&&Z++}xt==="LineString"&&Z++;break;case"Polygon":case"MultiLineString":for(M=0;M<b.length;M++){for(w=0;w<b[M].length-C;w++){if(v(b[M][w],G,et,Z,Mt)===!1)return!1;G++}xt==="MultiLineString"&&Z++,xt==="Polygon"&&Mt++}xt==="Polygon"&&Z++;break;case"MultiPolygon":for(M=0;M<b.length;M++){for(Mt=0,w=0;w<b[M].length;w++){for(E=0;E<b[M][w].length-C;E++){if(v(b[M][w][E],G,et,Z,Mt)===!1)return!1;G++}Mt++}Z++}break;case"GeometryCollection":for(M=0;M<R.geometries.length;M++)if(i(R.geometries[M],v,x)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function r(d,v,x,M){var w=x;return i(d,function(E,R,O,b,S){R===0&&x===void 0?w=E:w=v(w,E,R,O,b,S)},M),w}function a(d,v){var x;switch(d.type){case"FeatureCollection":for(x=0;x<d.features.length&&v(d.features[x].properties,x)!==!1;x++);break;case"Feature":v(d.properties,0);break}}function n(d,v,x){var M=x;return a(d,function(w,E){E===0&&x===void 0?M=w:M=v(M,w,E)}),M}function o(d,v){if(d.type==="Feature")v(d,0);else if(d.type==="FeatureCollection")for(var x=0;x<d.features.length&&v(d.features[x],x)!==!1;x++);}function l(d,v,x){var M=x;return o(d,function(w,E){E===0&&x===void 0?M=w:M=v(M,w,E)}),M}function u(d){var v=[];return i(d,function(x){v.push(x)}),v}function p(d,v){var x,M,w,E,R,O,b,S,C,G,V=0,J=d.type==="FeatureCollection",X=d.type==="Feature",rt=J?d.features.length:1;for(x=0;x<rt;x++){for(O=J?d.features[x].geometry:X?d.geometry:d,S=J?d.features[x].properties:X?d.properties:{},C=J?d.features[x].bbox:X?d.bbox:void 0,G=J?d.features[x].id:X?d.id:void 0,b=O?O.type==="GeometryCollection":!1,R=b?O.geometries.length:1,w=0;w<R;w++){if(E=b?O.geometries[w]:O,E===null){if(v(null,V,S,C,G)===!1)return!1;continue}switch(E.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(v(E,V,S,C,G)===!1)return!1;break}case"GeometryCollection":{for(M=0;M<E.geometries.length;M++)if(v(E.geometries[M],V,S,C,G)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}V++}}function _(d,v,x){var M=x;return p(d,function(w,E,R,O,b){E===0&&x===void 0?M=w:M=v(M,w,E,R,O,b)}),M}function f(d,v){p(d,function(x,M,w,E,R){var O=x===null?null:x.type;switch(O){case null:case"Point":case"LineString":case"Polygon":return v(e.feature(x,w,{bbox:E,id:R}),M,0)===!1?!1:void 0}var b;switch(O){case"MultiPoint":b="Point";break;case"MultiLineString":b="LineString";break;case"MultiPolygon":b="Polygon";break}for(var S=0;S<x.coordinates.length;S++){var C=x.coordinates[S],G={type:b,coordinates:C};if(v(e.feature(G,w),M,S)===!1)return!1}})}function B(d,v,x){var M=x;return f(d,function(w,E,R){E===0&&R===0&&x===void 0?M=w:M=v(M,w,E,R)}),M}function P(d,v){f(d,function(x,M,w){var E=0;if(x.geometry){var R=x.geometry.type;if(!(R==="Point"||R==="MultiPoint")){var O,b=0,S=0,C=0;if(i(x,function(G,V,J,X,rt){if(O===void 0||M>b||X>S||rt>C){O=G,b=M,S=X,C=rt,E=0;return}var Et=e.lineString([O,G],x.properties);if(v(Et,M,w,rt,E)===!1)return!1;E++,O=G})===!1)return!1}}})}function A(d,v,x){var M=x,w=!1;return P(d,function(E,R,O,b,S){w===!1&&x===void 0?M=E:M=v(M,E,R,O,b,S),w=!0}),M}function z(d,v){if(!d)throw new Error("geojson is required");f(d,function(x,M,w){if(x.geometry!==null){var E=x.geometry.type,R=x.geometry.coordinates;switch(E){case"LineString":if(v(x,M,w,0,0)===!1)return!1;break;case"Polygon":for(var O=0;O<R.length;O++)if(v(e.lineString(R[O],x.properties),M,w,O)===!1)return!1;break}}})}function N(d,v,x){var M=x;return z(d,function(w,E,R,O){E===0&&x===void 0?M=w:M=v(M,w,E,R,O)}),M}function q(d,v){if(v=v||{},!e.isObject(v))throw new Error("options is invalid");var x=v.featureIndex||0,M=v.multiFeatureIndex||0,w=v.geometryIndex||0,E=v.segmentIndex||0,R=v.properties,O;switch(d.type){case"FeatureCollection":x<0&&(x=d.features.length+x),R=R||d.features[x].properties,O=d.features[x].geometry;break;case"Feature":R=R||d.properties,O=d.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":O=d;break;default:throw new Error("geojson is invalid")}if(O===null)return null;var b=O.coordinates;switch(O.type){case"Point":case"MultiPoint":return null;case"LineString":return E<0&&(E=b.length+E-1),e.lineString([b[E],b[E+1]],R,v);case"Polygon":return w<0&&(w=b.length+w),E<0&&(E=b[w].length+E-1),e.lineString([b[w][E],b[w][E+1]],R,v);case"MultiLineString":return M<0&&(M=b.length+M),E<0&&(E=b[M].length+E-1),e.lineString([b[M][E],b[M][E+1]],R,v);case"MultiPolygon":return M<0&&(M=b.length+M),w<0&&(w=b[M].length+w),E<0&&(E=b[M][w].length-E-1),e.lineString([b[M][w][E],b[M][w][E+1]],R,v)}throw new Error("geojson is invalid")}function k(d,v){if(v=v||{},!e.isObject(v))throw new Error("options is invalid");var x=v.featureIndex||0,M=v.multiFeatureIndex||0,w=v.geometryIndex||0,E=v.coordIndex||0,R=v.properties,O;switch(d.type){case"FeatureCollection":x<0&&(x=d.features.length+x),R=R||d.features[x].properties,O=d.features[x].geometry;break;case"Feature":R=R||d.properties,O=d.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":O=d;break;default:throw new Error("geojson is invalid")}if(O===null)return null;var b=O.coordinates;switch(O.type){case"Point":return e.point(b,R,v);case"MultiPoint":return M<0&&(M=b.length+M),e.point(b[M],R,v);case"LineString":return E<0&&(E=b.length+E),e.point(b[E],R,v);case"Polygon":return w<0&&(w=b.length+w),E<0&&(E=b[w].length+E),e.point(b[w][E],R,v);case"MultiLineString":return M<0&&(M=b.length+M),E<0&&(E=b[M].length+E),e.point(b[M][E],R,v);case"MultiPolygon":return M<0&&(M=b.length+M),w<0&&(w=b[M].length+w),E<0&&(E=b[M][w].length-E),e.point(b[M][w][E],R,v)}throw new Error("geojson is invalid")}t.coordAll=u,t.coordEach=i,t.coordReduce=r,t.featureEach=o,t.featureReduce=l,t.findPoint=k,t.findSegment=q,t.flattenEach=f,t.flattenReduce=B,t.geomEach=p,t.geomReduce=_,t.lineEach=z,t.lineReduce=N,t.propEach=a,t.propReduce=n,t.segmentEach=P,t.segmentReduce=A}),oa=D(t=>{Object.defineProperty(t,"__esModule",{value:!0});var e=vi();function i(r){var a=[1/0,1/0,-1/0,-1/0];return e.coordEach(r,function(n){a[0]>n[0]&&(a[0]=n[0]),a[1]>n[1]&&(a[1]=n[1]),a[2]<n[0]&&(a[2]=n[0]),a[3]<n[1]&&(a[3]=n[1])}),a}i.default=i,t.default=i}),Li=D((t,e)=>{var i=na(),r=yi(),a=vi(),n=oa().default,o=a.featureEach;a.coordEach,r.polygon;var l=r.featureCollection;function u(p){var _=new i(p);return _.insert=function(f){if(f.type!=="Feature")throw new Error("invalid feature");return f.bbox=f.bbox?f.bbox:n(f),i.prototype.insert.call(this,f)},_.load=function(f){var B=[];return Array.isArray(f)?f.forEach(function(P){if(P.type!=="Feature")throw new Error("invalid features");P.bbox=P.bbox?P.bbox:n(P),B.push(P)}):o(f,function(P){if(P.type!=="Feature")throw new Error("invalid features");P.bbox=P.bbox?P.bbox:n(P),B.push(P)}),i.prototype.load.call(this,B)},_.remove=function(f,B){if(f.type!=="Feature")throw new Error("invalid feature");return f.bbox=f.bbox?f.bbox:n(f),i.prototype.remove.call(this,f,B)},_.clear=function(){return i.prototype.clear.call(this)},_.search=function(f){var B=i.prototype.search.call(this,this.toBBox(f));return l(B)},_.collides=function(f){return i.prototype.collides.call(this,this.toBBox(f))},_.all=function(){var f=i.prototype.all.call(this);return l(f)},_.toJSON=function(){return i.prototype.toJSON.call(this)},_.fromJSON=function(f){return i.prototype.fromJSON.call(this,f)},_.toBBox=function(f){var B;if(f.bbox)B=f.bbox;else if(Array.isArray(f)&&f.length===4)B=f;else if(Array.isArray(f)&&f.length===6)B=[f[0],f[1],f[3],f[4]];else if(f.type==="Feature")B=n(f);else if(f.type==="FeatureCollection")B=n(f);else throw new Error("invalid geojson");return{minX:B[0],minY:B[1],maxX:B[2],maxY:B[3]}},_}e.exports=u,e.exports.default=u}),sa=D((t,e)=>{(function(i,r){typeof t=="object"&&typeof e<"u"?e.exports=r():(i=typeof globalThis<"u"?globalThis:i||self,i.polygonClipping=r())})(t,function(){function i(g,s){if(!(g instanceof s))throw new TypeError("Cannot call a class as a function")}function r(g,s){for(var h=0;h<s.length;h++){var c=s[h];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(g,c.key,c)}}function a(g,s,h){return s&&r(g.prototype,s),h&&r(g,h),g}var n=function(){function g(s,h){this.next=null,this.key=s,this.data=h,this.left=null,this.right=null}return g}();function o(g,s){return g>s?1:g<s?-1:0}function l(g,s,h){for(var c=new n(null,null),m=c,y=c;;){var T=h(g,s.key);if(T<0){if(s.left===null)break;if(h(g,s.left.key)<0){var I=s.left;if(s.left=I.right,I.right=s,s=I,s.left===null)break}y.left=s,y=s,s=s.left}else if(T>0){if(s.right===null)break;if(h(g,s.right.key)>0){var I=s.right;if(s.right=I.left,I.left=s,s=I,s.right===null)break}m.right=s,m=s,s=s.right}else break}return m.right=s.left,y.left=s.right,s.left=c.right,s.right=c.left,s}function u(g,s,h,c){var m=new n(g,s);if(h===null)return m.left=m.right=null,m;h=l(g,h,c);var y=c(g,h.key);return y<0?(m.left=h.left,m.right=h,h.left=null):y>=0&&(m.right=h.right,m.left=h,h.right=null),m}function p(g,s,h){var c=null,m=null;if(s){s=l(g,s,h);var y=h(s.key,g);y===0?(c=s.left,m=s.right):y<0?(m=s.right,s.right=null,c=s):(c=s.left,s.left=null,m=s)}return{left:c,right:m}}function _(g,s,h){return s===null?g:(g===null||(s=l(g.key,s,h),s.left=g),s)}function f(g,s,h,c,m){if(g){c(""+s+(h?"└── ":"├── ")+m(g)+`
`);var y=s+(h?"    ":"│   ");g.left&&f(g.left,y,!1,c,m),g.right&&f(g.right,y,!0,c,m)}}var B=function(){function g(s){s===void 0&&(s=o),this._root=null,this._size=0,this._comparator=s}return g.prototype.insert=function(s,h){return this._size++,this._root=u(s,h,this._root,this._comparator)},g.prototype.add=function(s,h){var c=new n(s,h);this._root===null&&(c.left=c.right=null,this._size++,this._root=c);var m=this._comparator,y=l(s,this._root,m),T=m(s,y.key);return T===0?this._root=y:(T<0?(c.left=y.left,c.right=y,y.left=null):T>0&&(c.right=y.right,c.left=y,y.right=null),this._size++,this._root=c),this._root},g.prototype.remove=function(s){this._root=this._remove(s,this._root,this._comparator)},g.prototype._remove=function(s,h,c){var m;if(h===null)return null;h=l(s,h,c);var y=c(s,h.key);return y===0?(h.left===null?m=h.right:(m=l(s,h.left,c),m.right=h.right),this._size--,m):h},g.prototype.pop=function(){var s=this._root;if(s){for(;s.left;)s=s.left;return this._root=l(s.key,this._root,this._comparator),this._root=this._remove(s.key,this._root,this._comparator),{key:s.key,data:s.data}}return null},g.prototype.findStatic=function(s){for(var h=this._root,c=this._comparator;h;){var m=c(s,h.key);if(m===0)return h;m<0?h=h.left:h=h.right}return null},g.prototype.find=function(s){return this._root&&(this._root=l(s,this._root,this._comparator),this._comparator(s,this._root.key)!==0)?null:this._root},g.prototype.contains=function(s){for(var h=this._root,c=this._comparator;h;){var m=c(s,h.key);if(m===0)return!0;m<0?h=h.left:h=h.right}return!1},g.prototype.forEach=function(s,h){for(var c=this._root,m=[],y=!1;!y;)c!==null?(m.push(c),c=c.left):m.length!==0?(c=m.pop(),s.call(h,c),c=c.right):y=!0;return this},g.prototype.range=function(s,h,c,m){for(var y=[],T=this._comparator,I=this._root,j;y.length!==0||I;)if(I)y.push(I),I=I.left;else{if(I=y.pop(),j=T(I.key,h),j>0)break;if(T(I.key,s)>=0&&c.call(m,I))return this;I=I.right}return this},g.prototype.keys=function(){var s=[];return this.forEach(function(h){var c=h.key;return s.push(c)}),s},g.prototype.values=function(){var s=[];return this.forEach(function(h){var c=h.data;return s.push(c)}),s},g.prototype.min=function(){return this._root?this.minNode(this._root).key:null},g.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},g.prototype.minNode=function(s){if(s===void 0&&(s=this._root),s)for(;s.left;)s=s.left;return s},g.prototype.maxNode=function(s){if(s===void 0&&(s=this._root),s)for(;s.right;)s=s.right;return s},g.prototype.at=function(s){for(var h=this._root,c=!1,m=0,y=[];!c;)if(h)y.push(h),h=h.left;else if(y.length>0){if(h=y.pop(),m===s)return h;m++,h=h.right}else c=!0;return null},g.prototype.next=function(s){var h=this._root,c=null;if(s.right){for(c=s.right;c.left;)c=c.left;return c}for(var m=this._comparator;h;){var y=m(s.key,h.key);if(y===0)break;y<0?(c=h,h=h.left):h=h.right}return c},g.prototype.prev=function(s){var h=this._root,c=null;if(s.left!==null){for(c=s.left;c.right;)c=c.right;return c}for(var m=this._comparator;h;){var y=m(s.key,h.key);if(y===0)break;y<0?h=h.left:(c=h,h=h.right)}return c},g.prototype.clear=function(){return this._root=null,this._size=0,this},g.prototype.toList=function(){return z(this._root)},g.prototype.load=function(s,h,c){h===void 0&&(h=[]),c===void 0&&(c=!1);var m=s.length,y=this._comparator;if(c&&k(s,h,0,m-1,y),this._root===null)this._root=P(s,h,0,m),this._size=m;else{var T=q(this.toList(),A(s,h),y);m=this._size+m,this._root=N({head:T},0,m)}return this},g.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(g.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),g.prototype.toString=function(s){s===void 0&&(s=function(c){return String(c.key)});var h=[];return f(this._root,"",!0,function(c){return h.push(c)},s),h.join("")},g.prototype.update=function(s,h,c){var m=this._comparator,y=p(s,this._root,m),T=y.left,I=y.right;m(s,h)<0?I=u(h,c,I,m):T=u(h,c,T,m),this._root=_(T,I,m)},g.prototype.split=function(s){return p(s,this._root,this._comparator)},g}();function P(g,s,h,c){var m=c-h;if(m>0){var y=h+Math.floor(m/2),T=g[y],I=s[y],j=new n(T,I);return j.left=P(g,s,h,y),j.right=P(g,s,y+1,c),j}return null}function A(g,s){for(var h=new n(null,null),c=h,m=0;m<g.length;m++)c=c.next=new n(g[m],s[m]);return c.next=null,h.next}function z(g){for(var s=g,h=[],c=!1,m=new n(null,null),y=m;!c;)s?(h.push(s),s=s.left):h.length>0?(s=y=y.next=h.pop(),s=s.right):c=!0;return y.next=null,m.next}function N(g,s,h){var c=h-s;if(c>0){var m=s+Math.floor(c/2),y=N(g,s,m),T=g.head;return T.left=y,g.head=g.head.next,T.right=N(g,m+1,h),T}return null}function q(g,s,h){for(var c=new n(null,null),m=c,y=g,T=s;y!==null&&T!==null;)h(y.key,T.key)<0?(m.next=y,y=y.next):(m.next=T,T=T.next),m=m.next;return y!==null?m.next=y:T!==null&&(m.next=T),c.next}function k(g,s,h,c,m){if(!(h>=c)){for(var y=g[h+c>>1],T=h-1,I=c+1;;){do T++;while(m(g[T],y)<0);do I--;while(m(g[I],y)>0);if(T>=I)break;var j=g[T];g[T]=g[I],g[I]=j,j=s[T],s[T]=s[I],s[I]=j}k(g,s,h,I,m),k(g,s,I+1,c,m)}}var d=function(g,s){return g.ll.x<=s.x&&s.x<=g.ur.x&&g.ll.y<=s.y&&s.y<=g.ur.y},v=function(g,s){if(s.ur.x<g.ll.x||g.ur.x<s.ll.x||s.ur.y<g.ll.y||g.ur.y<s.ll.y)return null;var h=g.ll.x<s.ll.x?s.ll.x:g.ll.x,c=g.ur.x<s.ur.x?g.ur.x:s.ur.x,m=g.ll.y<s.ll.y?s.ll.y:g.ll.y,y=g.ur.y<s.ur.y?g.ur.y:s.ur.y;return{ll:{x:h,y:m},ur:{x:c,y}}},x=Number.EPSILON;x===void 0&&(x=Math.pow(2,-52));var M=x*x,w=function(g,s){if(-x<g&&g<x&&-x<s&&s<x)return 0;var h=g-s;return h*h<M*g*s?0:g<s?-1:1},E=function(){function g(){i(this,g),this.reset()}return a(g,[{key:"reset",value:function(){this.xRounder=new R,this.yRounder=new R}},{key:"round",value:function(s,h){return{x:this.xRounder.round(s),y:this.yRounder.round(h)}}}]),g}(),R=function(){function g(){i(this,g),this.tree=new B,this.round(0)}return a(g,[{key:"round",value:function(s){var h=this.tree.add(s),c=this.tree.prev(h);if(c!==null&&w(h.key,c.key)===0)return this.tree.remove(s),c.key;var m=this.tree.next(h);return m!==null&&w(h.key,m.key)===0?(this.tree.remove(s),m.key):s}}]),g}(),O=new E,b=function(g,s){return g.x*s.y-g.y*s.x},S=function(g,s){return g.x*s.x+g.y*s.y},C=function(g,s,h){var c={x:s.x-g.x,y:s.y-g.y},m={x:h.x-g.x,y:h.y-g.y},y=b(c,m);return w(y,0)},G=function(g){return Math.sqrt(S(g,g))},V=function(g,s,h){var c={x:s.x-g.x,y:s.y-g.y},m={x:h.x-g.x,y:h.y-g.y};return b(m,c)/G(m)/G(c)},J=function(g,s,h){var c={x:s.x-g.x,y:s.y-g.y},m={x:h.x-g.x,y:h.y-g.y};return S(m,c)/G(m)/G(c)},X=function(g,s,h){return s.y===0?null:{x:g.x+s.x/s.y*(h-g.y),y:h}},rt=function(g,s,h){return s.x===0?null:{x:h,y:g.y+s.y/s.x*(h-g.x)}},Et=function(g,s,h,c){if(s.x===0)return rt(h,c,g.x);if(c.x===0)return rt(g,s,h.x);if(s.y===0)return X(h,c,g.y);if(c.y===0)return X(g,s,h.y);var m=b(s,c);if(m==0)return null;var y={x:h.x-g.x,y:h.y-g.y},T=b(y,s)/m,I=b(y,c)/m,j=g.x+I*s.x,F=h.x+T*c.x,K=g.y+I*s.y,H=h.y+T*c.y,U=(j+F)/2,it=(K+H)/2;return{x:U,y:it}},et=function(){a(g,null,[{key:"compare",value:function(s,h){var c=g.comparePoints(s.point,h.point);return c!==0?c:(s.point!==h.point&&s.link(h),s.isLeft!==h.isLeft?s.isLeft?1:-1:Z.compare(s.segment,h.segment))}},{key:"comparePoints",value:function(s,h){return s.x<h.x?-1:s.x>h.x?1:s.y<h.y?-1:s.y>h.y?1:0}}]);function g(s,h){i(this,g),s.events===void 0?s.events=[this]:s.events.push(this),this.point=s,this.isLeft=h}return a(g,[{key:"link",value:function(s){if(s.point===this.point)throw new Error("Tried to link already linked events");for(var h=s.point.events,c=0,m=h.length;c<m;c++){var y=h[c];this.point.events.push(y),y.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var s=this.point.events.length,h=0;h<s;h++){var c=this.point.events[h];if(c.segment.consumedBy===void 0)for(var m=h+1;m<s;m++){var y=this.point.events[m];y.consumedBy===void 0&&c.otherSE.point.events===y.otherSE.point.events&&c.segment.consume(y.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var s=[],h=0,c=this.point.events.length;h<c;h++){var m=this.point.events[h];m!==this&&!m.segment.ringOut&&m.segment.isInResult()&&s.push(m)}return s}},{key:"getLeftmostComparator",value:function(s){var h=this,c=new Map,m=function(y){var T=y.otherSE;c.set(y,{sine:V(h.point,s.point,T.point),cosine:J(h.point,s.point,T.point)})};return function(y,T){c.has(y)||m(y),c.has(T)||m(T);var I=c.get(y),j=I.sine,F=I.cosine,K=c.get(T),H=K.sine,U=K.cosine;return j>=0&&H>=0?F<U?1:F>U?-1:0:j<0&&H<0?F<U?-1:F>U?1:0:H<j?-1:H>j?1:0}}}]),g}(),yt=0,Z=function(){a(g,null,[{key:"compare",value:function(s,h){var c=s.leftSE.point.x,m=h.leftSE.point.x,y=s.rightSE.point.x,T=h.rightSE.point.x;if(T<c)return 1;if(y<m)return-1;var I=s.leftSE.point.y,j=h.leftSE.point.y,F=s.rightSE.point.y,K=h.rightSE.point.y;if(c<m){if(j<I&&j<F)return 1;if(j>I&&j>F)return-1;var H=s.comparePoint(h.leftSE.point);if(H<0)return 1;if(H>0)return-1;var U=h.comparePoint(s.rightSE.point);return U!==0?U:-1}if(c>m){if(I<j&&I<K)return-1;if(I>j&&I>K)return 1;var it=h.comparePoint(s.leftSE.point);if(it!==0)return it;var W=s.comparePoint(h.rightSE.point);return W<0?1:W>0?-1:1}if(I<j)return-1;if(I>j)return 1;if(y<T){var at=h.comparePoint(s.rightSE.point);if(at!==0)return at}if(y>T){var pt=s.comparePoint(h.rightSE.point);if(pt<0)return 1;if(pt>0)return-1}if(y!==T){var ct=F-I,_t=y-c,ht=K-j,wt=T-m;if(ct>_t&&ht<wt)return 1;if(ct<_t&&ht>wt)return-1}return y>T?1:y<T||F<K?-1:F>K?1:s.id<h.id?-1:s.id>h.id?1:0}}]);function g(s,h,c,m){i(this,g),this.id=++yt,this.leftSE=s,s.segment=this,s.otherSE=h,this.rightSE=h,h.segment=this,h.otherSE=s,this.rings=c,this.windings=m}return a(g,[{key:"replaceRightSE",value:function(s){this.rightSE=s,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var s=this.leftSE.point.y,h=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:s<h?s:h},ur:{x:this.rightSE.point.x,y:s>h?s:h}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(s){return s.x===this.leftSE.point.x&&s.y===this.leftSE.point.y||s.x===this.rightSE.point.x&&s.y===this.rightSE.point.y}},{key:"comparePoint",value:function(s){if(this.isAnEndpoint(s))return 0;var h=this.leftSE.point,c=this.rightSE.point,m=this.vector();if(h.x===c.x)return s.x===h.x?0:s.x<h.x?1:-1;var y=(s.y-h.y)/m.y,T=h.x+y*m.x;if(s.x===T)return 0;var I=(s.x-h.x)/m.x,j=h.y+I*m.y;return s.y===j?0:s.y<j?-1:1}},{key:"getIntersection",value:function(s){var h=this.bbox(),c=s.bbox(),m=v(h,c);if(m===null)return null;var y=this.leftSE.point,T=this.rightSE.point,I=s.leftSE.point,j=s.rightSE.point,F=d(h,I)&&this.comparePoint(I)===0,K=d(c,y)&&s.comparePoint(y)===0,H=d(h,j)&&this.comparePoint(j)===0,U=d(c,T)&&s.comparePoint(T)===0;if(K&&F)return U&&!H?T:!U&&H?j:null;if(K)return H&&y.x===j.x&&y.y===j.y?null:y;if(F)return U&&T.x===I.x&&T.y===I.y?null:I;if(U&&H)return null;if(U)return T;if(H)return j;var it=Et(y,this.vector(),I,s.vector());return it===null||!d(m,it)?null:O.round(it.x,it.y)}},{key:"split",value:function(s){var h=[],c=s.events!==void 0,m=new et(s,!0),y=new et(s,!1),T=this.rightSE;this.replaceRightSE(y),h.push(y),h.push(m);var I=new g(m,T,this.rings.slice(),this.windings.slice());return et.comparePoints(I.leftSE.point,I.rightSE.point)>0&&I.swapEvents(),et.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),c&&(m.checkForConsuming(),y.checkForConsuming()),h}},{key:"swapEvents",value:function(){var s=this.rightSE;this.rightSE=this.leftSE,this.leftSE=s,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var h=0,c=this.windings.length;h<c;h++)this.windings[h]*=-1}},{key:"consume",value:function(s){for(var h=this,c=s;h.consumedBy;)h=h.consumedBy;for(;c.consumedBy;)c=c.consumedBy;var m=g.compare(h,c);if(m!==0){if(m>0){var y=h;h=c,c=y}if(h.prev===c){var T=h;h=c,c=T}for(var I=0,j=c.rings.length;I<j;I++){var F=c.rings[I],K=c.windings[I],H=h.rings.indexOf(F);H===-1?(h.rings.push(F),h.windings.push(K)):h.windings[H]+=K}c.rings=null,c.windings=null,c.consumedBy=h,c.leftSE.consumedBy=h.leftSE,c.rightSE.consumedBy=h.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var s=this.prev.consumedBy||this.prev;this._beforeState=s.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var s=this.beforeState();this._afterState={rings:s.rings.slice(0),windings:s.windings.slice(0),multiPolys:[]};for(var h=this._afterState.rings,c=this._afterState.windings,m=this._afterState.multiPolys,y=0,T=this.rings.length;y<T;y++){var I=this.rings[y],j=this.windings[y],F=h.indexOf(I);F===-1?(h.push(I),c.push(j)):c[F]+=j}for(var K=[],H=[],U=0,it=h.length;U<it;U++)if(c[U]!==0){var W=h[U],at=W.poly;if(H.indexOf(at)===-1)if(W.isExterior)K.push(at);else{H.indexOf(at)===-1&&H.push(at);var pt=K.indexOf(W.poly);pt!==-1&&K.splice(pt,1)}}for(var ct=0,_t=K.length;ct<_t;ct++){var ht=K[ct].multiPoly;m.indexOf(ht)===-1&&m.push(ht)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var s=this.beforeState().multiPolys,h=this.afterState().multiPolys;switch(vt.type){case"union":{var c=s.length===0,m=h.length===0;this._isInResult=c!==m;break}case"intersection":{var y,T;s.length<h.length?(y=s.length,T=h.length):(y=h.length,T=s.length),this._isInResult=T===vt.numMultiPolys&&y<T;break}case"xor":{var I=Math.abs(s.length-h.length);this._isInResult=I%2===1;break}case"difference":{var j=function(F){return F.length===1&&F[0].isSubject};this._isInResult=j(s)!==j(h);break}default:throw new Error("Unrecognized operation type found ".concat(vt.type))}return this._isInResult}}],[{key:"fromRing",value:function(s,h,c){var m,y,T,I=et.comparePoints(s,h);if(I<0)m=s,y=h,T=1;else if(I>0)m=h,y=s,T=-1;else throw new Error("Tried to create degenerate segment at [".concat(s.x,", ").concat(s.y,"]"));var j=new et(m,!0),F=new et(y,!1);return new g(j,F,[c],[T])}}]),g}(),Mt=function(){function g(s,h,c){if(i(this,g),!Array.isArray(s)||s.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=h,this.isExterior=c,this.segments=[],typeof s[0][0]!="number"||typeof s[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var m=O.round(s[0][0],s[0][1]);this.bbox={ll:{x:m.x,y:m.y},ur:{x:m.x,y:m.y}};for(var y=m,T=1,I=s.length;T<I;T++){if(typeof s[T][0]!="number"||typeof s[T][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var j=O.round(s[T][0],s[T][1]);j.x===y.x&&j.y===y.y||(this.segments.push(Z.fromRing(y,j,this)),j.x<this.bbox.ll.x&&(this.bbox.ll.x=j.x),j.y<this.bbox.ll.y&&(this.bbox.ll.y=j.y),j.x>this.bbox.ur.x&&(this.bbox.ur.x=j.x),j.y>this.bbox.ur.y&&(this.bbox.ur.y=j.y),y=j)}(m.x!==y.x||m.y!==y.y)&&this.segments.push(Z.fromRing(y,m,this))}return a(g,[{key:"getSweepEvents",value:function(){for(var s=[],h=0,c=this.segments.length;h<c;h++){var m=this.segments[h];s.push(m.leftSE),s.push(m.rightSE)}return s}}]),g}(),xt=function(){function g(s,h){if(i(this,g),!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Mt(s[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var c=1,m=s.length;c<m;c++){var y=new Mt(s[c],this,!1);y.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=y.bbox.ll.x),y.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=y.bbox.ll.y),y.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=y.bbox.ur.x),y.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=y.bbox.ur.y),this.interiorRings.push(y)}this.multiPoly=h}return a(g,[{key:"getSweepEvents",value:function(){for(var s=this.exteriorRing.getSweepEvents(),h=0,c=this.interiorRings.length;h<c;h++)for(var m=this.interiorRings[h].getSweepEvents(),y=0,T=m.length;y<T;y++)s.push(m[y]);return s}}]),g}(),Ui=function(){function g(s,h){if(i(this,g),!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof s[0][0][0]=="number"&&(s=[s])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var c=0,m=s.length;c<m;c++){var y=new xt(s[c],this);y.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=y.bbox.ll.x),y.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=y.bbox.ll.y),y.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=y.bbox.ur.x),y.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=y.bbox.ur.y),this.polys.push(y)}this.isSubject=h}return a(g,[{key:"getSweepEvents",value:function(){for(var s=[],h=0,c=this.polys.length;h<c;h++)for(var m=this.polys[h].getSweepEvents(),y=0,T=m.length;y<T;y++)s.push(m[y]);return s}}]),g}(),so=function(){a(g,null,[{key:"factory",value:function(s){for(var h=[],c=0,m=s.length;c<m;c++){var y=s[c];if(!(!y.isInResult()||y.ringOut)){for(var T=null,I=y.leftSE,j=y.rightSE,F=[I],K=I.point,H=[];T=I,I=j,F.push(I),I.point!==K;)for(;;){var U=I.getAvailableLinkedEvents();if(U.length===0){var it=F[0].point,W=F[F.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(it.x,",")+" ".concat(it.y,"]. Last matching segment found ends at")+" [".concat(W.x,", ").concat(W.y,"]."))}if(U.length===1){j=U[0].otherSE;break}for(var at=null,pt=0,ct=H.length;pt<ct;pt++)if(H[pt].point===I.point){at=pt;break}if(at!==null){var _t=H.splice(at)[0],ht=F.splice(_t.index);ht.unshift(ht[0].otherSE),h.push(new g(ht.reverse()));continue}H.push({index:F.length,point:I.point});var wt=I.getLeftmostComparator(T);j=U.sort(wt)[0].otherSE;break}h.push(new g(F))}}return h}}]);function g(s){i(this,g),this.events=s;for(var h=0,c=s.length;h<c;h++)s[h].segment.ringOut=this;this.poly=null}return a(g,[{key:"getGeom",value:function(){for(var s=this.events[0].point,h=[s],c=1,m=this.events.length-1;c<m;c++){var y=this.events[c].point,T=this.events[c+1].point;C(y,s,T)!==0&&(h.push(y),s=y)}if(h.length===1)return null;var I=h[0],j=h[1];C(I,s,j)===0&&h.shift(),h.push(h[0]);for(var F=this.isExteriorRing()?1:-1,K=this.isExteriorRing()?0:h.length-1,H=this.isExteriorRing()?h.length:-1,U=[],it=K;it!=H;it+=F)U.push([h[it].x,h[it].y]);return U}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var s=this.enclosingRing();this._isExteriorRing=s?!s.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var s=this.events[0],h=1,c=this.events.length;h<c;h++){var m=this.events[h];et.compare(s,m)>0&&(s=m)}for(var y=s.segment.prevInResult(),T=y?y.prevInResult():null;;){if(!y)return null;if(!T)return y.ringOut;if(T.ringOut!==y.ringOut)return T.ringOut.enclosingRing()!==y.ringOut?y.ringOut:y.ringOut.enclosingRing();y=T.prevInResult(),T=y?y.prevInResult():null}}}]),g}(),Vi=function(){function g(s){i(this,g),this.exteriorRing=s,s.poly=this,this.interiorRings=[]}return a(g,[{key:"addInterior",value:function(s){this.interiorRings.push(s),s.poly=this}},{key:"getGeom",value:function(){var s=[this.exteriorRing.getGeom()];if(s[0]===null)return null;for(var h=0,c=this.interiorRings.length;h<c;h++){var m=this.interiorRings[h].getGeom();m!==null&&s.push(m)}return s}}]),g}(),lo=function(){function g(s){i(this,g),this.rings=s,this.polys=this._composePolys(s)}return a(g,[{key:"getGeom",value:function(){for(var s=[],h=0,c=this.polys.length;h<c;h++){var m=this.polys[h].getGeom();m!==null&&s.push(m)}return s}},{key:"_composePolys",value:function(s){for(var h=[],c=0,m=s.length;c<m;c++){var y=s[c];if(!y.poly)if(y.isExteriorRing())h.push(new Vi(y));else{var T=y.enclosingRing();T.poly||h.push(new Vi(T)),T.poly.addInterior(y)}}return h}}]),g}(),ho=function(){function g(s){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Z.compare;i(this,g),this.queue=s,this.tree=new B(h),this.segments=[]}return a(g,[{key:"process",value:function(s){var h=s.segment,c=[];if(s.consumedBy)return s.isLeft?this.queue.remove(s.otherSE):this.tree.remove(h),c;var m=s.isLeft?this.tree.insert(h):this.tree.find(h);if(!m)throw new Error("Unable to find segment #".concat(h.id," ")+"[".concat(h.leftSE.point.x,", ").concat(h.leftSE.point.y,"] -> ")+"[".concat(h.rightSE.point.x,", ").concat(h.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var y=m,T=m,I=void 0,j=void 0;I===void 0;)y=this.tree.prev(y),y===null?I=null:y.key.consumedBy===void 0&&(I=y.key);for(;j===void 0;)T=this.tree.next(T),T===null?j=null:T.key.consumedBy===void 0&&(j=T.key);if(s.isLeft){var F=null;if(I){var K=I.getIntersection(h);if(K!==null&&(h.isAnEndpoint(K)||(F=K),!I.isAnEndpoint(K)))for(var H=this._splitSafely(I,K),U=0,it=H.length;U<it;U++)c.push(H[U])}var W=null;if(j){var at=j.getIntersection(h);if(at!==null&&(h.isAnEndpoint(at)||(W=at),!j.isAnEndpoint(at)))for(var pt=this._splitSafely(j,at),ct=0,_t=pt.length;ct<_t;ct++)c.push(pt[ct])}if(F!==null||W!==null){var ht=null;if(F===null)ht=W;else if(W===null)ht=F;else{var wt=et.comparePoints(F,W);ht=wt<=0?F:W}this.queue.remove(h.rightSE),c.push(h.rightSE);for(var re=h.split(ht),Gt=0,zt=re.length;Gt<zt;Gt++)c.push(re[Gt])}c.length>0?(this.tree.remove(h),c.push(s)):(this.segments.push(h),h.prev=I)}else{if(I&&j){var Lt=I.getIntersection(j);if(Lt!==null){if(!I.isAnEndpoint(Lt))for(var ae=this._splitSafely(I,Lt),Nt=0,ti=ae.length;Nt<ti;Nt++)c.push(ae[Nt]);if(!j.isAnEndpoint(Lt))for(var ne=this._splitSafely(j,Lt),oe=0,ei=ne.length;oe<ei;oe++)c.push(ne[oe])}}this.tree.remove(h)}return c}},{key:"_splitSafely",value:function(s,h){this.tree.remove(s);var c=s.rightSE;this.queue.remove(c);var m=s.split(h);return m.push(c),s.consumedBy===void 0&&this.tree.insert(s),m}}]),g}(),Ki=typeof process<"u"&&Ji.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,uo=typeof process<"u"&&Ji.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,po=function(){function g(){i(this,g)}return a(g,[{key:"run",value:function(s,h,c){vt.type=s,O.reset();for(var m=[new Ui(h,!0)],y=0,T=c.length;y<T;y++)m.push(new Ui(c[y],!1));if(vt.numMultiPolys=m.length,vt.type==="difference")for(var I=m[0],j=1;j<m.length;)v(m[j].bbox,I.bbox)!==null?j++:m.splice(j,1);if(vt.type==="intersection"){for(var F=0,K=m.length;F<K;F++)for(var H=m[F],U=F+1,it=m.length;U<it;U++)if(v(H.bbox,m[U].bbox)===null)return[]}for(var W=new B(et.compare),at=0,pt=m.length;at<pt;at++)for(var ct=m[at].getSweepEvents(),_t=0,ht=ct.length;_t<ht;_t++)if(W.insert(ct[_t]),W.size>Ki)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var wt=new ho(W),re=W.size,Gt=W.pop();Gt;){var zt=Gt.key;if(W.size===re){var Lt=zt.segment;throw new Error("Unable to pop() ".concat(zt.isLeft?"left":"right"," SweepEvent ")+"[".concat(zt.point.x,", ").concat(zt.point.y,"] from segment #").concat(Lt.id," ")+"[".concat(Lt.leftSE.point.x,", ").concat(Lt.leftSE.point.y,"] -> ")+"[".concat(Lt.rightSE.point.x,", ").concat(Lt.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(W.size>Ki)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(wt.segments.length>uo)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var ae=wt.process(zt),Nt=0,ti=ae.length;Nt<ti;Nt++){var ne=ae[Nt];ne.consumedBy===void 0&&W.insert(ne)}re=W.size,Gt=W.pop()}O.reset();var oe=so.factory(wt.segments),ei=new lo(oe);return ei.getGeom()}}]),g}(),vt=new po,co=function(g){for(var s=arguments.length,h=new Array(s>1?s-1:0),c=1;c<s;c++)h[c-1]=arguments[c];return vt.run("union",g,h)},go=function(g){for(var s=arguments.length,h=new Array(s>1?s-1:0),c=1;c<s;c++)h[c-1]=arguments[c];return vt.run("intersection",g,h)},fo=function(g){for(var s=arguments.length,h=new Array(s>1?s-1:0),c=1;c<s;c++)h[c-1]=arguments[c];return vt.run("xor",g,h)},_o=function(g){for(var s=arguments.length,h=new Array(s>1?s-1:0),c=1;c<s;c++)h[c-1]=arguments[c];return vt.run("difference",g,h)},mo={union:co,intersection:go,xor:fo,difference:_o};return mo})});Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(this===null)throw new TypeError("Array.prototype.findIndex called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");for(var e=Object(this),i=e.length>>>0,r=arguments[1],a=0;a<i;a++)if(t.call(r,e[a],a,e))return a;return-1},Array.prototype.find=Array.prototype.find||function(t){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof t!="function")throw new TypeError("callback must be a function");for(var e=Object(this),i=e.length>>>0,r=arguments[1],a=0;a<i;a++){var n=e[a];if(t.call(r,n,a,e))return n}},typeof Object.assign!="function"&&(Object.assign=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var i=arguments[e];if(i!=null)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t}),function(t){t.forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(this==null)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(r===0)return!1;var a=e|0,n=Math.max(a>=0?a:r-Math.abs(a),0);function o(l,u){return l===u||typeof l=="number"&&typeof u=="number"&&isNaN(l)&&isNaN(u)}for(;n<r;){if(o(i[n],t))return!0;n++}return!1}});var la={name:"@geoman-io/leaflet-geoman-free",version:"2.16.0",description:"A Leaflet Plugin For Editing Geometry Layers in Leaflet 1.0",keywords:["leaflet","geoman","polygon management","geometry editing","map data","map overlay","polygon","geojson","leaflet-draw","data-field-geojson","ui-leaflet-draw"],files:["dist"],main:"dist/leaflet-geoman.js",types:"dist/leaflet-geoman.d.ts",dependencies:{"@turf/boolean-contains":"^6.5.0","@turf/kinks":"^6.5.0","@turf/line-intersect":"^6.5.0","@turf/line-split":"^6.5.0",lodash:"4.17.21","polygon-clipping":"0.15.3"},devDependencies:{"@types/leaflet":"^1.7.9","cross-env":"^7.0.3",cypress:"6.9.1","cypress-wait-until":"1.7.1",esbuild:"^0.20.0",eslint:"8.56.0","eslint-config-airbnb-base":"15.0.0","eslint-config-prettier":"9.1.0","eslint-plugin-cypress":"2.15.1","eslint-plugin-import":"2.29.1",husky:"^9.0.7",leaflet:"1.9.3","lint-staged":"^15.2.1",prettier:"3.2.4","prosthetic-hand":"1.3.1","ts-node":"^10.9.2"},peerDependencies:{leaflet:"^1.2.0"},scripts:{start:"npm run dev",dev:"cross-env DEV=true ts-node bundle.mjs",build:"ts-node bundle.mjs",test:"cypress run",cypress:"cypress open",prepare:"npm run build && husky","eslint-check":"eslint --print-config . | eslint-config-prettier-check",eslint:'eslint "{src,cypress,demo}/**/*.js" --fix ',prettier:'prettier --write "{src,cypress,demo}/**/*.{js,css}" --log-level=warn',lint:"npm run eslint && npm run prettier"},repository:{type:"git",url:"git://github.com/geoman-io/leaflet-geoman.git"},author:{name:"Sumit Kumar",email:"sales@geoman.io",url:"http://geoman.io"},license:"MIT",bugs:{url:"https://github.com/geoman-io/leaflet-geoman/issues"},homepage:"https://geoman.io",prettier:{trailingComma:"es5",tabWidth:2,semi:!0,singleQuote:!0},"lint-staged":{"*.js":'eslint "{src,cypress,demo}/**/*.js" --fix',"*.{js,css,md}":'prettier --write "{src,cypress,demo}/**/*.{js,css}"'}},bi=ut(Fe()),ha={tooltips:{placeMarker:"Click to place marker",firstVertex:"Click to place first vertex",continueLine:"Click to continue drawing",finishLine:"Click any existing marker to finish",finishPoly:"Click first marker to finish",finishRect:"Click to finish",startCircle:"Click to place circle center",finishCircle:"Click to finish circle",placeCircleMarker:"Click to place circle marker",placeText:"Click to place text"},actions:{finish:"Finish",cancel:"Cancel",removeLastVertex:"Remove Last Vertex"},buttonTitles:{drawMarkerButton:"Draw Marker",drawPolyButton:"Draw Polygons",drawLineButton:"Draw Polyline",drawCircleButton:"Draw Circle",drawRectButton:"Draw Rectangle",editButton:"Edit Layers",dragButton:"Drag Layers",cutButton:"Cut Layers",deleteButton:"Remove Layers",drawCircleMarkerButton:"Draw Circle Marker",snappingButton:"Snap dragged marker to other layers and vertices",pinningButton:"Pin shared vertices together",rotateButton:"Rotate Layers",drawTextButton:"Draw Text",scaleButton:"Scale Layers",autoTracingButton:"Auto trace Line"},measurements:{totalLength:"Length",segmentLength:"Segment length",area:"Area",radius:"Radius",perimeter:"Perimeter",height:"Height",width:"Width",coordinates:"Position",coordinatesMarker:"Position Marker"}},ua={tooltips:{placeMarker:"Platziere den Marker mit Klick",firstVertex:"Platziere den ersten Marker mit Klick",continueLine:"Klicke, um weiter zu zeichnen",finishLine:"Beende mit Klick auf existierenden Marker",finishPoly:"Beende mit Klick auf ersten Marker",finishRect:"Beende mit Klick",startCircle:"Platziere das Kreiszentrum mit Klick",finishCircle:"Beende den Kreis mit Klick",placeCircleMarker:"Platziere den Kreismarker mit Klick",placeText:"Platziere den Text mit Klick"},actions:{finish:"Beenden",cancel:"Abbrechen",removeLastVertex:"Letzten Vertex löschen"},buttonTitles:{drawMarkerButton:"Marker zeichnen",drawPolyButton:"Polygon zeichnen",drawLineButton:"Polyline zeichnen",drawCircleButton:"Kreis zeichnen",drawRectButton:"Rechteck zeichnen",editButton:"Layer editieren",dragButton:"Layer bewegen",cutButton:"Layer schneiden",deleteButton:"Layer löschen",drawCircleMarkerButton:"Kreismarker zeichnen",snappingButton:"Bewegter Layer an andere Layer oder Vertexe einhacken",pinningButton:"Vertexe an der gleichen Position verknüpfen",rotateButton:"Layer drehen",drawTextButton:"Text zeichnen",scaleButton:"Layer skalieren",autoTracingButton:"Linie automatisch nachzeichen"},measurements:{totalLength:"Länge",segmentLength:"Segment Länge",area:"Fläche",radius:"Radius",perimeter:"Umfang",height:"Höhe",width:"Breite",coordinates:"Position",coordinatesMarker:"Position Marker"}},pa={tooltips:{placeMarker:"Clicca per posizionare un Marker",firstVertex:"Clicca per posizionare il primo vertice",continueLine:"Clicca per continuare a disegnare",finishLine:"Clicca qualsiasi marker esistente per terminare",finishPoly:"Clicca il primo marker per terminare",finishRect:"Clicca per terminare",startCircle:"Clicca per posizionare il punto centrale del cerchio",finishCircle:"Clicca per terminare il cerchio",placeCircleMarker:"Clicca per posizionare un Marker del cherchio"},actions:{finish:"Termina",cancel:"Annulla",removeLastVertex:"Rimuovi l'ultimo vertice"},buttonTitles:{drawMarkerButton:"Disegna Marker",drawPolyButton:"Disegna Poligoni",drawLineButton:"Disegna Polilinea",drawCircleButton:"Disegna Cerchio",drawRectButton:"Disegna Rettangolo",editButton:"Modifica Livelli",dragButton:"Sposta Livelli",cutButton:"Ritaglia Livelli",deleteButton:"Elimina Livelli",drawCircleMarkerButton:"Disegna Marker del Cerchio",snappingButton:"Snap ha trascinato il pennarello su altri strati e vertici",pinningButton:"Pin condiviso vertici insieme",rotateButton:"Ruota livello"}},ca={tooltips:{placeMarker:"Klik untuk menempatkan marker",firstVertex:"Klik untuk menempatkan vertex pertama",continueLine:"Klik untuk meneruskan digitasi",finishLine:"Klik pada sembarang marker yang ada untuk mengakhiri",finishPoly:"Klik marker pertama untuk mengakhiri",finishRect:"Klik untuk mengakhiri",startCircle:"Klik untuk menempatkan titik pusat lingkaran",finishCircle:"Klik untuk mengakhiri lingkaran",placeCircleMarker:"Klik untuk menempatkan penanda lingkarann"},actions:{finish:"Selesai",cancel:"Batal",removeLastVertex:"Hilangkan Vertex Terakhir"},buttonTitles:{drawMarkerButton:"Digitasi Marker",drawPolyButton:"Digitasi Polygon",drawLineButton:"Digitasi Polyline",drawCircleButton:"Digitasi Lingkaran",drawRectButton:"Digitasi Segi Empat",editButton:"Edit Layer",dragButton:"Geser Layer",cutButton:"Potong Layer",deleteButton:"Hilangkan Layer",drawCircleMarkerButton:"Digitasi Penanda Lingkaran",snappingButton:"Jepretkan penanda yang ditarik ke lapisan dan simpul lain",pinningButton:"Sematkan simpul bersama bersama",rotateButton:"Putar lapisan"}},da={tooltips:{placeMarker:"Adaugă un punct",firstVertex:"Apasă aici pentru a adăuga primul Vertex",continueLine:"Apasă aici pentru a continua desenul",finishLine:"Apasă pe orice obiect pentru a finisa desenul",finishPoly:"Apasă pe primul obiect pentru a finisa",finishRect:"Apasă pentru a finisa",startCircle:"Apasă pentru a desena un cerc",finishCircle:"Apasă pentru a finisa un cerc",placeCircleMarker:"Adaugă un punct"},actions:{finish:"Termină",cancel:"Anulează",removeLastVertex:"Șterge ultimul Vertex"},buttonTitles:{drawMarkerButton:"Adaugă o bulină",drawPolyButton:"Desenează un poligon",drawLineButton:"Desenează o linie",drawCircleButton:"Desenează un cerc",drawRectButton:"Desenează un dreptunghi",editButton:"Editează straturile",dragButton:"Mută straturile",cutButton:"Taie straturile",deleteButton:"Șterge straturile",drawCircleMarkerButton:"Desenează marcatorul cercului",snappingButton:"Fixați marcatorul glisat pe alte straturi și vârfuri",pinningButton:"Fixați vârfurile partajate împreună",rotateButton:"Rotiți stratul"}},ga={tooltips:{placeMarker:"Нажмите, чтобы нанести маркер",firstVertex:"Нажмите, чтобы нанести первый объект",continueLine:"Нажмите, чтобы продолжить рисование",finishLine:"Нажмите любой существующий маркер для завершения",finishPoly:"Выберите первую точку, чтобы закончить",finishRect:"Нажмите, чтобы закончить",startCircle:"Нажмите, чтобы добавить центр круга",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Нажмите, чтобы нанести круговой маркер"},actions:{finish:"Завершить",cancel:"Отменить",removeLastVertex:"Отменить последнее действие"},buttonTitles:{drawMarkerButton:"Добавить маркер",drawPolyButton:"Рисовать полигон",drawLineButton:"Рисовать кривую",drawCircleButton:"Рисовать круг",drawRectButton:"Рисовать прямоугольник",editButton:"Редактировать слой",dragButton:"Перенести слой",cutButton:"Вырезать слой",deleteButton:"Удалить слой",drawCircleMarkerButton:"Добавить круговой маркер",snappingButton:"Привязать перетаскиваемый маркер к другим слоям и вершинам",pinningButton:"Связать общие точки вместе",rotateButton:"Поворот слоя"}},fa={tooltips:{placeMarker:"Presiona para colocar un marcador",firstVertex:"Presiona para colocar el primer vértice",continueLine:"Presiona para continuar dibujando",finishLine:"Presiona cualquier marcador existente para finalizar",finishPoly:"Presiona el primer marcador para finalizar",finishRect:"Presiona para finalizar",startCircle:"Presiona para colocar el centro del círculo",finishCircle:"Presiona para finalizar el círculo",placeCircleMarker:"Presiona para colocar un marcador de círculo"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Eliminar último vértice"},buttonTitles:{drawMarkerButton:"Dibujar Marcador",drawPolyButton:"Dibujar Polígono",drawLineButton:"Dibujar Línea",drawCircleButton:"Dibujar Círculo",drawRectButton:"Dibujar Rectángulo",editButton:"Editar Capas",dragButton:"Arrastrar Capas",cutButton:"Cortar Capas",deleteButton:"Eliminar Capas",drawCircleMarkerButton:"Dibujar Marcador de Círculo",snappingButton:"El marcador de Snap arrastrado a otras capas y vértices",pinningButton:"Fijar juntos los vértices compartidos",rotateButton:"Rotar capa"}},_a={tooltips:{placeMarker:"Klik om een marker te plaatsen",firstVertex:"Klik om het eerste punt te plaatsen",continueLine:"Klik om te blijven tekenen",finishLine:"Klik op een bestaand punt om te beëindigen",finishPoly:"Klik op het eerst punt om te beëindigen",finishRect:"Klik om te beëindigen",startCircle:"Klik om het middelpunt te plaatsen",finishCircle:"Klik om de cirkel te beëindigen",placeCircleMarker:"Klik om een marker te plaatsen"},actions:{finish:"Bewaar",cancel:"Annuleer",removeLastVertex:"Verwijder laatste punt"},buttonTitles:{drawMarkerButton:"Plaats Marker",drawPolyButton:"Teken een vlak",drawLineButton:"Teken een lijn",drawCircleButton:"Teken een cirkel",drawRectButton:"Teken een vierkant",editButton:"Bewerk",dragButton:"Verplaats",cutButton:"Knip",deleteButton:"Verwijder",drawCircleMarkerButton:"Plaats Marker",snappingButton:"Snap gesleepte marker naar andere lagen en hoekpunten",pinningButton:"Speld gedeelde hoekpunten samen",rotateButton:"Laag roteren"}},ma={tooltips:{placeMarker:"Cliquez pour placer un marqueur",firstVertex:"Cliquez pour placer le premier sommet",continueLine:"Cliquez pour continuer à dessiner",finishLine:"Cliquez sur n'importe quel marqueur pour terminer",finishPoly:"Cliquez sur le premier marqueur pour terminer",finishRect:"Cliquez pour terminer",startCircle:"Cliquez pour placer le centre du cercle",finishCircle:"Cliquez pour finir le cercle",placeCircleMarker:"Cliquez pour placer le marqueur circulaire"},actions:{finish:"Terminer",cancel:"Annuler",removeLastVertex:"Retirer le dernier sommet"},buttonTitles:{drawMarkerButton:"Placer des marqueurs",drawPolyButton:"Dessiner des polygones",drawLineButton:"Dessiner des polylignes",drawCircleButton:"Dessiner un cercle",drawRectButton:"Dessiner un rectangle",editButton:"Éditer des calques",dragButton:"Déplacer des calques",cutButton:"Couper des calques",deleteButton:"Supprimer des calques",drawCircleMarkerButton:"Dessiner un marqueur circulaire",snappingButton:"Glisser le marqueur vers d'autres couches et sommets",pinningButton:"Épingler ensemble les sommets partagés",rotateButton:"Tourner des calques"}},ya={tooltips:{placeMarker:"单击放置标记",firstVertex:"单击放置首个顶点",continueLine:"单击继续绘制",finishLine:"单击任何存在的标记以完成",finishPoly:"单击第一个标记以完成",finishRect:"单击完成",startCircle:"单击放置圆心",finishCircle:"单击完成圆形",placeCircleMarker:"点击放置圆形标记"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最后的顶点"},buttonTitles:{drawMarkerButton:"绘制标记",drawPolyButton:"绘制多边形",drawLineButton:"绘制线段",drawCircleButton:"绘制圆形",drawRectButton:"绘制长方形",editButton:"编辑图层",dragButton:"拖拽图层",cutButton:"剪切图层",deleteButton:"删除图层",drawCircleMarkerButton:"画圆圈标记",snappingButton:"将拖动的标记捕捉到其他图层和顶点",pinningButton:"将共享顶点固定在一起",rotateButton:"旋转图层"}},va={tooltips:{placeMarker:"單擊放置標記",firstVertex:"單擊放置第一個頂點",continueLine:"單擊繼續繪製",finishLine:"單擊任何存在的標記以完成",finishPoly:"單擊第一個標記以完成",finishRect:"單擊完成",startCircle:"單擊放置圓心",finishCircle:"單擊完成圓形",placeCircleMarker:"點擊放置圓形標記"},actions:{finish:"完成",cancel:"取消",removeLastVertex:"移除最後一個頂點"},buttonTitles:{drawMarkerButton:"放置標記",drawPolyButton:"繪製多邊形",drawLineButton:"繪製線段",drawCircleButton:"繪製圓形",drawRectButton:"繪製方形",editButton:"編輯圖形",dragButton:"移動圖形",cutButton:"裁切圖形",deleteButton:"刪除圖形",drawCircleMarkerButton:"畫圓圈標記",snappingButton:"將拖動的標記對齊到其他圖層和頂點",pinningButton:"將共享頂點固定在一起",rotateButton:"旋轉圖形"}},La={tooltips:{placeMarker:"Clique para posicionar o marcador",firstVertex:"Clique para posicionar o primeiro vértice",continueLine:"Clique para continuar desenhando",finishLine:"Clique em qualquer marcador existente para finalizar",finishPoly:"Clique no primeiro ponto para fechar o polígono",finishRect:"Clique para finalizar",startCircle:"Clique para posicionar o centro do círculo",finishCircle:"Clique para fechar o círculo",placeCircleMarker:"Clique para posicionar o marcador circular"},actions:{finish:"Finalizar",cancel:"Cancelar",removeLastVertex:"Remover último vértice"},buttonTitles:{drawMarkerButton:"Desenhar um marcador",drawPolyButton:"Desenhar um polígono",drawLineButton:"Desenhar uma polilinha",drawCircleButton:"Desenhar um círculo",drawRectButton:"Desenhar um retângulo",editButton:"Editar camada(s)",dragButton:"Mover camada(s)",cutButton:"Recortar camada(s)",deleteButton:"Remover camada(s)",drawCircleMarkerButton:"Marcador de círculos de desenho",snappingButton:"Marcador arrastado para outras camadas e vértices",pinningButton:"Vértices compartilhados de pinos juntos"}},ba={tooltips:{placeMarker:"Kliknij, aby umieścić znacznik",firstVertex:"Kliknij, aby umieścić pierwszy wierzchołek",continueLine:"Kliknij, aby kontynuować rysowanie",finishLine:"Kliknij dowolny istniejący znacznik, aby zakończyć",finishPoly:"Kliknij pierwszy znacznik, aby zakończyć",finishRect:"Kliknij, aby zakończyć",startCircle:"Kliknij, aby umieścić środek okręgu",finishCircle:"Kliknij, aby zakończyć okrąg",placeCircleMarker:"Kliknij, aby umieścić znacznik okręgu",placeText:"Kliknij, aby umieścić tekst"},actions:{finish:"Zakończ",cancel:"Anuluj",removeLastVertex:"Usuń ostatni wierzchołek"},buttonTitles:{drawMarkerButton:"Rysuj znacznik",drawPolyButton:"Rysuj wielokąt",drawLineButton:"Rysuj linię",drawCircleButton:"Rysuj okrąg",drawRectButton:"Rysuj prostokąt",editButton:"Edytuj warstwy",dragButton:"Przeciągnij warstwy",cutButton:"Wytnij warstwy",deleteButton:"Usuń warstwy",drawCircleMarkerButton:"Rysuj znacznik okrągły",snappingButton:"Przyciągnij przenoszony znacznik do innych warstw i wierzchołków",pinningButton:"Przypnij wspólne wierzchołki razem",rotateButton:"Obróć warstwy",drawTextButton:"Rysuj tekst",scaleButton:"Skaluj warstwy",autoTracingButton:"Automatyczne śledzenie linii"},measurements:{totalLength:"Długość",segmentLength:"Długość odcinka",area:"Obszar",radius:"Promień",perimeter:"Obwód",height:"Wysokość",width:"Szerokość",coordinates:"Pozycja",coordinatesMarker:"Znacznik pozycji"}},ka={tooltips:{placeMarker:"Klicka för att placera markör",firstVertex:"Klicka för att placera första hörnet",continueLine:"Klicka för att fortsätta rita",finishLine:"Klicka på en existerande punkt för att slutföra",finishPoly:"Klicka på den första punkten för att slutföra",finishRect:"Klicka för att slutföra",startCircle:"Klicka för att placera cirkelns centrum",finishCircle:"Klicka för att slutföra cirkeln",placeCircleMarker:"Klicka för att placera cirkelmarkör"},actions:{finish:"Slutför",cancel:"Avbryt",removeLastVertex:"Ta bort sista hörnet"},buttonTitles:{drawMarkerButton:"Rita Markör",drawPolyButton:"Rita Polygoner",drawLineButton:"Rita Linje",drawCircleButton:"Rita Cirkel",drawRectButton:"Rita Rektangel",editButton:"Redigera Lager",dragButton:"Dra Lager",cutButton:"Klipp i Lager",deleteButton:"Ta bort Lager",drawCircleMarkerButton:"Rita Cirkelmarkör",snappingButton:"Snäpp dra markören till andra lager och hörn",pinningButton:"Fäst delade hörn tillsammans",rotateButton:"Rotera lagret"}},Ma={tooltips:{placeMarker:"Κάντε κλικ για να τοποθετήσετε Δείκτη",firstVertex:"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο",continueLine:"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε",finishLine:"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί",finishPoly:"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε",finishRect:"Κάντε κλικ για να τελειώσετε",startCircle:"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου",finishCircle:"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο",placeCircleMarker:"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},actions:{finish:"Τέλος",cancel:"Ακύρωση",removeLastVertex:"Κατάργηση τελευταίου σημείου"},buttonTitles:{drawMarkerButton:"Σχεδίαση Δείκτη",drawPolyButton:"Σχεδίαση Πολυγώνου",drawLineButton:"Σχεδίαση Γραμμής",drawCircleButton:"Σχεδίαση Κύκλου",drawRectButton:"Σχεδίαση Ορθογωνίου",editButton:"Επεξεργασία Επιπέδων",dragButton:"Μεταφορά Επιπέδων",cutButton:"Αποκοπή Επιπέδων",deleteButton:"Κατάργηση Επιπέδων",drawCircleMarkerButton:"Σχεδίαση Κυκλικού Δείκτη",snappingButton:"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές",pinningButton:"Περικοπή κοινών κορυφών μαζί",rotateButton:"Περιστρέψτε το στρώμα"}},xa={tooltips:{placeMarker:"Kattintson a jelölő elhelyezéséhez",firstVertex:"Kattintson az első pont elhelyezéséhez",continueLine:"Kattintson a következő pont elhelyezéséhez",finishLine:"A befejezéshez kattintson egy meglévő pontra",finishPoly:"A befejezéshez kattintson az első pontra",finishRect:"Kattintson a befejezéshez",startCircle:"Kattintson a kör középpontjának elhelyezéséhez",finishCircle:"Kattintson a kör befejezéséhez",placeCircleMarker:"Kattintson a körjelölő elhelyezéséhez"},actions:{finish:"Befejezés",cancel:"Mégse",removeLastVertex:"Utolsó pont eltávolítása"},buttonTitles:{drawMarkerButton:"Jelölő rajzolása",drawPolyButton:"Poligon rajzolása",drawLineButton:"Vonal rajzolása",drawCircleButton:"Kör rajzolása",drawRectButton:"Négyzet rajzolása",editButton:"Elemek szerkesztése",dragButton:"Elemek mozgatása",cutButton:"Elemek vágása",deleteButton:"Elemek törlése",drawCircleMarkerButton:"Kör jelölő rajzolása",snappingButton:"Kapcsolja a jelöltőt másik elemhez vagy ponthoz",pinningButton:"Közös pontok összekötése",rotateButton:"Fólia elforgatása"}},wa={tooltips:{placeMarker:"Tryk for at placere en markør",firstVertex:"Tryk for at placere det første punkt",continueLine:"Tryk for at fortsætte linjen",finishLine:"Tryk på et eksisterende punkt for at afslutte",finishPoly:"Tryk på det første punkt for at afslutte",finishRect:"Tryk for at afslutte",startCircle:"Tryk for at placere cirklens center",finishCircle:"Tryk for at afslutte cirklen",placeCircleMarker:"Tryk for at placere en cirkelmarkør"},actions:{finish:"Afslut",cancel:"Afbryd",removeLastVertex:"Fjern sidste punkt"},buttonTitles:{drawMarkerButton:"Placer markør",drawPolyButton:"Tegn polygon",drawLineButton:"Tegn linje",drawCircleButton:"Tegn cirkel",drawRectButton:"Tegn firkant",editButton:"Rediger",dragButton:"Træk",cutButton:"Klip",deleteButton:"Fjern",drawCircleMarkerButton:"Tegn cirkelmarkør",snappingButton:"Fastgør trukket markør til andre elementer",pinningButton:"Sammenlæg delte elementer",rotateButton:"Roter laget"}},Ca={tooltips:{placeMarker:"Klikk for å plassere punkt",firstVertex:"Klikk for å plassere første punkt",continueLine:"Klikk for å tegne videre",finishLine:"Klikk på et eksisterende punkt for å fullføre",finishPoly:"Klikk første punkt for å fullføre",finishRect:"Klikk for å fullføre",startCircle:"Klikk for å sette sirkel midtpunkt",finishCircle:"Klikk for å fullføre sirkel",placeCircleMarker:"Klikk for å plassere sirkel",placeText:"Klikk for å plassere tekst"},actions:{finish:"Fullfør",cancel:"Kanseller",removeLastVertex:"Fjern forrige punkt"},buttonTitles:{drawMarkerButton:"Tegn punkt",drawPolyButton:"Tegn flate",drawLineButton:"Tegn linje",drawCircleButton:"Tegn sirkel",drawRectButton:"Tegn rektangel",editButton:"Rediger objekter",dragButton:"Dra objekter",cutButton:"Kutt objekter",deleteButton:"Fjern objekter",drawCircleMarkerButton:"Tegn sirkel-punkt",snappingButton:"Fest dratt punkt til andre objekter og punkt",pinningButton:"Pin delte punkter sammen",rotateButton:"Rotér objekter",drawTextButton:"Tegn tekst",scaleButton:"Skalér objekter",autoTracingButton:"Automatisk sporing av linje"},measurements:{totalLength:"Lengde",segmentLength:"Segmentlengde",area:"Område",radius:"Radius",perimeter:"Omriss",height:"Høyde",width:"Bredde",coordinates:"Posisjon",coordinatesMarker:"Posisjonsmarkør"}},Ea={tooltips:{placeMarker:"کلیک برای جانمایی نشان",firstVertex:"کلیک برای رسم اولین رأس",continueLine:"کلیک برای ادامه رسم",finishLine:"کلیک روی هر نشان موجود برای پایان",finishPoly:"کلیک روی اولین نشان برای پایان",finishRect:"کلیک برای پایان",startCircle:"کلیک برای رسم مرکز دایره",finishCircle:"کلیک برای پایان رسم دایره",placeCircleMarker:"کلیک برای رسم نشان دایره",placeText:"کلیک برای نوشتن متن"},actions:{finish:"پایان",cancel:"لفو",removeLastVertex:"حذف آخرین رأس"},buttonTitles:{drawMarkerButton:"درج نشان",drawPolyButton:"رسم چندضلعی",drawLineButton:"رسم خط",drawCircleButton:"رسم دایره",drawRectButton:"رسم چهارضلعی",editButton:"ویرایش لایه‌ها",dragButton:"جابجایی لایه‌ها",cutButton:"برش لایه‌ها",deleteButton:"حذف لایه‌ها",drawCircleMarkerButton:"رسم نشان دایره",snappingButton:"نشانگر را به لایه‌ها و رئوس دیگر بکشید",pinningButton:"رئوس مشترک را با هم پین کنید",rotateButton:"چرخش لایه",drawTextButton:"رسم متن",scaleButton:"مقیاس‌گذاری",autoTracingButton:"ردیاب خودکار"},measurements:{totalLength:"طول",segmentLength:"طول بخش",area:"ناحیه",radius:"شعاع",perimeter:"محیط",height:"ارتفاع",width:"عرض",coordinates:"موقعیت",coordinatesMarker:"موقعیت نشان"}},Pa={tooltips:{placeMarker:"Натисніть, щоб нанести маркер",firstVertex:"Натисніть, щоб нанести першу вершину",continueLine:"Натисніть, щоб продовжити малювати",finishLine:"Натисніть будь-який існуючий маркер для завершення",finishPoly:"Виберіть перший маркер, щоб завершити",finishRect:"Натисніть, щоб завершити",startCircle:"Натисніть, щоб додати центр кола",finishCircle:"Натисніть, щоб завершити коло",placeCircleMarker:"Натисніть, щоб нанести круговий маркер"},actions:{finish:"Завершити",cancel:"Відмінити",removeLastVertex:"Видалити попередню вершину"},buttonTitles:{drawMarkerButton:"Малювати маркер",drawPolyButton:"Малювати полігон",drawLineButton:"Малювати криву",drawCircleButton:"Малювати коло",drawRectButton:"Малювати прямокутник",editButton:"Редагувати шари",dragButton:"Перенести шари",cutButton:"Вирізати шари",deleteButton:"Видалити шари",drawCircleMarkerButton:"Малювати круговий маркер",snappingButton:"Прив’язати перетягнутий маркер до інших шарів та вершин",pinningButton:"Зв'язати спільні вершини разом",rotateButton:"Повернути шар"}},Sa={tooltips:{placeMarker:"İşaretçi yerleştirmek için tıklayın",firstVertex:"İlk tepe noktasını yerleştirmek için tıklayın",continueLine:"Çizime devam etmek için tıklayın",finishLine:"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın",finishPoly:"Bitirmek için ilk işaretçiyi tıklayın",finishRect:"Bitirmek için tıklayın",startCircle:"Daire merkezine yerleştirmek için tıklayın",finishCircle:"Daireyi bitirmek için tıklayın",placeCircleMarker:"Daire işaretçisi yerleştirmek için tıklayın"},actions:{finish:"Bitir",cancel:"İptal",removeLastVertex:"Son köşeyi kaldır"},buttonTitles:{drawMarkerButton:"Çizim İşaretçisi",drawPolyButton:"Çokgenler çiz",drawLineButton:"Çoklu çizgi çiz",drawCircleButton:"Çember çiz",drawRectButton:"Dikdörtgen çiz",editButton:"Katmanları düzenle",dragButton:"Katmanları sürükle",cutButton:"Katmanları kes",deleteButton:"Katmanları kaldır",drawCircleMarkerButton:"Daire işaretçisi çiz",snappingButton:"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır",pinningButton:"Paylaşılan köşeleri birbirine sabitle",rotateButton:"Katmanı döndür"}},Ba={tooltips:{placeMarker:"Kliknutím vytvoříte značku",firstVertex:"Kliknutím vytvoříte první objekt",continueLine:"Kliknutím pokračujte v kreslení",finishLine:"Kliknutí na libovolnou existující značku pro dokončení",finishPoly:"Vyberte první bod pro dokončení",finishRect:"Klikněte pro dokončení",startCircle:"Kliknutím přidejte střed kruhu",finishCircle:"Нажмите, чтобы задать радиус",placeCircleMarker:"Kliknutím nastavte poloměr"},actions:{finish:"Dokončit",cancel:"Zrušit",removeLastVertex:"Zrušit poslední akci"},buttonTitles:{drawMarkerButton:"Přidat značku",drawPolyButton:"Nakreslit polygon",drawLineButton:"Nakreslit křivku",drawCircleButton:"Nakreslit kruh",drawRectButton:"Nakreslit obdélník",editButton:"Upravit vrstvu",dragButton:"Přeneste vrstvu",cutButton:"Vyjmout vrstvu",deleteButton:"Smazat vrstvu",drawCircleMarkerButton:"Přidat kruhovou značku",snappingButton:"Navázat tažnou značku k dalším vrstvám a vrcholům",pinningButton:"Spojit společné body dohromady",rotateButton:"Otočte vrstvu"}},Da={tooltips:{placeMarker:"クリックしてマーカーを配置",firstVertex:"クリックして最初の頂点を配置",continueLine:"クリックして描画を続ける",finishLine:"任意のマーカーをクリックして終了",finishPoly:"最初のマーカーをクリックして終了",finishRect:"クリックして終了",startCircle:"クリックして円の中心を配置",finishCircle:"クリックして円の描画を終了",placeCircleMarker:"クリックして円マーカーを配置",placeText:"クリックしてテキストを配置"},actions:{finish:"終了",cancel:"キャンセル",removeLastVertex:"最後の頂点を削除"},buttonTitles:{drawMarkerButton:"マーカーを描画",drawPolyButton:"ポリゴンを描画",drawLineButton:"折れ線を描画",drawCircleButton:"円を描画",drawRectButton:"矩形を描画",editButton:"レイヤーを編集",dragButton:"レイヤーをドラッグ",cutButton:"レイヤーを切り取り",deleteButton:"レイヤーを削除",drawCircleMarkerButton:"円マーカーを描画",snappingButton:"ドラッグしたマーカーを他のレイヤーや頂点にスナップする",pinningButton:"共有する頂点を同時に動かす",rotateButton:"レイヤーを回転",drawTextButton:"テキストを描画"}},Ra={tooltips:{placeMarker:"Klikkaa asettaaksesi merkin",firstVertex:"Klikkaa asettaakseni ensimmäisen osuuden",continueLine:"Klikkaa jatkaaksesi piirtämistä",finishLine:"Klikkaa olemassa olevaa merkkiä lopettaaksesi",finishPoly:"Klikkaa ensimmäistä merkkiä lopettaaksesi",finishRect:"Klikkaa lopettaaksesi",startCircle:"Klikkaa asettaaksesi ympyrän keskipisteen",finishCircle:"Klikkaa lopettaaksesi ympyrän",placeCircleMarker:"Klikkaa asettaaksesi ympyrämerkin",placeText:"Klikkaa asettaaksesi tekstin"},actions:{finish:"Valmis",cancel:"Peruuta",removeLastVertex:"Poista viimeinen osuus"},buttonTitles:{drawMarkerButton:"Piirrä merkkejä",drawPolyButton:"Piirrä monikulmioita",drawLineButton:"Piirrä viivoja",drawCircleButton:"Piirrä ympyrä",drawRectButton:"Piirrä neliskulmioita",editButton:"Muokkaa",dragButton:"Siirrä",cutButton:"Leikkaa",deleteButton:"Poista",drawCircleMarkerButton:"Piirrä ympyrämerkki",snappingButton:"Kiinnitä siirrettävä merkki toisiin muotoihin",pinningButton:"Kiinnitä jaetut muodot yhteen",rotateButton:"Käännä",drawTextButton:"Piirrä tekstiä"}},Ta={tooltips:{placeMarker:"마커 위치를 클릭하세요",firstVertex:"첫번째 꼭지점 위치을 클릭하세요",continueLine:"계속 그리려면 클릭하세요",finishLine:"끝내려면 기존 마커를 클릭하세요",finishPoly:"끝내려면 처음 마커를 클릭하세요",finishRect:"끝내려면 클릭하세요",startCircle:"원의 중심이 될 위치를 클릭하세요",finishCircle:"원을 끝내려면 클릭하세요",placeCircleMarker:"원 마커 위치를 클릭하세요",placeText:"텍스트 위치를 클릭하세요"},actions:{finish:"끝내기",cancel:"취소",removeLastVertex:"마지막 꼭지점 제거"},buttonTitles:{drawMarkerButton:"마커 그리기",drawPolyButton:"다각형 그리기",drawLineButton:"다각선 그리기",drawCircleButton:"원 그리기",drawRectButton:"직사각형 그리기",editButton:"레이어 편집하기",dragButton:"레이어 끌기",cutButton:"레이어 자르기",deleteButton:"레이어 제거하기",drawCircleMarkerButton:"원 마커 그리기",snappingButton:"잡아끈 마커를 다른 레이어 및 꼭지점에 들러붙게 하기",pinningButton:"공유 꼭지점을 함께 찍기",rotateButton:"레이어 회전하기",drawTextButton:"텍스트 그리기"}},Oa={tooltips:{placeMarker:"Маркерди жайгаштыруу үчүн басыңыз",firstVertex:"Биринчи чокуну жайгаштырууну үчүн басыңыз",continueLine:"Сүрөт тартууну улантуу үчүн басыңыз",finishLine:"Аяктоо үчүн учурдагы маркерди басыңыз",finishPoly:"Бүтүрүү үчүн биринчи маркерди басыңыз",finishRect:"Бүтүрүү үчүн басыңыз",startCircle:"Айлананын борборун жайгаштырууну үчүн басыңыз",finishCircle:"Айлананы бүтүрүү үчүн басыңыз",placeCircleMarker:"Тегерек маркерди жайгаштыруу үчүн басыңыз",placeText:"Текстти жайгаштыруу үчүн басыңыз"},actions:{finish:"Аягы",cancel:"Жок кылуу",removeLastVertex:"Акыркы чокуну өчүрүү"},buttonTitles:{drawMarkerButton:"Маркерди чизуу",drawPolyButton:"Полигон чизуу",drawLineButton:"Полилиния чизуу",drawCircleButton:"Дайынды чизуу",drawRectButton:"Прямоугольник чизуу",editButton:"Слоопту түзөтүү",dragButton:"Слоопту карап сүйлөү",cutButton:"Слооптун башын кесүү",deleteButton:"Слооптун өчүрүү",drawCircleMarkerButton:"Дайынды маркерди чизуу",snappingButton:"Башка слооптордун жана вертекстердин арасына чекилдөө",pinningButton:"Бөлүшкөн вертекстерди бирге тутуштуруу",rotateButton:"Слооптун өзгөртүү",drawTextButton:"Текст чизуу",scaleButton:"Слооптун өлчөмүн өзгөртүү",autoTracingButton:"Автоматтык тизмеги чизуу"},measurements:{totalLength:"Узундук",segmentLength:"Сегмент узундугу",area:"Аймак",radius:"Радиус",perimeter:"Периметр",height:"Диаметр",width:"Кенчилик",coordinates:"Координаттар",coordinatesMarker:"Маркердин координаттары"}},Qt={en:ha,de:ua,it:pa,id:ca,ro:da,ru:ga,es:fa,nl:_a,fr:ma,pt_br:La,zh:ya,zh_tw:va,pl:ba,sv:ka,el:Ma,hu:xa,da:wa,no:Ca,fa:Ea,ua:Pa,tr:Sa,cz:Ba,ja:Da,fi:Ra,ko:Ta,ky:Oa},Ia={_globalEditModeEnabled:!1,enableGlobalEditMode(t){let e={...t};this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach(i=>{this._isRelevantForEdit(i)&&i.pm.enable(e)}),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayersEdit={},this.map.on("layeradd",this._layerAddedEdit,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach(t=>{t.pm.disable()}),this.map.off("layeradd",this._layerAddedEdit,this),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled(){return this.globalEditModeEnabled()},globalEditModeEnabled(){return this._globalEditModeEnabled},toggleGlobalEditMode(t=this.globalOptions){this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)},handleLayerAdditionInGlobalEditMode(){let t=this._addedLayersEdit;if(this._addedLayersEdit={},this.globalEditModeEnabled())for(let e in t){let i=t[e];this._isRelevantForEdit(i)&&i.pm.enable({...this.globalOptions})}},_layerAddedEdit({layer:t}){this._addedLayersEdit[L.stamp(t)]=t},_isRelevantForEdit(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&t.options.pmIgnore===!1)&&!t._pmTempLayer&&t.pm.options.allowEditing}},Aa=Ia,ja={_globalDragModeEnabled:!1,enableGlobalDragMode(){let t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,this._addedLayersDrag={},t.forEach(e=>{this._isRelevantForDrag(e)&&e.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this._layerAddedDrag,this),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode(){let t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,t.forEach(e=>{e.pm.disableLayerDrag()}),this.map.off("layeradd",this._layerAddedDrag,this),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled(){return!!this._globalDragModeEnabled},toggleGlobalDragMode(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode(){let t=this._addedLayersDrag;if(this._addedLayersDrag={},this.globalDragModeEnabled())for(let e in t){let i=t[e];this._isRelevantForDrag(i)&&i.pm.enableLayerDrag()}},_layerAddedDrag({layer:t}){this._addedLayersDrag[L.stamp(t)]=t},_isRelevantForDrag(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&t.options.pmIgnore===!1)&&!t._pmTempLayer&&t.pm.options.draggable}},Ga=ja,za={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode(){this._globalRemovalModeEnabled=!0,this.map.eachLayer(t=>{this._isRelevantForRemoval(t)&&(t.pm.enabled()&&t.pm.disable(),t.on("click",this.removeLayer,this))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.handleLayerAdditionInGlobalRemovalMode,100,this)),this._addedLayersRemoval={},this.map.on("layeradd",this._layerAddedRemoval,this),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode(){this._globalRemovalModeEnabled=!1,this.map.eachLayer(t=>{t.off("click",this.removeLayer,this)}),this.map.off("layeradd",this._layerAddedRemoval,this),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("removalMode",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},removeLayer(t){let e=t.target;this._isRelevantForRemoval(e)&&!e.pm.dragging()&&(e.removeFrom(this.map.pm._getContainingLayer()),e.remove(),e instanceof L.LayerGroup?(this._fireRemoveLayerGroup(e),this._fireRemoveLayerGroup(this.map,e)):(e.pm._fireRemove(e),e.pm._fireRemove(this.map,e)))},_isRelevantForRemoval(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&t.options.pmIgnore===!1)&&!t._pmTempLayer&&t.pm.options.allowRemoval},handleLayerAdditionInGlobalRemovalMode(){let t=this._addedLayersRemoval;if(this._addedLayersRemoval={},this.globalRemovalModeEnabled())for(let e in t){let i=t[e];this._isRelevantForRemoval(i)&&(i.pm.enabled()&&i.pm.disable(),i.on("click",this.removeLayer,this))}},_layerAddedRemoval({layer:t}){this._addedLayersRemoval[L.stamp(t)]=t}},Na=za,Fa={_globalRotateModeEnabled:!1,enableGlobalRotateMode(){this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter(t=>t instanceof L.Polyline).forEach(t=>{this._isRelevantForRotate(t)&&t.pm.enableRotate()}),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this.handleLayerAdditionInGlobalRotateMode,100,this)),this._addedLayersRotate={},this.map.on("layeradd",this._layerAddedRotate,this),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter(t=>t instanceof L.Polyline).forEach(t=>{t.pm.disableRotate()}),this.map.off("layeradd",this._layerAddedRotate,this),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_isRelevantForRotate(t){return t.pm&&t instanceof L.Polyline&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&t.options.pmIgnore===!1)&&!t._pmTempLayer&&t.pm.options.allowRotation},handleLayerAdditionInGlobalRotateMode(){let t=this._addedLayersRotate;if(this._addedLayersRotate={},this.globalRotateModeEnabled())for(let e in t){let i=t[e];this._isRelevantForRemoval(i)&&i.pm.enableRotate()}},_layerAddedRotate({layer:t}){this._addedLayersRotate[L.stamp(t)]=t}},Ua=Fa,Va=ut(Fe()),Ka={_fireDrawStart(t="Draw",e={}){this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},t,e)},_fireDrawEnd(t="Draw",e={}){this.__fire(this._map,"pm:drawend",{shape:this._shape},t,e)},_fireCreate(t,e="Draw",i={}){this.__fire(this._map,"pm:create",{shape:this._shape,marker:t,layer:t},e,i)},_fireCenterPlaced(t="Draw",e={}){let i=t==="Draw"?this._layer:void 0,r=t!=="Draw"?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:i,layer:r,latlng:this._layer.getLatLng()},t,e)},_fireCut(t,e,i,r="Draw",a={}){this.__fire(t,"pm:cut",{shape:this._shape,layer:e,originalLayer:i},r,a)},_fireEdit(t=this._layer,e="Edit",i={}){this.__fire(t,"pm:edit",{layer:this._layer,shape:this.getShape()},e,i)},_fireEnable(t="Edit",e={}){this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDisable(t="Edit",e={}){this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},t,e)},_fireUpdate(t="Edit",e={}){this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},t,e)},_fireMarkerDragStart(t,e=void 0,i="Edit",r={}){this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},i,r)},_fireMarkerDrag(t,e=void 0,i="Edit",r={}){this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},i,r)},_fireMarkerDragEnd(t,e=void 0,i=void 0,r="Edit",a={}){this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e,intersectionReset:i},r,a)},_fireDragStart(t="Edit",e={}){this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},t,e)},_fireDrag(t,e="Edit",i={}){this.__fire(this._layer,"pm:drag",{...t,shape:this.getShape()},e,i)},_fireDragEnd(t="Edit",e={}){this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},t,e)},_fireDragEnable(t="Edit",e={}){this.__fire(this._layer,"pm:dragenable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDragDisable(t="Edit",e={}){this.__fire(this._layer,"pm:dragdisable",{layer:this._layer,shape:this.getShape()},t,e)},_fireRemove(t,e=t,i="Edit",r={}){this.__fire(t,"pm:remove",{layer:e,shape:this.getShape()},i,r)},_fireVertexAdded(t,e,i,r="Edit",a={}){this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:t,indexPath:e,latlng:i,shape:this.getShape()},r,a)},_fireVertexRemoved(t,e,i="Edit",r={}){this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:t,indexPath:e,shape:this.getShape()},i,r)},_fireVertexClick(t,e,i="Edit",r={}){this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},i,r)},_fireIntersect(t,e=this._layer,i="Edit",r={}){this.__fire(e,"pm:intersect",{layer:this._layer,intersection:t,shape:this.getShape()},i,r)},_fireLayerReset(t,e,i="Edit",r={}){this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},i,r)},_fireChange(t,e="Edit",i={}){this.__fire(this._layer,"pm:change",{layer:this._layer,latlngs:t,shape:this.getShape()},e,i)},_fireTextChange(t,e="Edit",i={}){this.__fire(this._layer,"pm:textchange",{layer:this._layer,text:t,shape:this.getShape()},e,i)},_fireTextFocus(t="Edit",e={}){this.__fire(this._layer,"pm:textfocus",{layer:this._layer,shape:this.getShape()},t,e)},_fireTextBlur(t="Edit",e={}){this.__fire(this._layer,"pm:textblur",{layer:this._layer,shape:this.getShape()},t,e)},_fireSnapDrag(t,e,i="Snapping",r={}){this.__fire(t,"pm:snapdrag",e,i,r)},_fireSnap(t,e,i="Snapping",r={}){this.__fire(t,"pm:snap",e,i,r)},_fireUnsnap(t,e,i="Snapping",r={}){this.__fire(t,"pm:unsnap",e,i,r)},_fireRotationEnable(t,e,i="Rotation",r={}){this.__fire(t,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly,shape:this.getShape()},i,r)},_fireRotationDisable(t,e="Rotation",i={}){this.__fire(t,"pm:rotatedisable",{layer:this._layer,shape:this.getShape()},e,i)},_fireRotationStart(t,e,i="Rotation",r={}){this.__fire(t,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:e},i,r)},_fireRotation(t,e,i,r=this._rotationLayer,a="Rotation",n={}){this.__fire(t,"pm:rotate",{layer:r,helpLayer:this._layer,startAngle:this._startAngle,angle:r.pm.getAngle(),angleDiff:e,oldLatLngs:i,newLatLngs:r.getLatLngs()},a,n)},_fireRotationEnd(t,e,i,r="Rotation",a={}){this.__fire(t,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:e,angle:this._rotationLayer.pm.getAngle(),originLatLngs:i,newLatLngs:this._rotationLayer.getLatLngs()},r,a)},_fireActionClick(t,e,i,r="Toolbar",a={}){this.__fire(this._map,"pm:actionclick",{text:t.text,action:t,btnName:e,button:i},r,a)},_fireButtonClick(t,e,i="Toolbar",r={}){this.__fire(this._map,"pm:buttonclick",{btnName:t,button:e},i,r)},_fireLangChange(t,e,i,r,a="Global",n={}){this.__fire(this.map,"pm:langchange",{oldLang:t,activeLang:e,fallback:i,translations:r},a,n)},_fireGlobalDragModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalEditModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalRemovalModeToggled(t,e="Global",i={}){this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:t,map:this.map},e,i)},_fireGlobalCutModeToggled(t="Global",e={}){this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},t,e)},_fireGlobalDrawModeToggled(t="Global",e={}){this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},t,e)},_fireGlobalRotateModeToggled(t="Global",e={}){this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},t,e)},_fireRemoveLayerGroup(t,e=t,i="Edit",r={}){this.__fire(t,"pm:remove",{layer:e,shape:void 0},i,r)},_fireKeyeventEvent(t,e,i,r="Global",a={}){this.__fire(this.map,"pm:keyevent",{event:t,eventType:e,focusOn:i},r,a)},__fire(t,e,i,r,a={}){i=(0,Va.default)(i,a,{source:r}),L.PM.Utils._fireEvent(t,e,i)}},me=Ka,Ha=()=>({_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener(t){this.map=t,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.on(window,"blur",this._onBlur,this),t.once("unload",this._unbindKeyListenerEvents,this)},_unbindKeyListenerEvents(){L.DomEvent.off(document,"keydown keyup",this._onKeyListener,this),L.DomEvent.off(window,"blur",this._onBlur,this)},_onKeyListener(t){let e="document";this.map.getContainer().contains(t.target)&&(e="map");let i={event:t,eventType:t.type,focusOn:e};this._lastEvents[t.type]=i,this._lastEvents.current=i,this.map.pm._fireKeyeventEvent(t,t.type,e)},_onBlur(t){t.altKey=!1;let e={event:t,eventType:t.type,focusOn:"document"};this._lastEvents[t.type]=e,this._lastEvents.current=e},getLastKeyEvent(t="current"){return this._lastEvents[t]},isShiftKeyPressed(){var t;return(t=this._lastEvents.current)==null?void 0:t.event.shiftKey},isAltKeyPressed(){var t;return(t=this._lastEvents.current)==null?void 0:t.event.altKey},isCtrlKeyPressed(){var t;return(t=this._lastEvents.current)==null?void 0:t.event.ctrlKey},isMetaKeyPressed(){var t;return(t=this._lastEvents.current)==null?void 0:t.event.metaKey},getPressedKey(){var t;return(t=this._lastEvents.current)==null?void 0:t.event.key}}),qa=Ha,Ja=ut(_e()),Ya=ut(aa());function Y(t){let e=L.PM.activeLang;return(0,Ya.default)(Qt,e)||(e="en"),(0,Ja.default)(Qt[e],t)}function Ve(t){for(let e=0;e<t.length;e+=1){let i=t[e];if(Array.isArray(i)){if(Ve(i))return!0}else if(i!=null&&i!=="")return!0}return!1}function ye(t){return t.reduce((e,i)=>{if(i.length!==0){let r=Array.isArray(i)?ye(i):i;Array.isArray(r)?r.length!==0&&e.push(r):e.push(r)}return e},[])}function Xa(t,e,i){let r={a:L.CRS.Earth.R,b:63567523142e-4,f:.0033528106647474805},{a,b:n,f:o}=r,l=t.lng,u=t.lat,p=i,_=Math.PI,f=e*_/180,B=Math.sin(f),P=Math.cos(f),A=(1-o)*Math.tan(u*_/180),z=1/Math.sqrt(1+A*A),N=A*z,q=Math.atan2(A,P),k=z*B,d=1-k*k,v=d*(a*a-n*n)/(n*n),x=1+v/16384*(4096+v*(-768+v*(320-175*v))),M=v/1024*(256+v*(-128+v*(74-47*v))),w=p/(n*x),E=2*Math.PI,R,O,b;for(;Math.abs(w-E)>1e-12;){R=Math.cos(2*q+w),O=Math.sin(w),b=Math.cos(w);let Et=M*O*(R+M/4*(b*(-1+2*R*R)-M/6*R*(-3+4*O*O)*(-3+4*R*R)));E=w,w=p/(n*x)+Et}let S=N*O-z*b*P,C=Math.atan2(N*b+z*O*P,(1-o)*Math.sqrt(k*k+S*S)),G=Math.atan2(O*B,z*b-N*O*P),V=o/16*d*(4+o*(4-3*d)),J=G-(1-V)*o*k*(w+V*O*(R+V*b*(-1+2*R*R))),X=l+J*180/_,rt=C*180/_;return L.latLng(X,rt)}function ki(t,e,i,r,a=!0){let n,o,l,u=[];for(let p=0;p<i;p+=1){if(a)n=p*360/i+r,o=Xa(t,n,e),l=L.latLng(o.lng,o.lat);else{let _=t.lat+Math.cos(2*p*Math.PI/i)*e,f=t.lng+Math.sin(2*p*Math.PI/i)*e;l=L.latLng(_,f)}u.push(l)}return u}function Za(t,e,i){e=(e+360)%360;let r=Math.PI/180,a=180/Math.PI,{R:n}=L.CRS.Earth,o=t.lng*r,l=t.lat*r,u=e*r,p=Math.sin(l),_=Math.cos(l),f=Math.cos(i/n),B=Math.sin(i/n),P=Math.asin(p*f+_*B*Math.cos(u)),A=o+Math.atan2(Math.sin(u)*B*_,f-p*Math.sin(P));A*=a;let z=A-360,N=A<-180?A+360:A;return A=A>180?z:N,L.latLng([P*a,A])}function Ke(t,e,i){let r=t.latLngToContainerPoint(e),a=t.latLngToContainerPoint(i),n=Math.atan2(a.y-r.y,a.x-r.x)*180/Math.PI+90;return n+=n<0?360:0,n}function ve(t,e,i,r){let a=Ke(t,e,i);return Za(e,a,r)}function Wa(t,e,i="asc"){if(!e||Object.keys(e).length===0)return(u,p)=>u-p;let r=Object.keys(e),a,n=r.length-1,o={};for(;n>=0;)a=r[n],o[a.toLowerCase()]=e[a],n-=1;function l(u){if(u instanceof L.Marker)return"Marker";if(u instanceof L.Circle)return"Circle";if(u instanceof L.CircleMarker)return"CircleMarker";if(u instanceof L.Rectangle)return"Rectangle";if(u instanceof L.Polygon)return"Polygon";if(u instanceof L.Polyline)return"Line"}return(u,p)=>{let _,f;if(t==="instanceofShape"){if(_=l(u.layer).toLowerCase(),f=l(p.layer).toLowerCase(),!_||!f)return 0}else{if(!u.hasOwnProperty(t)||!p.hasOwnProperty(t))return 0;_=u[t].toLowerCase(),f=p[t].toLowerCase()}let B=_ in o?o[_]:Number.MAX_SAFE_INTEGER,P=f in o?o[f]:Number.MAX_SAFE_INTEGER,A=0;return B<P?A=-1:B>P&&(A=1),i==="desc"?A*-1:A}}function Pt(t,e=t.getLatLngs()){return t instanceof L.Polygon?L.polygon(e).getLatLngs():L.polyline(e).getLatLngs()}function Mi(t,e){var i,r,a,n;if((r=(i=e.options.crs)==null?void 0:i.projection)!=null&&r.MAX_LATITUDE){let o=(n=(a=e.options.crs)==null?void 0:a.projection)==null?void 0:n.MAX_LATITUDE;t.lat=Math.max(Math.min(o,t.lat),-o)}return t}function Ht(t){return t.options.renderer||t._map&&(t._map._getPaneRenderer(t.options.pane)||t._map.options.renderer||t._map._renderer)||t._renderer}var Qa=L.Class.extend({includes:[Aa,Ga,Na,Ua,me],initialize(t){this.map=t,this.Draw=new L.PM.Draw(t),this.Toolbar=new L.PM.Toolbar(t),this.Keyboard=qa(),this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"},draggable:!0},this.Keyboard._initKeyListener(t)},setLang(t="en",e,i="en"){let r=L.PM.activeLang;e&&(Qt[t]=(0,bi.default)(Qt[i],e)),L.PM.activeLang=t,this.map.pm.Toolbar.reinit(),this._fireLangChange(r,t,i,Qt[t])},addControls(t){this.Toolbar.addControls(t)},removeControls(){this.Toolbar.removeControls()},toggleControls(){this.Toolbar.toggleControls()},controlsVisible(){return this.Toolbar.isVisible},enableDraw(t="Polygon",e){t==="Poly"&&(t="Polygon"),this.Draw.enable(t,e)},disableDraw(t="Polygon"){t==="Poly"&&(t="Polygon"),this.Draw.disable(t)},setPathOptions(t,e={}){let i=e.ignoreShapes||[],r=e.merge||!1;this.map.pm.Draw.shapes.forEach(a=>{i.indexOf(a)===-1&&this.map.pm.Draw[a].setPathOptions(t,r)})},getGlobalOptions(){return this.globalOptions},setGlobalOptions(t){let e=(0,bi.default)(this.globalOptions,t);e.editable&&(e.resizeableCircleMarker=e.editable,delete e.editable);let i=!1;this.map.pm.Draw.CircleMarker.enabled()&&!!this.map.pm.Draw.CircleMarker.options.resizeableCircleMarker!=!!e.resizeableCircleMarker&&(this.map.pm.Draw.CircleMarker.disable(),i=!0);let r=!1;this.map.pm.Draw.Circle.enabled()&&!!this.map.pm.Draw.Circle.options.resizableCircle!=!!e.resizableCircle&&(this.map.pm.Draw.Circle.disable(),r=!0),this.map.pm.Draw.shapes.forEach(a=>{this.map.pm.Draw[a].setOptions(e)}),i&&this.map.pm.Draw.CircleMarker.enable(),r&&this.map.pm.Draw.Circle.enable(),L.PM.Utils.findLayers(this.map).forEach(a=>{a.pm.setOptions(e)}),this.map.fire("pm:globaloptionschanged"),this.globalOptions=e,this.applyGlobalOptions()},applyGlobalOptions(){L.PM.Utils.findLayers(this.map).forEach(t=>{t.pm.enabled()&&t.pm.applyOptions()})},globalDrawModeEnabled(){return!!this.Draw.getActiveShape()},globalCutModeEnabled(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode(t){return this.Draw.Cut.enable(t)},toggleGlobalCutMode(t){return this.Draw.Cut.toggle(t)},disableGlobalCutMode(){return this.Draw.Cut.disable()},getGeomanLayers(t=!1){let e=L.PM.Utils.findLayers(this.map);if(!t)return e;let i=L.featureGroup();return i._pmTempLayer=!0,e.forEach(r=>{i.addLayer(r)}),i},getGeomanDrawLayers(t=!1){let e=L.PM.Utils.findLayers(this.map).filter(r=>r._drawnByGeoman===!0);if(!t)return e;let i=L.featureGroup();return i._pmTempLayer=!0,e.forEach(r=>{i.addLayer(r)}),i},_getContainingLayer(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map},_isCRSSimple(){return this.map.options.crs===L.CRS.Simple},_touchEventCounter:0,_addTouchEvents(t){this._touchEventCounter===0&&(L.DomEvent.on(t,"touchmove",this._canvasTouchMove,this),L.DomEvent.on(t,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter+=1},_removeTouchEvents(t){this._touchEventCounter===1&&(L.DomEvent.off(t,"touchmove",this._canvasTouchMove,this),L.DomEvent.off(t,"touchstart touchend touchcancel",this._canvasTouchClick,this)),this._touchEventCounter=this._touchEventCounter<=1?0:this._touchEventCounter-1},_canvasTouchMove(t){Ht(this.map)._onMouseMove(this._createMouseEvent("mousemove",t))},_canvasTouchClick(t){let e="";t.type==="touchstart"||t.type==="pointerdown"?e="mousedown":(t.type==="touchend"||t.type==="pointerup"||t.type==="touchcancel"||t.type==="pointercancel")&&(e="mouseup"),e&&Ht(this.map)._onClick(this._createMouseEvent(e,t))},_createMouseEvent(t,e){let i,r=e.touches[0]||e.changedTouches[0];try{i=new MouseEvent(t,{bubbles:e.bubbles,cancelable:e.cancelable,view:e.view,detail:r.detail,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,button:e.button,relatedTarget:e.relatedTarget})}catch{i=document.createEvent("MouseEvents"),i.initMouseEvent(t,e.bubbles,e.cancelable,e.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}return i}}),$a=Qa,tn=L.Control.extend({includes:[me],options:{position:"topleft",disableByOtherButtons:!0},initialize(t){this._button=L.Util.extend({},this.options,t)},onAdd(t){return this._map=t,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):this._button.tool==="edit"?this._container=this._map.pm.Toolbar.editContainer:this._button.tool==="options"?this._container=this._map.pm.Toolbar.optionsContainer:this._button.tool==="custom"?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this.buttonsDomNode=this._makeButton(this._button),this._container.appendChild(this.buttonsDomNode),this._container},onRemove(){return this.buttonsDomNode.remove(),this._container},getText(){return this._button.text},getIconUrl(){return this._button.iconUrl},destroy(){this._button={},this._update()},toggle(t){return typeof t=="boolean"?this._button.toggleStatus=t:this._button.toggleStatus=!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled(){return this._button.toggleStatus},onCreate(){this.toggle(!1)},disable(){this.toggle(!1),this._button.disabled=!0,this._updateDisabled()},enable(){this._button.disabled=!1,this._updateDisabled()},_triggerClick(t){t&&t.preventDefault(),!this._button.disabled&&(this._button.onClick(t,{button:this,event:t}),this._clicked(t),this._button.afterClick(t,{button:this,event:t}))},_makeButton(t){let e=this.options.position.indexOf("right")>-1?"pos-right":"",i=L.DomUtil.create("div",`button-container  ${e}`,this._container);t.title&&i.setAttribute("title",t.title);let r=L.DomUtil.create("a","leaflet-buttons-control-button",i);r.setAttribute("role","button"),r.setAttribute("tabindex","0"),r.href="#";let a=L.DomUtil.create("div",`leaflet-pm-actions-container ${e}`,i),n=t.actions,o={cancel:{text:Y("actions.cancel"),onClick(){this._triggerClick()}},finishMode:{text:Y("actions.finish"),onClick(){this._triggerClick()}},removeLastVertex:{text:Y("actions.removeLastVertex"),onClick(){this._map.pm.Draw[t.jsClass]._removeLastVertex()}},finish:{text:Y("actions.finish"),onClick(u){this._map.pm.Draw[t.jsClass]._finishShape(u)}}};n.forEach(u=>{let p=typeof u=="string"?u:u.name,_;if(o[p])_=o[p];else if(u.text)_=u;else return;let f=L.DomUtil.create("a",`leaflet-pm-action ${e} action-${p}`,a);if(f.setAttribute("role","button"),f.setAttribute("tabindex","0"),f.href="#",f.innerHTML=_.text,L.DomEvent.disableClickPropagation(f),L.DomEvent.on(f,"click",L.DomEvent.stop),!t.disabled&&_.onClick){let B=P=>{P.preventDefault();let A="",{buttons:z}=this._map.pm.Toolbar;for(let N in z)if(z[N]._button===t){A=N;break}this._fireActionClick(_,A,t)};L.DomEvent.addListener(f,"click",B,this),L.DomEvent.addListener(f,"click",_.onClick,this)}}),t.toggleStatus&&L.DomUtil.addClass(i,"active");let l=L.DomUtil.create("div","control-icon",r);return t.iconUrl&&l.setAttribute("src",t.iconUrl),t.className&&L.DomUtil.addClass(l,t.className),L.DomEvent.disableClickPropagation(r),L.DomEvent.on(r,"click",L.DomEvent.stop),t.disabled||(L.DomEvent.addListener(r,"click",this._onBtnClick,this),L.DomEvent.addListener(r,"click",this._triggerClick,this)),t.disabled&&(L.DomUtil.addClass(r,"pm-disabled"),r.setAttribute("aria-disabled","true")),i},_applyStyleClasses(){this._container&&(!this._button.toggleStatus||this._button.cssToggle===!1?(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")):(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")))},_onBtnClick(){if(this._button.disabled)return;this._button.disableOtherButtons&&this._map.pm.Toolbar.triggerClickOnToggledButtons(this);let t="",{buttons:e}=this._map.pm.Toolbar;for(let i in e)if(e[i]._button===this._button){t=i;break}this._fireButtonClick(t,this._button)},_clicked(){this._button.doToggle&&this.toggle()},_updateDisabled(){if(!this._container)return;let t="pm-disabled",e=this.buttonsDomNode.children[0];this._button.disabled?(L.DomUtil.addClass(e,t),e.setAttribute("aria-disabled","true")):(L.DomUtil.removeClass(e,t),e.setAttribute("aria-disabled","false"))}}),en=tn;L.Control.PMButton=en;var rn=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,drawText:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize(t){this.init(t)},reinit(){let t=this.isVisible;this.removeControls(),this._defineButtons(),t&&this.addControls()},init(t){this.map=t,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer(t){let e=`${t}Container`;return this[e]||(this[e]=L.DomUtil.create("div",`leaflet-pm-toolbar leaflet-pm-${t} leaflet-bar leaflet-control`)),this[e]},getButtons(){return this.buttons},addControls(t=this.options){typeof t.editPolygon<"u"&&(t.editMode=t.editPolygon),typeof t.deleteLayer<"u"&&(t.removalMode=t.deleteLayer),L.Util.setOptions(this,t),this.applyIconStyle(),this.isVisible=!0,this._showHideButtons()},applyIconStyle(){let t=this.getButtons(),e={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete",drawText:"control-icon leaflet-pm-icon-text"}};for(let i in t){let r=t[i];L.Util.setOptions(r,{className:e.geomanIcons[i]})}},removeControls(){let t=this.getButtons();for(let e in t)t[e].remove();this.isVisible=!1},toggleControls(t=this.options){this.isVisible?this.removeControls():this.addControls(t)},_addButton(t,e){return this.buttons[t]=e,this.options[t]=this.options[t]||!1,this.buttons[t]},triggerClickOnToggledButtons(t){for(let e in this.buttons){let i=this.buttons[e];i._button.disableByOtherButtons&&i!==t&&i.toggled()&&i._triggerClick()}},toggleButton(t,e,i=!0){return t==="editPolygon"&&(t="editMode"),t==="deleteLayer"&&(t="removalMode"),i&&this.triggerClickOnToggledButtons(this.buttons[t]),this.buttons[t]?this.buttons[t].toggle(e):!1},_defineButtons(){let t={className:"control-icon leaflet-pm-icon-marker",title:Y("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:()=>{},afterClick:(B,P)=>{this.map.pm.Draw[P.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},e={title:Y("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:()=>{},afterClick:(B,P)=>{this.map.pm.Draw[P.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},i={className:"control-icon leaflet-pm-icon-polyline",title:Y("buttonTitles.drawLineButton"),jsClass:"Line",onClick:()=>{},afterClick:(B,P)=>{this.map.pm.Draw[P.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},r={title:Y("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:()=>{},afterClick:(B,P)=>{this.map.pm.Draw[P.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},a={title:Y("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:()=>{},afterClick:(B,P)=>{this.map.pm.Draw[P.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},n={title:Y("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:()=>{},afterClick:(B,P)=>{this.map.pm.Draw[P.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},o={title:Y("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},l={title:Y("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},u={title:Y("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:()=>{},afterClick:(B,P)=>{this.map.pm.Draw[P.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},p={title:Y("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},_={title:Y("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:()=>{},afterClick:()=>{this.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},f={className:"control-icon leaflet-pm-icon-text",title:Y("buttonTitles.drawTextButton"),jsClass:"Text",onClick:()=>{},afterClick:(B,P)=>{this.map.pm.Draw[P.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]};this._addButton("drawMarker",new L.Control.PMButton(t)),this._addButton("drawPolyline",new L.Control.PMButton(i)),this._addButton("drawRectangle",new L.Control.PMButton(n)),this._addButton("drawPolygon",new L.Control.PMButton(e)),this._addButton("drawCircle",new L.Control.PMButton(r)),this._addButton("drawCircleMarker",new L.Control.PMButton(a)),this._addButton("drawText",new L.Control.PMButton(f)),this._addButton("editMode",new L.Control.PMButton(o)),this._addButton("dragMode",new L.Control.PMButton(l)),this._addButton("cutPolygon",new L.Control.PMButton(u)),this._addButton("removalMode",new L.Control.PMButton(p)),this._addButton("rotateMode",new L.Control.PMButton(_))},_showHideButtons(){if(!this.isVisible)return;this.removeControls(),this.isVisible=!0;let t=this.getButtons(),e=[];this.options.drawControls===!1&&(e=e.concat(Object.keys(t).filter(i=>!t[i]._button.tool))),this.options.editControls===!1&&(e=e.concat(Object.keys(t).filter(i=>t[i]._button.tool==="edit"))),this.options.optionsControls===!1&&(e=e.concat(Object.keys(t).filter(i=>t[i]._button.tool==="options"))),this.options.customControls===!1&&(e=e.concat(Object.keys(t).filter(i=>t[i]._button.tool==="custom")));for(let i in t)if(this.options[i]&&e.indexOf(i)===-1){let r=t[i]._button.tool;r||(r="draw"),t[i].setPosition(this._getBtnPosition(r)),t[i].addTo(this.map)}},_getBtnPosition(t){return this.options.positions&&this.options.positions[t]?this.options.positions[t]:this.options.position},setBlockPosition(t,e){this.options.positions[t]=e,this._showHideButtons(),this.changeControlOrder()},getBlockPositions(){return this.options.positions},copyDrawControl(t,e){if(e)typeof e!="object"&&(e={name:e});else throw new TypeError("Button has no name");let i=this._btnNameMapping(t);if(!e.name)throw new TypeError("Button has no name");if(this.buttons[e.name])throw new TypeError("Button with this name already exists");let r=this.map.pm.Draw.createNewDrawInstance(e.name,i);e={...this.buttons[i]._button,...e};let a=this.createCustomControl(e);return{drawInstance:r,control:a}},createCustomControl(t){if(!t.name)throw new TypeError("Button has no name");if(this.buttons[t.name])throw new TypeError("Button with this name already exists");t.onClick||(t.onClick=()=>{}),t.afterClick||(t.afterClick=()=>{}),t.toggle!==!1&&(t.toggle=!0),t.block&&(t.block=t.block.toLowerCase()),(!t.block||t.block==="draw")&&(t.block=""),t.className?t.className.indexOf("control-icon")===-1&&(t.className=`control-icon ${t.className}`):t.className="control-icon";let e={tool:t.block,className:t.className,title:t.title||"",jsClass:t.name,onClick:t.onClick,afterClick:t.afterClick,doToggle:t.toggle,toggleStatus:!1,disableOtherButtons:t.disableOtherButtons??!0,disableByOtherButtons:t.disableByOtherButtons??!0,cssToggle:t.toggle,position:this.options.position,actions:t.actions||[],disabled:!!t.disabled};this.options[t.name]!==!1&&(this.options[t.name]=!0);let i=this._addButton(t.name,new L.Control.PMButton(e));return this.changeControlOrder(),i},changeControlOrder(t=[]){let e=this._shapeMapping(),i=[];t.forEach(n=>{e[n]?i.push(e[n]):i.push(n)});let r=this.getButtons(),a={};i.forEach(n=>{r[n]&&(a[n]=r[n])}),Object.keys(r).filter(n=>!r[n]._button.tool).forEach(n=>{i.indexOf(n)===-1&&(a[n]=r[n])}),Object.keys(r).filter(n=>r[n]._button.tool==="edit").forEach(n=>{i.indexOf(n)===-1&&(a[n]=r[n])}),Object.keys(r).filter(n=>r[n]._button.tool==="options").forEach(n=>{i.indexOf(n)===-1&&(a[n]=r[n])}),Object.keys(r).filter(n=>r[n]._button.tool==="custom").forEach(n=>{i.indexOf(n)===-1&&(a[n]=r[n])}),Object.keys(r).forEach(n=>{i.indexOf(n)===-1&&(a[n]=r[n])}),this.map.pm.Toolbar.buttons=a,this._showHideButtons()},getControlOrder(){let t=this.getButtons(),e=[];for(let i in t)e.push(i);return e},changeActionsOfControl(t,e){let i=this._btnNameMapping(t);if(!i)throw new TypeError("No name passed");if(!e)throw new TypeError("No actions passed");if(!this.buttons[i])throw new TypeError("Button with this name not exists");this.buttons[i]._button.actions=e,this.changeControlOrder()},setButtonDisabled(t,e){let i=this._btnNameMapping(t);e?this.buttons[i].disable():this.buttons[i].enable()},_shapeMapping(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode",Text:"drawText"}},_btnNameMapping(t){let e=this._shapeMapping();return e[t]?e[t]:t}}),an=rn,nn=ut(Fe()),on={_initSnappableMarkers(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents(t){t.forEach(e=>{if(Array.isArray(e)){this._assignEvents(e);return}e.off("drag",this._handleSnapping,this),e.on("drag",this._handleSnapping,this),e.off("dragend",this._cleanupSnapping,this),e.on("dragend",this._cleanupSnapping,this)})},_cleanupSnapping(t){if(t){let e=t.target;e._snapped=!1}delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("layerremove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(e=>{e.remove()})},_handleThrottleSnapping(){this.throttledList&&this._createSnapList()},_handleSnapping(t){var l,u,p;let e=t.target;if(e._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),((l=t==null?void 0:t.originalEvent)==null?void 0:l.altKey)||((p=(u=this._map)==null?void 0:u.pm)==null?void 0:p.Keyboard.isAltKeyPressed())||(this._snapList===void 0&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0))return!1;let i=this._calcClosestLayer(e.getLatLng(),this._snapList);if(Object.keys(i).length===0)return!1;let r=i.layer instanceof L.Marker||i.layer instanceof L.CircleMarker||!this.options.snapSegment,a;r?a=i.latlng:a=this._checkPrioritiySnapping(i);let n=this.options.snapDistance,o={marker:e,shape:this._shape,snapLatLng:a,segment:i.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:i.layer,distance:i.distance};if(this._fireSnapDrag(o.marker,o),this._fireSnapDrag(this._layer,o),i.distance<n){e._orgLatLng=e.getLatLng(),e.setLatLng(a),e._snapped=!0,e._snapInfo=o;let _=()=>{this._snapLatLng=a,this._fireSnap(e,o),this._fireSnap(this._layer,o)},f=this._snapLatLng||{},B=a||{};(f.lat!==B.lat||f.lng!==B.lng)&&_()}else this._snapLatLng&&(this._unsnap(o),e._snapped=!1,e._snapInfo=void 0,this._fireUnsnap(o.marker,o),this._fireUnsnap(this._layer,o));return!0},_createSnapList(){let t=[],e=[],i=this._map;i.off("layerremove",this._handleSnapLayerRemoval,this),i.on("layerremove",this._handleSnapLayerRemoval,this),i.eachLayer(r=>{if((r instanceof L.Polyline||r instanceof L.Marker||r instanceof L.CircleMarker||r instanceof L.ImageOverlay)&&r.options.snapIgnore!==!0){if(r.options.snapIgnore===void 0&&(!L.PM.optIn&&r.options.pmIgnore===!0||L.PM.optIn&&r.options.pmIgnore!==!1))return;(r instanceof L.Circle||r instanceof L.CircleMarker)&&r.pm&&r.pm._hiddenPolyCircle?t.push(r.pm._hiddenPolyCircle):r instanceof L.ImageOverlay&&(r=L.rectangle(r.getBounds())),t.push(r);let a=L.polyline([],{color:"red",pmIgnore:!0});a._pmTempLayer=!0,e.push(a),(r instanceof L.Circle||r instanceof L.CircleMarker)&&e.push(a)}}),t=t.filter(r=>this._layer!==r),t=t.filter(r=>r._latlng||r._latlngs&&Ve(r._latlngs)),t=t.filter(r=>!r._pmTempLayer),this._otherSnapLayers?(this._otherSnapLayers.forEach(()=>{let r=L.polyline([],{color:"red",pmIgnore:!0});r._pmTempLayer=!0,e.push(r)}),this._snapList=t.concat(this._otherSnapLayers)):this._snapList=t,this.debugIndicatorLines=e},_handleSnapLayerRemoval({layer:t}){if(!t._leaflet_id)return;let e=this._snapList.findIndex(i=>i._leaflet_id===t._leaflet_id);e>-1&&this._snapList.splice(e,1)},_calcClosestLayer(t,e){return this._calcClosestLayers(t,e,1)[0]},_calcClosestLayers(t,e,i=1){let r=[],a={};e.forEach((o,l)=>{if(o._parentCopy&&o._parentCopy===this._layer)return;let u=this._calcLayerDistances(t,o);if(u.distance=Math.floor(u.distance),this.debugIndicatorLines){if(!this.debugIndicatorLines[l]){let p=L.polyline([],{color:"red",pmIgnore:!0});p._pmTempLayer=!0,this.debugIndicatorLines[l]=p}this.debugIndicatorLines[l].setLatLngs([t,u.latlng])}i===1&&(a.distance===void 0||u.distance-5<=a.distance)?(u.distance+5<a.distance&&(r=[]),a=u,a.layer=o,r.push(a)):i!==1&&(a={},a=u,a.layer=o,r.push(a))}),i!==1&&(r=r.sort((o,l)=>o.distance-l.distance)),i===-1&&(i=r.length);let n=this._getClosestLayerByPriority(r,i);return L.Util.isArray(n)?n:[n]},_calcLayerDistances(t,e){let i=this._map,r=e instanceof L.Marker||e instanceof L.CircleMarker,a=e instanceof L.Polygon,n=t;if(r){let o=e.getLatLng();return{latlng:{...o},distance:this._getDistance(i,o,n)}}return this._calcLatLngDistances(n,e.getLatLngs(),i,a)},_calcLatLngDistances(t,e,i,r=!1){let a,n,o,l=u=>{u.forEach((p,_)=>{if(Array.isArray(p)){l(p);return}if(this.options.snapSegment){let f=p,B;r?B=_+1===u.length?0:_+1:B=_+1===u.length?void 0:_+1;let P=u[B];if(P){let A=this._getDistanceToSegment(i,t,f,P);(n===void 0||A<n)&&(n=A,o=[f,P])}}else{let f=this._getDistance(i,t,p);(n===void 0||f<n)&&(n=f,a=p)}})};return l(e),this.options.snapSegment?{latlng:{...this._getClosestPointOnSegment(i,t,o[0],o[1])},segment:o,distance:n}:{latlng:a,distance:n}},_getClosestLayerByPriority(t,e=1){t=t.sort((o,l)=>o._leaflet_id-l._leaflet_id);let i=["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],r=this._map.pm.globalOptions.snappingOrder||[],a=0,n={};return r.concat(i).forEach(o=>{n[o]||(a+=1,n[o]=a)}),t.sort(Wa("instanceofShape",n)),e===1?t[0]||{}:t.slice(0,e)},_checkPrioritiySnapping(t){let e=this._map,i=t.segment[0],r=t.segment[1],a=t.latlng,n=this._getDistance(e,i,a),o=this._getDistance(e,r,a),l=n<o?i:r,u=n<o?n:o;if(this.options.snapMiddle){let f=L.PM.Utils.calcMiddleLatLng(e,i,r),B=this._getDistance(e,f,a);B<n&&B<o&&(l=f,u=B)}let p=this.options.snapDistance,_;return u<p?_=l:_=a,{..._}},_unsnap(){delete this._snapLatLng},_getClosestPointOnSegment(t,e,i,r){let a=t.getMaxZoom();a===1/0&&(a=t.getZoom());let n=t.project(e,a),o=t.project(i,a),l=t.project(r,a),u=L.LineUtil.closestPointOnSegment(n,o,l);return t.unproject(u,a)},_getDistanceToSegment(t,e,i,r){let a=t.latLngToLayerPoint(e),n=t.latLngToLayerPoint(i),o=t.latLngToLayerPoint(r);return L.LineUtil.pointToSegmentDistance(a,n,o)},_getDistance(t,e,i){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(i))}},xi=on,sn=L.Class.extend({includes:[xi,me],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,resizeableCircleMarker:!1,resizableCircle:!0,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1,rectangleAngle:0},setOptions(t){L.Util.setOptions(this,t),this.setStyle(this.options)},setStyle(){},getOptions(){return this.options},initialize(t){let e=new L.Icon.Default;e.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=e,this._map=t,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut","Text"],this.shapes.forEach(i=>{this[i]=new L.PM.Draw[i](this._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions(t,e=!1){e?this.options.pathOptions=(0,nn.default)(this.options.pathOptions,t):this.options.pathOptions=t},getShapes(){return this.shapes},getShape(){return this._shape},enable(t,e){if(!t)throw new Error(`Error: Please pass a shape as a parameter. Possible shapes are: ${this.getShapes().join(",")}`);this.disable(),this[t].enable(e)},disable(){this.shapes.forEach(t=>{this[t].disable()})},addControls(){this.shapes.forEach(t=>{this[t].addButton()})},getActiveShape(){let t;return this.shapes.forEach(e=>{this[e]._enabled&&(t=e)}),t},_setGlobalDrawMode(){this._shape==="Cut"?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();let t=L.PM.Utils.findLayers(this._map);this._enabled?t.forEach(e=>{L.PM.Utils.disablePopup(e)}):t.forEach(e=>{L.PM.Utils.enablePopup(e)})},createNewDrawInstance(t,e){let i=this._getShapeFromBtnName(e);if(this[t])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[i])throw new TypeError(`There is no class L.PM.Draw.${i}`);return this[t]=new L.PM.Draw[i](this._map),this[t].toolbarButtonName=t,this[t]._shape=t,this.shapes.push(t),this[e]&&this[t].setOptions(this[e].options),this[t].setOptions(this[t].options),this[t]},_getShapeFromBtnName(t){let e={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate",drawText:"Text"};return e[t]?e[t]:this[t]?this[t]._shape:t},_finishLayer(t){t.pm&&(t.pm.setOptions(this.options),t.pm._shape=this._shape,t.pm._map=this._map),this._addDrawnLayerProp(t)},_addDrawnLayerProp(t){t._drawnByGeoman=!0},_setPane(t,e){e==="layerPane"?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":e==="vertexPane"?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":e==="markerPane"&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer(){return(this._map||this._layer._map).pm.getGeomanLayers().length===0}}),st=sn;st.Marker=st.extend({initialize(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(Y("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(e=>{this.isRelevantMarker(e)&&e.pm.enable()}),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(t=>{this.isRelevantMarker(t)&&t.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},isRelevantMarker(t){return t instanceof L.Marker&&t.pm&&!t._pmTempLayer&&!t.pm._initTextMarker},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){let e=t;e.target=this._hintMarker,this._handleSnapping(e)}this._fireChange(this._hintMarker.getLatLng(),"Draw")},_createMarker(t){if(!t.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=new L.Marker(e,this.options.markerStyle);this._setPane(i,"markerPane"),this._finishLayer(i),i.pm||(i.options.draggable=!1),i.addTo(this._map.pm._getContainingLayer()),i.pm&&this.options.markerEditable?i.pm.enable():i.dragging&&i.dragging.disable(),this._fireCreate(i),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},setStyle(){var t,e;(t=this.options.markerStyle)!=null&&t.icon&&((e=this._hintMarker)==null||e.setIcon(this.options.markerStyle.icon))}});var dt=63710088e-1,wi={centimeters:dt*100,centimetres:dt*100,degrees:dt/111325,feet:dt*3.28084,inches:dt*39.37,kilometers:dt/1e3,kilometres:dt/1e3,meters:dt,metres:dt,miles:dt/1609.344,millimeters:dt*1e3,millimetres:dt*1e3,nauticalmiles:dt/1852,radians:1,yards:dt*1.0936};function qt(t,e,i){i===void 0&&(i={});var r={type:"Feature"};return(i.id===0||i.id)&&(r.id=i.id),i.bbox&&(r.bbox=i.bbox),r.properties=e||{},r.geometry=t,r}function Jt(t,e,i){if(i===void 0&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Ci(t[0])||!Ci(t[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:t};return qt(r,e,i)}function $t(t,e,i){if(i===void 0&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:t};return qt(r,e,i)}function St(t,e){e===void 0&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}function ln(t,e){e===void 0&&(e="kilometers");var i=wi[e];if(!i)throw new Error(e+" units is invalid");return t*i}function hn(t,e){e===void 0&&(e="kilometers");var i=wi[e];if(!i)throw new Error(e+" units is invalid");return t/i}function He(t){var e=t%(2*Math.PI);return e*180/Math.PI}function mt(t){var e=t%360;return e*Math.PI/180}function Ci(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function Le(t){var e,i,r={type:"FeatureCollection",features:[]};if(t.type==="Feature"?i=t.geometry:i=t,i.type==="LineString")e=[i.coordinates];else if(i.type==="MultiLineString")e=i.coordinates;else if(i.type==="MultiPolygon")e=[].concat.apply([],i.coordinates);else if(i.type==="Polygon")e=i.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return e.forEach(function(a){e.forEach(function(n){for(var o=0;o<a.length-1;o++)for(var l=o;l<n.length-1;l++)if(!(a===n&&(Math.abs(o-l)===1||o===0&&l===a.length-2&&a[o][0]===a[a.length-1][0]&&a[o][1]===a[a.length-1][1]))){var u=un(a[o][0],a[o][1],a[o+1][0],a[o+1][1],n[l][0],n[l][1],n[l+1][0],n[l+1][1]);u&&r.features.push(Jt([u[0],u[1]]))}})}),r}function un(t,e,i,r,a,n,o,l){var u,p,_,f,B,P={x:null,y:null,onLine1:!1,onLine2:!1};return u=(l-n)*(i-t)-(o-a)*(r-e),u===0?P.x!==null&&P.y!==null?P:!1:(p=e-n,_=t-a,f=(o-a)*p-(l-n)*_,B=(i-t)*p-(r-e)*_,p=f/u,_=B/u,P.x=t+p*(i-t),P.y=e+p*(r-e),p>=0&&p<=1&&(P.onLine1=!0),_>=0&&_<=1&&(P.onLine2=!0),P.onLine1&&P.onLine2?[P.x,P.y]:!1)}st.Line=st.extend({initialize(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._markers=[],this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],{...this.options.templineStyle,pmIgnore:!1}),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Y("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._createVertex,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.on(this.options.finishOn,this._finishShape,this),this.options.finishOn==="dblclick"&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this.isRed=!1,this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this.options.finishOn!=="snap"&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine(){let t=this._layer.getLatLngs();if(t.length>0){let e=t[t.length-1];this._hintline.setLatLngs([e,this._hintMarker.getLatLng()])}},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){let i=t;i.target=this._hintMarker,this._handleSnapping(i)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,this._hintMarker.getLatLng());let e=this._layer._defaultShape().slice();e.push(this._hintMarker.getLatLng()),this._change(e)},hasSelfIntersection(){return Le(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection(t,e){let i=L.polyline(this._layer.getLatLngs());t&&(e||(e=this._hintMarker.getLatLng()),i.addLatLng(e));let r=Le(i.toGeoJSON(15));this._doesSelfIntersect=r.features.length>0,this._doesSelfIntersect?this.isRed||(this.isRed=!0,this._hintline.setStyle({color:"#f00000ff"}),this._fireIntersect(r,this._map,"Draw")):this._hintline.isEmpty()||(this.isRed=!1,this._hintline.setStyle(this.options.hintlineStyle))},_createVertex(t){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,t.latlng),this._doesSelfIntersect))return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=this._layer.getLatLngs(),r=i[i.length-1];if(e.equals(i[0])||i.length>0&&e.equals(r)){this._finishShape();return}this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:e,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(e);let a=this._createMarker(e);this._setTooltipText(),this._setHintLineAfterNewVertex(e),this._fireVertexAdded(a,void 0,e,"Draw"),this._change(this._layer.getLatLngs()),this.options.finishOn==="snap"&&this._hintMarker._snapped&&this._finishShape(t)},_setHintLineAfterNewVertex(t){this._hintline.setLatLngs([t,t])},_removeLastVertex(){let t=this._markers;if(t.length<=1){this.disable();return}let e=this._layer.getLatLngs(),i=t[t.length-1],{indexPath:r}=L.PM.Utils.findDeepMarkerIndex(t,i);t.pop(),this._layerGroup.removeLayer(i);let a=t[t.length-1],n=e.indexOf(a.getLatLng());e=e.slice(0,n+1),this._layer.setLatLngs(e),this._layer._latlngInfo.pop(),this._syncHintLine(),this._setTooltipText(),this._fireVertexRemoved(i,r,"Draw"),this._change(this._layer.getLatLngs())},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=1)return;let e=L.polyline(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this.options.snappable&&this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()},_createMarker(t){let e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),this._markers.push(e),e.on("click",this._finishShape,this),e},_setTooltipText(){let{length:t}=this._layer.getLatLngs().flat(),e="";t<=1?e=Y("tooltips.continueLine"):e=Y("tooltips.finishLine"),this._hintMarker.setTooltipContent(e)},_change(t){this._fireChange(t,"Draw")},setStyle(){var t,e;(t=this._layer)==null||t.setStyle(this.options.templineStyle),(e=this._hintline)==null||e.setStyle(this.options.hintlineStyle)}}),st.Polygon=st.Line.extend({initialize(t){this._map=t,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},enable(t){L.PM.Draw.Line.prototype.enable.call(this,t),this._layer.pm._shape="Polygon"},_createMarker(t){let e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),this._markers.push(e),this._layer.getLatLngs().flat().length===1?(e.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(e)-1,this.options.snappable&&this._cleanupSnapping()):e.on("click",()=>1),e},_setTooltipText(){let{length:t}=this._layer.getLatLngs().flat(),e="";t<=2?e=Y("tooltips.continueLine"):e=Y("tooltips.finishPoly"),this._hintMarker.setTooltipContent(e)},_finishShape(){if(!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=2)return;let e=L.polygon(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this.disable(),this.options.continueDrawing&&this.enable()}}),st.Rectangle=st.extend({initialize(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable(t){if(L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Y("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){this._styleMarkers=[];for(let e=0;e<2;e+=1){let i=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(i,"vertexPane"),i._pmTempLayer=!0,this._layerGroup.addLayer(i),this._styleMarkers.push(i)}}this._map.getContainer().classList.add("geoman-draw-cursor"),this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(i=>{L.DomUtil.addClass(i._icon,"visible"),i.setLatLng(e)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(Y("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin(){let t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){let i=t;i.target=this._hintMarker,this._handleSnapping(i)}let e=this._layerGroup&&this._layerGroup.hasLayer(this._layer)?this._layer.getLatLngs():[this._hintMarker.getLatLng()];this._fireChange(e,"Draw")},_syncRectangleSize(){let t=Mi(this._startMarker.getLatLng(),this._map),e=Mi(this._hintMarker.getLatLng(),this._map),i=L.PM.Utils._getRotatedRectangle(t,e,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(i),this.options.cursorMarker&&this._styleMarkers){let r=[];i.forEach(a=>{!a.equals(t,1e-8)&&!a.equals(e,1e-8)&&r.push(a)}),r.forEach((a,n)=>{try{this._styleMarkers[n].setLatLng(a)}catch{}})}},_findCorners(){let t=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(t[0],t[2],this.options.rectangleAngle||0,this._map)},_finishShape(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=this._startMarker.getLatLng();if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let r=L.rectangle([i,e],this.options.pathOptions);if(this.options.rectangleAngle){let a=L.PM.Utils._getRotatedRectangle(i,e,this.options.rectangleAngle||0,this._map);r.setLatLngs(a),r.pm&&r.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(r,"layerPane"),this._finishLayer(r),r.addTo(this._map.pm._getContainingLayer()),this._fireCreate(r),this.disable(),this.options.continueDrawing&&this.enable()},setStyle(){var t;(t=this._layer)==null||t.setStyle(this.options.pathOptions)}}),st.CircleMarker=st.extend({initialize(t){this._map=t,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1,this._BaseCircleClass=L.CircleMarker,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._defaultRadius=10},enable(t){if(L.Util.setOptions(this,t),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._map.getContainer().classList.add("geoman-draw-cursor"),this.options[this._editableOption]){let e={};L.extend(e,this.options.templineStyle),e.radius=0,this._layerGroup=new L.FeatureGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=new this._BaseCircleClass(this._map.getCenter(),e),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._centerMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._hintMarker=L.marker(this._map.getCenter(),{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Y("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this)}else this._map.on("click",this._createMarker,this),this._hintMarker=new this._BaseCircleClass(this._map.getCenter(),{radius:this._defaultRadius,...this.options.templineStyle}),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(Y("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip();this._map.on("mousemove",this._syncHintMarker,this),this._extendingEnable(),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},_extendingEnable(){!this.options[this._editableOption]&&this.options.markerEditable&&this._map.eachLayer(t=>{this.isRelevantMarker(t)&&t.pm.enable()}),this._layer.bringToBack()},disable(){this._enabled&&(this._enabled=!1,this._map.getContainer().classList.remove("geoman-draw-cursor"),this.options[this._editableOption]?(this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._extendingDisable(),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_extendingDisable(){this._map.eachLayer(t=>{this.isRelevantMarker(t)&&t.pm.disable()})},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_placeCenterMarker(t){this._layerGroup.addLayer(this._layer),this._layerGroup.addLayer(this._centerMarker),this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng();this._layerGroup.addLayer(this._layer),this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter(){let t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(Y("tooltips.finishCircle")),this._fireCenterPlaced(),this._fireChange(this._layer.getLatLng(),"Draw"))},_syncHintLine(){let t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius(){let t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),i=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(i)},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){let i=t;i.target=this._hintMarker,this._handleSnapping(i)}this._handleHintMarkerSnapping();let e=this._layerGroup&&this._layerGroup.hasLayer(this._centerMarker)?this._centerMarker.getLatLng():this._hintMarker.getLatLng();this._fireChange(e,"Draw")},isRelevantMarker(t){return t instanceof L.CircleMarker&&!(t instanceof L.Circle)&&t.pm&&!t._pmTempLayer},_createMarker(t){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer()||!t.latlng||this._layerIsDragging)return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng(),i=new this._BaseCircleClass(e,{radius:this._defaultRadius,...this.options.pathOptions});this._setPane(i,"layerPane"),this._finishLayer(i),i.addTo(this._map.pm._getContainingLayer()),this._extendingCreateMarker(i),this._fireCreate(i),this._cleanupSnapping(),this.options.continueDrawing||this.disable()},_extendingCreateMarker(t){t.pm&&this.options.markerEditable&&t.pm.enable()},_finishShape(t){if(this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._centerMarker.getLatLng(),i=this._defaultRadius;if(this.options[this._editableOption]){let n=this._hintMarker.getLatLng();i=this._distanceCalculation(e,n),this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?i=this.options[this._minRadiusOption]:this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(i=this.options[this._maxRadiusOption])}let r={...this.options.pathOptions,radius:i},a=new this._BaseCircleClass(e,r);this._setPane(a,"layerPane"),this._finishLayer(a),a.addTo(this._map.pm._getContainingLayer()),a.pm&&a.pm._updateHiddenPolyCircle(),this._fireCreate(a),this.disable(),this.options.continueDrawing&&this.enable()},_getNewDestinationOfHintMarker(){let t=this._hintMarker.getLatLng();if(this.options[this._editableOption]){if(!this._layerGroup.hasLayer(this._centerMarker))return t;let e=this._centerMarker.getLatLng(),i=this._distanceCalculation(e,t);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?t=ve(this._map,e,t,this._getMinDistanceInMeter()):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(t=ve(this._map,e,t,this._getMaxDistanceInMeter()))}return t},_getMinDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,this._centerMarker.getLatLng())},_getMaxDistanceInMeter(){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,this._centerMarker.getLatLng())},_handleHintMarkerSnapping(){if(this.options[this._editableOption]){if(this._hintMarker._snapped){let t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),i=this._distanceCalculation(t,e);this._layerGroup.hasLayer(this._centerMarker)&&(this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._hintMarker.setLatLng(this._hintMarker._orgLatLng):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng))}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},setStyle(){var e,i;let t={};L.extend(t,this.options.templineStyle),this.options[this._editableOption]&&(t.radius=0),(e=this._layer)==null||e.setStyle(t),(i=this._hintline)==null||i.setStyle(this.options.hintlineStyle)},_distanceCalculation(t,e){return this._map.project(t).distanceTo(this._map.project(e))}}),st.Circle=st.CircleMarker.extend({initialize(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle",this._BaseCircleClass=L.Circle,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizableCircle",this._defaultRadius=100},_extendingEnable(){},_extendingDisable(){},_extendingCreateMarker(){},isRelevantMarker(){},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_distanceCalculation(t,e){return this._map.distance(t,e)}});function bt(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function kt(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function be(t){return t.type==="Feature"?t.geometry:t}function Ei(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}function qe(t,e,i){if(t!==null)for(var r,a,n,o,l,u,p,_=0,f=0,B,P=t.type,A=P==="FeatureCollection",z=P==="Feature",N=A?t.features.length:1,q=0;q<N;q++){p=A?t.features[q].geometry:z?t.geometry:t,B=p?p.type==="GeometryCollection":!1,l=B?p.geometries.length:1;for(var k=0;k<l;k++){var d=0,v=0;if(o=B?p.geometries[k]:p,o!==null){u=o.coordinates;var x=o.type;switch(_=i&&(x==="Polygon"||x==="MultiPolygon")?1:0,x){case null:break;case"Point":if(e(u,f,q,d,v)===!1)return!1;f++,d++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(e(u[r],f,q,d,v)===!1)return!1;f++,x==="MultiPoint"&&d++}x==="LineString"&&d++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(a=0;a<u[r].length-_;a++){if(e(u[r][a],f,q,d,v)===!1)return!1;f++}x==="MultiLineString"&&d++,x==="Polygon"&&v++}x==="Polygon"&&d++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(v=0,a=0;a<u[r].length;a++){for(n=0;n<u[r][a].length-_;n++){if(e(u[r][a][n],f,q,d,v)===!1)return!1;f++}v++}d++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(qe(o.geometries[r],e,i)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function te(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var i=0;i<t.features.length&&e(t.features[i],i)!==!1;i++);}function pn(t,e,i){var r=i;return te(t,function(a,n){n===0&&i===void 0?r=a:r=e(r,a,n)}),r}function cn(t,e){var i,r,a,n,o,l,u,p,_,f,B=0,P=t.type==="FeatureCollection",A=t.type==="Feature",z=P?t.features.length:1;for(i=0;i<z;i++){for(l=P?t.features[i].geometry:A?t.geometry:t,p=P?t.features[i].properties:A?t.properties:{},_=P?t.features[i].bbox:A?t.bbox:void 0,f=P?t.features[i].id:A?t.id:void 0,u=l?l.type==="GeometryCollection":!1,o=u?l.geometries.length:1,a=0;a<o;a++){if(n=u?l.geometries[a]:l,n===null){if(e(null,B,p,_,f)===!1)return!1;continue}switch(n.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(n,B,p,_,f)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<n.geometries.length;r++)if(e(n.geometries[r],B,p,_,f)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}B++}}function Je(t,e){cn(t,function(i,r,a,n,o){var l=i===null?null:i.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return e(qt(i,a,{bbox:n,id:o}),r,0)===!1?!1:void 0}var u;switch(l){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var p=0;p<i.coordinates.length;p++){var _=i.coordinates[p],f={type:u,coordinates:_};if(e(qt(f,a),r,p)===!1)return!1}})}function dn(t){if(!t)throw new Error("geojson is required");var e=[];return Je(t,function(i){gn(i,e)}),St(e)}function gn(t,e){var i=[],r=t.geometry;if(r!==null){switch(r.type){case"Polygon":i=kt(r);break;case"LineString":i=[kt(r)]}i.forEach(function(a){var n=fn(a,t.properties);n.forEach(function(o){o.id=e.length,e.push(o)})})}}function fn(t,e){var i=[];return t.reduce(function(r,a){var n=$t([r,a],e);return n.bbox=_n(r,a),i.push(n),a}),i}function _n(t,e){var i=t[0],r=t[1],a=e[0],n=e[1],o=i<a?i:a,l=r<n?r:n,u=i>a?i:a,p=r>n?r:n;return[o,l,u,p]}var Ye=dn,mn=ut(Li(),1);function yn(t,e){var i={},r=[];if(t.type==="LineString"&&(t=qt(t)),e.type==="LineString"&&(e=qt(e)),t.type==="Feature"&&e.type==="Feature"&&t.geometry!==null&&e.geometry!==null&&t.geometry.type==="LineString"&&e.geometry.type==="LineString"&&t.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var a=Pi(t,e);return a&&r.push(a),St(r)}var n=(0,mn.default)();return n.load(Ye(e)),te(Ye(t),function(o){te(n.search(o),function(l){var u=Pi(o,l);if(u){var p=kt(u).join(",");i[p]||(i[p]=!0,r.push(u))}})}),St(r)}function Pi(t,e){var i=kt(t),r=kt(e);if(i.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var a=i[0][0],n=i[0][1],o=i[1][0],l=i[1][1],u=r[0][0],p=r[0][1],_=r[1][0],f=r[1][1],B=(f-p)*(o-a)-(_-u)*(l-n),P=(_-u)*(n-p)-(f-p)*(a-u),A=(o-a)*(n-p)-(l-n)*(a-u);if(B===0)return null;var z=P/B,N=A/B;if(z>=0&&z<=1&&N>=0&&N<=1){var q=a+z*(o-a),k=n+z*(l-n);return Jt([q,k])}return null}var At=yn,Si=ut(Li(),1);function vn(t,e,i){i===void 0&&(i={});var r=bt(t),a=bt(e),n=mt(a[1]-r[1]),o=mt(a[0]-r[0]),l=mt(r[1]),u=mt(a[1]),p=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(l)*Math.cos(u);return ln(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)),i.units)}var jt=vn;function Ln(t){var e=t[0],i=t[1],r=t[2],a=t[3],n=jt(t.slice(0,2),[r,i]),o=jt(t.slice(0,2),[e,a]);if(n>=o){var l=(i+a)/2;return[e,l-(r-e)/2,r,l+(r-e)/2]}else{var u=(e+r)/2;return[u-(a-i)/2,i,u+(a-i)/2,a]}}var bn=Ln;function Xe(t){var e=[1/0,1/0,-1/0,-1/0];return qe(t,function(i){e[0]>i[0]&&(e[0]=i[0]),e[1]>i[1]&&(e[1]=i[1]),e[2]<i[0]&&(e[2]=i[0]),e[3]<i[1]&&(e[3]=i[1])}),e}Xe.default=Xe;var ee=Xe;function kn(t,e){e===void 0&&(e={});var i=e.precision,r=e.coordinates,a=e.mutate;if(i=i==null||isNaN(i)?6:i,r=r==null||isNaN(r)?3:r,!t)throw new Error("<geojson> is required");if(typeof i!="number")throw new Error("<precision> must be a number");if(typeof r!="number")throw new Error("<coordinates> must be a number");(a===!1||a===void 0)&&(t=JSON.parse(JSON.stringify(t)));var n=Math.pow(10,i);return qe(t,function(o){Mn(o,n,r)}),t}function Mn(t,e,i){t.length>i&&t.splice(i,t.length);for(var r=0;r<t.length;r++)t[r]=Math.round(t[r]*e)/e;return t}var xn=kn;function Bi(t,e,i){if(i===void 0&&(i={}),i.final===!0)return wn(t,e);var r=bt(t),a=bt(e),n=mt(r[0]),o=mt(a[0]),l=mt(r[1]),u=mt(a[1]),p=Math.sin(o-n)*Math.cos(u),_=Math.cos(l)*Math.sin(u)-Math.sin(l)*Math.cos(u)*Math.cos(o-n);return He(Math.atan2(p,_))}function wn(t,e){var i=Bi(e,t);return i=(i+180)%360,i}function Di(t,e,i,r){r===void 0&&(r={});var a=bt(t),n=mt(a[0]),o=mt(a[1]),l=mt(i),u=hn(e,r.units),p=Math.asin(Math.sin(o)*Math.cos(u)+Math.cos(o)*Math.sin(u)*Math.cos(l)),_=n+Math.atan2(Math.sin(l)*Math.sin(u)*Math.cos(o),Math.cos(u)-Math.sin(o)*Math.sin(p)),f=He(_),B=He(p);return Jt([f,B],r.properties)}function Cn(t,e,i){i===void 0&&(i={});var r=Jt([1/0,1/0],{dist:1/0}),a=0;return Je(t,function(n){for(var o=kt(n),l=0;l<o.length-1;l++){var u=Jt(o[l]);u.properties.dist=jt(e,u,i);var p=Jt(o[l+1]);p.properties.dist=jt(e,p,i);var _=jt(u,p,i),f=Math.max(u.properties.dist,p.properties.dist),B=Bi(u,p),P=Di(e,f,B+90,i),A=Di(e,f,B-90,i),z=At($t([P.geometry.coordinates,A.geometry.coordinates]),$t([u.geometry.coordinates,p.geometry.coordinates])),N=null;z.features.length>0&&(N=z.features[0],N.properties.dist=jt(e,N,i),N.properties.location=a+jt(u,N,i)),u.properties.dist<r.properties.dist&&(r=u,r.properties.index=l,r.properties.location=a),p.properties.dist<r.properties.dist&&(r=p,r.properties.index=l+1,r.properties.location=a+_),N&&N.properties.dist<r.properties.dist&&(r=N,r.properties.index=l),a+=_}}),r}var En=Cn;function Pn(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var i=Ei(t),r=Ei(e);if(i!=="LineString")throw new Error("line must be LineString");if(r==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(r==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var a=xn(e,{precision:7});switch(r){case"Point":return Ze(t,a);case"MultiPoint":return Ri(t,a);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Ri(t,At(t,a))}}function Ri(t,e){var i=[],r=(0,Si.default)();return Je(e,function(a){if(i.forEach(function(l,u){l.id=u}),!i.length)i=Ze(t,a).features,i.forEach(function(l){l.bbox||(l.bbox=bn(ee(l)))}),r.load(St(i));else{var n=r.search(a);if(n.features.length){var o=Ti(a,n);i=i.filter(function(l){return l.id!==o.id}),r.remove(o),te(Ze(o,a),function(l){i.push(l),r.insert(l)})}}}),St(i)}function Ze(t,e){var i=[],r=kt(t)[0],a=kt(t)[t.geometry.coordinates.length-1];if(We(r,bt(e))||We(a,bt(e)))return St([t]);var n=(0,Si.default)(),o=Ye(t);n.load(o);var l=n.search(e);if(!l.features.length)return St([t]);var u=Ti(e,l),p=[r],_=pn(o,function(f,B,P){var A=kt(B)[1],z=bt(e);return P===u.id?(f.push(z),i.push($t(f)),We(z,A)?[z]:[z,A]):(f.push(A),f)},p);return _.length>1&&i.push($t(_)),St(i)}function Ti(t,e){if(!e.features.length)throw new Error("lines must contain features");if(e.features.length===1)return e.features[0];var i,r=1/0;return te(e,function(a){var n=En(a,t),o=n.properties.dist;o<r&&(i=a,r=o)}),i}function We(t,e){return t[0]===e[0]&&t[1]===e[1]}var Sn=Pn;function ke(t,e,i){if(i===void 0&&(i={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=bt(t),a=be(e),n=a.type,o=e.bbox,l=a.coordinates;if(o&&Bn(r,o)===!1)return!1;n==="Polygon"&&(l=[l]);for(var u=!1,p=0;p<l.length&&!u;p++)if(Oi(r,l[p][0],i.ignoreBoundary)){for(var _=!1,f=1;f<l[p].length&&!_;)Oi(r,l[p][f],!i.ignoreBoundary)&&(_=!0),f++;_||(u=!0)}return u}function Oi(t,e,i){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var a=0,n=e.length-1;a<e.length;n=a++){var o=e[a][0],l=e[a][1],u=e[n][0],p=e[n][1],_=t[1]*(o-u)+l*(u-t[0])+p*(t[0]-o)===0&&(o-t[0])*(u-t[0])<=0&&(l-t[1])*(p-t[1])<=0;if(_)return!i;var f=l>t[1]!=p>t[1]&&t[0]<(u-o)*(t[1]-l)/(p-l)+o;f&&(r=!r)}return r}function Bn(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}function Dn(t,e,i){i===void 0&&(i={});for(var r=bt(t),a=kt(e),n=0;n<a.length-1;n++){var o=!1;if(i.ignoreEndVertices&&(n===0&&(o="start"),n===a.length-2&&(o="end"),n===0&&n+1===a.length-1&&(o="both")),Rn(a[n],a[n+1],r,o,typeof i.epsilon>"u"?null:i.epsilon))return!0}return!1}function Rn(t,e,i,r,a){var n=i[0],o=i[1],l=t[0],u=t[1],p=e[0],_=e[1],f=i[0]-l,B=i[1]-u,P=p-l,A=_-u,z=f*A-B*P;if(a!==null){if(Math.abs(z)>a)return!1}else if(z!==0)return!1;if(r){if(r==="start")return Math.abs(P)>=Math.abs(A)?P>0?l<n&&n<=p:p<=n&&n<l:A>0?u<o&&o<=_:_<=o&&o<u;if(r==="end")return Math.abs(P)>=Math.abs(A)?P>0?l<=n&&n<p:p<n&&n<=l:A>0?u<=o&&o<_:_<o&&o<=u;if(r==="both")return Math.abs(P)>=Math.abs(A)?P>0?l<n&&n<p:p<n&&n<l:A>0?u<o&&o<_:_<o&&o<u}else return Math.abs(P)>=Math.abs(A)?P>0?l<=n&&n<=p:p<=n&&n<=l:A>0?u<=o&&o<=_:_<=o&&o<=u;return!1}var ie=Dn;function Tn(t,e){var i=be(t),r=be(e),a=i.type,n=r.type,o=i.coordinates,l=r.coordinates;switch(a){case"Point":switch(n){case"Point":return Qe(o,l);default:throw new Error("feature2 "+n+" geometry not supported")}case"MultiPoint":switch(n){case"Point":return On(i,r);case"MultiPoint":return In(i,r);default:throw new Error("feature2 "+n+" geometry not supported")}case"LineString":switch(n){case"Point":return ie(r,i,{ignoreEndVertices:!0});case"LineString":return Gn(i,r);case"MultiPoint":return An(i,r);default:throw new Error("feature2 "+n+" geometry not supported")}case"Polygon":switch(n){case"Point":return ke(r,i,{ignoreBoundary:!0});case"LineString":return zn(i,r);case"Polygon":return Nn(i,r);case"MultiPoint":return jn(i,r);default:throw new Error("feature2 "+n+" geometry not supported")}default:throw new Error("feature1 "+a+" geometry not supported")}}function On(t,e){var i,r=!1;for(i=0;i<t.coordinates.length;i++)if(Qe(t.coordinates[i],e.coordinates)){r=!0;break}return r}function In(t,e){for(var i=0,r=e.coordinates;i<r.length;i++){for(var a=r[i],n=!1,o=0,l=t.coordinates;o<l.length;o++){var u=l[o];if(Qe(a,u)){n=!0;break}}if(!n)return!1}return!0}function An(t,e){for(var i=!1,r=0,a=e.coordinates;r<a.length;r++){var n=a[r];if(ie(n,t,{ignoreEndVertices:!0})&&(i=!0),!ie(n,t))return!1}return!!i}function jn(t,e){for(var i=0,r=e.coordinates;i<r.length;i++){var a=r[i];if(!ke(a,t,{ignoreBoundary:!0}))return!1}return!0}function Gn(t,e){for(var i=!1,r=0,a=e.coordinates;r<a.length;r++){var n=a[r];if(ie({type:"Point",coordinates:n},t,{ignoreEndVertices:!0})&&(i=!0),!ie({type:"Point",coordinates:n},t,{ignoreEndVertices:!1}))return!1}return i}function zn(t,e){var i=!1,r=0,a=ee(t),n=ee(e);if(!Ii(a,n))return!1;for(r;r<e.coordinates.length-1;r++){var o=Fn(e.coordinates[r],e.coordinates[r+1]);if(ke({type:"Point",coordinates:o},t,{ignoreBoundary:!0})){i=!0;break}}return i}function Nn(t,e){if(t.type==="Feature"&&t.geometry===null||e.type==="Feature"&&e.geometry===null)return!1;var i=ee(t),r=ee(e);if(!Ii(i,r))return!1;for(var a=be(e).coordinates,n=0,o=a;n<o.length;n++)for(var l=o[n],u=0,p=l;u<p.length;u++){var _=p[u];if(!ke(_,t))return!1}return!0}function Ii(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function Qe(t,e){return t[0]===e[0]&&t[1]===e[1]}function Fn(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}var Un=ut(_e()),Ai=ut(sa());function Me(t){let e={type:"Feature"};return e.geometry=t,e}function xe(t){return t.type==="Feature"?t.geometry:t}function ji(t){return t&&t.geometry&&t.geometry.coordinates?t.geometry.coordinates:t}function Vn(t){return Me({type:"LineString",coordinates:t})}function Kn(t){return Me({type:"MultiLineString",coordinates:t})}function Gi(t){return Me({type:"Polygon",coordinates:t})}function zi(t){return Me({type:"MultiPolygon",coordinates:t})}function Hn(t,e){let i=xe(t),r=xe(e),a=Ai.default.intersection(i.coordinates,r.coordinates);return a.length===0?null:a.length===1?Gi(a[0]):zi(a)}function qn(t,e){let i=xe(t),r=xe(e),a=Ai.default.difference(i.coordinates,r.coordinates);return a.length===0?null:a.length===1?Gi(a[0]):zi(a)}function Ni(t){return Array.isArray(t)?1+Ni(t[0]):-1}function Jn(t){t instanceof L.Polyline&&(t=t.toGeoJSON(15));let e=ji(t),i=Ni(e),r=[];return i>1?e.forEach(a=>{r.push(Vn(a))}):r.push(t),r}function Yn(t){let e=[];return t.eachLayer(i=>{e.push(ji(i.toGeoJSON(15)))}),Kn(e)}st.Cut=st.Polygon.extend({initialize(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape(){if(this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;let t=this._layer.getLatLngs();if(t.length<=2)return;let e=L.polygon(t,this.options.pathOptions);e._latlngInfos=this._layer._latlngInfo,this.cut(e),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(({layer:i,originalLayer:r})=>{this._fireCut(r,i,r),this._fireCut(this._map,i,r),r.pm._fireEdit()}),this._editedLayers=[],this.disable(),this.options.continueDrawing&&this.enable()},cut(t){let e=this._map._layers,i=t._latlngInfos||[];Object.keys(e).map(r=>e[r]).filter(r=>r.pm).filter(r=>!r._pmTempLayer).filter(r=>!L.PM.optIn&&!r.options.pmIgnore||L.PM.optIn&&r.options.pmIgnore===!1).filter(r=>r instanceof L.Polyline).filter(r=>r!==t).filter(r=>r.pm.options.allowCutting).filter(r=>this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0?this.options.layersToCut.indexOf(r)>-1:!0).filter(r=>!this._layerGroup.hasLayer(r)).filter(r=>{try{let a=!!At(t.toGeoJSON(15),r.toGeoJSON(15)).features.length>0;return a||r instanceof L.Polyline&&!(r instanceof L.Polygon)?a:!!Hn(t.toGeoJSON(15),r.toGeoJSON(15))}catch{return r instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}}).forEach(r=>{let a;if(r instanceof L.Polygon){a=L.polygon(r.getLatLngs());let u=a.getLatLngs();i.forEach(p=>{if(p&&p.snapInfo){let{latlng:_}=p,f=this._calcClosestLayer(_,[a]);if(f&&f.segment&&f.distance<this.options.snapDistance){let{segment:B}=f;if(B&&B.length===2){let{indexPath:P,parentPath:A,newIndex:z}=L.PM.Utils._getIndexFromSegment(u,B);(P.length>1?(0,Un.default)(u,A):u).splice(z,0,_)}}}})}else a=r;let n=this._cutLayer(t,a),o=L.geoJSON(n,r.options);o.getLayers().length===1&&([o]=o.getLayers()),this._setPane(o,"layerPane");let l=o.addTo(this._map.pm._getContainingLayer());if(l.pm.enable(r.pm.options),l.pm.disable(),r._pmTempLayer=!0,t._pmTempLayer=!0,r.remove(),r.removeFrom(this._map.pm._getContainingLayer()),t.remove(),t.removeFrom(this._map.pm._getContainingLayer()),l.getLayers&&l.getLayers().length===0&&this._map.pm.removeLayer({target:l}),l instanceof L.LayerGroup?(l.eachLayer(u=>{this._addDrawnLayerProp(u)}),this._addDrawnLayerProp(l)):this._addDrawnLayerProp(l),this.options.layersToCut&&L.Util.isArray(this.options.layersToCut)&&this.options.layersToCut.length>0){let u=this.options.layersToCut.indexOf(r);u>-1&&this.options.layersToCut.splice(u,1)}this._editedLayers.push({layer:l,originalLayer:r})})},_cutLayer(t,e){let i=L.geoJSON(),r;if(e instanceof L.Polygon)r=qn(e.toGeoJSON(15),t.toGeoJSON(15));else{let a=Jn(e);a.forEach(n=>{let o=Sn(n,t.toGeoJSON(15)),l;o&&o.features.length>0?l=L.geoJSON(o):l=L.geoJSON(n),l.getLayers().forEach(u=>{Tn(t.toGeoJSON(15),u.toGeoJSON(15))||u.addTo(i)})}),a.length>1?r=Yn(i):r=i.toGeoJSON(15)}return r},_change:L.Util.falseFn}),st.Text=st.extend({initialize(t){this._map=t,this._shape="Text",this.toolbarButtonName="drawText"},enable(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(Y("tooltips.placeText"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.getContainer().classList.add("geoman-draw-cursor"),this._fireDrawStart(),this._setGlobalDrawMode()},disable(){var t;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),(t=this._hintMarker)==null||t.remove(),this._map.getContainer().classList.remove("geoman-draw-cursor"),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled(){return this._enabled},toggle(t){this.enabled()?this.disable():this.enable(t)},_syncHintMarker(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){let e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_createMarker(t){var a,n,o,l;if(!t.latlng||this.options.requireSnapToFinish&&!this._hintMarker._snapped&&!this._isFirstLayer())return;this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);let e=this._hintMarker.getLatLng();if(this.textArea=this._createTextArea(),(a=this.options.textOptions)==null?void 0:a.className){let u=this.options.textOptions.className.split(" ");this.textArea.classList.add(...u)}let i=this._createTextIcon(this.textArea),r=new L.Marker(e,{textMarker:!0,_textMarkerOverPM:!0,icon:i});if(this._setPane(r,"markerPane"),this._finishLayer(r),r.pm||(r.options.draggable=!1),r.addTo(this._map.pm._getContainingLayer()),r.pm){r.pm.textArea=this.textArea,L.setOptions(r.pm,{removeIfEmpty:((n=this.options.textOptions)==null?void 0:n.removeIfEmpty)??!0});let u=((o=this.options.textOptions)==null?void 0:o.focusAfterDraw)??!0;r.pm._createTextMarker(u),(l=this.options.textOptions)!=null&&l.text&&r.pm.setText(this.options.textOptions.text)}this._fireCreate(r),this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()},_createTextArea(){let t=document.createElement("textarea");return t.readOnly=!0,t.classList.add("pm-textarea","pm-disabled"),t},_createTextIcon(t){return L.divIcon({className:"pm-text-marker",html:t})}});var Xn={enableLayerDrag(){if(!this.options.draggable||!this._layer._map)return;this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,Ht(this._layer)instanceof L.Canvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0;let t=this._getDOMElem();t&&(Ht(this._layer)instanceof L.Canvas?(this._layer.on("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._addTouchEvents(t)):L.DomEvent.on(t,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._fireDragEnable()},disableLayerDrag(){this._layerDragEnabled=!1,Ht(this._layer)instanceof L.Canvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._originalMapDragState&&this._dragging&&this._map.dragging.enable(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable();let t=this._getDOMElem();t&&(Ht(this._layer)instanceof L.Canvas?(this._layer.off("touchstart mousedown",this._dragMixinOnMouseDown,this),this._map.pm._removeTouchEvents(t)):L.DomEvent.off(t,"touchstart mousedown",this._simulateMouseDownEvent,this)),this._layerDragged&&this._fireUpdate(),this._layerDragged=!1,this._fireDragDisable()},dragging(){return this._dragging},layerDragEnabled(){return!!this._layerDragEnabled},_simulateMouseDownEvent(t){let e=t.touches?t.touches[0]:t,i={originalEvent:e,target:this._layer};return i.containerPoint=this._map.mouseEventToContainerPoint(e),i.latlng=this._map.containerPointToLatLng(i.containerPoint),this._dragMixinOnMouseDown(i),!1},_simulateMouseMoveEvent(t){let e=t.touches?t.touches[0]:t,i={originalEvent:e,target:this._layer};return i.containerPoint=this._map.mouseEventToContainerPoint(e),i.latlng=this._map.containerPointToLatLng(i.containerPoint),this._dragMixinOnMouseMove(i),!1},_simulateMouseUpEvent(t){let e={originalEvent:t.touches?t.touches[0]:t,target:this._layer};return t.type.indexOf("touch")===-1&&(e.containerPoint=this._map.mouseEventToContainerPoint(t),e.latlng=this._map.containerPointToLatLng(e.containerPoint)),this._dragMixinOnMouseUp(e),!1},_dragMixinOnMouseDown(t){if(t.originalEvent.button>0)return;this._overwriteEventIfItComesFromMarker(t);let e=t._fromLayerSync,i=this._syncLayers("_dragMixinOnMouseDown",t);if(this._layer instanceof L.Marker&&(this.options.snappable&&!e&&!i?this._initSnappableMarkers():this._disableSnapping()),this._layer instanceof L.CircleMarker){let r="resizeableCircleMarker";this._layer instanceof L.Circle&&(r="resizableCircle"),this.options.snappable&&!e&&!i?this._layer.pm.options[r]||this._initSnappableMarkersDrag():this._layer.pm.options[r]?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag()}this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,L.DomEvent.on(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),L.DomEvent.on(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this)},_dragMixinOnMouseMove(t){this._overwriteEventIfItComesFromMarker(t);let e=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",t),this._dragging||(this._dragging=!0,L.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._map.dragging.disable(),this._fireDragStart()),this._tempDragCoord||(this._tempDragCoord=t.latlng),this._onLayerDrag(t),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp(t){let e=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",t),this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0,L.DomEvent.off(this._map.getContainer(),"touchmove mousemove",this._simulateMouseMoveEvent,this),L.DomEvent.off(this._map.getContainer(),"touchend mouseup",this._simulateMouseUpEvent,this),this._dragging?(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),this._layerDragged=!0,window.setTimeout(()=>{this._dragging=!1,e&&L.DomUtil.removeClass(e,"leaflet-pm-dragging"),this._fireDragEnd(),this._fireEdit(),this._layerEdited=!0},10),!0):!1},_onLayerDrag(t){let{latlng:e}=t,i={lat:e.lat-this._tempDragCoord.lat,lng:e.lng-this._tempDragCoord.lng},r=a=>a.map(n=>{if(Array.isArray(n))return r(n);let o={lat:n.lat+i.lat,lng:n.lng+i.lng};return(n.alt||n.alt===0)&&(o.alt=n.alt),o});if(this._layer instanceof L.Circle&&this._layer.options.resizableCircle||this._layer instanceof L.CircleMarker&&this._layer.options.resizeableCircleMarker){let a=r([this._layer.getLatLng()]);this._layer.setLatLng(a[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){let a=this._layer.getLatLng();this._layer._snapped&&(a=this._layer._orgLatLng);let n=r([a]);this._layer.setLatLng(n[0]),this._fireChange(this._layer.getLatLng(),"Edit")}else if(this._layer instanceof L.ImageOverlay){let a=r([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(a),this._fireChange(this._layer.getBounds(),"Edit")}else{let a=r(this._layer.getLatLngs());this._layer.setLatLngs(a),this._fireChange(this._layer.getLatLngs(),"Edit")}this._tempDragCoord=e,t.layer=this._layer,this._fireDrag(t)},addDraggingClass(){let t=this._getDOMElem();t&&L.DomUtil.addClass(t,"leaflet-pm-draggable")},removeDraggingClass(){let t=this._getDOMElem();t&&L.DomUtil.removeClass(t,"leaflet-pm-draggable")},_getDOMElem(){let t=null;return this._layer._path?t=this._layer._path:this._layer._renderer&&this._layer._renderer._container?t=this._layer._renderer._container:this._layer._image?t=this._layer._image:this._layer._icon&&(t=this._layer._icon),t},_overwriteEventIfItComesFromMarker(t){t.target.getLatLng&&(!t.target._radius||t.target._radius<=10)&&(t.containerPoint=this._map.mouseEventToContainerPoint(t.originalEvent),t.latlng=this._map.containerPointToLatLng(t.containerPoint))},_syncLayers(t,e){if(this.enabled())return!1;if(!e._fromLayerSync&&this._layer===e.target&&this.options.syncLayersOnDrag){e._fromLayerSync=!0;let i=[];if(L.Util.isArray(this.options.syncLayersOnDrag))i=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach(r=>{r instanceof L.LayerGroup&&(i=i.concat(r.pm.getLayers(!0)))});else if(this.options.syncLayersOnDrag===!0&&this._parentLayerGroup)for(let r in this._parentLayerGroup){let a=this._parentLayerGroup[r];a.pm&&(i=a.pm.getLayers(!0))}return L.Util.isArray(i)&&i.length>0&&(i=i.filter(r=>!!r.pm).filter(r=>!!r.pm.options.draggable),i.forEach(r=>{r!==this._layer&&r.pm[t]&&(r._snapped=!1,r.pm[t](e))})),i.length>0}return!1},_stopDOMImageDrag(t){return t.preventDefault(),!1}},Zn=Xn,Wn=ut(_e());function Qn(t,e,i,r){return i.unproject(e.transform(i.project(t,r)),r)}function Fi(t,e,i){let r=i.getMaxZoom();if(r===1/0&&(r=i.getZoom()),L.Util.isArray(t)){let a=[];return t.forEach(n=>{a.push(Fi(n,e,i))}),a}return t instanceof L.LatLng?Qn(t,e,i,r):null}function Yt(t,e){e instanceof L.Layer&&(e=e.getLatLng());let i=t.getMaxZoom();return i===1/0&&(i=t.getZoom()),t.project(e,i)}function we(t,e){let i=t.getMaxZoom();return i===1/0&&(i=t.getZoom()),t.unproject(e,i)}var $n={_onRotateStart(t){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Yt(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Yt(this._map,t.target.getLatLng()),this._initialRotateLatLng=Pt(this._layer),this._startAngle=this.getAngle();let e=Pt(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,e),this._fireRotationStart(this._map,e)},_onRotate(t){let e=Yt(this._map,t.target.getLatLng()),i=this._rotationStartPoint,r=this._rotationOriginPoint,a=Math.atan2(e.y-r.y,e.x-r.x)-Math.atan2(i.y-r.y,i.x-r.x);this._layer.setLatLngs(this._rotateLayer(a,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let n=this;function o(_,f=[],B=-1){if(B>-1&&f.push(B),L.Util.isArray(_[0]))_.forEach((P,A)=>o(P,f.slice(),A));else{let P=(0,Wn.default)(n._markers,f);_.forEach((A,z)=>{P[z].setLatLng(A)})}}o(this._layer.getLatLngs());let l=Pt(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(a,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));let u=a*180/Math.PI;u=u<0?u+360:u;let p=u+this._startAngle;this._setAngle(p),this._rotationLayer.pm._setAngle(p),this._fireRotation(this._rotationLayer,u,l),this._fireRotation(this._map,u,l),this._rotationLayer.pm._fireChange(this._rotationLayer.getLatLngs(),"Rotation")},_onRotateEnd(){let t=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;let e=Pt(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=Pt(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,t,e),this._fireRotationEnd(this._map,t,e),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1),this._layerRotated=!0},_rotateLayer(t,e,i,r,a){let n=Yt(a,i);return this._matrix=r.clone().rotate(t,n).flip(),Fi(e,this._matrix,a)},_setAngle(t){t=t<0?t+360:t,this._angle=t%360},_getRotationCenter(){if(this._rotationCenter)return this._rotationCenter;let t=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),e=t.getCenter();return t.removeFrom(this._layer._map),e},enableRotate(){if(!this.options.allowRotation){this.disableRotate();return}this.rotateEnabled()&&this.disableRotate(),this._layer instanceof L.Rectangle&&this._angle===void 0&&this.setInitAngle(Ke(this._layer._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let t={fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0};this._rotatePoly=L.polygon(this._layer.getLatLngs(),t),this._rotatePoly._pmTempLayer=!0,this._rotatePoly.addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setRotationCenter(this.getRotationCenter()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=Pt(this._layer),this._rotateEnabled=!0,this._layer.on("remove",this.disableRotate,this),this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)},disableRotate(){this.rotateEnabled()&&(this._rotatePoly.pm._layerRotated&&this._fireUpdate(),this._rotatePoly.pm._layerRotated=!1,this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._layer.off("remove",this.disableRotate,this),this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled(){return!!this._rotateEnabled},rotateLayer(t){let e=this.getAngle(),i=this._layer.getLatLngs(),r=t*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(r,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+t),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(r,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers());let a=this.getAngle()-e;a=a<0?a+360:a,this._startAngle=e,this._fireRotation(this._layer,a,i,this._layer),this._fireRotation(this._map||this._layer._map,a,i,this._layer),delete this._startAngle,this._fireChange(this._layer.getLatLngs(),"Rotation")},rotateLayerToAngle(t){let e=t-this.getAngle();this.rotateLayer(e)},getAngle(){return this._angle||0},setInitAngle(t){this._setAngle(t)},getRotationCenter(){return this._getRotationCenter()},setRotationCenter(t){this._rotationCenter=t,this._rotatePoly&&this._rotatePoly.pm.setRotationCenter(t)}},to=$n,eo=L.Class.extend({includes:[Zn,xi,to,me],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0,resizeableCircleMarker:!1,resizableCircle:!0},setOptions(t){L.Util.setOptions(this,t)},getOptions(){return this.options},applyOptions(){},isPolygon(){return this._layer instanceof L.Polygon},getShape(){return this._shape},_setPane(t,e){e==="layerPane"?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":e==="vertexPane"?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":e==="markerPane"&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation(t,e){let i=e.target,r={layer:this._layer,marker:i,event:e},a="";return t==="move"?a="moveVertexValidation":t==="add"?a="addVertexValidation":t==="remove"&&(a="removeVertexValidation"),this.options[a]&&typeof this.options[a]=="function"&&!this.options[a](r)?(t==="move"&&(i._cancelDragEventChain=i.getLatLng()),!1):(i._cancelDragEventChain=null,!0)},_vertexValidationDrag(t){return t._cancelDragEventChain?(t._latlng=t._cancelDragEventChain,t.update(),!1):!0},_vertexValidationDragEnd(t){return t._cancelDragEventChain?(t._cancelDragEventChain=null,!1):!0}}),ot=eo;ot.LayerGroup=L.Class.extend({initialize(t){this._layerGroup=t,this._layers=this.getLayers(),this._getMap(),this._layers.forEach(r=>this._initLayer(r));let e=r=>{if(r.layer._pmTempLayer)return;this._layers=this.getLayers();let a=this._layers.filter(n=>!n.pm._parentLayerGroup||!(this._layerGroup._leaflet_id in n.pm._parentLayerGroup));a.forEach(n=>{this._initLayer(n)}),a.length>0&&this._getMap()&&this._getMap().pm.globalEditModeEnabled()&&this.enabled()&&this.enable(this.getOptions())};this._layerGroup.on("layeradd",L.Util.throttle(e,100,this),this),this._layerGroup.on("layerremove",r=>{this._removeLayerFromGroup(r.target)},this);let i=r=>{r.target._pmTempLayer||(this._layers=this.getLayers())};this._layerGroup.on("layerremove",L.Util.throttle(i,100,this),this)},enable(t,e=[]){e.length===0&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach(i=>{i instanceof L.LayerGroup?e.indexOf(i._leaflet_id)===-1&&(e.push(i._leaflet_id),i.pm.enable(t,e)):i.pm.enable(t)})},disable(t=[]){t.length===0&&(this._layers=this.getLayers()),this._layers.forEach(e=>{e instanceof L.LayerGroup?t.indexOf(e._leaflet_id)===-1&&(t.push(e._leaflet_id),e.pm.disable(t)):e.pm.disable()})},enabled(t=[]){return t.length===0&&(this._layers=this.getLayers()),!!this._layers.find(e=>e instanceof L.LayerGroup?t.indexOf(e._leaflet_id)===-1?(t.push(e._leaflet_id),e.pm.enabled(t)):!1:e.pm.enabled())},toggleEdit(t,e=[]){e.length===0&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach(i=>{i instanceof L.LayerGroup?e.indexOf(i._leaflet_id)===-1&&(e.push(i._leaflet_id),i.pm.toggleEdit(t,e)):i.pm.toggleEdit(t)})},_initLayer(t){let e=L.Util.stamp(this._layerGroup);t.pm._parentLayerGroup||(t.pm._parentLayerGroup={}),t.pm._parentLayerGroup[e]=this._layerGroup},_removeLayerFromGroup(t){if(t.pm&&t.pm._layerGroup){let e=L.Util.stamp(this._layerGroup);delete t.pm._layerGroup[e]}},dragging(){return this._layers=this.getLayers(),this._layers?!!this._layers.find(t=>t.pm.dragging()):!1},getOptions(){return this.options},_getMap(){var t;return this._map||((t=this._layers.find(e=>!!e._map))==null?void 0:t._map)||null},getLayers(t=!1,e=!0,i=!0,r=[]){let a=[];return t?this._layerGroup.getLayers().forEach(n=>{a.push(n),n instanceof L.LayerGroup&&r.indexOf(n._leaflet_id)===-1&&(r.push(n._leaflet_id),a=a.concat(n.pm.getLayers(!0,!0,!0,r)))}):a=this._layerGroup.getLayers(),i&&(a=a.filter(n=>!(n instanceof L.LayerGroup))),e&&(a=a.filter(n=>!!n.pm),a=a.filter(n=>!n._pmTempLayer),a=a.filter(n=>!L.PM.optIn&&!n.options.pmIgnore||L.PM.optIn&&n.options.pmIgnore===!1)),a},setOptions(t,e=[]){e.length===0&&(this._layers=this.getLayers()),this.options=t,this._layers.forEach(i=>{i.pm&&(i instanceof L.LayerGroup?e.indexOf(i._leaflet_id)===-1&&(e.push(i._leaflet_id),i.pm.setOptions(t,e)):i.pm.setOptions(t))})}}),ot.Marker=ot.extend({_shape:"Marker",initialize(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable(t={draggable:!0}){if(L.Util.setOptions(this,t),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._fireEnable()},disable(){this.enabled()&&(this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1)},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker(t){let e=t.target;e.remove(),this._fireRemove(e),this._fireRemove(this._map,e)},_onDragEnd(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)}});var Bt=ut(_e()),io={filterMarkerGroup(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this.throttledApplyLimitFilters||(this.throttledApplyLimitFilters=L.Util.throttle(this.applyLimitFilters,100,this)),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.throttledApplyLimitFilters,this))},_removeMarkerLimitEvents(){this._map.off("mousemove",this.throttledApplyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache(){let t=[...this._markerGroup.getLayers(),...this.markerCache];this.markerCache=t.filter((e,i,r)=>r.indexOf(e)===i)},renderLimits(t){this.markerCache.forEach(e=>{t.includes(e)?this._markerGroup.addLayer(e):this._markerGroup.removeLayer(e)})},applyLimitFilters({latlng:t={lat:0,lng:0}}){if(this._preventRenderMarkers)return;let e=[...this._filterClosestMarkers(t)];this.renderLimits(e)},_filterClosestMarkers(t){let e=[...this.markerCache],i=this.options.limitMarkersToCount;return i===-1?e:(e.sort((r,a)=>{let n=r._latlng.distanceTo(t),o=a._latlng.distanceTo(t);return n-o}),e.filter((r,a)=>i>-1?a<i:!0))},_preventRenderMarkers:!1,_preventRenderingMarkers(t){this._preventRenderMarkers=!!t}},ro=io;ot.Line=ot.extend({includes:[ro],_shape:"Line",initialize(t){this._layer=t,this._enabled=!1},enable(t){if(L.Util.setOptions(this,t),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:(this._layer.options.color!=="#f00000ff"?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()}},disable(){if(!this.enabled()||this._dragging)return;this._enabled=!1,this._markerGroup.clearLayers(),this._markerGroup.removeFrom(this._map),this._layer.off("remove",this.disable,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);let t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()},enabled(){return this._enabled},toggleEdit(t){return this.enabled()?this.disable():this.enable(t),this.enabled()},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initMarkers(){let t=this._map,e=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0;let i=r=>{if(Array.isArray(r[0]))return r.map(i,this);let a=r.map(this._createMarker,this);return this.options.hideMiddleMarkers!==!0&&r.map((n,o)=>{let l=this.isPolygon()?(o+1)%r.length:o+1;return this._createMiddleMarker(a[o],a[l])}),a};this._markers=i(e),this.filterMarkerGroup(),t.addLayer(this._markerGroup)},_createMarker(t){let e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this.options.rotate?(e.on("dragstart",this._onRotateStart,this),e.on("drag",this._onRotate,this),e.on("dragend",this._onRotateEnd,this)):(e.on("click",this._onVertexClick,this),e.on("dragstart",this._onMarkerDragStart,this),e.on("move",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(e),e},_createMiddleMarker(t,e){if(!t||!e)return!1;let i=L.PM.Utils.calcMiddleLatLng(this._map,t.getLatLng(),e.getLatLng()),r=this._createMarker(i),a=L.divIcon({className:"marker-icon marker-icon-middle"});return r.setIcon(a),r.leftM=t,r.rightM=e,t._middleMarkerNext=r,e._middleMarkerPrev=r,r.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),r.on("movestart",this._onMiddleMarkerMoveStart,this),r},_onMiddleMarkerClick(t){let e=t.target;if(!this._vertexValidation("add",t))return;let i=L.divIcon({className:"marker-icon"});e.setIcon(i),this._addMarker(e,e.leftM,e.rightM)},_onMiddleMarkerMoveStart(t){let e=t.target;if(e.on("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidation("add",t)){e.on("move",this._onMiddleMarkerMovePrevent,this);return}e._dragging=!0,this._addMarker(e,e.leftM,e.rightM)},_onMiddleMarkerMovePrevent(t){let e=t.target;this._vertexValidationDrag(e)},_onMiddleMarkerMoveEnd(t){let e=t.target;if(e.off("move",this._onMiddleMarkerMovePrevent,this),e.off("moveend",this._onMiddleMarkerMoveEnd,this),!this._vertexValidationDragEnd(e))return;let i=L.divIcon({className:"marker-icon"});e.setIcon(i),setTimeout(()=>{delete e._dragging},100)},_addMarker(t,e,i){t.off("movestart",this._onMiddleMarkerMoveStart,this),t.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);let r=t.getLatLng(),a=this._layer._latlngs;delete t.leftM,delete t.rightM;let{indexPath:n,index:o,parentPath:l}=L.PM.Utils.findDeepMarkerIndex(this._markers,e),u=n.length>1?(0,Bt.default)(a,l):a,p=n.length>1?(0,Bt.default)(this._markers,l):this._markers;u.splice(o+1,0,r),p.splice(o+1,0,t),this._layer.setLatLngs(a),this.options.hideMiddleMarkers!==!0&&(this._createMiddleMarker(e,t),this._createMiddleMarker(t,i)),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"),this._fireVertexAdded(t,L.PM.Utils.findDeepMarkerIndex(this._markers,t).indexPath,r),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection(){return Le(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval(){this._handleLayerStyle(!0)&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle(t){let e=this._layer,i,r;if(this.options.allowSelfIntersection?i=!1:(r=Le(this._layer.toGeoJSON(15)),i=r.features.length>0),i){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return i;t?this._flashLayer():(e.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(r)}else e.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1);return i},_flashLayer(){this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout(()=>{this._layer.setStyle({color:this.cachedColor}),this.isRed=!1},200)},_updateDisabledMarkerStyle(t,e){t.forEach(i=>{Array.isArray(i)?this._updateDisabledMarkerStyle(i,e):i._icon&&(e&&!this._checkMarkerAllowedToDrag(i)?L.DomUtil.addClass(i._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(i._icon,"vertexmarker-disabled"))})},_removeMarker(t){let e=t.target;if(!this._vertexValidation("remove",t))return;this.options.allowSelfIntersection||(this._coordsBeforeEdit=Pt(this._layer,this._layer.getLatLngs()));let i=this._layer.getLatLngs(),{indexPath:r,index:a,parentPath:n}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);if(!r)return;let o=r.length>1?(0,Bt.default)(i,n):i,l=r.length>1?(0,Bt.default)(this._markers,n):this._markers;if(!this.options.removeLayerBelowMinVertexCount&&(o.length<=2||this.isPolygon()&&o.length<=3)){this._flashLayer();return}o.splice(a,1),this._layer.setLatLngs(i),this.isPolygon()&&o.length<=2&&o.splice(0,o.length);let u=!1;if(o.length<=1&&(o.splice(0,o.length),n.length>1&&r.length>1&&(i=ye(i)),this._layer.setLatLngs(i),this._initMarkers(),u=!0),Ve(i)||this._layer.remove(),i=ye(i),this._layer.setLatLngs(i),this._markers=ye(this._markers),!u&&(l=r.length>1?(0,Bt.default)(this._markers,n):this._markers,e._middleMarkerPrev&&this._markerGroup.removeLayer(e._middleMarkerPrev),e._middleMarkerNext&&this._markerGroup.removeLayer(e._middleMarkerNext),this._markerGroup.removeLayer(e),l)){let p,_;if(this.isPolygon()?(p=(a+1)%l.length,_=(a+(l.length-1))%l.length):(_=a-1<0?void 0:a-1,p=a+1>=l.length?void 0:a+1),p!==_){let f=l[_],B=l[p];this.options.hideMiddleMarkers!==!0&&this._createMiddleMarker(f,B)}l.splice(a,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(e,r),this._fireChange(this._layer.getLatLngs(),"Edit")},updatePolygonCoordsFromMarkerDrag(t){let e=this._layer.getLatLngs(),i=t.getLatLng(),{indexPath:r,index:a,parentPath:n}=L.PM.Utils.findDeepMarkerIndex(this._markers,t);(r.length>1?(0,Bt.default)(e,n):e).splice(a,1,i),this._layer.setLatLngs(e)},_getNeighborMarkers(t){let{indexPath:e,index:i,parentPath:r}=L.PM.Utils.findDeepMarkerIndex(this._markers,t),a=e.length>1?(0,Bt.default)(this._markers,r):this._markers,n=(i+1)%a.length,o=(i+(a.length-1))%a.length,l=a[o],u=a[n];return{prevMarker:l,nextMarker:u}},_checkMarkerAllowedToDrag(t){let{prevMarker:e,nextMarker:i}=this._getNeighborMarkers(t),r=L.polyline([e.getLatLng(),t.getLatLng()]),a=L.polyline([t.getLatLng(),i.getLatLng()]),n=At(this._layer.toGeoJSON(15),r.toGeoJSON(15)).features.length,o=At(this._layer.toGeoJSON(15),a.toGeoJSON(15)).features.length;return t.getLatLng()===this._markers[0][0].getLatLng()?o+=1:t.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(n+=1),!(n<=2&&o<=2)},_onMarkerDragStart(t){let e=t.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),!this._vertexValidation("move",t))return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireMarkerDragStart(t,i),this.options.allowSelfIntersection||(this._coordsBeforeEdit=Pt(this._layer,this._layer.getLatLngs())),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(e):this._markerAllowedToDrag=null},_onMarkerDrag(t){let e=t.target;if(!this._vertexValidationDrag(e))return;let{indexPath:i,index:r,parentPath:a}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);if(!i)return;if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&this._markerAllowedToDrag===!1){this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),this._handleLayerStyle();return}this.updatePolygonCoordsFromMarkerDrag(e);let n=i.length>1?(0,Bt.default)(this._markers,a):this._markers,o=(r+1)%n.length,l=(r+(n.length-1))%n.length,u=e.getLatLng(),p=n[l].getLatLng(),_=n[o].getLatLng();if(e._middleMarkerNext){let f=L.PM.Utils.calcMiddleLatLng(this._map,u,_);e._middleMarkerNext.setLatLng(f)}if(e._middleMarkerPrev){let f=L.PM.Utils.calcMiddleLatLng(this._map,u,p);e._middleMarkerPrev.setLatLng(f)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(t,i),this._fireChange(this._layer.getLatLngs(),"Edit")},_onMarkerDragEnd(t){let e=t.target;if(!this._vertexValidationDragEnd(e))return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e),r=this.hasSelfIntersection();r&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(r=!1);let a=!this.options.allowSelfIntersection&&r;if(this._fireMarkerDragEnd(t,i,a),a){this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),this._fireLayerReset(t,i);return}!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit")},_onVertexClick(t){let e=t.target;if(e._dragging)return;let{indexPath:i}=L.PM.Utils.findDeepMarkerIndex(this._markers,e);this._fireVertexClick(t,i)}}),ot.Polygon=ot.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag(t){let{prevMarker:e,nextMarker:i}=this._getNeighborMarkers(t),r=L.polyline([e.getLatLng(),t.getLatLng()]),a=L.polyline([t.getLatLng(),i.getLatLng()]),n=At(this._layer.toGeoJSON(15),r.toGeoJSON(15)).features.length,o=At(this._layer.toGeoJSON(15),a.toGeoJSON(15)).features.length;return!(n<=2&&o<=2)}}),ot.Rectangle=ot.Polygon.extend({_shape:"Rectangle",_initMarkers(){let t=this._map,e=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.FeatureGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup),this._markers=[],this._markers[0]=e.map(this._createMarker,this),[this._cornerMarkers]=this._markers,this._layer.getLatLngs()[0].forEach((i,r)=>{let a=this._cornerMarkers.find(n=>n._index===r);a&&a.setLatLng(i)})},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker(t,e){let i=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(i,"vertexPane"),i._origLatLng=t,i._index=e,i._pmTempLayer=!0,i.on("click",this._onVertexClick,this),this._markerGroup.addLayer(i),i},_addMarkerEvents(){this._markers[0].forEach(t=>{t.on("dragstart",this._onMarkerDragStart,this),t.on("drag",this._onMarkerDrag,this),t.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||t.on("contextmenu",this._removeMarker,this)})},_removeMarker(){return null},_onMarkerDragStart(t){if(!this._vertexValidation("move",t))return;let e=t.target,i=this._cornerMarkers;e._oppositeCornerLatLng=i.find(r=>r._index===(e._index+2)%4).getLatLng(),e._snapped=!1,this._fireMarkerDragStart(t)},_onMarkerDrag(t){let e=t.target;this._vertexValidationDrag(e)&&e._index!==void 0&&(this._adjustRectangleForMarkerMove(e),this._fireMarkerDrag(t),this._fireChange(this._layer.getLatLngs(),"Edit"))},_onMarkerDragEnd(t){let e=t.target;this._vertexValidationDragEnd(e)&&(this._cornerMarkers.forEach(i=>{delete i._oppositeCornerLatLng}),this._fireMarkerDragEnd(t),this._fireEdit(),this._layerEdited=!0,this._fireChange(this._layer.getLatLngs(),"Edit"))},_adjustRectangleForMarkerMove(t){L.extend(t._origLatLng,t._latlng);let e=L.PM.Utils._getRotatedRectangle(t.getLatLng(),t._oppositeCornerLatLng,this.getAngle(),this._map);this._layer.setLatLngs(e),this._adjustAllMarkers(),this._layer.redraw()},_adjustAllMarkers(){let t=this._layer.getLatLngs()[0];t&&t.length!==4&&t.length>0?(t.forEach((e,i)=>{this._cornerMarkers[i].setLatLng(e)}),this._cornerMarkers.slice(t.length).forEach(e=>{e.setLatLng(t[0])})):!t||!t.length?console.error("The layer has no LatLngs"):this._cornerMarkers.forEach(e=>{e.setLatLng(t[e._index])})},_findCorners(){this._angle===void 0&&this.setInitAngle(Ke(this._map,this._layer.getLatLngs()[0][0],this._layer.getLatLngs()[0][1])||0);let t=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(t[0],t[2],this.getAngle(),this._map||this)}}),ot.CircleMarker=ot.extend({_shape:"CircleMarker",initialize(t){this._layer=t,this._enabled=!1,this._minRadiusOption="minRadiusCircleMarker",this._maxRadiusOption="maxRadiusCircleMarker",this._editableOption="resizeableCircleMarker",this._updateHiddenPolyCircle()},enable(t={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,t),this.options.editable&&(this.options.resizeableCircleMarker=this.options.editable,delete this.options.editable),!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._extendingEnable(),this._updateHiddenPolyCircle(),this._fireEnable()},_extendingEnable(){this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this)},disable(){this.dragging()||(this._map||(this._map=this._layer._map),this._map&&this.enabled()&&(this.layerDragEnabled()&&this.disableLayerDrag(),this.options[this._editableOption]?(this._helperLayers&&this._helperLayers.clearLayers(),this._map.off("move",this._syncMarkers,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this._extendingDisable(),this._layer.off("remove",this.disable,this),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1))},_extendingDisable(){this._layer.off("contextmenu",this._removeMarker,this)},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options[this._editableOption]?(this._initMarkers(),this._map.on("move",this._syncMarkers,this),this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this),this._centerMarker.on("move",this._moveCircle,this)):this._disableSnapping()):(this.options.draggable&&this.enableLayerDrag(),this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this._initSnappableMarkersDrag():this._disableSnappingDrag()),this._extendingApplyOptions()},_extendingApplyOptions(){this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers(){let t=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.FeatureGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t);let e=this._layer.getLatLng(),i=this._layer._radius,r=this._getLatLngOnCircle(e,i);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(r),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle(t,e){let i=this._map.project(t),r=L.point(i.x+e,i.y);return this._map.unproject(r)},_createHintLine(t,e){let i=t.getLatLng(),r=e.getLatLng();this._hintline=L.polyline([i,r],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker(t){let e=this._createMarker(t);return this.options.draggable?L.DomUtil.addClass(e._icon,"leaflet-pm-draggable"):e.dragging.disable(),e},_createOuterMarker(t){let e=this._createMarker(t);return e.on("drag",this._resizeCircle,this),e},_createMarker(t){let e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),e.on("click",this._onVertexClick,this),this._helperLayers.addLayer(e),e},_moveCircle(t){if(t.target._cancelDragEventChain)return;let e=this._centerMarker.getLatLng();this._layer.setLatLng(e);let i=this._layer._radius,r=this._getLatLngOnCircle(e,i);this._outerMarker._latlng=r,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit"),this._fireChange(this._layer.getLatLng(),"Edit")},_syncMarkers(){let t=this._layer.getLatLng(),e=this._layer._radius,i=this._getLatLngOnCircle(t,e);this._outerMarker.setLatLng(i),this._centerMarker.setLatLng(t),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._layer.setRadius(this.options[this._minRadiusOption]):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]?this._layer.setRadius(this.options[this._maxRadiusOption]):this._layer.setRadius(i),this._updateHiddenPolyCircle(),this._fireChange(this._layer.getLatLng(),"Edit")},_syncHintLine(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_removeMarker(){this.options[this._editableOption]&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart(t){this._vertexValidation("move",t)&&this._fireMarkerDragStart(t)},_onMarkerDrag(t){let e=t.target;e instanceof L.Marker&&!this._vertexValidationDrag(e)||this._fireMarkerDrag(t)},_onMarkerDragEnd(t){this._extedingMarkerDragEnd();let e=t.target;this._vertexValidationDragEnd(e)&&(this.options[this._editableOption]&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(t))},_extedingMarkerDragEnd(){this._map.pm.Draw.CircleMarker._layerIsDragging=!1},_initSnappableMarkersDrag(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle(){let t=this._layer._map||this._map;if(t){let e=L.PM.Utils.pxRadiusToMeterRadius(this._layer.getRadius(),t,this._layer.getLatLng()),i=L.circle(this._layer.getLatLng(),this._layer.options);i.setRadius(e);let r=t&&t.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(i,200,!r).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(i,200,!r),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker(){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);return this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?e=ve(this._map,t,e,this._getMinDistanceInMeter(t)):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&(e=ve(this._map,t,e,this._getMaxDistanceInMeter(t))),e},_handleOuterMarkerSnapping(){if(this._outerMarker._snapped){let t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),i=this._distanceCalculation(t,e);this.options[this._minRadiusOption]&&i<this.options[this._minRadiusOption]?this._outerMarker.setLatLng(this._outerMarker._orgLatLng):this.options[this._maxRadiusOption]&&i>this.options[this._maxRadiusOption]&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_distanceCalculation(t,e){return this._map.project(t).distanceTo(this._map.project(e))},_getMinDistanceInMeter(t){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._minRadiusOption],this._map,t)},_getMaxDistanceInMeter(t){return L.PM.Utils.pxRadiusToMeterRadius(this.options[this._maxRadiusOption],this._map,t)},_onVertexClick(t){t.target._dragging||this._fireVertexClick(t,void 0)}}),ot.Circle=ot.CircleMarker.extend({_shape:"Circle",initialize(t){this._layer=t,this._enabled=!1,this._minRadiusOption="minRadiusCircle",this._maxRadiusOption="maxRadiusCircle",this._editableOption="resizableCircle",this._updateHiddenPolyCircle()},enable(t){L.PM.Edit.CircleMarker.prototype.enable.call(this,t||{})},_extendingEnable(){},_extendingDisable(){this._layer.off("remove",this.disable,this);let t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.removeClass(t,"leaflet-pm-draggable")},_extendingApplyOptions(){},_syncMarkers(){},_removeMarker(){},_onDragStart(){},_extedingMarkerDragEnd(){},_updateHiddenPolyCircle(){let t=this._map&&this._map.pm._isCRSSimple();this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200,!t).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200,!t),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_distanceCalculation(t,e){return this._map.distance(t,e)},_getMinDistanceInMeter(){return this.options[this._minRadiusOption]},_getMaxDistanceInMeter(){return this.options[this._maxRadiusOption]},_onVertexClick(t){t.target._dragging||this._fireVertexClick(t,void 0)}}),ot.ImageOverlay=ot.extend({_shape:"ImageOverlay",initialize(t){this._layer=t,this._enabled=!1},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},enabled(){return this._enabled},enable(t={draggable:!0,snappable:!0}){if(L.Util.setOptions(this,t),this._map=this._layer._map,!!this._map){if(!this.options.allowEditing){this.disable();return}this.enabled()||this.disable(),this.enableLayerDrag(),this._layer.on("remove",this.disable,this),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()}},disable(){this._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this._layer.off("remove",this.disable,this),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._enabled=!1)},_findCorners(){let t=this._layer.getBounds(),e=t.getNorthWest(),i=t.getNorthEast(),r=t.getSouthEast(),a=t.getSouthWest();return[e,i,r,a]}}),ot.Text=ot.extend({_shape:"Text",initialize(t){this._layer=t,this._enabled=!1},enable(t){if(L.Util.setOptions(this,t),!!this.textArea){if(!this.options.allowEditing||!this._layer._map){this.disable();return}this._map=this._layer._map,this.enabled()&&this.disable(),this.applyOptions(),this._safeToCacheDragState=!0,this._focusChange(),this.textArea.readOnly=!1,this.textArea.classList.remove("pm-disabled"),this._layer.on("remove",this.disable,this),L.DomEvent.on(this.textArea,"input",this._autoResize,this),L.DomEvent.on(this.textArea,"focus",this._focusChange,this),L.DomEvent.on(this.textArea,"blur",this._focusChange,this),this._layer.on("dblclick",L.DomEvent.stop),L.DomEvent.off(this.textArea,"mousedown",this._preventTextSelection),this._enabled=!0,this._fireEnable()}},disable(){if(!this.enabled())return;this._layer.off("remove",this.disable,this),L.DomEvent.off(this.textArea,"input",this._autoResize,this),L.DomEvent.off(this.textArea,"focus",this._focusChange,this),L.DomEvent.off(this.textArea,"blur",this._focusChange,this),L.DomEvent.off(document,"click",this._documentClick,this),this._focusChange(),this.textArea.readOnly=!0,this.textArea.classList.add("pm-disabled");let t=document.activeElement;this.textArea.focus(),this.textArea.selectionStart=0,this.textArea.selectionEnd=0,L.DomEvent.on(this.textArea,"mousedown",this._preventTextSelection),t.focus(),this._disableOnBlurActive=!1,this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),this._enabled=!1},enabled(){return this._enabled},toggleEdit(t){this.enabled()?this.disable():this.enable(t)},applyOptions(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_initSnappableMarkers(){let t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=this.options.snapSegment===void 0?!0:this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping(){let t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_autoResize(){this.textArea.style.height="1px",this.textArea.style.width="1px";let t=this.textArea.scrollHeight>21?this.textArea.scrollHeight:21,e=this.textArea.scrollWidth>16?this.textArea.scrollWidth:16;this.textArea.style.height=`${t}px`,this.textArea.style.width=`${e}px`,this._layer.options.text=this.getText(),this._fireTextChange(this.getText())},_disableOnBlur(){this._disableOnBlurActive=!0,setTimeout(()=>{this.enabled()&&L.DomEvent.on(document,"click",this._documentClick,this)},100)},_documentClick(t){t.target!==this.textArea&&(this.disable(),!this.getText()&&this.options.removeIfEmpty&&this.remove())},_focusChange(t={}){let e=this._hasFocus;this._hasFocus=t.type==="focus",!e!=!this._hasFocus&&(this._hasFocus?(this._applyFocus(),this._focusText=this.getText(),this._fireTextFocus()):(this._removeFocus(),this._fireTextBlur(),this._focusText!==this.getText()&&(this._fireEdit(),this._layerEdited=!0)))},_applyFocus(){this.textArea.classList.add("pm-hasfocus"),this._map.dragging&&(this._safeToCacheDragState&&(this._originalMapDragState=this._map.dragging._enabled,this._safeToCacheDragState=!1),this._map.dragging.disable())},_removeFocus(){this._map.dragging&&(this._originalMapDragState&&this._map.dragging.enable(),this._safeToCacheDragState=!0),this.textArea.classList.remove("pm-hasfocus")},focus(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.focus()},blur(){if(!this.enabled())throw new TypeError("Layer is not enabled");this.textArea.blur(),this._disableOnBlurActive&&this.disable()},hasFocus(){return this._hasFocus},getElement(){return this.textArea},setText(t){this.textArea.value=t,this._autoResize()},getText(){return this.textArea.value},_initTextMarker(){if(this.textArea=L.PM.Draw.Text.prototype._createTextArea.call(this),this.options.className){let e=this.options.className.split(" ");this.textArea.classList.add(...e)}let t=L.PM.Draw.Text.prototype._createTextIcon.call(this,this.textArea);this._layer.setIcon(t),this._layer.once("add",this._createTextMarker,this)},_createTextMarker(t=!1){this._layer.off("add",this._createTextMarker,this),this._layer.getElement().tabIndex=-1,this.textArea.wrap="off",this.textArea.style.overflow="hidden",this.textArea.style.height=L.DomUtil.getStyle(this.textArea,"font-size"),this.textArea.style.width="1px",this._layer.options.text&&this.setText(this._layer.options.text),this._autoResize(),t===!0&&(this.enable(),this.focus(),this._disableOnBlur())},_preventTextSelection(t){t.preventDefault()}});var $e=function(t,e,i,r,a,n){this._matrix=[t,e,i,r,a,n]};$e.init=()=>new L.PM.Matrix(1,0,0,1,0,0),$e.prototype={transform(t){return this._transform(t.clone())},_transform(t){let e=this._matrix,{x:i,y:r}=t;return t.x=e[0]*i+e[1]*r+e[4],t.y=e[2]*i+e[3]*r+e[5],t},untransform(t){let e=this._matrix;return new L.Point((t.x/e[0]-e[4])/e[0],(t.y/e[2]-e[5])/e[2])},clone(){let t=this._matrix;return new L.PM.Matrix(t[0],t[1],t[2],t[3],t[4],t[5])},translate(t){if(t===void 0)return new L.Point(this._matrix[4],this._matrix[5]);let e,i;return typeof t=="number"?(e=t,i=t):(e=t.x,i=t.y),this._add(1,0,0,1,e,i)},scale(t,e){if(t===void 0)return new L.Point(this._matrix[0],this._matrix[3]);let i,r;return e=e||L.point(0,0),typeof t=="number"?(i=t,r=t):(i=t.x,r=t.y),this._add(i,0,0,r,e.x,e.y)._add(1,0,0,1,-e.x,-e.y)},rotate(t,e){let i=Math.cos(t),r=Math.sin(t);return e=e||new L.Point(0,0),this._add(i,r,-r,i,e.x,e.y)._add(1,0,0,1,-e.x,-e.y)},flip(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add(t,e,i,r,a,n){let o=[[],[],[]],l=this._matrix,u=[[l[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]],p=[[t,i,a],[e,r,n],[0,0,1]],_;t&&t instanceof L.PM.Matrix&&(l=t._matrix,p=[[l[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]]);for(let f=0;f<3;f+=1)for(let B=0;B<3;B+=1){_=0;for(let P=0;P<3;P+=1)_+=u[f][P]*p[P][B];o[f][B]=_}return this._matrix=[o[0][0],o[1][0],o[0][1],o[1][1],o[0][2],o[1][2]],this}};var ao=$e,no={calcMiddleLatLng(t,e,i){let r=t.project(e),a=t.project(i);return t.unproject(r._add(a)._divideBy(2))},findLayers(t){let e=[];return t.eachLayer(i=>{(i instanceof L.Polyline||i instanceof L.Marker||i instanceof L.Circle||i instanceof L.CircleMarker||i instanceof L.ImageOverlay)&&e.push(i)}),e=e.filter(i=>!!i.pm),e=e.filter(i=>!i._pmTempLayer),e=e.filter(i=>!L.PM.optIn&&!i.options.pmIgnore||L.PM.optIn&&i.options.pmIgnore===!1),e},circleToPolygon(t,e=60,i=!0){let r=t.getLatLng(),a=t.getRadius(),n=ki(r,a,e,0,i),o=[];for(let l=0;l<n.length;l+=1){let u=[n[l].lat,n[l].lng];o.push(u)}return L.polygon(o,t.options)},disablePopup(t){t.getPopup()&&(t._tempPopupCopy=t.getPopup(),t.unbindPopup())},enablePopup(t){t._tempPopupCopy&&(t.bindPopup(t._tempPopupCopy),delete t._tempPopupCopy)},_fireEvent(t,e,i,r=!1){t.fire(e,i,r);let{groups:a}=this.getAllParentGroups(t);a.forEach(n=>{n.fire(e,i,r)})},getAllParentGroups(t){let e=[],i=[],r=a=>{for(let n in a._eventParents)if(e.indexOf(n)===-1){e.push(n);let o=a._eventParents[n];i.push(o),r(o)}};return!t._pmLastGroupFetch||!t._pmLastGroupFetch.time||new Date().getTime()-t._pmLastGroupFetch.time>1e3?(r(t),t._pmLastGroupFetch={time:new Date().getTime(),groups:i,groupIds:e},{groupIds:e,groups:i}):{groups:t._pmLastGroupFetch.groups,groupIds:t._pmLastGroupFetch.groupIds}},createGeodesicPolygon:ki,getTranslation:Y,findDeepCoordIndex(t,e,i=!0){let r,a=o=>(l,u)=>{let p=o.concat(u);if(i){if(l.lat&&l.lat===e.lat&&l.lng===e.lng)return r=p,!0}else if(l.lat&&L.latLng(l).equals(e))return r=p,!0;return Array.isArray(l)&&l.some(a(p))};t.some(a([]));let n={};return r&&(n={indexPath:r,index:r[r.length-1],parentPath:r.slice(0,r.length-1)}),n},findDeepMarkerIndex(t,e){let i,r=n=>(o,l)=>{let u=n.concat(l);return o._leaflet_id===e._leaflet_id?(i=u,!0):Array.isArray(o)&&o.some(r(u))};t.some(r([]));let a={};return i&&(a={indexPath:i,index:i[i.length-1],parentPath:i.slice(0,i.length-1)}),a},_getIndexFromSegment(t,e){if(e&&e.length===2){let i=this.findDeepCoordIndex(t,e[0]),r=this.findDeepCoordIndex(t,e[1]),a=Math.max(i.index,r.index);return(i.index===0||r.index===0)&&a!==1&&(a+=1),{indexA:i,indexB:r,newIndex:a,indexPath:i.indexPath,parentPath:i.parentPath}}return null},_getRotatedRectangle(t,e,i,r){let a=Yt(r,t),n=Yt(r,e),o=i*Math.PI/180,l=Math.cos(o),u=Math.sin(o),p=(n.x-a.x)*l+(n.y-a.y)*u,_=(n.y-a.y)*l-(n.x-a.x)*u,f=p*l+a.x,B=p*u+a.y,P=-_*u+a.x,A=_*l+a.y,z=we(r,a),N=we(r,{x:f,y:B}),q=we(r,n),k=we(r,{x:P,y:A});return[z,N,q,k]},pxRadiusToMeterRadius(t,e,i){let r=e.project(i),a=L.point(r.x+t,r.y);return e.distance(e.unproject(a),i)}},oo=no;L.PM=L.PM||{version:la.version,Map:$a,Toolbar:an,Draw:st,Edit:ot,Utils:oo,Matrix:ao,activeLang:"en",optIn:!1,initialize(t){this.addInitHooks(t)},setOptIn(t){this.optIn=!!t},addInitHooks(){function t(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this)),this.pm&&this.pm.setGlobalOptions({})}L.Map.addInitHook(t);function e(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}L.LayerGroup.addInitHook(e);function i(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.options.textMarker?(this.pm=new L.PM.Edit.Text(this),this.options._textMarkerOverPM||this.pm._initTextMarker(),delete this.options._textMarkerOverPM):this.pm=new L.PM.Edit.Marker(this))}L.Marker.addInitHook(i);function r(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}L.CircleMarker.addInitHook(r);function a(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}L.Polyline.addInitHook(a);function n(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}L.Polygon.addInitHook(n);function o(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}L.Rectangle.addInitHook(o);function l(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}L.Circle.addInitHook(l);function u(){this.pm=void 0,L.PM.optIn?this.options.pmIgnore===!1&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.ImageOverlay.addInitHook(u)},reInitLayer(t){t instanceof L.LayerGroup&&t.eachLayer(e=>{this.reInitLayer(e)}),t.pm||L.PM.optIn&&t.options.pmIgnore!==!1||t.options.pmIgnore||(t instanceof L.Map?t.pm=new L.PM.Map(t):t instanceof L.Marker?t.options.textMarker?(t.pm=new L.PM.Edit.Text(t),t.pm._initTextMarker(),t.pm._createTextMarker(!1)):t.pm=new L.PM.Edit.Marker(t):t instanceof L.Circle?t.pm=new L.PM.Edit.Circle(t):t instanceof L.CircleMarker?t.pm=new L.PM.Edit.CircleMarker(t):t instanceof L.Rectangle?t.pm=new L.PM.Edit.Rectangle(t):t instanceof L.Polygon?t.pm=new L.PM.Edit.Polygon(t):t instanceof L.Polyline?t.pm=new L.PM.Edit.Line(t):t instanceof L.LayerGroup?t.pm=new L.PM.Edit.LayerGroup(t):t instanceof L.ImageOverlay&&(t.pm=new L.PM.Edit.ImageOverlay(t)))}},L.version==="1.7.1"&&L.Canvas.include({_onClick(t){let e=this._map.mouseEventToLayerPoint(t),i,r;for(let a=this._drawFirst;a;a=a.next)i=a.layer,i.options.interactive&&i._containsPoint(e)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(i))&&(r=i);r&&(L.DomEvent.fakeStop(t),this._fireEvent([r],t))}}),L.PM.initialize()})();const jo=Ft=>(So("data-v-7228ea52"),Ft=Ft(),Bo(),Ft),Go=jo(()=>Pe("div",{class:"title"},[Pe("span",null,"属性")],-1)),zo={key:0,class:"content"},Xt="bed806b1ccb34b268ab1c0700123d444",No=yo({__name:"leafletMap",setup(Ft){nt.Icon.Default.prototype.options.iconUrl=Io,nt.Icon.Default.prototype.options.iconRetinaUrl=Ao,nt.Icon.Default.prototype.options.shadowUrl=Oo;const se=new nt.Icon.Default,Se=new nt.Icon({...nt.Icon.Default.prototype.options,iconUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-yellow.png",iconRetinaUrl:"https://jsdelivr.cdn.iszy.xyz/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-yellow.png"});let lt,tt,Zt;const D=ii(),Wt=ii(),ut=ii();vo(()=>{gt.on("locationGeo",Rt),gt.on("updateGeojsonLayer",le),gt.on("getGeoJson",he),gt.on("addLayer",ue),gt.on("removeLayer",pe),gt.on("selectFeature",ce),Be()}),Lo(()=>{gt.off("locationGeo",Rt),gt.off("updateGeojsonLayer",le),gt.off("getGeoJson",he),gt.off("addLayer",ue),gt.off("removeLayer",pe),gt.off("selectFeature",ce),tt&&tt.remove()});function Be(){Wt.value&&(tt=nt.map(Wt.value,{attributionControl:!0,zoomControl:!1,minZoom:4,trackResize:!0}),tt.setView([35,105],4),lt=nt.geoJSON(void 0,{onEachFeature:Dt,pointToLayer:(Q,$)=>nt.marker($).addTo(tt)}).addTo(tt),Zt=nt.control.layers({高德矢量:ft("GaoDe.Normal.Map",{maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">高德地图</a> 贡献者'}).addTo(tt),高德影像:nt.layerGroup([ft("GaoDe.Satellite.Map",{maxNativeZoom:18,maxZoom:20}),ft("GaoDe.Satellite.Annotation",{maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">高德地图</a> 贡献者'}),谷歌矢量:nt.layerGroup([ft("Google.Normal.Map",{maxZoom:20})],{attribution:'&copy; <a href="https://www.google.com/maps" target="_blank">谷歌地图</a> 贡献者'}),谷歌影像:nt.layerGroup([ft("Google.Satellite.Map",{maxZoom:20}),ft("Google.Satellite.Annotation",{maxZoom:20})],{attribution:'&copy; <a href="https://www.google.com/maps" target="_blank">谷歌地图</a> 贡献者'}),OpenStreetMap:ft("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> 贡献者',maxNativeZoom:19,maxZoom:20}),天地图矢量:nt.layerGroup([ft("TianDiTu.Normal.Map",{key:Xt,maxNativeZoom:18,maxZoom:20}),ft("TianDiTu.Normal.Annotation",{key:Xt,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'}),天地图影像:nt.layerGroup([ft("TianDiTu.Satellite.Map",{key:Xt,maxNativeZoom:18,maxZoom:20}),ft("TianDiTu.Satellite.Annotation",{key:Xt,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'}),天地图地形:nt.layerGroup([ft("TianDiTu.Terrain.Map",{key:Xt,maxNativeZoom:14,maxZoom:20}),ft("TianDiTu.Terrain.Annotation",{key:Xt,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">天地图</a> 贡献者'})},{图形:lt},{hideSingleBase:!0,position:"bottomleft"}).addTo(tt),nt.control.scale({imperial:!1,position:"bottomright"}).addTo(tt),nt.control.zoom({zoomInTitle:"放大",zoomOutTitle:"缩小",position:"topright"}).addTo(tt),tt.pm.setLang("zh"),tt.pm.setGlobalOptions({layerGroup:lt}),tt.pm.addControls({position:"topright",drawCircleMarker:!1,drawText:!1,rotateMode:!0}),tt.on("pm:create pm:remove pm:cut",function(Q){Tt(),Q.type==="pm:create"&&Dt(Q.layer.toGeoJSON(),Q.layer)}))}function Dt(Q,$){$.on("pm:change",function(){Tt()}),Q.properties||(Q.properties={}),ut.value&&$.bindPopup(ut.value).on("popupopen",()=>{D.value=Q,tt.hasLayer($)&&($ instanceof nt.Marker?$.setIcon(Se):$.setStyle({color:"#ffff00",weight:5,opacity:.65}))}).on("popupclose",()=>{D.value=void 0,tt.hasLayer($)&&($ instanceof nt.Marker?$.setIcon(se):lt.resetStyle($))})}function Rt(Q){try{const $=nt.geoJSON(Q);tt.fitBounds($.getBounds())}catch{}}function le(Q){lt.clearLayers();try{lt.addData(Q),tt.fitBounds(lt.getBounds())}catch{}}function he(Q){Q(lt==null?void 0:lt.toGeoJSON())}function ue(Q,$){Q.addTo(tt),Zt.addOverlay(Q,$)}function pe(Q){tt.removeLayer(Q),Zt.removeLayer(Q)}function Tt(){lt.getLayers().length===0?gt.emit("updateEditor",{type:"FeatureCollection",features:[]}):gt.emit("updateEditor",lt.toGeoJSON())}function ce(Q){if(lt.getLayers().length>Q){const $=lt.getLayers()[Q];$.openPopup(),tt.fitBounds($.getBounds())}}return(Q,$)=>{var Ct,Ut;const De=Ro,de=To;return Ee(),ri(qi,null,[Pe("div",{ref_key:"mapContainer",ref:Wt,class:"map-container"},null,512),bo(Pe("div",{ref_key:"propertyPopup",ref:ut,class:"property-popup"},[Go,(Ct=ai(D))!=null&&Ct.properties&&Object.keys((Ut=ai(D))==null?void 0:Ut.properties).length?(Ee(),ri("div",zo,[ko(de,{column:1,border:!0},{default:Hi(()=>[(Ee(!0),ri(qi,null,Mo(ai(D).properties,(Re,Te,Ot)=>(Ee(),xo(De,{key:Ot,label:Te.toString()},{default:Hi(()=>[wo(Co(Re),1)]),_:2},1032,["label"]))),128))]),_:1})])):Eo("",!0)],512),[[Po,!1]])],64)}}}),qo=Do(No,[["__scopeId","data-v-7228ea52"]]);export{qo as default};
