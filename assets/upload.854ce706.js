var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,r=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&o(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&o(e,a,t[a]);return e},p=(e,n)=>t(e,a(n));import{u as d}from"./index.18e8bfc5.js";import{E as c,b1 as m,b2 as g,a as l,o as h,c as u,w as f,b,e as v,au as j,p as y,h as w,g as O}from"./vendor.588f181b.js";/* empty css              *//* empty css              */import{_ as x}from"./index.9ba79af3.js";var D=".container[data-v-46e8de4a] {\n  width: 100%;\n  height: 100%;\n}\n[data-v-46e8de4a] .ant-upload-drag-icon .i-icon {\n  font-size: 4.8rem;\n}\n.ant-spin-nested-loading[data-v-46e8de4a] {\n  height: 100% !important;\n}\n.ant-spin-nested-loading[data-v-46e8de4a] .ant-spin {\n  height: 100%;\n  max-height: unset;\n}\n.ant-spin-nested-loading[data-v-46e8de4a] .ant-spin-container {\n  height: 100%;\n}";const{Dragger:R}=j,{mapGetters:U,mapState:$,mapActions:q}=c("imgHosting"),F={name:"upload",components:{Dragger:R,UploadOne:m,Spin:g},props:["activeKey"],data:()=>({spinning:!1}),computed:r(r({},U(["config"])),$(["uploader","commonConfig"])),mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:p(r({},q(["addImage"])),{async customRequest({file:e}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const t=e.name||"";e=new File([e],((new Date).getTime()+t.substring(t.lastIndexOf("."))).toLowerCase(),{type:e.type,lastModified:e.lastModified})}try{const a=await d[this.uploader].handle(this.config(this.uploader),e);if(this.addImage(a),this.commonConfig.copyUrlAfterUpload)try{await navigator.clipboard.writeText(a.url),this.$msg.success("上传成功，地址已复制到剪贴板")}catch(t){this.$msg.error("上传成功，但地址复制失败")}else this.$msg.success("上传成功")}catch(t){this.$msg.error("上传失败")}}else this.$msg.warn("请先进行设置");this.spinning=!1},rejectFile(){this.$msg.warning("不支持的文件类型！")},paste(e){if("home"===this.activeKey){const t=e.clipboardData&&e.clipboardData.items;let a;t&&t.length&&(-1!==t[0].type.indexOf("image")?(a=t[0].getAsFile(),this.customRequest({file:a})):this.rejectFile())}}})},I=e=>(y("data-v-46e8de4a"),e=e(),w(),e),L={class:"ant-upload-drag-icon"},P=I((()=>v("p",{class:"ant-upload-text"},[O("直接粘贴图片或拖拽图片到这里上传"),v("br"),O("或者直接点击选择文件上传")],-1))),S=I((()=>v("p",{class:"ant-upload-hint"}," 暂时仅支持单文件上传。 ",-1)));function _(e,t,a,n,i,s){const o=l("UploadOne"),r=l("Dragger"),p=l("Spin");return h(),u(p,{spinning:e.spinning},{default:f((()=>[b(r,{fileList:[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp",onReject:s.rejectFile,showUploadList:!1,customRequest:s.customRequest},{default:f((()=>[v("p",L,[b(o)]),P,S])),_:1},8,["onReject","customRequest"])])),_:1},8,["spinning"])}var C=x(F,[["render",_],["__scopeId","data-v-46e8de4a"]]);export{C as default};
