import{L,l as g}from"./leaflet-src.3ed96abf.js";import{aG as Z,d as te,a4 as ee,ag as xt,aI as wt,ah as re,h as ie,y as G,r as K,o as ne,f as D,K as et}from"./vendor.9bf0bfaf.js";/* empty css                *//* empty css               *//* empty css                *//* empty css               */import{_ as se}from"./index.59750db5.js";var a=window.SuperMap=window.SuperMap||{};a.Components=window.SuperMap.Components||{};a.inherit=function(r,t){var e=function(){};e.prototype=t.prototype,r.prototype=new e;var i,n,s;for(i=2,n=arguments.length;i<n;i++)s=arguments[i],typeof s=="function"&&(s=s.prototype),a.Util.extend(r.prototype,s)};a.mixin=function(...r){class t{constructor(o){for(var l=0;l<r.length;l++)n(this,new r[l](o))}}for(var e=0;e<r.length;e++){var i=r[e];n(t,i),n(t.prototype,i.prototype),n(t.prototype,new i)}return t;function n(s,o){var l=Object.getOwnPropertyNames(o);Object.getOwnPropertySymbols&&(l=l.concat(Object.getOwnPropertySymbols(o)));for(var h=0;h<l.length;h++){var c=l[h];if(c!=="constructor"&&c!=="prototype"&&c!=="name"&&c!=="length"){let p=Object.getOwnPropertyDescriptor(o,c);window.ActiveXObject?Object.defineProperty(s,c,p||{}):Object.defineProperty(s,c,p)}}}};a.String={startsWith:function(r,t){return r.indexOf(t)==0},contains:function(r,t){return r.indexOf(t)!=-1},trim:function(r){return r.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(r){for(var t=r.split("-"),e=t[0],i=1,n=t.length;i<n;i++){var s=t[i];e+=s.charAt(0).toUpperCase()+s.substring(1)}return e},format:function(r,t,e){t||(t=window);var i=function(n,s){for(var o,l=s.split(/\.+/),h=0;h<l.length;h++)h==0&&(o=t),o=o[l[h]];return typeof o=="function"&&(o=e?o.apply(null,e):o()),typeof o=="undefined"?"undefined":o};return r.replace(a.String.tokenRegEx,i)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(r){return a.String.numberRegEx.test(r)},numericIf:function(r){return a.String.isNumeric(r)?parseFloat(r):r}};var oe=a.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(r,t){var e=0;return t>0&&(e=parseFloat(r.toPrecision(t))),e},format:function(r,t,e,i){t=typeof t!="undefined"?t:0,e=typeof e!="undefined"?e:a.Number.thousandsSeparator,i=typeof i!="undefined"?i:a.Number.decimalSeparator,t!=null&&(r=parseFloat(r.toFixed(t)));var n=r.toString().split(".");n.length===1&&t==null&&(t=0);var s=n[0];if(e)for(var o=/(-?[0-9]+)([0-9]{3})/;o.test(s);)s=s.replace(o,"$1"+e+"$2");var l;if(t==0)l=s;else{var h=n.length>1?n[1]:"0";t!=null&&(h=h+new Array(t-h.length+1).join("0")),l=s+i+h}return l}};Number.prototype.limitSigDigs||(Number.prototype.limitSigDigs=function(r){return oe.limitSigDigs(this,r)});a.Function={bind:function(r,t){var e=Array.prototype.slice.apply(arguments,[2]);return function(){var i=e.concat(Array.prototype.slice.apply(arguments,[0]));return r.apply(t,i)}},bindAsEventListener:function(r,t){return function(e){return r.call(t,e||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}};a.Array={filter:function(r,t,e){var i=[];if(Array.prototype.filter)i=r.filter(t,e);else{var n=r.length;if(typeof t!="function")throw new TypeError;for(var s=0;s<n;s++)if(s in r){var o=r[s];t.call(e,o,s,r)&&i.push(o)}}return i}};var v=a.Util=a.Util||{};a.Util.extend=function(r,t){if(r=r||{},t){for(var e in t){var i=t[e];i!==void 0&&(r[e]=i)}var n=typeof window.Event=="function"&&t instanceof window.Event;!n&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&(r.toString=t.toString)}return r};a.Util.copy=function(r,t){r=r||{};var e;if(t)for(var i in r)e=t[i],typeof e!="undefined"&&(r[i]=e)};a.Util.reset=function(r){r=r||{};for(var t in r)if(r.hasOwnProperty(t)){if(typeof r[t]=="object"&&r[t]instanceof Array){for(var e in r[t])r[t][e].destroy&&r[t][e].destroy();r[t].length=0}else typeof r[t]=="object"&&r[t]instanceof Object&&r[t].destroy&&r[t].destroy();r[t]=null}};a.Util.getElement=function(){for(var r=[],t=0,e=arguments.length;t<e;t++){var i=arguments[t];if(typeof i=="string"&&(i=document.getElementById(i)),arguments.length===1)return i;r.push(i)}return r};a.Util.isElement=function(r){return!!(r&&r.nodeType===1)};a.Util.isArray=function(r){return Object.prototype.toString.call(r)==="[object Array]"};a.Util.removeItem=function(r,t){for(var e=r.length-1;e>=0;e--)r[e]===t&&r.splice(e,1);return r};a.Util.indexOf=function(r,t){if(r==null)return-1;if(typeof r.indexOf=="function")return r.indexOf(t);for(var e=0,i=r.length;e<i;e++)if(r[e]===t)return e;return-1};a.Util.modifyDOMElement=function(r,t,e,i,n,s,o,l){t&&(r.id=t),e&&(r.style.left=e.x+"px",r.style.top=e.y+"px"),i&&(r.style.width=i.w+"px",r.style.height=i.h+"px"),n&&(r.style.position=n),s&&(r.style.border=s),o&&(r.style.overflow=o),parseFloat(l)>=0&&parseFloat(l)<1?(r.style.filter="alpha(opacity="+l*100+")",r.style.opacity=l):parseFloat(l)===1&&(r.style.filter="",r.style.opacity="")};a.Util.applyDefaults=function(r,t){r=r||{};var e=typeof window.Event=="function"&&t instanceof window.Event;for(var i in t)(r[i]===void 0||!e&&t.hasOwnProperty&&t.hasOwnProperty(i)&&!r.hasOwnProperty(i))&&(r[i]=t[i]);return!e&&t&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&!r.hasOwnProperty("toString")&&(r.toString=t.toString),r};a.Util.getParameterString=function(r){var t=[];for(var e in r){var i=r[e];if(i!=null&&typeof i!="function"){var n;Array.isArray(i)||i.toString()==="[object Object]"?n=encodeURIComponent(JSON.stringify(i)):n=encodeURIComponent(i),t.push(encodeURIComponent(e)+"="+n)}}return t.join("&")};a.Util.urlAppend=function(r,t){var e=r;if(t){t.indexOf("?")===0&&(t=t.substring(1));var i=(r+" ").split(/[?&]/);e+=i.pop()===" "?t:i.length?"&"+t:"?"+t}return e};a.Util.urlPathAppend=function(r,t){let e=r;if(!t)return e;t.indexOf("/")===0&&(t=t.substring(1));const i=r.split("?");return i[0].indexOf("/",i[0].length-1)<0&&(i[0]+="/"),e=`${i[0]}${t}${i.length>1?`?${i[1]}`:""}`,e};a.Util.DEFAULT_PRECISION=14;a.Util.toFloat=function(r,t){return t==null&&(t=a.Util.DEFAULT_PRECISION),typeof r!="number"&&(r=parseFloat(r)),t===0?r:parseFloat(r.toPrecision(t))};a.Util.rad=function(r){return r*Math.PI/180};a.Util.getParameters=function(r){r=r==null?window.location.href:r;var t="";if(a.String.contains(r,"?")){var e=r.indexOf("?")+1,i=a.String.contains(r,"#")?r.indexOf("#"):r.length;t=r.substring(e,i)}for(var n={},s=t.split(/[&;]/),o=0,l=s.length;o<l;++o){var h=s[o].split("=");if(h[0]){var c=h[0];try{c=decodeURIComponent(c)}catch{c=unescape(c)}var p=(h[1]||"").replace(/\+/g," ");try{p=decodeURIComponent(p)}catch{p=unescape(p)}p=p.split(","),p.length==1&&(p=p[0]),n[c]=p}}return n};a.Util.lastSeqID=0;a.Util.createUniqueID=function(r){return r==null&&(r="id_"),a.Util.lastSeqID+=1,r+a.Util.lastSeqID};a.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36};a.INCHES_PER_UNIT.in=a.INCHES_PER_UNIT.inches;a.INCHES_PER_UNIT.degrees=a.INCHES_PER_UNIT.dd;a.INCHES_PER_UNIT.nmi=1852*a.INCHES_PER_UNIT.m;a.METERS_PER_INCH=.0254000508001016;a.Util.extend(a.INCHES_PER_UNIT,{Inch:a.INCHES_PER_UNIT.inches,Meter:1/a.METERS_PER_INCH,Foot:.3048006096012192/a.METERS_PER_INCH,IFoot:.3048/a.METERS_PER_INCH,ClarkeFoot:.3047972651151/a.METERS_PER_INCH,SearsFoot:.30479947153867626/a.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/a.METERS_PER_INCH,IInch:.0254/a.METERS_PER_INCH,MicroInch:254e-7/a.METERS_PER_INCH,Mil:254e-10/a.METERS_PER_INCH,Centimeter:.01/a.METERS_PER_INCH,Kilometer:1e3/a.METERS_PER_INCH,Yard:.9144018288036576/a.METERS_PER_INCH,SearsYard:.914398414616029/a.METERS_PER_INCH,IndianYard:.9143985307444408/a.METERS_PER_INCH,IndianYd37:.91439523/a.METERS_PER_INCH,IndianYd62:.9143988/a.METERS_PER_INCH,IndianYd75:.9143985/a.METERS_PER_INCH,IndianFoot:.30479951/a.METERS_PER_INCH,IndianFt37:.30479841/a.METERS_PER_INCH,IndianFt62:.3047996/a.METERS_PER_INCH,IndianFt75:.3047995/a.METERS_PER_INCH,Mile:1609.3472186944373/a.METERS_PER_INCH,IYard:.9144/a.METERS_PER_INCH,IMile:1609.344/a.METERS_PER_INCH,NautM:1852/a.METERS_PER_INCH,"Lat-66":110943.31648893273/a.METERS_PER_INCH,"Lat-83":110946.25736872235/a.METERS_PER_INCH,Decimeter:.1/a.METERS_PER_INCH,Millimeter:.001/a.METERS_PER_INCH,Dekameter:10/a.METERS_PER_INCH,Decameter:10/a.METERS_PER_INCH,Hectometer:100/a.METERS_PER_INCH,GermanMeter:1.0000135965/a.METERS_PER_INCH,CaGrid:.999738/a.METERS_PER_INCH,ClarkeChain:20.1166194976/a.METERS_PER_INCH,GunterChain:20.11684023368047/a.METERS_PER_INCH,BenoitChain:20.116782494375872/a.METERS_PER_INCH,SearsChain:20.11676512155/a.METERS_PER_INCH,ClarkeLink:.201166194976/a.METERS_PER_INCH,GunterLink:.2011684023368047/a.METERS_PER_INCH,BenoitLink:.20116782494375873/a.METERS_PER_INCH,SearsLink:.2011676512155/a.METERS_PER_INCH,Rod:5.02921005842012/a.METERS_PER_INCH,IntnlChain:20.1168/a.METERS_PER_INCH,IntnlLink:.201168/a.METERS_PER_INCH,Perch:5.02921005842012/a.METERS_PER_INCH,Pole:5.02921005842012/a.METERS_PER_INCH,Furlong:201.1684023368046/a.METERS_PER_INCH,Rood:3.778266898/a.METERS_PER_INCH,CapeFoot:.3047972615/a.METERS_PER_INCH,Brealey:375/a.METERS_PER_INCH,ModAmFt:.304812252984506/a.METERS_PER_INCH,Fathom:1.8288/a.METERS_PER_INCH,"NautM-UK":1853.184/a.METERS_PER_INCH,"50kilometers":5e4/a.METERS_PER_INCH,"150kilometers":15e4/a.METERS_PER_INCH});a.Util.extend(a.INCHES_PER_UNIT,{mm:a.INCHES_PER_UNIT.Meter/1e3,cm:a.INCHES_PER_UNIT.Meter/100,dm:a.INCHES_PER_UNIT.Meter*100,km:a.INCHES_PER_UNIT.Meter*1e3,kmi:a.INCHES_PER_UNIT.nmi,fath:a.INCHES_PER_UNIT.Fathom,ch:a.INCHES_PER_UNIT.IntnlChain,link:a.INCHES_PER_UNIT.IntnlLink,"us-in":a.INCHES_PER_UNIT.inches,"us-ft":a.INCHES_PER_UNIT.Foot,"us-yd":a.INCHES_PER_UNIT.Yard,"us-ch":a.INCHES_PER_UNIT.GunterChain,"us-mi":a.INCHES_PER_UNIT.Mile,"ind-yd":a.INCHES_PER_UNIT.IndianYd37,"ind-ft":a.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/a.METERS_PER_INCH});a.DOTS_PER_INCH=96;a.Util.normalizeScale=function(r){var t=r>1?1/r:r;return t};a.Util.getResolutionFromScale=function(r,t){var e;if(r){t==null&&(t="degrees");var i=a.Util.normalizeScale(r);e=1/(i*a.INCHES_PER_UNIT[t]*a.DOTS_PER_INCH)}return e};a.Util.getScaleFromResolution=function(r,t){t==null&&(t="degrees");var e=r*a.INCHES_PER_UNIT[t]*a.DOTS_PER_INCH;return e};a.IS_GECKO=function(){var r=navigator.userAgent.toLowerCase();return r.indexOf("webkit")===-1&&r.indexOf("gecko")!==-1}();a.Browser=function(){var r="",t="",e="pc",i,n=navigator.userAgent.toLowerCase();return n.indexOf("msie")>-1||n.indexOf("trident")>-1&&n.indexOf("rv")>-1?(r="msie",i=n.match(/msie ([\d.]+)/)||n.match(/rv:([\d.]+)/)):n.indexOf("chrome")>-1?(r="chrome",i=n.match(/chrome\/([\d.]+)/)):n.indexOf("firefox")>-1?(r="firefox",i=n.match(/firefox\/([\d.]+)/)):n.indexOf("opera")>-1?(r="opera",i=n.match(/version\/([\d.]+)/)):n.indexOf("safari")>-1&&(r="safari",i=n.match(/version\/([\d.]+)/)),t=i?i[1]:"",n.indexOf("ipad")>-1||n.indexOf("ipod")>-1||n.indexOf("iphone")>-1?e="apple":n.indexOf("android")>-1&&(i=n.match(/version\/([\d.]+)/),t=i?i[1]:"",e="android"),{name:r,version:t,device:e}}();a.Util.getBrowser=function(){return a.Browser};a.Util.isSupportCanvas=function(){var r=!0,t=a.Util.getBrowser();return document.createElement("canvas").getContext?(t.name==="firefox"&&parseFloat(t.version)<5&&(r=!1),t.name==="safari"&&parseFloat(t.version)<4&&(r=!1),t.name==="opera"&&parseFloat(t.version)<10&&(r=!1),t.name==="msie"&&parseFloat(t.version)<9&&(r=!1)):r=!1,r}();a.Util.supportCanvas=function(){return a.Util.isSupportCanvas};a.INCHES_PER_UNIT.degree=a.INCHES_PER_UNIT.dd;a.INCHES_PER_UNIT.meter=a.INCHES_PER_UNIT.m;a.INCHES_PER_UNIT.foot=a.INCHES_PER_UNIT.ft;a.INCHES_PER_UNIT.inch=a.INCHES_PER_UNIT.inches;a.INCHES_PER_UNIT.mile=a.INCHES_PER_UNIT.mi;a.INCHES_PER_UNIT.kilometer=a.INCHES_PER_UNIT.km;a.INCHES_PER_UNIT.yard=a.INCHES_PER_UNIT.yd;a.Util.isInTheSameDomain=function(r){if(!r)return!0;var t=r.indexOf("//"),e=document.location.toString(),i=e.indexOf("//");if(t===-1)return!0;var n,s=n=r.substring(0,t),o=e.substring(i+2);i=o.indexOf("/");var l=o.indexOf(":"),h=o.substring(0,i),c=document.location.protocol;if(l!==-1||(h+=":"+(c.toLowerCase()==="http:"?80:443)),c.toLowerCase()!==s.toLowerCase())return!1;s=r.substring(t+2);var p=s.indexOf(":");t=s.indexOf("/");var E=s.substring(0,t),m;p!==-1?m=s.substring(0,p):(m=s.substring(0,t),E+=":"+(n.toLowerCase()==="http:"?80:443));var T=document.domain;return m===T&&E===h};a.Util.calculateDpi=function(r,t,e,i,n){if(!(!r||!t||!e)){var s=1e4,o=r.getWidth(),l=r.getHeight(),h=t.w,c=t.h;n=n||6378137,i=i||"degrees";var p;if(i.toLowerCase()==="degree"||i.toLowerCase()==="degrees"||i.toLowerCase()==="dd"){let E=o/h,m=l/c,T=E>m?E:m;p=.0254*s/T/e/(Math.PI*2*n/360)/s}else{let E=o/h;p=.0254*s/E/e/s}return p}};a.Util.toJSON=function(r){var t=r;if(t==null)return null;switch(t.constructor){case String:return t='"'+t.replace(/(["\\])/g,"\\$1")+'"',t=t.replace(/\n/g,"\\n"),t=t.replace(/\r/g,"\\r"),t=t.replace("<","&lt;"),t=t.replace(">","&gt;"),t=t.replace(/%/g,"%25"),t=t.replace(/&/g,"%26"),t;case Array:for(var e="",i=0,n=t.length;i<n;i++)e+=a.Util.toJSON(t[i]),i!==t.length-1&&(e+=",");return"["+e+"]";case Number:return isFinite(t)?String(t):null;case Boolean:return String(t);case Date:var s=`{'__type':"System.DateTime",'Year':`+t.getFullYear()+",'Month':"+(t.getMonth()+1)+",'Day':"+t.getDate()+",'Hour':"+t.getHours()+",'Minute':"+t.getMinutes()+",'Second':"+t.getSeconds()+",'Millisecond':"+t.getMilliseconds()+",'TimezoneOffset':"+t.getTimezoneOffset()+"}";return s;default:if(t.toJSON!=null&&typeof t.toJSON=="function")return t.toJSON();if(typeof t=="object"){if(t.length){let l=[];for(let h=0,c=t.length;h<c;h++)l.push(a.Util.toJSON(t[h]));return"["+l.join(",")+"]"}let o=[];for(let l in t)typeof t[l]!="function"&&l!=="CLASS_NAME"&&l!=="parent"&&o.push("'"+l+"':"+a.Util.toJSON(t[l]));return o.length>0?"{"+o.join(",")+"}":"{}"}return t.toString()}};a.Util.getResolutionFromScaleDpi=function(r,t,e,i){var n=null,s=1e4;return i=i||6378137,e=e||"",r>0&&t>0?(r=a.Util.normalizeScale(r),e.toLowerCase()==="degree"||e.toLowerCase()==="degrees"||e.toLowerCase()==="dd"?(n=.0254*s/t/r/(Math.PI*2*i/360)/s,n):(n=.0254*s/t/r/s,n)):-1};a.Util.getScaleFromResolutionDpi=function(r,t,e,i){var n=null,s=1e4;return i=i||6378137,e=e||"",r>0&&t>0?e.toLowerCase()==="degree"||e.toLowerCase()==="degrees"||e.toLowerCase()==="dd"?(n=.0254*s/t/r/(Math.PI*2*i/360)/s,n):(n=.0254*s/t/r/s,n):-1};a.Util.transformResult=function(r){return r.responseText&&typeof r.responseText=="string"&&(r=JSON.parse(r.responseText)),r};a.Util.copyAttributes=function(r,t){if(r=r||{},t)for(var e in t){var i=t[e];i!==void 0&&e!=="CLASS_NAME"&&typeof i!="function"&&(r[e]=i)}return r};a.Util.copyAttributesWithClip=function(r,t,e){if(r=r||{},t)for(var i in t){var n=!1;if(e&&e.length){for(var s=0,o=e.length;s<o;s++)if(i===e[s]){n=!0;break}}if(n!==!0){var l=t[i];l!==void 0&&i!=="CLASS_NAME"&&typeof l!="function"&&(r[i]=l)}}return r};a.Util.cloneObject=function(r){if(r===null||typeof r!="object")return r;if(r instanceof Date){let e=new Date;return e.setTime(r.getTime()),e}if(r instanceof Array)return r.slice(0);if(r instanceof Object){let e={};for(var t in r)r.hasOwnProperty(t)&&(e[t]=a.Util.cloneObject(r[t]));return e}throw new Error("Unable to copy obj! Its type isn't supported.")};a.Util.lineIntersection=function(r,t,e,i){var n=null,s,o,l=(i.x-e.x)*(r.y-e.y)-(i.y-e.y)*(r.x-e.x),h=(t.x-r.x)*(r.y-e.y)-(t.y-r.y)*(r.x-e.x),c=(i.y-e.y)*(t.x-r.x)-(i.x-e.x)*(t.y-r.y);if(c!=0)s=l/c,o=h/c,s>=0&&o<=1&&s<=1&&o>=0?n=new a.Geometry.Point(r.x+s*(t.x-r.x),r.y+s*(t.y-r.y)):n="No Intersection";else if(l==0&&h==0){var p=Math.max(r.y,t.y),E=Math.min(r.y,t.y),m=Math.max(r.x,t.x),T=Math.min(r.x,t.x);(e.y>=E&&e.y<=p||i.y>=E&&i.y<=p)&&e.x>=T&&e.x<=m||i.x>=T&&i.x<=m?n="Coincident":n="Parallel"}else n="Parallel";return n};a.Util.getTextBounds=function(r,t,e){document.body.appendChild(e),e.style.width="auto",e.style.height="auto",r.fontSize&&(e.style.fontSize=r.fontSize),r.fontFamily&&(e.style.fontFamily=r.fontFamily),r.fontWeight&&(e.style.fontWeight=r.fontWeight),e.style.position="relative",e.style.visibility="hidden",e.style.display="inline-block",e.innerHTML=t;var i=e.clientWidth,n=e.clientHeight;return document.body.removeChild(e),{textWidth:i,textHeight:n}};a.Util.convertPath=function(r,t){return t?r.replace(/\{([\w-\.]+)\}/g,(e,i)=>{var n;return t.hasOwnProperty(i)?n=ae(t[i]):n=e,encodeURIComponent(n)}):r};function ae(r){return r==null||r==null?"":r instanceof Date?r.toJSON():le(r)?JSON.stringify(r):r.toString()}function le(r){if(typeof r!="string"&&typeof r!="object")return!1;try{const t=r.toString();return t==="[object Object]"||t==="[object Array]"}catch{return!1}}(function(r,t){(function(e,i){i()})(Z,function(){function e(f){var y=this.constructor;return this.then(function(u){return y.resolve(f()).then(function(){return u})},function(u){return y.resolve(f()).then(function(){return y.reject(u)})})}function i(f){var y=this;return new y(function(u,d){if(!(f&&typeof f.length!="undefined"))return d(new TypeError(typeof f+" "+f+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var S=Array.prototype.slice.call(f);if(S.length===0)return u([]);var C=S.length;function A(O,P){if(P&&(typeof P=="object"||typeof P=="function")){var b=P.then;if(typeof b=="function"){b.call(P,function(U){A(O,U)},function(U){S[O]={status:"rejected",reason:U},--C===0&&u(S)});return}}S[O]={status:"fulfilled",value:P},--C===0&&u(S)}for(var R=0;R<S.length;R++)A(R,S[R])})}var n=setTimeout;function s(f){return Boolean(f&&typeof f.length!="undefined")}function o(){}function l(f,y){return function(){f.apply(y,arguments)}}function h(f){if(!(this instanceof h))throw new TypeError("Promises must be constructed via new");if(typeof f!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],I(f,this)}function c(f,y){for(;f._state===3;)f=f._value;if(f._state===0){f._deferreds.push(y);return}f._handled=!0,h._immediateFn(function(){var u=f._state===1?y.onFulfilled:y.onRejected;if(u===null){(f._state===1?p:E)(y.promise,f._value);return}var d;try{d=u(f._value)}catch(S){E(y.promise,S);return}p(y.promise,d)})}function p(f,y){try{if(y===f)throw new TypeError("A promise cannot be resolved with itself.");if(y&&(typeof y=="object"||typeof y=="function")){var u=y.then;if(y instanceof h){f._state=3,f._value=y,m(f);return}else if(typeof u=="function"){I(l(u,y),f);return}}f._state=1,f._value=y,m(f)}catch(d){E(f,d)}}function E(f,y){f._state=2,f._value=y,m(f)}function m(f){f._state===2&&f._deferreds.length===0&&h._immediateFn(function(){f._handled||h._unhandledRejectionFn(f._value)});for(var y=0,u=f._deferreds.length;y<u;y++)c(f,f._deferreds[y]);f._deferreds=null}function T(f,y,u){this.onFulfilled=typeof f=="function"?f:null,this.onRejected=typeof y=="function"?y:null,this.promise=u}function I(f,y){var u=!1;try{f(function(d){u||(u=!0,p(y,d))},function(d){u||(u=!0,E(y,d))})}catch(d){if(u)return;u=!0,E(y,d)}}h.prototype.catch=function(f){return this.then(null,f)},h.prototype.then=function(f,y){var u=new this.constructor(o);return c(this,new T(f,y,u)),u},h.prototype.finally=e,h.all=function(f){return new h(function(y,u){if(!s(f))return u(new TypeError("Promise.all accepts an array"));var d=Array.prototype.slice.call(f);if(d.length===0)return y([]);var S=d.length;function C(R,O){try{if(O&&(typeof O=="object"||typeof O=="function")){var P=O.then;if(typeof P=="function"){P.call(O,function(b){C(R,b)},u);return}}d[R]=O,--S===0&&y(d)}catch(b){u(b)}}for(var A=0;A<d.length;A++)C(A,d[A])})},h.allSettled=i,h.resolve=function(f){return f&&typeof f=="object"&&f.constructor===h?f:new h(function(y){y(f)})},h.reject=function(f){return new h(function(y,u){u(f)})},h.race=function(f){return new h(function(y,u){if(!s(f))return u(new TypeError("Promise.race accepts an array"));for(var d=0,S=f.length;d<S;d++)h.resolve(f[d]).then(y,u)})},h._immediateFn=typeof setImmediate=="function"&&function(f){setImmediate(f)}||function(f){n(f,0)},h._unhandledRejectionFn=function(y){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",y)};var N=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof Z!="undefined")return Z;throw new Error("unable to locate global object")}();typeof N.Promise!="function"?N.Promise=h:N.Promise.prototype.finally?N.Promise.allSettled||(N.Promise.allSettled=i):N.Promise.prototype.finally=e})})();var ue={exports:{}};(function(r){(function(t){if(!t.__disableNativeFetch&&t.fetch)return;function e(u){if(typeof u!="string"&&(u=String(u)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(u))throw new TypeError("Invalid character in header field name");return u.toLowerCase()}function i(u){return typeof u!="string"&&(u=String(u)),u}function n(u){this.map={},u instanceof n?u.forEach(function(d,S){this.append(S,d)},this):u&&Object.getOwnPropertyNames(u).forEach(function(d){this.append(d,u[d])},this)}n.prototype.append=function(u,d){u=e(u),d=i(d);var S=this.map[u];S||(S=[],this.map[u]=S),S.push(d)},n.prototype.delete=function(u){delete this.map[e(u)]},n.prototype.get=function(u){var d=this.map[e(u)];return d?d[0]:null},n.prototype.getAll=function(u){return this.map[e(u)]||[]},n.prototype.has=function(u){return this.map.hasOwnProperty(e(u))},n.prototype.set=function(u,d){this.map[e(u)]=[i(d)]},n.prototype.forEach=function(u,d){Object.getOwnPropertyNames(this.map).forEach(function(S){this.map[S].forEach(function(C){u.call(d,C,S,this)},this)},this)};function s(u){if(u.bodyUsed)return Promise.reject(new TypeError("Already read"));u.bodyUsed=!0}function o(u){return new Promise(function(d,S){u.onload=function(){d(u.result)},u.onerror=function(){S(u.error)}})}function l(u){var d=new FileReader;return d.readAsArrayBuffer(u),o(d)}function h(u,d){var S=new FileReader,C=d.headers.map["content-type"]?d.headers.map["content-type"].toString():"",A=/charset\=[0-9a-zA-Z\-\_]*;?/,R=u.type.match(A)||C.match(A),O=[u];return R&&O.push(R[0].replace(/^charset\=/,"").replace(/;$/,"")),S.readAsText.apply(S,O),o(S)}var c={blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};function p(){return this.bodyUsed=!1,this._initBody=function(u,d){if(this._bodyInit=u,typeof u=="string")this._bodyText=u;else if(c.blob&&Blob.prototype.isPrototypeOf(u))this._bodyBlob=u,this._options=d;else if(c.formData&&FormData.prototype.isPrototypeOf(u))this._bodyFormData=u;else if(!u)this._bodyText="";else if(!(c.arrayBuffer&&ArrayBuffer.prototype.isPrototypeOf(u)))throw new Error("unsupported BodyInit type")},c.blob?(this.blob=function(){var u=s(this);if(u)return u;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(l)},this.text=function(){var u=s(this);if(u)return u;if(this._bodyBlob)return h(this._bodyBlob,this._options);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var u=s(this);return u||Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(I)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(u){var d=u.toUpperCase();return E.indexOf(d)>-1?d:u}function T(u,d){d=d||{};var S=d.body;if(T.prototype.isPrototypeOf(u)){if(u.bodyUsed)throw new TypeError("Already read");this.url=u.url,this.credentials=u.credentials,d.headers||(this.headers=new n(u.headers)),this.method=u.method,this.mode=u.mode,S||(S=u._bodyInit,u.bodyUsed=!0)}else this.url=u;if(this.credentials=d.credentials||this.credentials||"omit",(d.headers||!this.headers)&&(this.headers=new n(d.headers)),this.method=m(d.method||this.method||"GET"),this.mode=d.mode||this.mode||null,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&S)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(S,d)}T.prototype.clone=function(){return new T(this)};function I(u){var d=new FormData;return u.trim().split("&").forEach(function(S){if(S){var C=S.split("="),A=C.shift().replace(/\+/g," "),R=C.join("=").replace(/\+/g," ");d.append(decodeURIComponent(A),decodeURIComponent(R))}}),d}function N(u){var d=new n,S=u.getAllResponseHeaders().trim().split(`
`);return S.forEach(function(C){var A=C.trim().split(":"),R=A.shift().trim(),O=A.join(":").trim();d.append(R,O)}),d}p.call(T.prototype);function f(u,d){d||(d={}),this._initBody(u,d),this.type="default",this.status=d.status,this.ok=this.status>=200&&this.status<300,this.statusText=d.statusText,this.headers=d.headers instanceof n?d.headers:new n(d.headers),this.url=d.url||""}p.call(f.prototype),f.prototype.clone=function(){return new f(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new n(this.headers),url:this.url})},f.error=function(){var u=new f(null,{status:0,statusText:""});return u.type="error",u};var y=[301,302,303,307,308];f.redirect=function(u,d){if(y.indexOf(d)===-1)throw new RangeError("Invalid status code");return new f(null,{status:d,headers:{location:u}})},t.Headers=n,t.Request=T,t.Response=f,t.fetch=function(u,d){return new Promise(function(S,C){var A;T.prototype.isPrototypeOf(u)&&!d?A=u:A=new T(u,d);var R=new XMLHttpRequest;function O(){if("responseURL"in R)return R.responseURL;if(/^X-Request-URL:/m.test(R.getAllResponseHeaders()))return R.getResponseHeader("X-Request-URL")}var P=!1;function b(){if(R.readyState===4){var U=R.status===1223?204:R.status;if(U<100||U>599){if(P)return;P=!0,C(new TypeError("Network request failed"));return}var pt={status:U,statusText:R.statusText,headers:N(R),url:O()},jt="response"in R?R.response:R.responseText;P||(P=!0,S(new f(jt,pt)))}}R.onreadystatechange=b,R.onload=b,R.onerror=function(){P||(P=!0,C(new TypeError("Network request failed")))},R.open(A.method,A.url,!0);try{A.credentials==="include"&&("withCredentials"in R?R.withCredentials=!0:console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning"))}catch(U){console&&console.warn&&console.warn("set withCredentials error:"+U)}"responseType"in R&&c.blob&&(R.responseType="blob"),A.headers.forEach(function(U,pt){R.setRequestHeader(pt,U)}),R.send(typeof A._bodyInit=="undefined"?null:A._bodyInit)})},t.fetch.polyfill=!0,r.exports&&(r.exports=t.fetch)})(typeof self!="undefined"?self:Z)})(ue);var ct={exports:{}};(function(r,t){(function(e,i){i(t,r)})(Z,function(e,i){var n={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function s(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function o(c){try{delete window[c]}catch{window[c]=void 0}}function l(c){var p=document.getElementById(c);p&&document.getElementsByTagName("head")[0].removeChild(p)}function h(c){var p=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],E=c,m=p.timeout||n.timeout,T=p.jsonpCallback||n.jsonpCallback,I=void 0;return new Promise(function(N,f){var y=p.jsonpCallbackFunction||s(),u=T+"_"+y;window[y]=function(S){N({ok:!0,json:function(){return Promise.resolve(S)}}),I&&clearTimeout(I),l(u),o(y)},E+=E.indexOf("?")===-1?"?":"&";var d=document.createElement("script");d.setAttribute("src",""+E+T+"="+y),p.charset&&d.setAttribute("charset",p.charset),d.id=u,document.getElementsByTagName("head")[0].appendChild(d),I=setTimeout(function(){f(new Error("JSONP request to "+c+" timed out")),o(y),l(u),window[y]=function(){o(y)}},m),d.onerror=function(){f(new Error("JSONP request to "+c+" failed")),o(y),l(u),I&&clearTimeout(I)}})}i.exports=h})})(ct,ct.exports);var Mt=ct.exports;let Nt=window.fetch;a.setCORS=function(r){a.CORS=r};var he=a.isCORS=function(){return a.CORS!=null?a.CORS:window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest};a.setRequestTimeout=function(r){return a.RequestTimeout=r};var _t=a.getRequestTimeout=function(){return a.RequestTimeout||45e3},Y=a.FetchRequest={commit:function(r,t,e,i){switch(r=r&&r.toUpperCase(),r){case"GET":return this.get(t,e,i);case"POST":return this.post(t,e,i);case"PUT":return this.put(t,e,i);case"DELETE":return this.delete(t,e,i);default:return this.get(t,e,i)}},supportDirectRequest:function(r,t){return v.isInTheSameDomain(r)?!0:t.crossOrigin!=null?t.crossOrigin:he()||t.proxy},get:function(r,t,e){e=e||{};var i="GET";if(r=v.urlAppend(r,this._getParameterString(t||{})),r=this._processUrl(r,e),!this.supportDirectRequest(r,e)){r=r.replace(".json",".jsonp");var n={url:r,data:t};return a.Util.RequestJSONPPromise.GET(n)}return this.urlIsLong(r)?this._postSimulatie(i,r.substring(0,r.indexOf("?")-1),t,e):this._fetch(r,t,e,i)},delete:function(r,t,e){e=e||{};var i="DELETE";if(r=v.urlAppend(r,this._getParameterString(t||{})),r=this._processUrl(r,e),!this.supportDirectRequest(r,e)){r=r.replace(".json",".jsonp");var n={url:r+="&_method=DELETE",data:t};return a.Util.RequestJSONPPromise.DELETE(n)}return this.urlIsLong(r)?this._postSimulatie(i,r.substring(0,r.indexOf("?")-1),t,e):this._fetch(r,t,e,i)},post:function(r,t,e){if(e=e||{},!this.supportDirectRequest(r,e)){r=r.replace(".json",".jsonp");var i={url:r+="&_method=POST",data:t};return a.Util.RequestJSONPPromise.POST(i)}return this._fetch(this._processUrl(r,e),t,e,"POST")},put:function(r,t,e){if(e=e||{},r=this._processUrl(r,e),!this.supportDirectRequest(r,e)){r=r.replace(".json",".jsonp");var i={url:r+="&_method=PUT",data:t};return a.Util.RequestJSONPPromise.PUT(i)}return this._fetch(r,t,e,"PUT")},urlIsLong:function(r){for(var t=0,e=null,i=0,n=r.length;i<n;i++)e=r.charCodeAt(i),e<127?t++:128<=e&&e<=2047?t+=2:2048<=e&&e<=65535&&(t+=3);return!(t<2e3)},_postSimulatie:function(r,t,e,i){var n=t.indexOf("?")>-1?"&":"?";return t+=n+"_method="+r,typeof e!="string"&&(e=JSON.stringify(e)),this.post(t,e,i)},_processUrl:function(r,t){if(this._isMVTRequest(r))return r;if(r.indexOf(".json")===-1&&!t.withoutFormatSuffix)if(r.indexOf("?")<0)r+=".json";else{var e=r.split("?");e.length===2&&(r=e[0]+".json?"+e[1])}return t&&t.proxy&&(typeof t.proxy=="function"?r=t.proxy(r):(r=decodeURIComponent(r),r=t.proxy+encodeURIComponent(r))),r},_fetch:function(r,t,e,i){return e=e||{},e.headers=e.headers||{},!e.headers["Content-Type"]&&!FormData.prototype.isPrototypeOf(t)&&(e.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),e.timeout?this._timeout(e.timeout,Nt(r,{method:i,headers:e.headers,body:i==="PUT"||i==="POST"?t:void 0,credentials:this._getWithCredentials(e),mode:"cors",timeout:_t()}).then(function(n){return n})):Nt(r,{method:i,body:i==="PUT"||i==="POST"?t:void 0,headers:e.headers,credentials:this._getWithCredentials(e),mode:"cors",timeout:_t()}).then(function(n){return n})},_getWithCredentials:function(r){return r.withCredentials===!0?"include":r.withCredentials===!1?"omit":"same-origin"},_fetchJsonp:function(r,t){return t=t||{},Mt(r,{method:"GET",timeout:t.timeout}).then(function(e){return e})},_timeout:function(r,t){return new Promise(function(e,i){setTimeout(function(){i(new Error("timeout"))},r),t.then(e,i)})},_getParameterString:function(r){var t=[];for(var e in r){var i=r[e];if(i!=null&&typeof i!="function"){var n;Array.isArray(i)||i.toString()==="[object Object]"?n=encodeURIComponent(JSON.stringify(i)):n=encodeURIComponent(i),t.push(encodeURIComponent(e)+"="+n)}}return t.join("&")},_isMVTRequest:function(r){return r.indexOf(".mvt")>-1||r.indexOf(".pbf")>-1}};a.Util.RequestJSONPPromise={limitLength:1500,queryKeys:[],queryValues:[],supermap_callbacks:{},addQueryStrings:function(r){var t=this;for(var e in r){t.queryKeys.push(e),typeof r[e]!="string"&&(r[e]=a.Util.toJSON(r[e]));var i=encodeURIComponent(r[e]);t.queryValues.push(i)}},issue:function(r){for(var t=this,e=t.getUid(),i=r.url,n=[],s=new Promise(function(T){t.supermap_callbacks[e]=function(I){delete t.supermap_callbacks[e],T(I)}}),o=i,l=0,h=t.queryKeys?t.queryKeys.length:0,c=0;c<h;c++)if(o.length+t.queryKeys[c].length+2>=t.limitLength){if(l==0)return!1;n.push(o),o=i,l=0,c--}else if(o.length+t.queryKeys[c].length+2+t.queryValues[c].length>t.limitLength)for(var p=t.queryValues[c];p.length>0;){var E=t.limitLength-o.length-t.queryKeys[c].length-2;o.indexOf("?")>-1?o+="&":o+="?";var m=p.substring(0,E);m.substring(E-1,E)==="%"?(E-=1,m=p.substring(0,E)):m.substring(E-2,E-1)==="%"&&(E-=2,m=p.substring(0,E)),o+=t.queryKeys[c]+"="+m,p=p.substring(E),m.length>0&&(n.push(o),o=i,l=0)}else l++,o.indexOf("?")>-1?o+="&":o+="?",o+=t.queryKeys[c]+"="+t.queryValues[c];return n.push(o),t.send(n,"SuperMap.Util.RequestJSONPPromise.supermap_callbacks["+e+"]",r&&r.proxy),s},getUid:function(){var r=new Date().getTime(),t=Math.floor(Math.random()*1e17);return r*1e3+t},send:function(r,t,e){var i=r.length;if(i>0)for(var n=new Date().getTime(),s=0;s<i;s++){var o=r[s];o.indexOf("?")>-1?o+="&":o+="?",o+="sectionCount="+i,o+="&sectionIndex="+s,o+="&jsonpUserID="+n,e&&(o=decodeURIComponent(o),o=e+encodeURIComponent(o)),Mt(o,{jsonpCallbackFunction:t,timeout:3e4})}},GET:function(r){var t=this;return t.queryKeys.length=0,t.queryValues.length=0,t.addQueryStrings(r.params),t.issue(r)},POST:function(r){var t=this;return t.queryKeys.length=0,t.queryValues.length=0,t.addQueryStrings({requestEntity:r.data}),t.issue(r)},PUT:function(r){var t=this;return t.queryKeys.length=0,t.queryValues.length=0,t.addQueryStrings({requestEntity:r.data}),t.issue(r)},DELETE:function(r){var t=this;return t.queryKeys.length=0,t.queryValues.length=0,t.addQueryStrings({requestEntity:r.data}),t.issue(r)}};class it{constructor(t,e){this.value=t||"",this.name=e||"token",this.CLASS_NAME="SuperMap.Credential"}getUrlParameters(){return this.name+"="+this.value}getValue(){return this.value}destroy(){this.value=null,this.name=null}}it.CREDENTIAL=null;a.Credential=it;class J{static generateToken(t,e){var i=this.servers[t];if(!!i)return Y.post(i.tokenServiceUrl,JSON.stringify(e.toJSON())).then(function(n){return n.text()})}static registerServers(t){this.servers=this.servers||{},v.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var i=t[e];this.servers[i.server]=i}}static registerToken(t,e){if(this.tokens=this.tokens||{},!(!t||!e)){var i=this._getTokenStorageKey(t);this.tokens[i]=e}}static registerKey(t,e){if(this.keys=this.keys||{},!(!t||t.length<1||!e)){t=v.isArray(t)?t:[t];for(var i=0;i<t.length;i++){var n=this._getUrlRestString(t[0])||t[0];this.keys[n]=e}}}static getServerInfo(t){return this.servers=this.servers||{},this.servers[t]}static getToken(t){if(!!t){this.tokens=this.tokens||{};var e=this._getTokenStorageKey(t);return this.tokens[e]}}static getKey(t){this.keys=this.keys||{};var e=this._getUrlRestString(t)||t;return this.keys[e]}static loginiServer(t,e,i,n){t=v.urlPathAppend(t,"services/security/login");var s={username:e&&e.toString(),password:i&&i.toString(),rememberme:n};s=JSON.stringify(s);var o={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}};return Y.post(t,s,o).then(function(l){return l.json()})}static logoutiServer(t){t=v.urlPathAppend(t,"services/security/logout");var e={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withoutFormatSuffix:!0};return Y.get(t,"",e).then(function(){return!0}).catch(function(){return!1})}static loginOnline(t,e){var i=J.SSO+"/login?service="+t;this._open(i,e)}static loginiPortal(t,e,i){t=v.urlPathAppend(t,"web/login");var n={username:e&&e.toString(),password:i&&i.toString()};n=JSON.stringify(n);var s={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0};return Y.post(t,n,s).then(function(o){return o.json()})}static logoutiPortal(t){t=v.urlPathAppend(t,"services/security/logout");var e={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0,withoutFormatSuffix:!0};return Y.get(t,"",e).then(function(){return!0}).catch(function(){return!1})}static loginManager(t,e,i){if(!v.isInTheSameDomain(t)){var n=i?i.isNewTab:!0;this._open(t,n);return}var s=v.urlPathAppend(t,"icloud/security/tokens"),o=e||{},l={username:o.userName&&o.userName.toString(),password:o.password&&o.password.toString()};l=JSON.stringify(l);var h={headers:{Accept:"*/*","Content-Type":"application/json"}},c=this;return Y.post(s,l,h).then(function(p){p.text().then(function(E){return c.imanagerToken=E,E})})}static destroyAllCredentials(){this.keys=null,this.tokens=null,this.servers=null}static destroyToken(t){if(!!t){var e=this._getTokenStorageKey(t);this.tokens=this.tokens||{},this.tokens[e]&&delete this.tokens[e]}}static destroyKey(t){if(!!t){this.keys=this.keys||{};var e=this._getUrlRestString(t)||t;this.keys[e]&&delete this.keys[e]}}static appendCredential(t){var e=t,i=this.getToken(t),n=i?new it(i,"token"):null;return n||(i=this.getKey(t),n=i?new it(i,"key"):null),n&&(e=v.urlAppend(e,n.getUrlParameters())),e}static _open(t,e){e=e!=null?e:!0;var i=window.screen.availWidth/2-this.INNER_WINDOW_WIDTH/2,n=window.screen.availHeight/2-this.INNER_WINDOW_HEIGHT/2,s="height="+this.INNER_WINDOW_HEIGHT+", width="+this.INNER_WINDOW_WIDTH+",top="+n+", left="+i+",toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no";e?window.open(t,"login"):window.open(t,"login",s)}static _getTokenStorageKey(t){var e=/(.*?):\/\/([^\/]+)/i,i=t.match(e);return i?i[0]:t}static _getUrlRestString(t){if(!t)return t;var e=/(http|https):\/\/(.*\/rest)/i,i=t.match(e);return i?i[0]:t}}J.INNER_WINDOW_WIDTH=600;J.INNER_WINDOW_HEIGHT=600;J.SSO="https://sso.supermap.com";J.ONLINE="https://www.supermapol.com";a.SecurityManager=J;a.DataFormat={GEOJSON:"GEOJSON",ISERVER:"ISERVER"};a.ServerType={ISERVER:"ISERVER",IPORTAL:"IPORTAL",ONLINE:"ONLINE"};var w=a.GeometryType={LINE:"LINE",LINEM:"LINEM",POINT:"POINT",REGION:"REGION",POINTEPS:"POINTEPS",LINEEPS:"LINEEPS",REGIONEPS:"REGIONEPS",ELLIPSE:"ELLIPSE",CIRCLE:"CIRCLE",TEXT:"TEXT",RECTANGLE:"RECTANGLE",UNKNOWN:"UNKNOWN",GEOCOMPOUND:"GEOCOMPOUND"};a.QueryOption={ATTRIBUTE:"ATTRIBUTE",ATTRIBUTEANDGEOMETRY:"ATTRIBUTEANDGEOMETRY",GEOMETRY:"GEOMETRY"};a.JoinType={INNERJOIN:"INNERJOIN",LEFTJOIN:"LEFTJOIN"};a.SpatialQueryMode={CONTAIN:"CONTAIN",CROSS:"CROSS",DISJOINT:"DISJOINT",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",NONE:"NONE",OVERLAP:"OVERLAP",TOUCH:"TOUCH",WITHIN:"WITHIN"};a.SpatialRelationType={CONTAIN:"CONTAIN",INTERSECT:"INTERSECT",WITHIN:"WITHIN"};a.MeasureMode={DISTANCE:"DISTANCE",AREA:"AREA"};var W=a.Unit={METER:"METER",KILOMETER:"KILOMETER",MILE:"MILE",YARD:"YARD",DEGREE:"DEGREE",MILLIMETER:"MILLIMETER",CENTIMETER:"CENTIMETER",INCH:"INCH",DECIMETER:"DECIMETER",FOOT:"FOOT",SECOND:"SECOND",MINUTE:"MINUTE",RADIAN:"RADIAN"};a.BufferRadiusUnit={CENTIMETER:"CENTIMETER",DECIMETER:"DECIMETER",FOOT:"FOOT",INCH:"INCH",KILOMETER:"KILOMETER",METER:"METER",MILE:"MILE",MILLIMETER:"MILLIMETER",YARD:"YARD"};a.EngineType={IMAGEPLUGINS:"IMAGEPLUGINS",OGC:"OGC",ORACLEPLUS:"ORACLEPLUS",SDBPLUS:"SDBPLUS",SQLPLUS:"SQLPLUS",UDB:"UDB"};a.ThemeGraphTextFormat={CAPTION:"CAPTION",CAPTION_PERCENT:"CAPTION_PERCENT",CAPTION_VALUE:"CAPTION_VALUE",PERCENT:"PERCENT",VALUE:"VALUE"};a.ThemeGraphType={AREA:"AREA",BAR:"BAR",BAR3D:"BAR3D",LINE:"LINE",PIE:"PIE",PIE3D:"PIE3D",POINT:"POINT",RING:"RING",ROSE:"ROSE",ROSE3D:"ROSE3D",STACK_BAR:"STACK_BAR",STACK_BAR3D:"STACK_BAR3D",STEP:"STEP"};a.GraphAxesTextDisplayMode={ALL:"ALL",NONE:"NONE",YAXES:"YAXES"};a.GraduatedMode={CONSTANT:"CONSTANT",LOGARITHM:"LOGARITHM",SQUAREROOT:"SQUAREROOT"};a.RangeMode={CUSTOMINTERVAL:"CUSTOMINTERVAL",EQUALINTERVAL:"EQUALINTERVAL",LOGARITHM:"LOGARITHM",QUANTILE:"QUANTILE",SQUAREROOT:"SQUAREROOT",STDDEVIATION:"STDDEVIATION"};a.ThemeType={DOTDENSITY:"DOTDENSITY",GRADUATEDSYMBOL:"GRADUATEDSYMBOL",GRAPH:"GRAPH",LABEL:"LABEL",RANGE:"RANGE",UNIQUE:"UNIQUE"};a.ColorGradientType={BLACK_WHITE:"BLACKWHITE",BLUE_BLACK:"BLUEBLACK",BLUE_RED:"BLUERED",BLUE_WHITE:"BLUEWHITE",CYAN_BLACK:"CYANBLACK",CYAN_BLUE:"CYANBLUE",CYAN_GREEN:"CYANGREEN",CYAN_WHITE:"CYANWHITE",GREEN_BLACK:"GREENBLACK",GREEN_BLUE:"GREENBLUE",GREEN_ORANGE_VIOLET:"GREENORANGEVIOLET",GREEN_RED:"GREENRED",GREEN_WHITE:"GREENWHITE",PINK_BLACK:"PINKBLACK",PINK_BLUE:"PINKBLUE",PINK_RED:"PINKRED",PINK_WHITE:"PINKWHITE",RAIN_BOW:"RAINBOW",RED_BLACK:"REDBLACK",RED_WHITE:"REDWHITE",SPECTRUM:"SPECTRUM",TERRAIN:"TERRAIN",YELLOW_BLACK:"YELLOWBLACK",YELLOW_BLUE:"YELLOWBLUE",YELLOW_GREEN:"YELLOWGREEN",YELLOW_RED:"YELLOWRED",YELLOW_WHITE:"YELLOWWHITE"};a.TextAlignment={TOPLEFT:"TOPLEFT",TOPCENTER:"TOPCENTER",TOPRIGHT:"TOPRIGHT",BASELINELEFT:"BASELINELEFT",BASELINECENTER:"BASELINECENTER",BASELINERIGHT:"BASELINERIGHT",BOTTOMLEFT:"BOTTOMLEFT",BOTTOMCENTER:"BOTTOMCENTER",BOTTOMRIGHT:"BOTTOMRIGHT",MIDDLELEFT:"MIDDLELEFT",MIDDLECENTER:"MIDDLECENTER",MIDDLERIGHT:"MIDDLERIGHT"};a.FillGradientMode={NONE:"NONE",LINEAR:"LINEAR",RADIAL:"RADIAL",CONICAL:"CONICAL",SQUARE:"SQUARE"};a.AlongLineDirection={NORMAL:"ALONG_LINE_NORMAL",LB_TO_RT:"LEFT_BOTTOM_TO_RIGHT_TOP",LT_TO_RB:"LEFT_TOP_TO_RIGHT_BOTTOM",RB_TO_LT:"RIGHT_BOTTOM_TO_LEFT_TOP",RT_TO_LB:"RIGHT_TOP_TO_LEFT_BOTTOM"};a.LabelBackShape={DIAMOND:"DIAMOND",ELLIPSE:"ELLIPSE",MARKER:"MARKER",NONE:"NONE",RECT:"RECT",ROUNDRECT:"ROUNDRECT",TRIANGLE:"TRIANGLE"};a.LabelOverLengthMode={NEWLINE:"NEWLINE",NONE:"NONE",OMIT:"OMIT"};a.DirectionType={EAST:"EAST",NONE:"NONE",NORTH:"NORTH",SOURTH:"SOURTH",WEST:"WEST"};a.SideType={LEFT:"LEFT",MIDDLE:"MIDDLE",NONE:"NONE",RIGHT:"RIGHT"};a.SupplyCenterType={FIXEDCENTER:"FIXEDCENTER",NULL:"NULL",OPTIONALCENTER:"OPTIONALCENTER"};a.TurnType={AHEAD:"AHEAD",BACK:"BACK",END:"END",LEFT:"LEFT",NONE:"NONE",RIGHT:"RIGHT"};a.BufferEndType={FLAT:"FLAT",ROUND:"ROUND"};a.OverlayOperationType={CLIP:"CLIP",ERASE:"ERASE",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",UNION:"UNION",UPDATE:"UPDATE",XOR:"XOR"};a.OutputType={INDEXEDHDFS:"INDEXEDHDFS",UDB:"UDB",MONGODB:"MONGODB",PG:"PG"};a.SmoothMethod={BSPLINE:"BSPLINE",POLISH:"POLISH"};a.SurfaceAnalystMethod={ISOLINE:"ISOLINE",ISOREGION:"ISOREGION"};a.DataReturnMode={DATASET_AND_RECORDSET:"DATASET_AND_RECORDSET",DATASET_ONLY:"DATASET_ONLY",RECORDSET_ONLY:"RECORDSET_ONLY"};a.EditType={ADD:"add",UPDATE:"update",DELETE:"delete"};a.TransferTactic={LESS_TIME:"LESS_TIME",LESS_TRANSFER:"LESS_TRANSFER",LESS_WALK:"LESS_WALK",MIN_DISTANCE:"MIN_DISTANCE"};a.TransferPreference={BUS:"BUS",SUBWAY:"SUBWAY",NO_SUBWAY:"NO_SUBWAY",NONE:"NONE"};a.GridType={CROSS:"CROSS",GRID:"GRID",POINT:"POINT"};a.ColorSpaceType={CMYK:"CMYK",RGB:"RGB"};a.LayerType={UGC:"UGC",WMS:"WMS",WFS:"WFS",CUSTOM:"CUSTOM"};a.UGCLayerType={THEME:"THEME",VECTOR:"VECTOR",GRID:"GRID",IMAGE:"IMAGE"};a.StatisticMode={AVERAGE:"AVERAGE",MAX:"MAX",MIN:"MIN",STDDEVIATION:"STDDEVIATION",SUM:"SUM",VARIANCE:"VARIANCE"};a.PixelFormat={BIT16:"BIT16",BIT32:"BIT32",BIT64:"BIT64",SINGLE:"SINGLE",DOUBLE:"DOUBLE",UBIT1:"UBIT1",UBIT4:"UBIT4",UBIT8:"UBIT8",UBIT24:"UBIT24",UBIT32:"UBIT32"};a.SearchMode={KDTREE_FIXED_COUNT:"KDTREE_FIXED_COUNT",KDTREE_FIXED_RADIUS:"KDTREE_FIXED_RADIUS",NONE:"NONE",QUADTREE:"QUADTREE"};a.InterpolationAlgorithmType={KRIGING:"KRIGING",SimpleKriging:"SimpleKriging",UniversalKriging:"UniversalKriging"};a.VariogramMode={EXPONENTIAL:"EXPONENTIAL",GAUSSIAN:"GAUSSIAN",SPHERICAL:"SPHERICAL"};a.Exponent={EXP1:"EXP1",EXP2:"EXP2"};a.ClientType={IP:"IP",REFERER:"Referer",REQUESTIP:"RequestIP",NONE:"NONE",SERVER:"SERVER",WEB:"WEB"};a.ChartType={BAR:"Bar",BAR3D:"Bar3D",CIRCLE:"Circle",PIE:"Pie",POINT:"Point",LINE:"Line",RING:"Ring"};a.ClipAnalystMode={CLIP:"clip",INTERSECT:"intersect"};a.AnalystAreaUnit={SQUAREMETER:"SquareMeter",SQUAREKILOMETER:"SquareKiloMeter",HECTARE:"Hectare",ARE:"Are",ACRE:"Acre",SQUAREFOOT:"SquareFoot",SQUAREYARD:"SquareYard",SQUAREMILE:"SquareMile"};a.AnalystSizeUnit={METER:"Meter",KILOMETER:"Kilometer",YARD:"Yard",FOOT:"Foot",MILE:"Mile"};a.StatisticAnalystMode={MAX:"max",MIN:"min",AVERAGE:"average",SUM:"sum",VARIANCE:"variance",STDDEVIATION:"stdDeviation"};a.SummaryType={SUMMARYMESH:"SUMMARYMESH",SUMMARYREGION:"SUMMARYREGION"};a.TopologyValidatorRule={REGIONNOOVERLAP:"REGIONNOOVERLAP",REGIONNOOVERLAPWITH:"REGIONNOOVERLAPWITH",REGIONCONTAINEDBYREGION:"REGIONCONTAINEDBYREGION",REGIONCOVEREDBYREGION:"REGIONCOVEREDBYREGION",LINENOOVERLAP:"LINENOOVERLAP",LINENOOVERLAPWITH:"LINENOOVERLAPWITH",POINTNOIDENTICAL:"POINTNOIDENTICAL"};a.BucketAggType={GEOHASH_GRID:"geohash_grid"};a.MetricsAggType={AVG:"avg",MAX:"max",MIN:"min",SUM:"sum"};a.GetFeatureMode={BOUNDS:"BOUNDS",BUFFER:"BUFFER",ID:"ID",SPATIAL:"SPATIAL",SQL:"SQL"};a.RasterFunctionType={NDVI:"NDVI",HILLSHADE:"HILLSHADE"};a.ResourceType={MAP:"MAP",SERVICE:"SERVICE",SCENE:"SCENE",DATA:"DATA",INSIGHTS_WORKSPACE:"INSIGHTS_WORKSPACE",MAP_DASHBOARD:"MAP_DASHBOARD"};a.OrderBy={UPDATETIME:"UPDATETIME",HEATLEVEL:"HEATLEVEL",RELEVANCE:"RELEVANCE"};a.OrderType={ASC:"ASC",DESC:"DESC"};a.SearchType={PUBLIC:"PUBLIC",MY_RES:"MY_RES",MYGROUP_RES:"MYGROUP_RES",MYDEPARTMENT_RES:"MYDEPARTMENT_RES",SHARETOME_RES:"SHARETOME_RES"};a.AggregationTypes={TAG:"TAG",TYPE:"TYPE"};a.PermissionType={SEARCH:"SEARCH",READ:"READ",READWRITE:"READWRITE",DELETE:"DELETE",DOWNLOAD:"DOWNLOAD"};a.EntityType={DEPARTMENT:"DEPARTMENT",GROUP:"GROUP",IPORTALGROUP:"IPORTALGROUP",ROLE:"ROLE",USER:"USER"};a.DataItemType={WORKSPACE:"WORKSPACE",UDB:"UDB",SHP:"SHP",EXCEL:"EXCEL",CSV:"CSV",GEOJSON:"GEOJSON",SMTILES:"SMTILES",SVTILES:"SVTILES",MBTILES:"MBTILES",TPK:"TPK",UGCV5:"UGCV5",UGCV5_MVT:"UGCV5_MVT",JSON:"JSON"};a.WebExportFormatType={PNG:"PNG",PDF:"PDF"};a.WebScaleOrientationType={HORIZONTALLABELSBELOW:"HORIZONTALLABELSBELOW",HORIZONTALLABELSABOVE:"HORIZONTALLABELSABOVE",VERTICALLABELSLEFT:"VERTICALLABELSLEFT",VERTICALLABELSRIGHT:"VERTICALLABELSRIGHT"};a.WebScaleType={LINE:"LINE",BAR:"BAR",BAR_SUB:"BAR_SUB"};a.WebScaleUnit={METER:"METER",FOOT:"FOOT",DEGREES:"DEGREES"};class rt{constructor(){this.CLASS_NAME="SuperMap.Geometry",this.id=v.createUniqueID(this.CLASS_NAME+"_"),this.parent=null,this.bounds=null,this.SRID=null}destroy(){this.id=null,this.bounds=null,this.SRID=null}clone(){return new rt}setBounds(t){t&&(this.bounds=t.clone())}clearBounds(){this.bounds=null,this.parent&&this.parent.clearBounds()}extendBounds(t){var e=this.getBounds();e?this.bounds.extend(t):this.setBounds(t)}getBounds(){return this.bounds==null&&this.calculateBounds(),this.bounds}calculateBounds(){}getVertices(t){}getArea(){return 0}}a.Geometry=rt;class st{constructor(t,e){this.w=t?parseFloat(t):0,this.h=t?parseFloat(e):0,this.CLASS_NAME="SuperMap.Size"}toString(){return"w="+this.w+",h="+this.h}clone(){return new st(this.w,this.h)}equals(t){var e=!1;return t!=null&&(e=this.w===t.w&&this.h===t.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(t.w)&&isNaN(t.h)),e}destroy(){this.w=null,this.h=null}}a.Size=st;class j{constructor(t,e,i){this.x=t?parseFloat(t):0,this.y=e?parseFloat(e):0,this.mode=i,this.CLASS_NAME="SuperMap.Pixel",a.Pixel.Mode={LeftTop:"lefttop",RightTop:"righttop",RightBottom:"rightbottom",LeftBottom:"leftbottom"}}toString(){return"x="+this.x+",y="+this.y}clone(){return new j(this.x,this.y,this.mode)}equals(t){var e=!1;return t!=null&&(e=this.x==t.x&&this.y==t.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(t.x)&&isNaN(t.y)),e}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}add(t,e){if(t==null||e==null)throw new TypeError("Pixel.add cannot receive null values");return new j(this.x+t,this.y+e)}offset(t){var e=this.clone();return t&&(e=this.add(t.x,t.y)),e}destroy(){this.x=null,this.y=null,this.mode=null}}a.Pixel=j;class Q{constructor(t,e){v.isArray(t)&&(e=t[1],t=t[0]),this.lon=t?v.toFloat(t):0,this.lat=e?v.toFloat(e):0,this.CLASS_NAME="SuperMap.LonLat"}toString(){return"lon="+this.lon+",lat="+this.lat}toShortString(){return this.lon+","+this.lat}clone(){return new Q(this.lon,this.lat)}add(t,e){if(t==null||e==null)throw new TypeError("LonLat.add cannot receive null values");return new Q(this.lon+v.toFloat(t),this.lat+v.toFloat(e))}equals(t){var e=!1;return t!=null&&(e=this.lon===t.lon&&this.lat===t.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(t.lon)&&isNaN(t.lat)),e}wrapDateLine(t){var e=this.clone();if(t){for(;e.lon<t.left;)e.lon+=t.getWidth();for(;e.lon>t.right;)e.lon-=t.getWidth()}return e}destroy(){this.lon=null,this.lat=null}static fromString(t){var e=t.split(",");return new Q(e[0],e[1])}static fromArray(t){var e=v.isArray(t),i=e&&t[0],n=e&&t[1];return new Q(i,n)}}class M{constructor(t,e,i,n){v.isArray(t)&&(n=t[3],i=t[2],e=t[1],t=t[0]),this.left=t!=null?v.toFloat(t):this.left,this.bottom=e!=null?v.toFloat(e):this.bottom,this.right=i!=null?v.toFloat(i):this.right,this.top=n!=null?v.toFloat(n):this.top,this.centerLonLat=null,this.CLASS_NAME="SuperMap.Bounds"}clone(){return new M(this.left,this.bottom,this.right,this.top)}equals(t){var e=!1;return t!=null&&(e=this.left===t.left&&this.right===t.right&&this.top===t.top&&this.bottom===t.bottom),e}toString(){return[this.left,this.bottom,this.right,this.top].join(",")}toArray(t){return t===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]}toBBOX(t,e){t==null&&(t=6);var i=Math.pow(10,t),n=Math.round(this.left*i)/i,s=Math.round(this.bottom*i)/i,o=Math.round(this.right*i)/i,l=Math.round(this.top*i)/i;return e===!0?s+","+n+","+l+","+o:n+","+s+","+o+","+l}getWidth(){return this.right-this.left}getHeight(){return this.top-this.bottom}getSize(){return new st(this.getWidth(),this.getHeight())}getCenterPixel(){return new j((this.left+this.right)/2,(this.bottom+this.top)/2)}getCenterLonLat(){return this.centerLonLat||(this.centerLonLat=new Q((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat}scale(t,e){t=t||1,e==null&&(e=this.getCenterLonLat());var i,n;e.CLASS_NAME==="SuperMap.LonLat"?(i=e.lon,n=e.lat):(i=e.x,n=e.y);var s=(this.left-i)*t+i,o=(this.bottom-n)*t+n,l=(this.right-i)*t+i,h=(this.top-n)*t+n;return new M(s,o,l,h)}add(t,e){if(t==null||e==null)throw new TypeError("Bounds.add cannot receive null values");return new M(this.left+t,this.bottom+e,this.right+t,this.top+e)}extend(t){var e=null;if(t){switch(t.CLASS_NAME){case"SuperMap.LonLat":e=new M(t.lon,t.lat,t.lon,t.lat);break;case"SuperMap.Geometry.Point":e=new M(t.x,t.y,t.x,t.y);break;case"SuperMap.Bounds":e=t;break}e&&(this.centerLonLat=null,(this.left==null||e.left<this.left)&&(this.left=e.left),(this.bottom==null||e.bottom<this.bottom)&&(this.bottom=e.bottom),(this.right==null||e.right>this.right)&&(this.right=e.right),(this.top==null||e.top>this.top)&&(this.top=e.top))}}containsLonLat(t,e){typeof e=="boolean"&&(e={inclusive:e}),e=e||{};var i=this.contains(t.lon,t.lat,e.inclusive),n=e.worldBounds;if(n&&!i){var s=n.getWidth(),o=(n.left+n.right)/2,l=Math.round((t.lon-o)/s);i=this.containsLonLat({lon:t.lon-l*s,lat:t.lat},{inclusive:e.inclusive})}return i}containsPixel(t,e){return this.contains(t.x,t.y,e)}contains(t,e,i){if(i==null&&(i=!0),t==null||e==null)return!1;var n=!1;return i?n=t>=this.left&&t<=this.right&&e>=this.bottom&&e<=this.top:n=t>this.left&&t<this.right&&e>this.bottom&&e<this.top,n}intersectsBounds(t,e){if(typeof e=="boolean"&&(e={inclusive:e}),e=e||{},e.worldBounds){var i=this.wrapDateLine(e.worldBounds);t=t.wrapDateLine(e.worldBounds)}else i=this;e.inclusive==null&&(e.inclusive=!0);var n=!1,s=i.left===t.right||i.right===t.left||i.top===t.bottom||i.bottom===t.top;if(e.inclusive||!s){var o=t.bottom>=i.bottom&&t.bottom<=i.top||i.bottom>=t.bottom&&i.bottom<=t.top,l=t.top>=i.bottom&&t.top<=i.top||i.top>t.bottom&&i.top<t.top,h=t.left>=i.left&&t.left<=i.right||i.left>=t.left&&i.left<=t.right,c=t.right>=i.left&&t.right<=i.right||i.right>=t.left&&i.right<=t.right;n=(o||l)&&(h||c)}if(e.worldBounds&&!n){var p=e.worldBounds,E=p.getWidth(),m=!p.containsBounds(i),T=!p.containsBounds(t);m&&!T?(t=t.add(-E,0),n=i.intersectsBounds(t,{inclusive:e.inclusive})):T&&!m&&(i=i.add(-E,0),n=t.intersectsBounds(i,{inclusive:e.inclusive}))}return n}containsBounds(t,e,i){e==null&&(e=!1),i==null&&(i=!0);var n=this.contains(t.left,t.bottom,i),s=this.contains(t.right,t.bottom,i),o=this.contains(t.left,t.top,i),l=this.contains(t.right,t.top,i);return e?n||s||o||l:n&&s&&o&&l}determineQuadrant(t){var e="",i=this.getCenterLonLat();return e+=t.lat<i.lat?"b":"t",e+=t.lon<i.lon?"l":"r",e}wrapDateLine(t,e){e=e||{};var i=e.leftTolerance||0,n=e.rightTolerance||0,s=this.clone();if(t){for(var o=t.getWidth();s.left<t.left&&s.right-n<=t.left;)s=s.add(o,0);for(;s.left+i>=t.right&&s.right>t.right;)s=s.add(-o,0);var l=s.left+i;l<t.right&&l>t.left&&s.right-n>t.right&&(s=s.add(-o,0))}return s}toServerJSONObject(){var t={rightTop:{x:this.right,y:this.top},leftBottom:{x:this.left,y:this.bottom},left:this.left,right:this.right,top:this.top,bottom:this.bottom};return t}destroy(){this.left=null,this.right=null,this.top=null,this.bottom=null,this.centerLonLat=null}static fromString(t,e){var i=t.split(",");return M.fromArray(i,e)}static fromArray(t,e){return e===!0?new M(t[1],t[0],t[3],t[2]):new M(t[0],t[1],t[2],t[3])}static fromSize(t){return new M(0,t.h,t.w,0)}static oppositeQuadrant(t){var e="";return e+=t.charAt(0)==="t"?"b":"t",e+=t.charAt(1)==="l"?"r":"l",e}}a.Bounds=M;class _ extends rt{constructor(t,e,i,n){super(t,e,i,n);this.x=parseFloat(t),this.y=parseFloat(e),this.tag=n||n==0?parseFloat(n):null,this.type=i||"Point",this.CLASS_NAME="SuperMap.Geometry.Point",this.geometryType="Point"}clone(t){return t==null&&(t=new _(this.x,this.y)),v.applyDefaults(t,this),t}calculateBounds(){this.bounds=new M(this.x,this.y,this.x,this.y)}equals(t){var e=!1;return t!=null&&(e=this.x===t.x&&this.y===t.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(t.x)&&isNaN(t.y)),e}move(t,e){this.x=this.x+t,this.y=this.y+e,this.clearBounds()}toShortString(){return this.x+", "+this.y}destroy(){this.x=null,this.y=null,this.tag=null,super.destroy()}getVertices(t){return[this]}}a.Geometry.Point=_;class k extends rt{constructor(t){super();this.components=[],this.componentTypes=null,t!=null&&this.addComponents(t),this.CLASS_NAME="SuperMap.Geometry.Collection",this.geometryType="Collection"}destroy(){this.components.length=0,this.components=null,super.destroy()}clone(){for(var t=new k,e=0,i=this.components.length;e<i;e++)t.addComponent(this.components[e].clone());return v.applyDefaults(t,this),t}getComponentsString(){for(var t=[],e=0,i=this.components.length;e<i;e++)t.push(this.components[e].toShortString());return t.join(",")}calculateBounds(){this.bounds=null;var t=new M,e=this.components;if(e)for(var i=0,n=e.length;i<n;i++)t.extend(e[i].getBounds());t.left!=null&&t.bottom!=null&&t.right!=null&&t.top!=null&&this.setBounds(t)}addComponents(t){v.isArray(t)||(t=[t]);for(var e=0,i=t.length;e<i;e++)this.addComponent(t[e])}addComponent(t,e){var i=!1;if(t&&(this.componentTypes==null||v.indexOf(this.componentTypes,t.CLASS_NAME)>-1)){if(e!=null&&e<this.components.length){var n=this.components.slice(0,e),s=this.components.slice(e,this.components.length);n.push(t),this.components=n.concat(s)}else this.components.push(t);t.parent=this,this.clearBounds(),i=!0}return i}removeComponents(t){var e=!1;v.isArray(t)||(t=[t]);for(var i=t.length-1;i>=0;--i)e=this.removeComponent(t[i])||e;return e}removeComponent(t){return v.removeItem(this.components,t),this.clearBounds(),!0}getArea(){for(var t=0,e=0,i=this.components.length;e<i;e++)t+=this.components[e].getArea();return t}equals(t){var e=!0;if(!t||!t.CLASS_NAME||this.CLASS_NAME!==t.CLASS_NAME)e=!1;else if(!v.isArray(t.components)||t.components.length!==this.components.length)e=!1;else for(var i=0,n=this.components.length;i<n;++i)if(!this.components[i].equals(t.components[i])){e=!1;break}return e}getVertices(t){for(var e=[],i=0,n=this.components.length;i<n;++i)Array.prototype.push.apply(e,this.components[i].getVertices(t));return e}}a.Geometry.Collection=k;class tt extends k{constructor(t){super(t);this.componentTypes=["SuperMap.Geometry.Point"],this.CLASS_NAME="SuperMap.Geometry.MultiPoint",this.geometryType="MultiPoint"}addPoint(t,e){this.addComponent(t,e)}removePoint(t){this.removeComponent(t)}}a.Geometry.MultiPoint=tt;class Ut extends tt{constructor(t){super(t);this.componentTypes=["SuperMap.Geometry.Point","SuperMap.PointWithMeasure"],this.CLASS_NAME="SuperMap.Geometry.Curve",this.geometryType="Curve"}}a.Geometry.Curve=Ut;class x extends Ut{constructor(t){super(t);this.CLASS_NAME="SuperMap.Geometry.LineString",this.geometryType="LineString"}removeComponent(t){var e=this.components&&this.components.length>2;return e&&super.removeComponent.apply(this,arguments),e}getSortedSegments(){for(var t=this.components.length-1,e=new Array(t),i,n,s=0;s<t;++s)i=this.components[s],n=this.components[s+1],i.x<n.x?e[s]={x1:i.x,y1:i.y,x2:n.x,y2:n.y}:e[s]={x1:n.x,y1:n.y,x2:i.x,y2:i.y};function o(l,h){return l.x1-h.x1}return e.sort(o)}getVertices(t){var e;return t===!0?e=[this.components[0],this.components[this.components.length-1]]:t===!1?e=this.components.slice(1,this.components.length-1):e=this.components.slice(),e}static calculateCircle(t){if(t.length<3)return t;var e={},i=t[0],n=t[1],s=t[2],o=0,l=0,h=!0,c=0,p=0,E=0,m=72,T=[],I=(s.y-i.y)/(s.x-i.x),N=s.y-I*s.x;if(s.x!=i.x&&s.y!=i.y&&n.y==I*n.x+N||s.x==i.x&&n.x==i.x||s.y==i.y&&n.y==i.y||s.x==i.x&&s.y==i.y||s.x==n.x&&s.y==n.y||i.x==n.x&&i.y==n.y)T.push(i),T.push(n),T.push(s);else{var f=(n.x*n.x+n.y*n.y-(i.x*i.x+i.y*i.y))*(2*(s.y-i.y))-(s.x*s.x+s.y*s.y-(i.x*i.x+i.y*i.y))*(2*(n.y-i.y)),y=2*(n.x-i.x)*(s.x*s.x+s.y*s.y-(i.x*i.x+i.y*i.y))-2*(s.x-i.x)*(n.x*n.x+n.y*n.y-(i.x*i.x+i.y*i.y)),u=4*((n.x-i.x)*(s.y-i.y)-(s.x-i.x)*(n.y-i.y));e.x=f/u,e.y=y/u,o=Math.sqrt((i.x-e.x)*(i.x-e.x)+(i.y-e.y)*(i.y-e.y));var d=(i.x-s.x)*(i.x-s.x)+(i.y-s.y)*(i.y-s.y),S=(2*o*o-d)/(2*o*o);S=S>=1?1:S,S=S<=-1?-1:S,E=Math.acos(S)*180/Math.PI,s.x==i.x?E=e.x>i.x&&n.x>i.x||e.x<i.x&&n.x<i.x?360-E:E:E=e.y>I*e.x+N&&n.y>I*n.x+N||e.y<I*e.x+N&&n.y<I*n.x+N?360-E:E,l=E/72,s.y!=i.y?s.x==i.x?s.y>i.y?n.x<i.x&&(h=!1):n.x>i.x&&(h=!1):s.x<i.x?n.y<I*n.x+N&&(h=!1):n.y>I*n.x+N&&(h=!1):s.x>i.x?n.y>i.y&&(h=!1):n.y<i.y&&(h=!1);var C=(i.y-e.y)/(i.x-e.x),A=C>=0?Math.atan(C)*180/Math.PI:Math.abs(Math.atan(C)*180/Math.PI)+90,R=Math.abs(e.y);i.y==R&&R==s.y&&i.x<s.x&&(A=A+180);var O=i.y-e.y;T.push(i);for(var P=1;P<m;P++){c=l*P,p=A,h?O>=0?C>=0?p=p+c:p=180-(p-90)+c:C>0?p=p-180+c:p=90-p+c:O>=0?C>=0?p=p-c:p=180-(p-90)-c:C>=0?p=p-180-c:p=90-p-c,p=p*Math.PI/180;var b=e.x+o*Math.cos(p),U=e.y+o*Math.sin(p);T.push(new _(b,U))}T.push(s)}return T}static createLineEPS(t){var e=[],i=t.length;if(i<2)return t;for(var n=0;n<i;){var s=t[n].type;if(s=="LTypeArc"){var o=x.createLineArc(e,n,i,t);e=o[0],n=o[1]}else e.push(t[n]),n++}return e}static createLineArc(t,e,i,n){if(e==0){let l=x.addPointEPS(n,e,i,"LTypeArc");Array.prototype.push.apply(t,l[0]),e=l[1]+1}else if(e==i-1){var s=[n[e-1],n[e]],o=x.calculateCircle(s);Array.prototype.push.apply(t,o),e++}else{let l=x.addPointEPS(n,e,i,"LTypeArc");t.pop(),Array.prototype.push.apply(t,l[0]),e=l[1]+1}return[t,e]}static addPointEPS(t,e,i,n){var s=[],o=e+1;e==0?Array.prototype.push.apply(s,[t[e],t[e+1]]):e==i-1?Array.prototype.push.apply(s,[t[e-1],t[e]]):Array.prototype.push.apply(s,[t[e-1],t[e],t[e+1]]);var l;return n=="LTypeCurve"?l=x.calculatePointsFBZN(s):n=="LTypeArc"&&(l=x.calculateCircle(s)),[l,o]}}a.Geometry.LineString=x;class B extends x{constructor(t){super(t);this.componentTypes=["SuperMap.Geometry.Point"],this.CLASS_NAME="SuperMap.Geometry.LinearRing",this.geometryType="LinearRing"}addComponent(t,e){var i=!1,n=this.components.pop();(e!=null||!t.equals(n))&&(i=super.addComponent.apply(this,arguments));var s=this.components[0];return super.addComponent.apply(this,[s]),i}removeComponent(t){var e=this.components&&this.components.length>3;if(e){this.components.pop(),super.removeComponent.apply(this,arguments);var i=this.components[0];super.addComponent.apply(this,[i])}return e}getArea(){var t=0;if(this.components&&this.components.length>2){for(var e=0,i=0,n=this.components.length;i<n-1;i++){var s=this.components[i],o=this.components[i+1];e+=(s.x+o.x)*(o.y-s.y)}t=-e/2}return t}getVertices(t){return t===!0?[]:this.components.slice(0,this.components.length-1)}}a.Geometry.LinearRing=B;class $ extends k{constructor(t){super(t);this.componentTypes=["SuperMap.Geometry.LineString"],this.CLASS_NAME="SuperMap.Geometry.MultiLineString",this.geometryType="MultiLineString"}}a.Geometry.MultiLineString=$;class F extends k{constructor(t){super(t);this.componentTypes=["SuperMap.Geometry.LinearRing"],this.CLASS_NAME="SuperMap.Geometry.Polygon",this.geometryType="Polygon"}getArea(){var t=0;if(this.components&&this.components.length>0){t+=Math.abs(this.components[0].getArea());for(var e=1,i=this.components.length;e<i;e++)t-=Math.abs(this.components[e].getArea())}return t}}a.Geometry.Polygon=F;class V extends k{constructor(t){super(t);this.componentTypes=["SuperMap.Geometry.Polygon"],this.CLASS_NAME="SuperMap.Geometry.MultiPolygon",this.geometryType="MultiPolygon"}}a.Geometry.MultiPolygon=V;class q{constructor(t,e,i){this.red=!t&&t!=0?255:t,this.green=e||0,this.blue=i||0,this.CLASS_NAME="SuperMap.ServerColor"}destroy(){var t=this;t.red=null,t.green=null,t.blue=null}static fromJson(t){if(!!t){var e=new q,i=255;t.red!==null&&(i=Number(t.red)),e.red=i;var n=0;t.green!==null&&(n=Number(t.green)),e.green=n;var s=0;return t.blue!==null&&(s=Number(t.blue)),e.blue=s,e}}}a.ServerColor=q;class ot{constructor(t){this.fillBackColor=new q(255,255,255),this.fillBackOpaque=!1,this.fillForeColor=new q(255,0,0),this.fillGradientMode=null,this.fillGradientAngle=0,this.fillGradientOffsetRatioX=0,this.fillGradientOffsetRatioY=0,this.fillOpaqueRate=100,this.fillSymbolID=0,this.lineColor=new q(0,0,0),this.lineSymbolID=0,this.lineWidth=1,this.markerAngle=0,this.markerSize=1,this.markerSymbolID=-1,t&&v.extend(this,t),this.CLASS_NAME="SuperMap.ServerStyle"}destroy(){var t=this;t.fillBackColor&&(t.fillBackColor.destroy(),t.fillBackColor=null),t.fillBackOpaque=null,t.fillForeColor&&(t.fillForeColor.destroy(),t.fillForeColor=null),t.fillGradientMode=null,t.fillGradientAngle=null,t.fillGradientOffsetRatioX=null,t.fillGradientOffsetRatioY=null,t.fillOpaqueRate=null,t.fillSymbolID=null,t.lineColor&&(t.lineColor.destroy(),t.lineColor=null),t.lineSymbolID=null,t.lineWidth=null,t.markerAngle=null,t.markerSize=null,t.markerSymbolID=null}toServerJSONObject(){var t={};return t=v.copyAttributes(t,this),t}static fromJson(t){if(!!t)return new ot({fillBackColor:q.fromJson(t.fillBackColor),fillBackOpaque:t.fillBackOpaque,fillForeColor:q.fromJson(t.fillForeColor),fillGradientMode:t.fillGradientMode,fillGradientAngle:t.fillGradientAngle,fillGradientOffsetRatioX:t.fillGradientOffsetRatioX,fillGradientOffsetRatioY:t.fillGradientOffsetRatioY,fillOpaqueRate:t.fillOpaqueRate,fillSymbolID:t.fillSymbolID,lineColor:q.fromJson(t.lineColor),lineSymbolID:t.lineSymbolID,lineWidth:t.lineWidth,markerAngle:t.markerAngle,markerSize:t.markerSize,markerSymbolID:t.markerSymbolID})}}a.ServerStyle=ot;class at extends _{constructor(t){super(t);this.measure=null,t&&v.extend(this,t),this.CLASS_NAME="SuperMap.PointWithMeasure"}equals(t){var e=!1;if(t!=null){var i=this.x===t.x&&this.y===t.y&&this.measure===t.measure,n=isNaN(this.x)&&isNaN(this.y)&&isNaN(this.measure),s=isNaN(t.x)&&isNaN(t.y)&&isNaN(t.measure);e=i||n&&s}return e}toJson(){var t="{";return this.measure!=null&&this.measure!=null&&(t+='"measure":'+this.measure+","),t+='"x":'+this.x+",",t+='"y":'+this.y,t+="}",t}destroy(){var t=this;t.measure=null,t.x=null,t.y=null}static fromJson(t){if(!!t)return new at({x:t.x,y:t.y,measure:t.measure})}}a.PointWithMeasure=at;class lt extends k{constructor(t,e){super(t,e);this.id=null,this.center=null,this.style=null,this.length=null,this.maxM=null,this.minM=null,this.parts=null,this.points=null,this.type=null,this.componentTypes=["SuperMap.Geometry.LinearRing","SuperMap.Geometry.LineString"],e&&v.extend(this,e),this.CLASS_NAME="SuperMap.Route",this.geometryType="LINEM"}toJson(){var t="{";if(this.id!=null&&this.id!=null&&(t+='"id":'+this.id+","),this.center!=null&&this.center!=null&&(t+='"center":'+this.center+","),this.style!=null&&this.style!=null&&(t+='"style":'+this.style+","),this.length!=null&&this.length!=null&&(t+='"length":'+this.length+","),this.maxM!=null&&this.maxM!=null&&(t+='"maxM":'+this.maxM+","),this.minM!=null&&this.minM!=null&&(t+='"minM":'+this.minM+","),this.type!=null&&this.type!=null&&(t+='"type":"'+this.type+'",'),this.parts!=null&&this.parts!=null){t+='"parts":['+this.parts[0];for(var e=1;e<this.parts.length;e++)t+=","+this.parts[e];t+="],"}if(this.components!=null&&this.components.length>0){t+='"points":[';for(var i=0,n=this.components.length;i<n;i++)for(var s=0,o=this.components[i].components.length;s<o;s++)t+=this.components[i].components[s].toJson()+",";t=t.replace(/,$/g,""),t+="]"}return t=t.replace(/,$/g,""),t+="}",t}destroy(){var t=this;t.id=null,t.center=null,t.style=null,t.length=null,t.maxM=null,t.minM=null,t.type=null,t.parts=null,t.components.length=0,t.components=null,t.componentTypes=null}static fromJson(t){if(!!t){var e=t.parts||[],i=t.points||[],n=e.length,s=[];if(n>0)for(var o=0,l=0,h=[];o<n;o++){for(var c=0;c<e[o];c++)h.push(at.fromJson(i[l+c]));l+=e[o],h[0].equals(h[e[o]-1])?s.push(new B(h)):s.push(new x(h)),h=[]}else return null;return new lt(s,{id:t.id,center:t.center,style:t.style,length:t.length,maxM:t.maxM,minM:t.minM,type:t.type,parts:t.parts})}}}a.Route=lt;class H{constructor(t){this.id=0,this.style=null,this.parts=null,this.points=null,this.type=null,this.prjCoordSys=null,t&&v.extend(this,t),this.CLASS_NAME="SuperMap.ServerGeometry"}destroy(){var t=this;t.id=null,t.style=null,t.parts=null,t.partTopo=null,t.points=null,t.type=null,t.prjCoordSys=null}toGeometry(){var t=this,e=t.type;switch(e.toUpperCase()){case w.POINT:return t.toGeoPoint();case w.LINE:return t.toGeoLine();case w.LINEM:return t.toGeoLinem();case w.REGION:return t.toGeoRegion();case w.POINTEPS:return t.toGeoPoint();case w.LINEEPS:return t.toGeoLineEPS();case w.REGIONEPS:return t.toGeoRegionEPS();case w.GEOCOMPOUND:return t.transformGeoCompound()}}toGeoPoint(){var t=this,e=t.parts||[],i=t.points||[],n=e.length;if(n>0){if(n===1)return new _(i[0].x,i[0].y);var s=[];for(let o=0;o<n;o++)s.push(new _(i[o].x,i[o].y));return new tt(s)}else return null}toGeoLine(){var t=this,e=t.parts||[],i=t.points||[],n=e.length;if(n>0)if(n===1){let s=[];for(let o=0;o<e[0];o++)s.push(new _(i[o].x,i[o].y));return s[0].equals(s[e[0]-1])?new B(s):new x(s)}else{let s=[];for(let o=0;o<n;o++){let l=[];for(let h=0;h<e[o];h++)l.push(new _(i[h].x,i[h].y));s.push(new x(l)),i.splice(0,e[o])}return new $(s)}else return null}toGeoLineEPS(){var t=this,e=t.parts||[],i=t.points||[],n,s,o,l,h,c=e.length;if(c>0)if(c===1){for(n=0,o=[];n<e[0];n++)o.push(new _(i[n].x,i[n].y,i[n].type));return o[0].equals(o[e[0]-1])?(h=x.createLineEPS(o),new B(h)):(h=x.createLineEPS(o),new x(h))}else{for(n=0,l=[];n<c;n++){for(s=0,o=[];s<e[n];s++)o.push(new _(i[s].x,i[s].y));h=x.createLineEPS(o),l.push(new x(h)),i.splice(0,e[n])}return new $(l)}else return null}toGeoLinem(){var t=this;return lt.fromJson(t)}toGeoRegion(){var t=this,e=t.parts||[],i=t.partTopo||[],n=t.points||[],s=e.length;if(s<=0)return null;var o=[],l=[];if(s==1){for(let f=0;f<n.length;f++)l.push(new _(n[f].x,n[f].y));return o.push(new F([new B(l)])),new V(o)}var h=[],c=[],p=[],E=[],m=[];for(let f=0,y=0;f<s;f++){for(let u=0;u<e[f];u++)l.push(new _(n[y+u].x,n[y+u].y));y+=e[f];var T=new F([new B(l)]);l=[],p.push(T),i.length===0&&E.push(T.getBounds()),m.push(1),c.push(T.getArea())}if(i.length===0){H.bubbleSort(c,p,i,E);var I=[];for(let f=1;f<p.length;f++)for(let y=f-1;y>=0;y--)if(I[f]=-1,E[y].containsBounds(E[f])){m[f]=m[y]*-1,m[f]<0&&(I[f]=y);break}for(let f=0;f<p.length;f++)m[f]>0?o.push(p[f]):(o[I[f]].components=o[I[f]].components.concat(p[f].components),o.push(""))}else{o=new Array;for(let f=0;f<p.length;f++)if(i[f]&&i[f]==-1?h=h.concat(p[f].components):(h.length>0&&o.length>0&&(o[o.length-1].components=o[o.length-1].components.concat(h),h=[]),o.push(p[f])),f==s-1){var N=o.length;if(N)o[N-1].components=o[N-1].components.concat(h);else for(let y=0,u=h.length;y<u;y++)o.push(new F(h))}}return new V(o)}toGeoRegionEPS(){var t=this,e=t.parts||[],i=t.partTopo||[],n=t.points||[],s=e.length;if(s<=0)return null;var o=[],l=[],h;if(s==1){for(var c=0;c<n.length;c++)l.push(new _(n[c].x,n[c].y));return h=x.createLineEPS(l),o.push(new F([new B(h)])),new V(o)}var p=[],E=[],m=[],T=[],I=[];for(let u=0,d=0;u<s;u++){for(let S=0;S<e[u];S++)l.push(new _(n[d+S].x,n[d+S].y));d+=e[u],h=x.createLineEPS(l);var N=new F([new B(h)]);l=[],m.push(N),i.length===0&&T.push(N.getBounds()),I.push(1),E.push(N.getArea())}if(i.length===0){H.bubbleSort(E,m,i,T);var f=[];for(let u=1;u<m.length;u++)for(let d=u-1;d>=0;d--)if(f[u]=-1,T[d].containsBounds(T[u])){I[u]=I[d]*-1,I[u]<0&&(f[u]=d);break}for(let u=0;u<m.length;u++)I[u]>0?o.push(m[u]):(o[f[u]].components=o[f[u]].components.concat(m[u].components),o.push(""))}else{o=new Array;for(let u=0;u<m.length;u++)if(i[u]&&i[u]==-1?p=p.concat(m[u].components):(p.length>0&&o.length>0&&(o[o.length-1].components=o[o.length-1].components.concat(p),p=[]),o.push(m[u])),u==s-1){var y=o.length;if(y)o[y-1].components=o[y-1].components.concat(p);else for(let d=0,S=p.length;d<S;d++)o.push(new F(p))}}return new V(o)}transformGeoCompound(){const t=this,e=t.geoParts||[],i=e.length;if(i<=0)return null;const n=[];for(let s=0;s<i;s++){const o=e[s];n.push(new H(o).toGeometry())}return new k(n)}static fromJson(t){if(!!t)return new H({id:t.id,style:ot.fromJson(t.style),parts:t.parts,partTopo:t.partTopo,points:t.points,center:t.center,length:t.length,maxM:t.maxM,minM:t.minM,type:t.type})}static fromGeometry(t){if(!!t){var e=0,i=[],n=[],s=null,o=t.components,l=t.CLASS_NAME,h={epsgCode:t.SRID};if(isNaN(t.id)||(e=t.id),l!="SuperMap.Geometry.LinearRing"&&l!="SuperMap.Geometry.LineString"&&(t instanceof tt||t instanceof $)){let c=o.length;for(let p=0;p<c;p++){let E=o[p].getVertices().length;i.push(E);for(let m=0;m<E;m++)n.push(new _(o[p].getVertices()[m].x,o[p].getVertices()[m].y))}s=l=="SuperMap.Geometry.MultiPoint"?w.POINT:w.LINE}else if(t instanceof V){let c=o.length;for(let p=0;p<c;p++){let E=o[p],m=E.components,T=m.length;for(let I=0;I<T;I++){let N=m[I].getVertices().length+1;i.push(N);for(let f=0;f<N-1;f++)n.push(new _(m[I].getVertices()[f].x,m[I].getVertices()[f].y));n.push(new _(m[I].getVertices()[0].x,m[I].getVertices()[0].y))}}s=w.REGION}else if(t instanceof F){let c=o.length;for(let p=0;p<c;p++){let E=o[p].getVertices().length+1;i.push(E);for(let m=0;m<E-1;m++)n.push(new _(o[p].getVertices()[m].x,o[p].getVertices()[m].y));n.push(new _(o[p].getVertices()[0].x,o[p].getVertices()[0].y))}s=w.REGION}else{let c=t.getVertices().length;for(let p=0;p<c;p++)n.push(new _(t.getVertices()[p].x,t.getVertices()[p].y));t instanceof B&&(n.push(new _(t.getVertices()[0].x,t.getVertices()[0].y)),c++),i.push(c),s=t instanceof _?w.POINT:w.LINE}return new H({id:e,style:null,parts:i,points:n,type:s,prjCoordSys:h})}}static IsClockWise(t){var e=t.length;if(e<3)return 0;var i=t[0].y*(t[e-1].x-t[1].x);t.push(t[0]);for(var n=1;n<e;n++)i+=t[n].y*(t[n-1].x-t[n+1].x);return i*.5}static bubbleSort(t,e,i,n){for(var s=0;s<t.length;s++)for(var o=0;o<t.length;o++)if(t[s]>t[o]){var l=t[o];t[o]=t[s],t[s]=l;var h=e[o];if(e[o]=e[s],e[s]=h,i&&i.length>0){var c=i[o];i[o]=i[s],i[s]=c}if(n&&n.length>0){var p=n[o];n[o]=n[s],n[s]=p}}}}a.ServerGeometry=H;class Dt{constructor(t,e,i){this.CLASS_NAME="SuperMap.Feature",this.layer=t,this.id=v.createUniqueID(this.CLASS_NAME+"_"),this.lonlat=e,this.data=i!=null?i:{}}destroy(){this.id=null,this.lonlat=null,this.data=null}}a.Feature=Dt;class X extends Dt{constructor(t,e,i){super(null,null,e);this.fid=null,this.geometry=t||null,this.attributes={},e&&(this.attributes=v.extend(this.attributes,e)),this.bounds=null,this.state=null,this.style=i||null,this.url=null,this.lonlat=null,this.CLASS_NAME="SuperMap.Feature.Vector",a.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},X.style={default:{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"default",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},delete:{display:"none"}}}destroy(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,super.destroy()}clone(){return new X(this.geometry?this.geometry.clone():null,this.attributes,this.style)}toState(t){if(t===a.State.UPDATE)switch(this.state){case a.State.UNKNOWN:case a.State.DELETE:this.state=t;break;case a.State.UPDATE:case a.State.INSERT:break}else if(t===a.State.INSERT)switch(this.state){case a.State.UNKNOWN:break;default:this.state=t;break}else if(t===a.State.DELETE)switch(this.state){case a.State.INSERT:break;case a.State.DELETE:break;case a.State.UNKNOWN:case a.State.UPDATE:this.state=t;break}else t===a.State.UNKNOWN&&(this.state=t)}}a.Feature.Vector=X;class bt{constructor(t){this.data=null,this.keepData=!1,v.extend(this,t),this.options=t,this.CLASS_NAME="SuperMap.Format"}destroy(){}read(t){}write(t){}}a.Format=a.Format||bt;class Gt extends bt{constructor(t){super(t);this.indent="    ",this.space=" ",this.newline=`
`,this.level=0,this.pretty=!1,this.nativeJSON=function(){return!!(window.JSON&&typeof JSON.parse=="function"&&typeof JSON.stringify=="function")}(),this.CLASS_NAME="SuperMap.Format.JSON",this.serialize={object:function(e){if(e==null)return"null";if(e.constructor===Date)return this.serialize.date.apply(this,[e]);if(e.constructor===Array)return this.serialize.array.apply(this,[e]);var i=["{"];this.level+=1;var n,s,o,l=!1;for(n in e)e.hasOwnProperty(n)&&(s=this.write.apply(this,[n,this.pretty]),o=this.write.apply(this,[e[n],this.pretty]),s!=null&&o!=null&&(l&&i.push(","),i.push(this.writeNewline(),this.writeIndent(),s,":",this.writeSpace(),o),l=!0));return this.level-=1,i.push(this.writeNewline(),this.writeIndent(),"}"),i.join("")},array:function(e){var i,n=["["];this.level+=1;for(var s=0,o=e.length;s<o;++s)i=this.write.apply(this,[e[s],this.pretty]),i!=null&&(s>0&&n.push(","),n.push(this.writeNewline(),this.writeIndent(),i));return this.level-=1,n.push(this.writeNewline(),this.writeIndent(),"]"),n.join("")},string:function(e){var i={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(e)?'"'+e.replace(/([\x00-\x1f\\"])/g,function(n,s){var o=i[s];return o||(o=s.charCodeAt(),"\\u00"+Math.floor(o/16).toString(16)+(o%16).toString(16))})+'"':'"'+e+'"'},number:function(e){return isFinite(e)?String(e):"null"},boolean:function(e){return String(e)},date:function(e){function i(n){return n<10?"0"+n:n}return'"'+e.getFullYear()+"-"+i(e.getMonth()+1)+"-"+i(e.getDate())+"T"+i(e.getHours())+":"+i(e.getMinutes())+":"+i(e.getSeconds())+'"'}}}read(t,e){var i;if(this.nativeJSON)try{i=JSON.parse(t,e)}catch{}return this.keepData&&(this.data=i),i}write(t,e){this.pretty=!!e;var i=null,n=typeof t;if(this.serialize[n])try{i=!this.pretty&&this.nativeJSON?JSON.stringify(t):this.serialize[n].apply(this,[t])}catch{}return i}writeIndent(){var t=[];if(this.pretty)for(var e=0;e<this.level;++e)t.push(this.indent);return t.join("")}writeNewline(){return this.pretty?this.newline:""}writeSpace(){return this.pretty?this.space:""}}a.Format.JSON=Gt;class Et extends Gt{constructor(t){super(t);this.ignoreExtraDims=!0,this.CLASS_NAME="SuperMap.Format.GeoJSON",this.parseCoords={point:function(e){if(this.ignoreExtraDims===!1&&e.length!=2)throw"Only 2D points are supported: "+e;return new _(e[0],e[1])},multipoint:function(e){for(var i=[],n=null,s=0,o=e.length;s<o;++s){try{n=this.parseCoords.point.apply(this,[e[s]])}catch(l){throw l}i.push(n)}return new tt(i)},linestring:function(e){for(var i=[],n=null,s=0,o=e.length;s<o;++s){try{n=this.parseCoords.point.apply(this,[e[s]])}catch(l){throw l}i.push(n)}return new x(i)},multilinestring:function(e){for(var i=[],n=null,s=0,o=e.length;s<o;++s){try{n=this.parseCoords.linestring.apply(this,[e[s]])}catch(l){throw l}i.push(n)}return new $(i)},polygon:function(e){for(var i=[],n,s,o=0,l=e.length;o<l;++o){try{s=this.parseCoords.linestring.apply(this,[e[o]])}catch(h){throw h}n=new B(s.components),i.push(n)}return new F(i)},multipolygon:function(e){for(var i=[],n=null,s=0,o=e.length;s<o;++s){try{n=this.parseCoords.polygon.apply(this,[e[s]])}catch(l){throw l}i.push(n)}return new V(i)},box:function(e){if(e.length!=2)throw"GeoJSON box coordinates must have 2 elements";return new F([new B([new _(e[0][0],e[0][1]),new _(e[1][0],e[0][1]),new _(e[1][0],e[1][1]),new _(e[0][0],e[1][1]),new _(e[0][0],e[0][1])])])}},this.extract={feature:function(e){var i=this.extract.geometry.apply(this,[e.geometry]),n={type:"Feature",properties:this.createAttributes(e),geometry:i};return e.geometry&&e.geometry.type==="TEXT"&&(n.properties.texts=e.geometry.texts,n.properties.textStyle=e.geometry.textStyle),e.fid&&(n.id=e.fid),e.ID&&(n.id=e.ID),n},geometry:function(e){if(e==null)return null;!e.parts&&e.points&&(e.parts=[e.points.length]);var i=e.hasOwnProperty("geometryType")?e:new H(e).toGeometry()||e,n=i.geometryType||i.type,s;n==="LinearRing"&&(n="LineString"),n==="LINEM"&&(n="MultiLineString"),s=this.extract[n.toLowerCase()].apply(this,[i]),n=n==="TEXT"?"Point":n;var o;return n==="Collection"?o={type:"GeometryCollection",geometries:s}:o={type:n,coordinates:s},o},point:function(e){var i=[e.x,e.y];for(var n in e)n!=="x"&&n!=="y"&&e[n]!==null&&!isNaN(e[n])&&i.push(e[n]);return i},text:function(e){return[e.points[0].x,e.points[0].y]},multipoint:function(e){for(var i=[],n=0,s=e.components.length;n<s;++n)i.push(this.extract.point.apply(this,[e.components[n]]));return i},linestring:function(e){for(var i=[],n=0,s=e.components.length;n<s;++n)i.push(this.extract.point.apply(this,[e.components[n]]));return i},multilinestring:function(e){for(var i=[],n=0,s=e.components.length;n<s;++n)i.push(this.extract.linestring.apply(this,[e.components[n]]));return i},polygon:function(e){for(var i=[],n=0,s=e.components.length;n<s;++n)i.push(this.extract.linestring.apply(this,[e.components[n]]));return i},multipolygon:function(e){for(var i=[],n=0,s=e.components.length;n<s;++n)i.push(this.extract.polygon.apply(this,[e.components[n]]));return i},collection:function(e){for(var i=e.components.length,n=new Array(i),s=0;s<i;++s)n[s]=this.extract.geometry.apply(this,[e.components[s]]);return n}}}read(t,e,i){e=e||"FeatureCollection";var n=null,s=null;if(typeof t=="string"?s=super.read(t,i):s=t,s){if(typeof s.type=="string"){if(this.isValidType(s,e))switch(e){case"Geometry":try{n=this.parseGeometry(s)}catch{}break;case"Feature":try{n=this.parseFeature(s),n.type="Feature"}catch{}break;case"FeatureCollection":switch(n=[],s.type){case"Feature":try{n.push(this.parseFeature(s))}catch{n=null}break;case"FeatureCollection":for(var o=0,l=s.features.length;o<l;++o)try{n.push(this.parseFeature(s.features[o]))}catch{n=null}break;default:try{var h=this.parseGeometry(s);n.push(new X(h))}catch{n=null}}break}}}return n}write(t,e){return super.write(this.toGeoJSON(t),e)}fromGeoJSON(t,e,i){let n=this.read(t,e,i);return v.isArray(n)?n.map(s=>this._toiSevrerFeature(s)):this._toiSevrerFeature(n)}toGeoJSON(t){var e={type:null};if(v.isArray(t)){e.type="FeatureCollection";var i=t.length;e.features=new Array(i);for(var n=0;n<i;++n){var s=t[n];if(o(s)){let l={};l.geometry=s,e.features[n]=this.extract.feature.apply(this,[l])}else e.features[n]=this.extract.feature.apply(this,[s])}}else if(o(t)){let l={};l.geometry=t,e=this.extract.feature.apply(this,[l])}else e=this.extract.feature.apply(this,[t]);function o(l){return l.hasOwnProperty("parts")&&l.hasOwnProperty("points")||l.hasOwnProperty("geoParts")}return e}isValidType(t,e){var i=!1;switch(e){case"Geometry":v.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],t.type)==-1||(i=!0);break;case"FeatureCollection":i=!0;break;default:t.type==e&&(i=!0)}return i}parseFeature(t){var e,i,n,s;n=t.properties?t.properties:{},s=t.geometry&&t.geometry.bbox||t.bbox;try{i=this.parseGeometry(t.geometry)}catch(o){throw o}return e=new X(i,n),s&&(e.bounds=M.fromArray(s)),t.id&&(e.fid=t.id),e}parseGeometry(t){if(t==null)return null;var e;if(t.type=="GeometryCollection"){if(!v.isArray(t.geometries))throw"GeometryCollection must have geometries array: "+t;for(var i=t.geometries.length,n=new Array(i),s=0;s<i;++s)n[s]=this.parseGeometry.apply(this,[t.geometries[s]]);e=new k(n)}else{if(!v.isArray(t.coordinates))throw"Geometry must have coordinates array: "+t;if(!this.parseCoords[t.type.toLowerCase()])throw"Unsupported geometry type: "+t.type;try{e=this.parseCoords[t.type.toLowerCase()].apply(this,[t.coordinates])}catch(o){throw o}}return e}createCRSObject(t){var e=t.layer.projection.toString(),i={};if(e.match(/epsg:/i)){var n=parseInt(e.substring(e.indexOf(":")+1));n==4326?i={type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:i={type:"name",properties:{name:"EPSG:"+n}}}return i}_toiSevrerFeature(t){const e=t.attributes,i=[],n=[];for(var s in e)i.push(s),n.push(e[s]);const o={fieldNames:i,fieldValues:n,geometry:H.fromGeometry(t.geometry)};return o.geometry.id=t.fid,o}createAttributes(t){if(!t)return null;var e={};s(t,e);var i=["fieldNames","fieldValues","geometry","stringID","ID"];for(var n in t)i.indexOf(n)>-1||(e[n]=t[n]);function s(o,l){if(!!(o.hasOwnProperty("fieldNames")&&o.hasOwnProperty("fieldValues"))){var h=o.fieldNames,c=o.fieldValues;for(var p in h)l[h[p]]=c[p]}}return e}}a.Format.GeoJSON=Et;var fe=function(r){var t=6378137,e;if(r===W.METER)e=1;else if(r===W.DEGREE)e=Math.PI*2*t/360;else if(r===W.KILOMETER)e=.001;else if(r===W.INCH)e=1/.025399999918;else if(r===W.FOOT)e=.3048;else return e;return e};const pe={};L.Util.supermap_callbacks=pe;const ce=function(r){return r&&new Et().toGeoJSON(r)},Bt=function(r){if(!r)return r;let t;const e=new Et;if(["FeatureCollection","Feature","Geometry"].indexOf(r.type)!==-1)t=e.read(r,r.type);else if(typeof r.toGeoJSON=="function"){const n=r.toGeoJSON();t=n?e.read(n,n.type):r}let i=t||r;return L.Util.isArray(t)&&(t.length===1?i=t[0]:t.length>1&&(i=[],t.map(function(n){return i.push(n.geometry),n}))),i&&i.geometry?i.geometry:i},mt=fe,Ft=function(r,t,e){const i=39.37007874015748,n=mt(e);let s=r*t*i*n;return s=1/s,s},de=function(r,t,e){const i=39.37007874015748,n=mt(e);let s=r*t*i*n;return s=1/s,s},ye=function(r,t,e,i){let n=null;const s=1e4;return i=i||6378137,e=e||"",r>0&&t>0?(r=L.Util.NormalizeScale(r),e.toLowerCase()==="degree"||e.toLowerCase()==="degrees"||e.toLowerCase()==="dd"?(n=.0254*s/t/r/(Math.PI*2*i/360)/s,n):(n=.0254*s/t/r/s,n)):-1},Ee=function(r){return r>1?1/r:r};L.Util.toGeoJSON=ce;L.Util.toSuperMapGeometry=Bt;L.Util.resolutionToScale=Ft;L.Util.scaleToResolution=de;L.Util.getMeterPerMapUnit=mt;L.Util.GetResolutionFromScaleDpi=ye;L.Util.NormalizeScale=Ee;const me=L.TileLayer.extend({options:{layersID:null,redirect:!1,transparent:!0,cacheEnabled:!0,clipRegionEnabled:!1,clipRegion:null,prjCoordSys:null,overlapDisplayed:!1,overlapDisplayedOptions:null,tileversion:null,crs:null,format:"png",tileProxy:null,attribution:"Map Data <span>\xA9 <a href='http://support.supermap.com.cn/product/iServer.aspx' title='SuperMap iServer' target='_blank'>SuperMap iServer</a></span>",subdomains:null},initialize:function(r,t){this._url=r,L.TileLayer.prototype.initialize.apply(this,arguments),L.setOptions(this,t),L.stamp(this),this.tileSetsIndex=-1,this.tempIndex=-1},onAdd:function(r){this._crs=this.options.crs||r.options.crs,L.TileLayer.prototype.onAdd.call(this,r)},getTileUrl:function(r){const t=this.getScaleFromCoords(r);let i=this._getLayerUrl()+"&scale="+t+"&x="+r.x+"&y="+r.y;return this.options.tileProxy&&(i=this.options.tileProxy+encodeURIComponent(i)),this.options.cacheEnabled||(i+="&_t="+new Date().getTime()),this.options.subdomains&&(i=L.Util.template(i,{s:this._getSubdomain(r)})),i},getScale:function(r){const t=this,e=r||t._map.getZoom();return t.scales[e]},getScaleFromCoords:function(r){const t=this;if(t.scales&&t.scales[r.z])return t.scales[r.z];t.scales=t.scales||{};const e=t.getDefaultScale(r);return t.scales[r.z]=e,e},getDefaultScale:function(r){const t=this,e=t._crs;if(e.scales)return e.scales[r.z];{const i=t._tileCoordsToBounds(r),n=e.project(i.getNorthEast()),s=e.project(i.getSouthWest()),o=t.options.tileSize,l=Math.max(Math.abs(n.x-s.x)/o,Math.abs(n.y-s.y)/o);let h=W.METER;if(e.code){const c=e.code.split(":");if(c&&c.length>1){const p=parseInt(c[1]);h=p&&p>=4e3&&p<=5e3?W.DEGREE:W.METER}}return Ft(l,96,h)}},setTileSetsInfo:function(r){this.tileSets=r,L.Util.isArray(this.tileSets)&&(this.tileSets=this.tileSets[0]),this.tileSets&&(this.fire("tilesetsinfoloaded",{tileVersions:this.tileSets.tileVersions}),this.changeTilesVersion())},lastTilesVersion:function(){this.tempIndex=this.tileSetsIndex-1,this.changeTilesVersion()},nextTilesVersion:function(){this.tempIndex=this.tileSetsIndex+1,this.changeTilesVersion()},changeTilesVersion:function(){const r=this;if(r.tileSets==null||r.tempIndex===r.tileSetsIndex||this.tempIndex<0)return;const t=r.tileSets.tileVersions;if(t&&r.tempIndex<t.length&&r.tempIndex>=0){const e=t[r.tempIndex].name;r.mergeTileVersionParam(e)&&(r.tileSetsIndex=r.tempIndex,r.fire("tileversionschanged",{tileVersion:t[r.tempIndex]}))}},updateCurrentTileSetsIndex:function(r){this.tempIndex=r},mergeTileVersionParam:function(r){return r?(this.requestParams.tileversion=r,this._paramsChanged=!0,this.redraw(),this._paramsChanged=!1,!0):!1},_getLayerUrl:function(){return this._paramsChanged&&(this._layerUrl=this._createLayerUrl()),this._layerUrl||this._createLayerUrl()},_createLayerUrl:function(){let r=v.urlPathAppend(this._url,`tileImage.${this.options.format}`);return this.requestParams=this.requestParams||this._getAllRequestParams(),r=v.urlAppend(r,g.exports.Util.getParamString(this.requestParams)),r=J.appendCredential(r),this._layerUrl=r,r},_getAllRequestParams:function(){const r=this,t=r.options||{},e={};let i=this.options.tileSize;i instanceof L.Point||(i=L.point(i,i)),e.width=i.x,e.height=i.y,e.redirect=t.redirect===!0,e.transparent=t.transparent===!0,e.cacheEnabled=t.cacheEnabled!==!1,t.prjCoordSys&&(e.prjCoordSys=JSON.stringify(t.prjCoordSys)),t.layersID&&(e.layersID=t.layersID.toString()),t.clipRegionEnabled&&t.clipRegion&&(t.clipRegion=H.fromGeometry(Bt(t.clipRegion)),e.clipRegionEnabled=t.clipRegionEnabled,e.clipRegion=JSON.stringify(t.clipRegion));const n=r._crs;if(n.options&&n.options.origin)e.origin=JSON.stringify({x:n.options.origin[0],y:n.options.origin[1]});else if(n.projection&&n.projection.bounds){const s=n.projection.bounds,o=L.point(s.min.x,s.max.y);e.origin=JSON.stringify({x:o.x,y:o.y})}return t.overlapDisplayed===!1?(e.overlapDisplayed=!1,t.overlapDisplayedOptions&&(e.overlapDisplayedOptions=r.overlapDisplayedOptions.toString())):e.overlapDisplayed=!0,e.cacheEnabled===!0&&t.tileversion&&(e.tileversion=t.tileversion.toString()),t.rasterfunction&&(e.rasterfunction=JSON.stringify(t.rasterfunction)),e}}),ge=function(r,t){return new me(r,t)};var ut=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,Se=document.documentElement.style.pointerEvents==="",z={cors:ut,pointerEvents:Se},At=0;function ht(r){var t="";r.f=r.f||"json";for(var e in r)if(r.hasOwnProperty(e)){var i=r[e],n=Object.prototype.toString.call(i),s;t.length&&(t+="&"),n==="[object Array]"?s=Object.prototype.toString.call(i[0])==="[object Object]"?JSON.stringify(i):i.join(","):n==="[object Object]"?s=JSON.stringify(i):n==="[object Date]"?s=i.valueOf():s=i,t+=encodeURIComponent(e)+"="+encodeURIComponent(s)}return t}function gt(r,t){var e=new window.XMLHttpRequest;return e.onerror=function(i){e.onreadystatechange=g.exports.Util.falseFn,r.call(t,{error:{code:500,message:"XMLHttpRequest error"}},null)},e.onreadystatechange=function(){var i,n;if(e.readyState===4){try{i=JSON.parse(e.responseText)}catch{i=null,n={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!n&&i.error&&(n=i.error,i=null),e.onerror=g.exports.Util.falseFn,r.call(t,n,i)}},e.ontimeout=function(){this.onerror()},e}function ve(r,t,e,i){var n=gt(e,i);return n.open("POST",r),typeof i!="undefined"&&i!==null&&typeof i.options!="undefined"&&(n.timeout=i.options.timeout),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.send(ht(t)),n}function Ht(r,t,e,i){var n=gt(e,i);return n.open("GET",r+"?"+ht(t),!0),typeof i!="undefined"&&i!==null&&typeof i.options!="undefined"&&(n.timeout=i.options.timeout,i.options.withCredentials&&(n.withCredentials=!0)),n.send(null),n}function Te(r,t,e,i){var n=ht(t),s=gt(e,i),o=(r+"?"+n).length;if(o<=2e3&&z.cors?s.open("GET",r+"?"+n):o>2e3&&z.cors&&(s.open("POST",r),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),typeof i!="undefined"&&i!==null&&typeof i.options!="undefined"&&(s.timeout=i.options.timeout,i.options.withCredentials&&(s.withCredentials=!0)),o<=2e3&&z.cors)s.send(null);else if(o>2e3&&z.cors)s.send(n);else{if(o<=2e3&&!z.cors)return St(r,t,e,i);ft("a request to "+r+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");return}return s}function St(r,t,e,i){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var n="c"+At;t.callback="window._EsriLeafletCallbacks."+n,window._EsriLeafletCallbacks[n]=function(o){if(window._EsriLeafletCallbacks[n]!==!0){var l,h=Object.prototype.toString.call(o);h==="[object Object]"||h==="[object Array]"||(l={error:{code:500,message:"Expected array or object as JSONP response"}},o=null),!l&&o.error&&(l=o,o=null),e.call(i,l,o),window._EsriLeafletCallbacks[n]=!0}};var s=g.exports.DomUtil.create("script",null,document.body);return s.type="text/javascript",s.src=r+"?"+ht(t),s.id=n,s.onerror=function(o){if(o&&window._EsriLeafletCallbacks[n]!==!0){var l={error:{code:500,message:"An unknown error occurred"}};e.call(i,l),window._EsriLeafletCallbacks[n]=!0}},g.exports.DomUtil.addClass(s,"esri-leaflet-jsonp"),At++,{id:n,url:s.src,abort:function(){window._EsriLeafletCallbacks._callback[n]({code:0,message:"Request aborted."})}}}var vt=z.cors?Ht:St;vt.CORS=Ht;vt.JSONP=St;function ft(){console&&console.warn&&console.warn.apply(console,arguments)}var nt={request:Te,get:vt,post:ve},Ie={attributionWidthOffset:55};/* @preserve
* @terraformer/arcgis - v2.0.7 - MIT
* Copyright (c) 2012-2021 Environmental Systems Research Institute, Inc.
* Thu Jul 22 2021 13:58:30 GMT-0700 (Pacific Daylight Time)
*/var Re=function(t,e,i,n){var s=(n[0]-i[0])*(t[1]-i[1])-(n[1]-i[1])*(t[0]-i[0]),o=(e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]),l=(n[1]-i[1])*(e[0]-t[0])-(n[0]-i[0])*(e[1]-t[1]);if(l!==0){var h=s/l,c=o/l;if(h>=0&&h<=1&&c>=0&&c<=1)return!0}return!1},Ne=function(t,e){for(var i=!1,n=-1,s=t.length,o=s-1;++n<s;o=n)(t[n][1]<=e[1]&&e[1]<t[o][1]||t[o][1]<=e[1]&&e[1]<t[n][1])&&e[0]<(t[o][0]-t[n][0])*(e[1]-t[n][1])/(t[o][1]-t[n][1])+t[n][0]&&(i=!i);return i},_e=function(t,e){for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},kt=function(t,e){for(var i=0;i<t.length-1;i++)for(var n=0;n<e.length-1;n++)if(Re(t[i],t[i+1],e[n],e[n+1]))return!0;return!1},dt=function(t){return _e(t[0],t[t.length-1])||t.push(t[0]),t},yt=function(t){var e=0,i=0,n=t.length,s=t[i],o;for(i;i<n-1;i++)o=t[i+1],e+=(o[0]-s[0])*(o[1]+s[1]),s=o;return e>=0},qt=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},Ae=function(t,e){var i=kt(t,e),n=Ne(t,e[0]);return!!(!i&&n)},Ce=function(t){for(var e=[],i=[],n,s,o,l=0;l<t.length;l++){var h=dt(t[l].slice(0));if(!(h.length<4))if(yt(h)){var c=[h.slice().reverse()];e.push(c)}else i.push(h.slice().reverse())}for(var p=[];i.length;){o=i.pop();var E=!1;for(n=e.length-1;n>=0;n--)if(s=e[n][0],Ae(s,o)){e[n].push(o),E=!0;break}E||p.push(o)}for(;p.length;){o=p.pop();var m=!1;for(n=e.length-1;n>=0;n--)if(s=e[n][0],kt(s,o)){e[n].push(o),m=!0;break}m||e.push([o.reverse()])}return e.length===1?{type:"Polygon",coordinates:e[0]}:{type:"MultiPolygon",coordinates:e}},Oe=function(t,e){for(var i=e?[e,"OBJECTID","FID"]:["OBJECTID","FID"],n=0;n<i.length;n++){var s=i[n];if(s in t&&(typeof t[s]=="string"||typeof t[s]=="number"))return t[s]}throw Error("No valid id attribute found")},Pe=function r(t,e){var i={};if(t.features){i.type="FeatureCollection",i.features=[];for(var n=0;n<t.features.length;n++)i.features.push(r(t.features[n],e))}if(typeof t.x=="number"&&typeof t.y=="number"&&(i.type="Point",i.coordinates=[t.x,t.y],typeof t.z=="number"&&i.coordinates.push(t.z)),t.points&&(i.type="MultiPoint",i.coordinates=t.points.slice(0)),t.paths&&(t.paths.length===1?(i.type="LineString",i.coordinates=t.paths[0].slice(0)):(i.type="MultiLineString",i.coordinates=t.paths.slice(0))),t.rings&&(i=Ce(t.rings.slice(0))),typeof t.xmin=="number"&&typeof t.ymin=="number"&&typeof t.xmax=="number"&&typeof t.ymax=="number"&&(i.type="Polygon",i.coordinates=[[[t.xmax,t.ymax],[t.xmin,t.ymax],[t.xmin,t.ymin],[t.xmax,t.ymin],[t.xmax,t.ymax]]]),(t.geometry||t.attributes)&&(i.type="Feature",i.geometry=t.geometry?r(t.geometry):null,i.properties=t.attributes?qt(t.attributes):null,t.attributes))try{i.id=Oe(t.attributes,e)}catch{}return JSON.stringify(i.geometry)===JSON.stringify({})&&(i.geometry=null),t.spatialReference&&t.spatialReference.wkid&&t.spatialReference.wkid!==4326&&console.warn("Object converted in non-standard crs - "+JSON.stringify(t.spatialReference)),i},Wt=function(t){var e=[],i=t.slice(0),n=dt(i.shift().slice(0));if(n.length>=4){yt(n)||n.reverse(),e.push(n);for(var s=0;s<i.length;s++){var o=dt(i[s].slice(0));o.length>=4&&(yt(o)&&o.reverse(),e.push(o))}}return e},Le=function(t){for(var e=[],i=0;i<t.length;i++)for(var n=Wt(t[i]),s=n.length-1;s>=0;s--){var o=n[s].slice(0);e.push(o)}return e},xe=function r(t,e){e=e||"OBJECTID";var i={wkid:4326},n={},s;switch(t.type){case"Point":n.x=t.coordinates[0],n.y=t.coordinates[1],t.coordinates[2]&&(n.z=t.coordinates[2]),n.spatialReference=i;break;case"MultiPoint":n.points=t.coordinates.slice(0),t.coordinates[0][2]&&(n.hasZ=!0),n.spatialReference=i;break;case"LineString":n.paths=[t.coordinates.slice(0)],t.coordinates[0][2]&&(n.hasZ=!0),n.spatialReference=i;break;case"MultiLineString":n.paths=t.coordinates.slice(0),t.coordinates[0][0][2]&&(n.hasZ=!0),n.spatialReference=i;break;case"Polygon":n.rings=Wt(t.coordinates.slice(0)),t.coordinates[0][0][2]&&(n.hasZ=!0),n.spatialReference=i;break;case"MultiPolygon":n.rings=Le(t.coordinates.slice(0)),t.coordinates[0][0][0][2]&&(n.hasZ=!0),n.spatialReference=i;break;case"Feature":t.geometry&&(n.geometry=r(t.geometry,e)),n.attributes=t.properties?qt(t.properties):{},t.id&&(n.attributes[e]=t.id);break;case"FeatureCollection":for(n=[],s=0;s<t.features.length;s++)n.push(r(t.features[s],e));break;case"GeometryCollection":for(n=[],s=0;s<t.geometries.length;s++)n.push(r(t.geometries[s],e));break}return n},Jt='<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>',we='Powered by <a href="https://www.esri.com">Esri</a>';function Ct(r,t){return xe(r,t)}function Me(r,t){return Pe(r,t)}function Ot(r){if(r.xmin!=="NaN"&&r.ymin!=="NaN"&&r.xmax!=="NaN"&&r.ymax!=="NaN"){var t=g.exports.latLng(r.ymin,r.xmin),e=g.exports.latLng(r.ymax,r.xmax);return g.exports.latLngBounds(t,e)}else return null}function Vt(r){return r=g.exports.latLngBounds(r),{xmin:r.getSouthWest().lng,ymin:r.getSouthWest().lat,xmax:r.getNorthEast().lng,ymax:r.getNorthEast().lat,spatialReference:{wkid:4326}}}var Kt=/^(OBJECTID|FID|OID|ID)$/i;function Ue(r){var t;if(r.objectIdFieldName)t=r.objectIdFieldName;else if(r.fields){for(var e=0;e<=r.fields.length-1;e++)if(r.fields[e].type==="esriFieldTypeOID"){t=r.fields[e].name;break}if(!t){for(e=0;e<=r.fields.length-1;e++)if(r.fields[e].name.match(Kt)){t=r.fields[e].name;break}}}return t}function De(r){for(var t in r.attributes)if(t.match(Kt))return t}function Tt(r,t){var e,i=r.features||r.results,n=i&&i.length;t?e=t:e=Ue(r);var s={type:"FeatureCollection",features:[]};if(n)for(var o=i.length-1;o>=0;o--){var l=Me(i[o],e||De(i[o]));s.features.push(l)}return s}function It(r){return r=g.exports.Util.trim(r),r[r.length-1]!=="/"&&(r+="/"),r}function Yt(r){if(r.url.indexOf("?")!==-1){r.requestParams=r.requestParams||{};var t=r.url.substring(r.url.indexOf("?")+1);r.url=r.url.split("?")[0],r.requestParams=JSON.parse('{"'+decodeURI(t).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return r.url=It(r.url.split("?")[0]),r}function be(r){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(r)}function Pt(r){var t;switch(r){case"Point":t="esriGeometryPoint";break;case"MultiPoint":t="esriGeometryMultipoint";break;case"LineString":t="esriGeometryPolyline";break;case"MultiLineString":t="esriGeometryPolyline";break;case"Polygon":t="esriGeometryPolygon";break;case"MultiPolygon":t="esriGeometryPolygon";break}return t}function Lt(r){return r.getSize().x-Ie.attributionWidthOffset+"px"}function zt(r){if(!!r.attributionControl){if(r.attributionControl._esriAttributionLayerCount||(r.attributionControl._esriAttributionLayerCount=0),r.attributionControl._esriAttributionLayerCount===0){if(!r.attributionControl._esriAttributionAddedOnce){var t=document.createElement("style");t.type="text/css",t.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(t);var e=document.createElement("style");e.type="text/css",e.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+Lt(r)+";}",document.getElementsByTagName("head")[0].appendChild(e),r.on("resize",function(i){r.attributionControl&&(r.attributionControl._container.style.maxWidth=Lt(i.target))}),r.attributionControl._esriAttributionAddedOnce=!0}r.attributionControl.setPrefix(Jt+" | "+we),g.exports.DomUtil.addClass(r.attributionControl._container,"esri-truncated-attribution:hover"),g.exports.DomUtil.addClass(r.attributionControl._container,"esri-truncated-attribution")}r.attributionControl._esriAttributionLayerCount=r.attributionControl._esriAttributionLayerCount+1}}function Qt(r){!r.attributionControl||(r.attributionControl._esriAttributionLayerCount&&r.attributionControl._esriAttributionLayerCount===1&&(r.attributionControl.setPrefix(Jt),g.exports.DomUtil.removeClass(r.attributionControl._container,"esri-truncated-attribution:hover"),g.exports.DomUtil.removeClass(r.attributionControl._container,"esri-truncated-attribution")),r.attributionControl._esriAttributionLayerCount=r.attributionControl._esriAttributionLayerCount-1)}function Xt(r){var t={geometry:null,geometryType:null};if(r instanceof g.exports.LatLngBounds)return t.geometry=Vt(r),t.geometryType="esriGeometryEnvelope",t;if(r.getLatLng&&(r=r.getLatLng()),r instanceof g.exports.LatLng&&(r={type:"Point",coordinates:[r.lng,r.lat]}),r instanceof g.exports.GeoJSON&&(r=r.getLayers()[0].feature.geometry,t.geometry=Ct(r),t.geometryType=Pt(r.type)),r.toGeoJSON&&(r=r.toGeoJSON()),r.type==="Feature"&&(r=r.geometry),r.type==="Point"||r.type==="LineString"||r.type==="Polygon"||r.type==="MultiPolygon")return t.geometry=Ct(r),t.geometryType=Pt(r.type),t;ft("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object")}var Ge=g.exports.ImageOverlay.extend({onAdd:function(r){this._topLeft=r.getPixelBounds().min,g.exports.ImageOverlay.prototype.onAdd.call(this,r)},_reset:function(){this._map.options.crs===g.exports.CRS.EPSG3857?g.exports.ImageOverlay.prototype._reset.call(this):g.exports.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),Be=g.exports.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:ut,attribution:null,interactive:!1,alt:""},onAdd:function(r){zt(r),this.options.zIndex&&(this.options.position=null),this._update=g.exports.Util.throttle(this._update,this.options.updateInterval,this),r.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?r.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(t,e){!t&&!this.options.attribution&&r.attributionControl&&e.copyrightText&&(this.options.attribution=e.copyrightText,r.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(r){Qt(r),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(r,t){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=g.exports.popup(t),this._popupFunction=r,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(r){return this.options.zIndex=r,this._currentImage&&this._currentImage.setZIndex(r),this},_setAutoZIndex:function(r){if(!!this._currentImage){for(var t=this._currentImage.getPane().children,e=-r(-1/0,1/0),i=0,n=t.length,s;i<n;i++)s=t[i].style.zIndex,t[i]!==this._currentImage._image&&s&&(e=r(e,+s));isFinite(e)&&(this.options.zIndex=e+r(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(r){return this.options.opacity=r,this._currentImage&&this._currentImage.setOpacity(r),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(r,t){return this.options.from=r,this.options.to=t,this._update(),this},metadata:function(r,t){return this.service.metadata(r,t),this},authenticate:function(r){return this.service.authenticate(r),this},redraw:function(){this._update()},_renderImage:function(r,t,e){if(this._map){if(e&&(r="data:"+e+";base64,"+r),!r)return;var i=new Ge(r,t,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),n=function(){this._map.removeLayer(i),this.fire("error"),i.off("load",s,this)},s=function(o){if(i.off("error",s,this),this._map){var l=o.target,h=this._currentImage;l._bounds.equals(t)&&l._bounds.equals(this._map.getBounds())?(this._currentImage=l,this.options.position==="front"?this.bringToFront():this.options.position==="back"&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),h&&this._map&&this._map.removeLayer(h),h&&h._map&&h._map.removeLayer(h)):this._map.removeLayer(l)}this.fire("load",{bounds:t})};i.once("error",n,this),i.once("load",s,this)}},_update:function(){if(!!this._map){var r=this._map.getZoom(),t=this._map.getBounds();if(!this._animatingZoom&&!(this._map._panTransition&&this._map._panTransition._inProgress)){if(r>this.options.maxZoom||r<this.options.minZoom){this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);return}var e=this._buildExportParams();g.exports.Util.extend(e,this.options.requestParams),e?(this._requestExport(e,t),this.fire("loading",{bounds:t})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(r,t,e,i){if(r=g.exports.latLng(r),this._shouldRenderPopup&&this._lastClick.equals(r)){var n=this._popupFunction(t,e,i);n&&this._popup.setLatLng(r).setContent(n).openOn(this._map)}},_resetPopupState:function(r){this._shouldRenderPopup=!1,this._lastClick=r.latlng},_calculateBbox:function(){var r=this._map.getPixelBounds(),t=this._map.unproject(r.getBottomLeft()),e=this._map.unproject(r.getTopRight()),i=this._map.options.crs.project(e),n=this._map.options.crs.project(t),s=g.exports.bounds(i,n);return[s.getBottomLeft().x,s.getBottomLeft().y,s.getTopRight().x,s.getTopRight().y].join(",")},_calculateImageSize:function(){var r=this._map.getPixelBounds(),t=this._map.getSize(),e=this._map.unproject(r.getBottomLeft()),i=this._map.unproject(r.getTopRight()),n=this._map.latLngToLayerPoint(i).y,s=this._map.latLngToLayerPoint(e).y;return(n>0||s<t.y)&&(t.y=s-n),t.x+","+t.y}}),Fe=g.exports.Evented.extend({options:{proxy:!1,useCors:ut,timeout:0},initialize:function(r){r=r||{},this._requestQueue=[],this._authenticating=!1,g.exports.Util.setOptions(this,r),this.options.url=It(this.options.url)},get:function(r,t,e,i){return this._request("get",r,t,e,i)},post:function(r,t,e,i){return this._request("post",r,t,e,i)},request:function(r,t,e,i){return this._request("request",r,t,e,i)},metadata:function(r,t){return this._request("get","",{},r,t)},authenticate:function(r){return this._authenticating=!1,this.options.token=r,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(r){this.options.timeout=r},_request:function(r,t,e,i,n){this.fire("requeststart",{url:this.options.url+t,params:e,method:r},!0);var s=this._createServiceCallback(r,t,e,i,n);if(this.options.token&&(e.token=this.options.token),this.options.requestParams&&g.exports.Util.extend(e,this.options.requestParams),this._authenticating){this._requestQueue.push([r,t,e,i,n]);return}else{var o=this.options.proxy?this.options.proxy+"?"+this.options.url+t:this.options.url+t;return(r==="get"||r==="request")&&!this.options.useCors?nt.get.JSONP(o,e,s,n):nt[r](o,e,s,n)}},_createServiceCallback:function(r,t,e,i,n){return g.exports.Util.bind(function(s,o){s&&(s.code===499||s.code===498)&&(this._authenticating=!0,this._requestQueue.push([r,t,e,i,n]),this.fire("authenticationrequired",{authenticate:g.exports.Util.bind(this.authenticate,this)},!0),s.authenticate=g.exports.Util.bind(this.authenticate,this)),i.call(n,s,o),s?this.fire("requesterror",{url:this.options.url+t,params:e,message:s.message,code:s.code,method:r},!0):this.fire("requestsuccess",{url:this.options.url+t,params:e,response:o,method:r},!0),this.fire("requestend",{url:this.options.url+t,params:e,method:r},!0)},this)},_runQueue:function(){for(var r=this._requestQueue.length-1;r>=0;r--){var t=this._requestQueue[r],e=t.shift();this[e].apply(this,t)}this._requestQueue=[]}}),Rt=g.exports.Class.extend({options:{proxy:!1,useCors:ut},generateSetter:function(r,t){return g.exports.Util.bind(function(e){return this.params[r]=e,this},t)},initialize:function(r){if(r.request&&r.options?(this._service=r,g.exports.Util.setOptions(this,r.options)):(g.exports.Util.setOptions(this,r),this.options.url=It(r.url)),this.params=g.exports.Util.extend({},this.params||{}),this.setters)for(var t in this.setters){var e=this.setters[t];this[t]=this.generateSetter(e,this)}},token:function(r){return this._service?this._service.authenticate(r):this.params.token=r,this},apikey:function(r){return this.token(r)},format:function(r){return this.params.returnUnformattedValues=!r,this},request:function(r,t){return this.options.requestParams&&g.exports.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,r,t):this._request("request",this.path,this.params,r,t)},_request:function(r,t,e,i,n){var s=this.options.proxy?this.options.proxy+"?"+this.options.url+t:this.options.url+t;return(r==="get"||r==="request")&&!this.options.useCors?nt.get.JSONP(s,e,i,n):nt[r](s,e,i,n)}}),He=Rt.extend({path:"identify",between:function(r,t){return this.params.time=[r.valueOf(),t.valueOf()],this}}),ke=He.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(r){var t=Vt(r.getBounds()),e=r.getSize();return this.params.imageDisplay=[e.x,e.y,96],this.params.mapExtent=[t.xmin,t.ymin,t.xmax,t.ymax],this},at:function(r){return r.length===2&&(r=g.exports.latLng(r)),this._setGeometryParams(r),this},layerDef:function(r,t){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[r,t].join(":"),this},simplify:function(r,t){var e=Math.abs(r.getBounds().getWest()-r.getBounds().getEast());return this.params.maxAllowableOffset=e/r.getSize().y*t,this},run:function(r,t){return this.request(function(e,i){if(e){r.call(t,e,void 0,i);return}else{var n=Tt(i);i.results=i.results.reverse();for(var s=0;s<n.features.length;s++){var o=n.features[s];o.layerId=i.results[s].layerId}r.call(t,void 0,n,i)}})},_setGeometryParams:function(r){var t=Xt(r);this.params.geometry=t.geometry,this.params.geometryType=t.geometryType}});function qe(r){return new ke(r)}var We=Rt.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(r){return this._setGeometryParams(r),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(r){return this._setGeometryParams(r),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(r){return this._setGeometryParams(r),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(r){return this._setGeometryParams(r),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(r){return this._setGeometryParams(r),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(r){return this._setGeometryParams(r),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(r){return this._setGeometryParams(r),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(r){return this._setGeometryParams(r),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(r,t){return r=g.exports.latLng(r),this.params.geometry=[r.lng,r.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=t,this.params.inSR=4326,this},where:function(r){return this.params.where=r,this},between:function(r,t){return this.params.time=[r.valueOf(),t.valueOf()],this},simplify:function(r,t){var e=Math.abs(r.getBounds().getWest()-r.getBounds().getEast());return this.params.maxAllowableOffset=e/r.getSize().y*t,this},orderBy:function(r,t){return t=t||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[r,t].join(" "),this},run:function(r,t){return this._cleanParams(),this.options.isModern||be(this.options.url)&&this.options.isModern===void 0?(this.params.f="geojson",this.request(function(e,i){this._trapSQLerrors(e),r.call(t,e,i,i)},this)):this.request(function(e,i){this._trapSQLerrors(e),r.call(t,e,i&&Tt(i),i)},this)},count:function(r,t){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(e,i){r.call(this,e,i&&i.count,i)},t)},ids:function(r,t){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(e,i){r.call(this,e,i&&i.objectIds,i)},t)},bounds:function(r,t){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(e,i){i&&i.extent&&Ot(i.extent)?r.call(t,e,Ot(i.extent),i):(e={message:"Invalid Bounds"},r.call(t,e,null,i))},t)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(r){var t=g.exports.point(r);return this.params.pixelSize=[t.x,t.y],this},layer:function(r){return this.path=r+"/query",this},_trapSQLerrors:function(r){r&&r.code==="400"&&ft("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(r){this.params.inSR=4326;var t=Xt(r);this.params.geometry=t.geometry,this.params.geometryType=t.geometryType}});function Je(r){return new We(r)}var Ve=Rt.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(r,t){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[r,t].join(":"),this},simplify:function(r,t){var e=Math.abs(r.getBounds().getWest()-r.getBounds().getEast());return this.params.maxAllowableOffset=e/r.getSize().y*t,this},run:function(r,t){return this.request(function(e,i){r.call(t,e,i&&Tt(i),i)},t)}});function Ke(r){return new Ve(r)}var Ye=Fe.extend({identify:function(){return qe(this)},find:function(){return Ke(this)},query:function(){return Je(this)}});function Zt(r){return new Ye(r)}var ze=Be.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(r){r=Yt(r),this.service=Zt(r),this.service.addEventParent(this),g.exports.Util.setOptions(this,r)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(r){return this.options.dynamicLayers=r,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(r){return this.options.layers=r,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(r){return this.options.layerDefs=r,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(r){return this.options.timeOptions=r,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(r){var t=g.exports.Util.bind(function(n,s,o){n||setTimeout(g.exports.Util.bind(function(){this._renderPopup(r.latlng,n,s,o)},this),300)},this),e;if(this.options.popup?e=this.options.popup.on(this._map).at(r.latlng):e=this.identify().on(this._map).at(r.latlng),e.params.maxAllowableOffset||e.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?e.layers("visible:"+this.options.layers.join(",")):e.layers("visible")),this.options.layerDefs&&typeof this.options.layerDefs!="string"&&!e.params.layerDefs)for(var i in this.options.layerDefs)this.options.layerDefs.hasOwnProperty(i)&&e.layerDef(i,this.options.layerDefs[i]);e.run(t),this._shouldRenderPopup=!0,this._lastClick=r.latlng},_buildExportParams:function(){var r=parseInt(this._map.options.crs.code.split(":")[1],10),t={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:r,imageSR:r};if(this.options.dynamicLayers&&(t.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(this.options.layers.length===0)return;t.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(t.layerDefs=typeof this.options.layerDefs=="string"?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(t.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(t.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(t.token=this.service.options.token),this.options.proxy&&(t.proxy=this.options.proxy),this.options.disableCache&&(t._ts=Date.now()),t},_requestExport:function(r,t){if(this.options.f==="json")this.service.request("export",r,function(i,n){i||(this.options.token&&n.href&&(n.href+="?token="+this.options.token),this.options.proxy&&n.href&&(n.href=this.options.proxy+"?"+n.href),n.href?this._renderImage(n.href,t):this._renderImage(n.imageData,t,n.contentType))},this);else{r.f="image";var e=this.options.url+"export"+g.exports.Util.getParamString(r);this.options.proxy&&(e=this.options.proxy+"?"+e),this._renderImage(e,t)}}});function Qe(r,t){return new ze(r,t)}var $t=g.exports.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{"0":156543.033928,"1":78271.5169639999,"2":39135.7584820001,"3":19567.8792409999,"4":9783.93962049996,"5":4891.96981024998,"6":2445.98490512499,"7":1222.99245256249,"8":611.49622628138,"9":305.748113140558,"10":152.874056570411,"11":76.4370282850732,"12":38.2185141425366,"13":19.1092570712683,"14":9.55462853563415,"15":4.77731426794937,"16":2.38865713397468,"17":1.19432856685505,"18":.597164283559817,"19":.298582141647617,"20":.14929107082381,"21":.07464553541191,"22":.0373227677059525,"23":.0186613838529763}},initialize:function(r){r=g.exports.Util.setOptions(this,r),r=Yt(r),this.tileUrl=(r.proxy?r.proxy+"?":"")+r.url+"tile/{z}/{y}/{x}"+(r.requestParams&&Object.keys(r.requestParams).length>0?g.exports.Util.getParamString(r.requestParams):""),r.url.indexOf("{s}")!==-1&&r.subdomains&&(r.url=r.url.replace("{s}",r.subdomains[0])),this.service=Zt(r),this.service.addEventParent(this);var t=new RegExp(/tiles.arcgis(online)?\.com/g);t.test(r.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),r.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),g.exports.TileLayer.prototype.initialize.call(this,this.tileUrl,r)},getTileUrl:function(r){var t=this._getZoomForUrl();return g.exports.Util.template(this.tileUrl,g.exports.Util.extend({s:this._getSubdomain(r),x:r.x,y:r.y,z:this._lodMap&&this._lodMap[t]?this._lodMap[t]:t},this.options))},createTile:function(r,t){var e=document.createElement("img");return g.exports.DomEvent.on(e,"load",g.exports.Util.bind(this._tileOnLoad,this,t,e)),g.exports.DomEvent.on(e,"error",g.exports.Util.bind(this._tileOnError,this,t,e)),this.options.crossOrigin&&(e.crossOrigin=""),e.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?e.src=this.getTileUrl(r):this.once("lodmap",function(){e.src=this.getTileUrl(r)},this),e},onAdd:function(r){zt(r),this._lodMap||this.metadata(function(t,e){if(!t&&e.spatialReference){var i=e.spatialReference.latestWkid||e.spatialReference.wkid;if(!this.options.attribution&&r.attributionControl&&e.copyrightText&&(this.options.attribution=e.copyrightText,r.attributionControl.addAttribution(this.getAttribution())),r.options.crs===g.exports.CRS.EPSG3857&&(i===102100||i===3857)){this._lodMap={};for(var n=e.tileInfo.lods,s=$t.MercatorZoomLevels,o=0;o<n.length;o++){var l=n[o];for(var h in s){var c=s[h];if(this._withinPercentage(l.resolution,c,this.options.zoomOffsetAllowance)){this._lodMap[h]=l.level;break}}}this.fire("lodmap")}else r.options.crs&&r.options.crs.code&&r.options.crs.code.indexOf(i)>-1||ft("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this),g.exports.TileLayer.prototype.onAdd.call(this,r)},onRemove:function(r){Qt(r),g.exports.TileLayer.prototype.onRemove.call(this,r)},metadata:function(r,t){return this.service.metadata(r,t),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(r){var t="?token="+r;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,t):this.tileUrl+t,this.options.token=r,this.service.authenticate(r),this},_withinPercentage:function(r,t,e){var i=Math.abs(r/t-1);return i<e}});function Xe(r,t){return new $t(r,t)}const{Item:Ze}=xt,{Option:$e}=wt,je=te({name:"AddService",components:{Button:ee,Form:xt,Select:wt,Input:re,Item:Ze,SelectOption:$e},props:{map:{type:Object,default:void 0},layerControl:{type:Object,default:void 0}},data:()=>({id:1,name:"\u670D\u52A1 1",url:"",type:"supermap_rest"}),methods:{addService(){const r=this.url,t=this.type,e=this.name;this.id++,this.name="\u670D\u52A1 "+this.id;let i;try{switch(t){case"supermap_rest":case"supermap_tile":{i=ge(r,{prjCoordSys:{epsgCode:3857},crs:g.exports.CRS.EPSG3857}).addTo(this.map);break}case"arcgis_rest":{i=Qe({url:r,f:"image"}),i.addTo(this.map);break}case"arcgis_tile":{i=Xe({url:r}),i.addTo(this.map);break}default:break}}catch{this.$msg.error("\u6DFB\u52A0\u670D\u52A1\u5931\u8D25")}i&&this.layerControl.addOverlay(i,e)}}}),tr=et(" \u8D85\u56FE\u52A8\u6001 "),er=et(" \u8D85\u56FE\u5207\u7247 "),rr=et(" ArcGIS \u52A8\u6001 "),ir=et(" ArcGIS \u5207\u7247 "),nr=et(" \u6DFB\u52A0 ");function sr(r,t,e,i,n,s){const o=K("Input"),l=K("Item"),h=K("SelectOption"),c=K("Select"),p=K("Button"),E=K("Form");return ne(),ie(E,{colon:!1,class:"addService"},{default:G(()=>[D(l,{label:"\u670D\u52A1\u540D\u79F0"},{default:G(()=>[D(o,{value:r.name,"onUpdate:value":t[0]||(t[0]=m=>r.name=m)},null,8,["value"])]),_:1}),D(l,{label:"\u670D\u52A1\u5730\u5740"},{default:G(()=>[D(o,{value:r.url,"onUpdate:value":t[1]||(t[1]=m=>r.url=m)},null,8,["value"])]),_:1}),D(l,{label:"\u670D\u52A1\u7C7B\u578B"},{default:G(()=>[D(c,{value:r.type,"onUpdate:value":t[2]||(t[2]=m=>r.type=m)},{default:G(()=>[D(h,{value:"supermap_rest"},{default:G(()=>[tr]),_:1}),D(h,{value:"supermap_tile"},{default:G(()=>[er]),_:1}),D(h,{value:"arcgis_rest"},{default:G(()=>[rr]),_:1}),D(h,{value:"arcgis_tile"},{default:G(()=>[ir]),_:1})]),_:1},8,["value"])]),_:1}),D(l,{class:"formBtnItem"},{default:G(()=>[D(p,{type:"primary",onClick:r.addService},{default:G(()=>[nr]),_:1},8,["onClick"])]),_:1})]),_:1})}var cr=se(je,[["render",sr],["__scopeId","data-v-6b825d66"]]);export{cr as default};
