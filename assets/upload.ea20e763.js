var k=Object.defineProperty,w=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var m=(e,t,o)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,a=(e,t)=>{for(var o in t||(t={}))v.call(t,o)&&m(e,o,t[o]);if(d)for(var o of d(t))x.call(t,o)&&m(e,o,t[o]);return e},l=(e,t)=>w(e,C(t));import{u as j}from"./index.7cbf6957.js";import{I as b,b as i,_ as y,k as I,r,o as L,c as S,w as p,s,bj as U,bk as $,d as u}from"./index.fd3c34f7.js";import{U as M}from"./index.a4cf11d3.js";import"./index.c7591175.js";/* empty css               */import{S as T}from"./index.53689b13.js";import"./Form.970fc2ed.js";import"./Col.165062d6.js";import"./responsiveObserve.3bea7b2a.js";import"./useFlexGapSupport.5d23bcb4.js";import"./toArray.f0b52048.js";import"./get.cd8ee735.js";import"./hasIn.d219cb93.js";import"./_arrayIncludesWith.40afec22.js";import"./toFinite.5a5e99db.js";import"./collapseMotion.69c5a13a.js";import"./debounce.f0dc985b.js";import"./EyeOutlined.d40575ed.js";import"./useMergedState.fcf9d1e6.js";import"./index.0bcab8cb.js";import"./useRefs.aacf5ee1.js";var D=b("upload-one",!0,function(e){return i("svg",{width:e.size,height:e.size,viewBox:"0 0 48 48",fill:"none"},[i("path",{d:"M11.6777 20.271C7.27476 21.3181 4 25.2766 4 30C4 35.5228 8.47715 40 14 40C14.9474 40 15.864 39.8683 16.7325 39.6221",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),i("path",{d:"M36.0547 20.271C40.4577 21.3181 43.7324 25.2766 43.7324 30C43.7324 35.5228 39.2553 40 33.7324 40V40C32.785 40 31.8684 39.8683 30.9999 39.6221",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),i("path",{d:"M36 20C36 13.3726 30.6274 8 24 8C17.3726 8 12 13.3726 12 20",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),i("path",{d:"M17.0654 27.881L23.9999 20.9236L31.1318 28",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null),i("path",{d:"M24 38V24.4618",stroke:e.colors[0],"stroke-width":e.strokeWidth,"stroke-linecap":e.strokeLinecap,"stroke-linejoin":e.strokeLinejoin},null)])});const{Dragger:W}=M,{mapGetters:q,mapActions:F}=I("imgHosting"),O={name:"ImgHostingUpload",components:{Dragger:W,UploadOne:D,Spin:T},props:{activeKey:{type:String,default:""}},data:()=>({spinning:!1,timeoutIndex:void 0}),computed:a({},q(["config","uploader","commonConfig"])),mounted(){document.addEventListener("paste",this.paste.bind(this))},beforeUnmount(){document.removeEventListener("paste",this.paste.bind(this))},methods:l(a({},F(["addImage"])),{async customRequest({file:e}){if(this.spinning=!0,this.uploader&&this.config(this.uploader)){if(this.commonConfig.renameTimeStamp){const t=e.name||"";e=new File([e],(new Date().getTime()+t.substring(t.lastIndexOf("."))).toLowerCase(),{type:e.type,lastModified:e.lastModified})}try{const t=await j[this.uploader].handle(this.config(this.uploader),e);if(this.addImage(t),this.commonConfig.copyUrlAfterUpload)try{this.commonConfig.customCopyContent?await navigator.clipboard.writeText(this.commonConfig.customCopyContent.replace(/\$url/g,t.url)):await navigator.clipboard.writeText(t.url),this.$msg.success("\u4E0A\u4F20\u6210\u529F\uFF0C\u5730\u5740\u5DF2\u590D\u5236\u5230\u526A\u8D34\u677F")}catch{this.$msg.error("\u4E0A\u4F20\u6210\u529F\uFF0C\u4F46\u5730\u5740\u590D\u5236\u5931\u8D25")}else this.$msg.success("\u4E0A\u4F20\u6210\u529F")}catch(t){console.log(t),this.$msg.error("\u4E0A\u4F20\u5931\u8D25")}}else this.$msg.warn("\u8BF7\u5148\u8FDB\u884C\u8BBE\u7F6E");this.spinning=!1},rejectFile(){this.$msg.warning("\u4E0D\u652F\u6301\u7684\u6587\u4EF6\u7C7B\u578B\uFF01")},paste(e){if(this.activeKey==="home"&&!this.spinning&&!this.timeoutIndex){this.timeoutIndex=setTimeout(()=>{this.timeoutIndex=void 0},500);const t=e.clipboardData&&e.clipboardData.items;let o;if(t&&t.length)for(const n of t)n.type.indexOf("image")!==-1&&(o=n.getAsFile());o?this.customRequest({file:o}):(this.rejectFile(),clearTimeout(this.timeoutIndex),this.timeoutIndex=void 0)}}})},h=e=>(U("data-v-2bf05edf"),e=e(),$(),e),R={class:"ant-upload-drag-icon"},V=h(()=>s("p",{class:"ant-upload-text"},[u(" \u76F4\u63A5\u7C98\u8D34\u56FE\u7247\u6216\u62D6\u62FD\u56FE\u7247\u5230\u8FD9\u91CC\u4E0A\u4F20"),s("br"),u("\u6216\u8005\u76F4\u63A5\u70B9\u51FB\u9009\u62E9\u6587\u4EF6\u4E0A\u4F20 ")],-1)),B=h(()=>s("p",{class:"ant-upload-hint"}," \u6682\u65F6\u4EC5\u652F\u6301\u5355\u6587\u4EF6\u4E0A\u4F20\u3002 ",-1));function N(e,t,o,n,A,c){const g=r("UploadOne"),f=r("Dragger"),_=r("Spin");return L(),S(_,{spinning:e.spinning},{default:p(()=>[i(f,{"file-list":[],accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp","show-upload-list":!1,"custom-request":c.customRequest,onReject:c.rejectFile},{default:p(()=>[s("p",R,[i(g)]),V,B]),_:1},8,["custom-request","onReject"])]),_:1},8,["spinning"])}var le=y(O,[["render",N],["__scopeId","data-v-2bf05edf"]]);export{le as default};
