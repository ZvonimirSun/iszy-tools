import{_ as f,bp as n,o as v,m as w,a as l,w as m,q as C,F as b,bq as E,b as x,$ as M,B as y}from"./index.6b075e9a.js";import{_}from"./index.9aae888d.js";import{m as c,c as r,C as d}from"./marker-shadow.ccb22ef5.js";import{l as s}from"./leaflet-src.48ca861e.js";import"./index.d856463b.js";import"./useFlexGapSupport.961efcb4.js";import"./SearchOutlined.9b969b07.js";import"./Password.6b43943e.js";import"./EyeOutlined.4309515f.js";const z=new s.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.cc/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-green.png",shadowUrl:c,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),Z=new s.exports.Icon({iconUrl:"https://jsdelivr.cdn.iszy.cc/gh/zvonimirsun/leaflet-color-markers@master/img/marker-icon-2x-yellow.png",shadowUrl:c,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),T={name:"LatLng",data:()=>({map:void 0,centerMarker:void 0,clickMarker:void 0,tdtToken:"bed806b1ccb34b268ab1c0700123d444",gaodeToken:"868d6830a7409520ae283cde3a3f84d1",latLng:{lng:"",lat:""},address:"",keyword:""}),mounted(){this.initMap()},methods:{initMap(){this.map=n(s.exports.map(this.$refs.mapContainer,{attributionControl:!0,zoomControl:!1})),this.map.setView([35,105],4),s.exports.control.layers({\u9AD8\u5FB7\u77E2\u91CF:r("GaoDe.Normal.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20,attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}).addTo(this.map),\u9AD8\u5FB7\u5F71\u50CF:s.exports.layerGroup([r("GaoDe.Satellite.Map",{minZoom:3,maxNativeZoom:18,maxZoom:20}),r("GaoDe.Satellite.Annotation",{minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://lbs.amap.com/pages/terms/" target="_blank">\u9AD8\u5FB7\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u77E2\u91CF:s.exports.layerGroup([r("TianDiTu.Normal.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20}),r("TianDiTu.Normal.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5F71\u50CF:s.exports.layerGroup([r("TianDiTu.Satellite.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20}),r("TianDiTu.Satellite.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:18,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),\u5929\u5730\u56FE\u5730\u5F62:s.exports.layerGroup([r("TianDiTu.Terrain.Map",{key:this.tdtToken,minZoom:3,maxNativeZoom:14,maxZoom:20}),r("TianDiTu.Terrain.Annotation",{key:this.tdtToken,minZoom:3,maxNativeZoom:14,maxZoom:20})],{attribution:'&copy; <a href="https://www.tianditu.gov.cn/" target="_blank">\u5929\u5730\u56FE</a> \u8D21\u732E\u8005'}),OpenStreetMap:r("OSM.Normal.Map",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> \u8D21\u732E\u8005'})},{},{hideSingleBase:!0,position:"bottomleft"}).addTo(this.map),s.exports.control.scale({imperial:!1,position:"bottomright"}).addTo(this.map),s.exports.control.zoom({zoomInTitle:"\u653E\u5927",zoomOutTitle:"\u7F29\u5C0F",position:"topright"}).addTo(this.map),this.centerMarker=n(s.exports.marker(this.map.getCenter(),{icon:z})).addTo(this.map).bindPopup(this.getPopupContent(this.map.getCenter()),{autoPan:!1,autoClose:!1,closeOnEscapeKey:!1,closeOnClick:!1}).on("popupopen",()=>{this.clickMarker&&this.clickMarker.closePopup()}).openPopup(),this.map.on("move",()=>{this.centerMarker.setLatLng(this.map.getCenter()).getPopup().setContent(this.getPopupContent(this.map.getCenter()))}),this.map.on("click",e=>{this.keyword=`${e.latlng.lng},${e.latlng.lat}`,this.locateLatLng(e.latlng,null,!1)}),"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(e=>{this.keyword||(this.keyword=`${e.coords.longitude},${e.coords.latitude}`),this.map.setView([e.coords.latitude,e.coords.longitude],16)})},getPopupContent(e,t){const o=e.lat;let a=e.lng%360;a<=-180&&(a+=360);let i="";return o>=0?i+=`<p>\u5317\u7EACN: ${Math.abs(o)}</p>`:i+=`<p>\u5357\u7EACS: ${Math.abs(o)}</p>`,a>=0?i+=`<p>\u4E1C\u7ECFE: ${Math.abs(a)}</p>`:i+=`<p>\u897F\u7ECFW: ${Math.abs(a)}</p>`,o>=0?i+=`<p>\u5317\u7EACN: ${this.formatDegree(Math.abs(o))}</p>`:i+=`<p>\u5357\u7EACS: ${this.formatDegree(Math.abs(o))}</p>`,a>=0?i+=`<p>\u4E1C\u7ECFE: ${this.formatDegree(a)}</p>`:i+=`<p>\u897F\u7ECFW: ${this.formatDegree(a)}</p>`,t&&(i+=`<p>\u5730\u5740: ${t}</p>`),i},handler(){if(!this.keyword)return;const e=this.keyword.replace(/ï¼Œ/g,",").split(",");if(e.length===2&&!isNaN(parseFloat(e[0].trim()))&&!isNaN(parseFloat(e[1].trim()))){this.latLng.lng=parseFloat(e[0].trim()),this.latLng.lat=parseFloat(e[1].trim()),this.locateLatLng(this.latLng);return}this.address=this.keyword,this.locateAddress()},async locateLatLng(e={},t,o=!0){if(e.lng!=null&&e.lat!=null&&e.lng!==""&&e.lat!=="")try{if(!t)try{const a=d.prototype.csysConvert.gps84_To_gcj02(e.lng,e.lat),i=await this.$axios.get("https://amap.api.iszy.xyz/v3/geocode/regeo",{params:{location:`${a.lng},${a.lat}`,output:"json",key:this.gaodeToken,homeorcorp:1}});i.data.status==="1"&&i.data.regeocode.formatted_address?t=i.data.regeocode.formatted_address:this.$msg.warn("\u672A\u627E\u5230\u76F8\u5173\u5730\u5740\u3002")}catch{this.$msg.error("\u67E5\u8BE2\u5730\u5740\u5931\u8D25\uFF01")}this.clickMarker?(this.clickMarker.setLatLng(e).getPopup().setContent(this.getPopupContent(e,t)),this.clickMarker.openPopup()):this.clickMarker=n(s.exports.marker(e,{icon:Z})).addTo(this.map).bindPopup(this.getPopupContent(e,t),{autoPan:!1,autoClose:!1,closeOnEscapeKey:!1,closeOnClick:!1,maxWidth:350}).on("popupopen",()=>{this.centerMarker&&this.centerMarker.closePopup()}).openPopup(),o&&this.map.setView(e,16)}catch{this.$msg.error("\u5B9A\u4F4D\u5931\u8D25!")}},async locateAddress(){if(this.address)try{const e=await this.$axios.get("https://amap.api.iszy.xyz/v3/geocode/geo",{params:{address:this.address,key:this.gaodeToken}});if(e.data.status==="1"&&Number(e.data.count)>0){const t=e.data.geocodes[0],o=d.prototype.csysConvert.gcj02_To_gps84(parseFloat(t.location.split(",")[0]),parseFloat(t.location.split(",")[1]));await this.locateLatLng({lat:o.lat,lng:o.lng},t.formatted_address)}else this.$msg.warn("\u672A\u627E\u5230\u76F8\u5173\u5730\u5740\u3002")}catch{this.$msg.error("\u67E5\u8BE2\u5730\u5740\u5931\u8D25!")}},formatDegree(e){e=Math.abs(e);const t=Math.floor(e),o=Math.floor((e-t)*60),a=((e-t)*3600%60).toFixed(2);return t+"\xB0 "+(o<10?"0"+o:o)+"' "+(a<10?"0"+a:a)+'" '}}},D=x(" \u89E3\u6790 "),$={ref:"mapContainer",class:"mapContainer"};function A(e,t,o,a,i,p){const h=M,k=y,g=_;return v(),w(b,null,[l(g,{size:8,align:"center"},{default:m(()=>[l(h,{value:e.keyword,"onUpdate:value":t[0]||(t[0]=u=>e.keyword=u),placeholder:"\u8F93\u5165\u7ECF\u7EAC\u5EA6(\u5982'116.4,36.9')\u6216\u5730\u5740(\u5982'\u5317\u4EAC\u5E02\u653F\u5E9C')","allow-clear":"",onKeypress:E(p.handler,["enter"])},null,8,["value","onKeypress"]),l(k,{type:"primary",onClick:p.handler},{default:m(()=>[D]),_:1},8,["onClick"])]),_:1}),C("div",$,null,512)],64)}var F=f(T,[["render",A],["__scopeId","data-v-a9fd504a"]]);export{F as default};
