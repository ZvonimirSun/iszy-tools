import{j as x,B as g,l as b,P as C,o as I,ad as T,ae as S,aa as a,aI as B,am as U,an as k,a as o,W as v,a3 as E}from"./vendor-2d125fa4.js";import{u as y,a as F}from"./imgHosting-f148a58a.js";import"./common-d4a6585c.js";import"./ant-design-vue-cea3bdbb.js";const u=s=>(U("data-v-e61141d8"),s=s(),k(),s),M=u(()=>o("div",{class:"el-icon--upload"},[o("span",{class:"i-icon-park-upload-one?mask"})],-1)),j=u(()=>o("div",{class:"el-upload__text"},[v(" 直接粘贴图片或拖拽图片到这里上传"),o("br"),v("或者"),o("em",null,"直接点击选择文件上传")],-1)),D=u(()=>o("div",{class:"el-upload__tip"}," 暂时仅支持单文件上传。 ",-1)),L=x({__name:"upload",props:{activeKey:{default:""}},setup(s){const h=s,p=g(!1),n=g(),r=y(),m=r.config,l=r.uploader,c=r.commonConfig;b(()=>{document.addEventListener("paste",f)}),C(()=>{document.removeEventListener("paste",f)});async function _(i){let t=i;if(p.value=!0,l&&m(l)){if(c.renameTimeStamp){const e=t.name||"";t=new File([t],(new Date().getTime()+e.substring(e.lastIndexOf("."))).toLowerCase(),{type:t.type,lastModified:t.lastModified})}try{const e=await F[l].handle(m(l),t);if(y().addImage(e),c.copyUrlAfterUpload)try{c.customCopyContent?await navigator.clipboard.writeText(c.customCopyContent.replace(/\$url/g,e.url)):await navigator.clipboard.writeText(e.url),a.success("上传成功，地址已复制到剪贴板")}catch{a.error("上传成功，但地址复制失败")}else a.success("上传成功")}catch(e){console.log(e),a.error("上传失败")}}else a.warning("请先进行设置");return p.value=!1,!1}function w(){a.warning("不支持的文件类型！")}function f(i){if(h.activeKey==="home"&&!p.value&&!n.value){n.value=setTimeout(()=>{n.value=void 0},500);const t=i.clipboardData&&i.clipboardData.items;let e;if(t&&t.length)for(const d of t)d.type.indexOf("image")!==-1&&(e=d.getAsFile());e?_(e):(w(),clearTimeout(n.value),n.value=void 0)}}return(i,t)=>{const e=B;return I(),T(e,{style:{height:"100%"},drag:"",accept:"image/bmp,image/gif,image/jpeg,image/png,image/webp","show-file-list":!1,"before-upload":_},{default:S(()=>[M,j,D]),_:1})}}});const O=E(L,[["__scopeId","data-v-e61141d8"]]);export{O as default};
