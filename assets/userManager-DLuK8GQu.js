import{K as s,L as m,N as n,Y as I,k as B,a4 as g,T as b,aW as p,ax as E,aA as u,E as z,r as L,w as F,x as h}from"./index-C6iSN1Cq.js";import"./el-empty-BwiJUvdZ.js";import{F as N,a as C,E as Y}from"./el-table-v2-DEtyx6r4.js";import{d as y}from"./dayjs.min-wuCXA2wp.js";/* empty css               */import{E as v}from"./el-popover-B6__6hzw.js";import"./el-popper-25t3ilqD.js";import{E as f}from"./index-CYsrhssY.js";import"./castArray-Bry1IcHc.js";import"./raf-Cz6MYyLe.js";import"./memoize-one.esm-BdPwpGay.js";import"./index-Da3wvpUo.js";import"./isUndefined-DCTLXrZ8.js";var d=function(a){return a[a.DELETED=-1]="DELETED",a[a.DEACTIVATED=0]="DEACTIVATED",a[a.ENABLED=1]="ENABLED",a[a.DISABLED=2]="DISABLED",a}(d||{});function M(a){return[{key:"userId",dataKey:"userId",width:150,hidden:!0},{key:"userName",dataKey:"userName",title:"用户名",width:150,align:"center"},{key:"nickName",dataKey:"nickName",title:"昵称",width:150,align:"center"},{key:"email",dataKey:"email",title:"邮箱",width:150,align:"center"},{key:"roles",title:"角色",width:150,align:"center",cellRenderer:({rowData:t})=>{var o;const i=((o=t.roles)==null?void 0:o.map(c=>c.name).join(", "))||"";return s("span",null,[i])}},{key:"status",title:"状态",width:100,align:"center",cellRenderer:({rowData:t})=>{switch(t.status){case d.ENABLED:return s(f,{type:"success"},{default:()=>[n("正常")]});case d.DISABLED:return s(f,{type:"info"},{default:()=>[n("禁用")]});case d.DEACTIVATED:return s(f,{type:"info"},{default:()=>[n("待激活")]});default:return s(f,{type:"warning"},{default:()=>[n("未知")]})}}},{key:"createdAt",title:"创建时间",width:200,align:"center",cellRenderer:({rowData:t})=>s("span",null,[y(t.createdAt).format("YYYY-MM-DD HH:mm:ss")])},{key:"updatedAt",title:"更新时间",width:200,align:"center",cellRenderer:({rowData:t})=>s("span",null,[y(t.updatedAt).format("YYYY-MM-DD HH:mm:ss")])},{key:"operations",title:"操作",width:200,fixed:N.RIGHT,cellRenderer:({rowData:t})=>s(I,null,[s(m,{size:"small",plain:!0,onClick:()=>a(t,"edit")},{default:()=>[n("修改")]}),t.status===d.DEACTIVATED||t.status===d.DISABLED?s(m,{size:"small",plain:!0,onClick:()=>a(t,"activate")},{default:()=>[n("启用")]}):s(m,{size:"small",plain:!0,onClick:()=>a(t,"disable")},{default:()=>[n("禁用")]}),s(v,{title:"确定要删除吗？",onConfirm:()=>a(t,"delete")},{reference:()=>s(m,{size:"small",plain:!0,type:"danger"},{default:()=>[n("删除")]})})])}]}const R={"h-full":"","w-full":""},Z=B({__name:"userManager",setup(a){const t=g([]),i=g({index:1,size:10}),o=M(w);b(()=>{c(1,i.size)});async function c(r,e){try{const l=(await p.get(`${E.apiOrigin}/user/list`,{params:{pageIndex:r,pageSize:e}})).data;if(l.success)t.splice(0,t.length,...l.data);else throw new Error(l.message)}catch(l){u.error(l.message)}}function w(r,e){switch(e){case"edit":break;case"disable":D(r);break;case"activate":A(r);break;case"delete":_(r);break}}async function D(r){try{const e=(await p.put(`${E.apiOrigin}/user/ban`,null,{params:{id:r.userId}})).data;if(e.success)u.success(e.message),await c(i.index,i.size);else throw new Error(e.message)}catch(e){u.error(e.message)}}async function A(r){try{const e=(await p.put(`${E.apiOrigin}/user/activate`,null,{params:{id:r.userId}})).data;if(e.success)u.success(e.message),await c(i.index,i.size);else throw new Error(e.message)}catch(e){u.error(e.message)}}async function _(r){try{const e=(await p.delete(`${E.apiOrigin}/user/${r.userId}`)).data;if(e.success)u.success(e.message),await c(i.index,i.size);else throw new Error(e.message)}catch(e){u.error(e.message)}}return(r,e)=>{const l=C,k=Y;return L(),z("div",R,[s(k,null,{default:F(({width:T,height:x})=>[s(l,{columns:h(o),data:h(t),width:T,height:x,fixed:""},null,8,["columns","data","width","height"])]),_:1})])}}});export{Z as default};
