import{bY as $,cj as ze,b2 as Ee,h as ye,v as F,x as he,z as ue,j as ne,bu as pe,di as Se,dj as xe,aT as be,u as ke,cd as Ne,R as k,dk as Oe,aP as Te,k as p,a9 as de,ai as _e,T as Ie,o as b,l as fe,w as I,K as f,ao as Re,G as h,n as m,m as a,q as ge,Z as Ae,H as E,aK as T,bj as $e,F as x,X as te,bh as Me,bi as Be,dl as Ve,bL as Ye,s as Pe,dm as Xe,dn as je,Y as De,am as Fe,as as He,r as ae,_ as Ce,aQ as M,aR as A,dd as Ke,t as Le,dp as We,c8 as Ze,dq as qe,dr as Ge,I as Qe,aE as we,b_ as Ue,aO as Je,ds as ea}from"./index-CReUdWLV.js";import{E as aa}from"./index-pgUbQnVT.js";const ta=(r,v)=>{if(!$||!r||!v)return!1;const n=r.getBoundingClientRect();let d;return v instanceof Element?d=v.getBoundingClientRect():d={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<d.bottom&&n.bottom>d.top&&n.right>d.left&&n.left<d.right};var na="Expected a function";function ce(r,v,n){var d=!0,l=!0;if(typeof r!="function")throw new TypeError(na);return ze(n)&&(d="leading"in n?!!n.leading:d,l="trailing"in n?!!n.trailing:l),Ee(r,v,{leading:d,maxWait:v,trailing:l})}const sa=ye({urlList:{type:F(Array),default:()=>he([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:F(String)}}),la={close:()=>!0,switch:r=>ue(r),rotate:r=>ue(r)},oa=ne({name:"ElImageViewer"}),ra=ne({...oa,props:sa,emits:la,setup(r,{expose:v,emit:n}){var d;const l=r,g={CONTAIN:{name:"contain",icon:pe(Se)},ORIGINAL:{name:"original",icon:pe(xe)}},{t:se}=be(),o=ke("image-viewer"),{nextZIndex:le}=Ne(),R=k(),N=k([]),S=Oe(),C=k(!0),w=k(l.initialIndex),y=Te(g.CONTAIN),i=k({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),B=k((d=l.zIndex)!=null?d:le()),V=p(()=>{const{urlList:t}=l;return t.length<=1}),H=p(()=>w.value===0),K=p(()=>w.value===l.urlList.length-1),Y=p(()=>l.urlList[w.value]),oe=p(()=>[o.e("btn"),o.e("prev"),o.is("disabled",!l.infinite&&H.value)]),W=p(()=>[o.e("btn"),o.e("next"),o.is("disabled",!l.infinite&&K.value)]),P=p(()=>{const{scale:t,deg:u,offsetX:s,offsetY:_,enableTransition:L}=i.value;let z=s/t,O=_/t;const D=u*Math.PI/180,ve=Math.cos(D),me=Math.sin(D);z=z*ve+O*me,O=O*ve-s/t*me;const ie={transform:`scale(${t}) rotate(${u}deg) translate(${z}px, ${O}px)`,transition:L?"transform .3s":""};return y.value.name===g.CONTAIN.name&&(ie.maxWidth=ie.maxHeight="100%"),ie});function X(){Z(),n("close")}function re(){const t=ce(s=>{switch(s.code){case A.esc:l.closeOnPressEscape&&X();break;case A.space:J();break;case A.left:ee();break;case A.up:c("zoomIn");break;case A.right:e();break;case A.down:c("zoomOut");break}}),u=ce(s=>{const _=s.deltaY||s.deltaX;c(_<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})});S.run(()=>{M(document,"keydown",t),M(document,"wheel",u)})}function Z(){S.stop()}function q(){C.value=!1}function G(t){C.value=!1,t.target.alt=se("el.image.error")}function Q(t){if(C.value||t.button!==0||!R.value)return;i.value.enableTransition=!1;const{offsetX:u,offsetY:s}=i.value,_=t.pageX,L=t.pageY,z=ce(D=>{i.value={...i.value,offsetX:u+D.pageX-_,offsetY:s+D.pageY-L}}),O=M(document,"mousemove",z);M(document,"mouseup",()=>{O()}),t.preventDefault()}function U(){i.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function J(){if(C.value)return;const t=Ke(g),u=Object.values(g),s=y.value.name,L=(u.findIndex(z=>z.name===s)+1)%t.length;y.value=g[t[L]],U()}function j(t){const u=l.urlList.length;w.value=(t+u)%u}function ee(){H.value&&!l.infinite||j(w.value-1)}function e(){K.value&&!l.infinite||j(w.value+1)}function c(t,u={}){if(C.value)return;const{minScale:s,maxScale:_}=l,{zoomRate:L,rotateDeg:z,enableTransition:O}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...u};switch(t){case"zoomOut":i.value.scale>s&&(i.value.scale=Number.parseFloat((i.value.scale/L).toFixed(3)));break;case"zoomIn":i.value.scale<_&&(i.value.scale=Number.parseFloat((i.value.scale*L).toFixed(3)));break;case"clockwise":i.value.deg+=z,n("rotate",i.value.deg);break;case"anticlockwise":i.value.deg-=z,n("rotate",i.value.deg);break}i.value.enableTransition=O}return de(Y,()=>{_e(()=>{const t=N.value[0];t!=null&&t.complete||(C.value=!0)})}),de(w,t=>{U(),n("switch",t)}),Ie(()=>{var t,u;re(),(u=(t=R.value)==null?void 0:t.focus)==null||u.call(t)}),v({setActiveItem:j}),(t,u)=>(b(),fe(a(aa),{to:"body",disabled:!t.teleported},{default:I(()=>[f(Re,{name:"viewer-fade",appear:""},{default:I(()=>[h("div",{ref_key:"wrapper",ref:R,tabindex:-1,class:m(a(o).e("wrapper")),style:ge({zIndex:B.value})},[h("div",{class:m(a(o).e("mask")),onClick:Ae(s=>t.hideOnClickModal&&X(),["self"])},null,10,["onClick"]),E(" CLOSE "),h("span",{class:m([a(o).e("btn"),a(o).e("close")]),onClick:X},[f(a(T),null,{default:I(()=>[f(a($e))]),_:1})],2),E(" ARROW "),a(V)?E("v-if",!0):(b(),x(te,{key:0},[h("span",{class:m(a(oe)),onClick:ee},[f(a(T),null,{default:I(()=>[f(a(Me))]),_:1})],2),h("span",{class:m(a(W)),onClick:e},[f(a(T),null,{default:I(()=>[f(a(Be))]),_:1})],2)],64)),E(" ACTIONS "),h("div",{class:m([a(o).e("btn"),a(o).e("actions")])},[h("div",{class:m(a(o).e("actions__inner"))},[f(a(T),{onClick:s=>c("zoomOut")},{default:I(()=>[f(a(Ve))]),_:1},8,["onClick"]),f(a(T),{onClick:s=>c("zoomIn")},{default:I(()=>[f(a(Ye))]),_:1},8,["onClick"]),h("i",{class:m(a(o).e("actions__divider"))},null,2),f(a(T),{onClick:J},{default:I(()=>[(b(),fe(Pe(a(y).icon)))]),_:1}),h("i",{class:m(a(o).e("actions__divider"))},null,2),f(a(T),{onClick:s=>c("anticlockwise")},{default:I(()=>[f(a(Xe))]),_:1},8,["onClick"]),f(a(T),{onClick:s=>c("clockwise")},{default:I(()=>[f(a(je))]),_:1},8,["onClick"])],2)],2),E(" CANVAS "),h("div",{class:m(a(o).e("canvas"))},[(b(!0),x(te,null,De(t.urlList,(s,_)=>Fe((b(),x("img",{ref_for:!0,ref:L=>N.value[_]=L,key:s,src:s,style:ge(a(P)),class:m(a(o).e("img")),crossorigin:t.crossorigin,onLoad:q,onError:G,onMousedown:Q},null,46,["src","crossorigin"])),[[He,_===w.value]])),128))],2),ae(t.$slots,"default")],6)]),_:3})]),_:3},8,["disabled"]))}});var ia=Ce(ra,[["__file","image-viewer.vue"]]);const ca=Le(ia),ua=ye({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:F([String,Object])},previewSrcList:{type:F(Array),default:()=>he([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:F(String)}}),da={load:r=>r instanceof Event,error:r=>r instanceof Event,switch:r=>ue(r),close:()=>!0,show:()=>!0},fa=ne({name:"ElImage",inheritAttrs:!1}),va=ne({...fa,props:ua,emits:da,setup(r,{emit:v}){const n=r;let d="";const{t:l}=be(),g=ke("image"),se=We(),o=p(()=>Ze(Object.entries(se).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),le=qe({excludeListeners:!0,excludeKeys:p(()=>Object.keys(o.value))}),R=k(),N=k(!1),S=k(!0),C=k(!1),w=k(),y=k(),i=$&&"loading"in HTMLImageElement.prototype;let B,V;const H=p(()=>[g.e("inner"),Y.value&&g.e("preview"),S.value&&g.is("loading")]),K=p(()=>{const{fit:e}=n;return $&&e?{objectFit:e}:{}}),Y=p(()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0}),oe=p(()=>{const{previewSrcList:e,initialIndex:c}=n;let t=c;return c>e.length-1&&(t=0),t}),W=p(()=>n.loading==="eager"?!1:!i&&n.loading==="lazy"||n.lazy),P=()=>{$&&(S.value=!0,N.value=!1,R.value=n.src)};function X(e){S.value=!1,N.value=!1,v("load",e)}function re(e){S.value=!1,N.value=!0,v("error",e)}function Z(){ta(w.value,y.value)&&(P(),Q())}const q=Ge(Z,200,!0);async function G(){var e;if(!$)return;await _e();const{scrollContainer:c}=n;Ue(c)?y.value=c:Je(c)&&c!==""?y.value=(e=document.querySelector(c))!=null?e:void 0:w.value&&(y.value=ea(w.value)),y.value&&(B=M(y,"scroll",q),setTimeout(()=>Z(),100))}function Q(){!$||!y.value||!q||(B==null||B(),y.value=void 0)}function U(e){if(e.ctrlKey){if(e.deltaY<0)return e.preventDefault(),!1;if(e.deltaY>0)return e.preventDefault(),!1}}function J(){Y.value&&(V=M("wheel",U,{passive:!1}),d=document.body.style.overflow,document.body.style.overflow="hidden",C.value=!0,v("show"))}function j(){V==null||V(),document.body.style.overflow=d,C.value=!1,v("close")}function ee(e){v("switch",e)}return de(()=>n.src,()=>{W.value?(S.value=!0,N.value=!1,Q(),G()):P()}),Ie(()=>{W.value?G():P()}),(e,c)=>(b(),x("div",we({ref_key:"container",ref:w},a(o),{class:[a(g).b(),e.$attrs.class]}),[N.value?ae(e.$slots,"error",{key:0},()=>[h("div",{class:m(a(g).e("error"))},Qe(a(l)("el.image.error")),3)]):(b(),x(te,{key:1},[R.value!==void 0?(b(),x("img",we({key:0},a(le),{src:R.value,loading:e.loading,style:a(K),class:a(H),crossorigin:e.crossorigin,onClick:J,onLoad:X,onError:re}),null,16,["src","loading","crossorigin"])):E("v-if",!0),S.value?(b(),x("div",{key:1,class:m(a(g).e("wrapper"))},[ae(e.$slots,"placeholder",{},()=>[h("div",{class:m(a(g).e("placeholder"))},null,2)])],2)):E("v-if",!0)],64)),a(Y)?(b(),x(te,{key:2},[C.value?(b(),fe(a(ca),{key:0,"z-index":e.zIndex,"initial-index":a(oe),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:j,onSwitch:ee},{default:I(()=>[e.$slots.viewer?(b(),x("div",{key:0},[ae(e.$slots,"viewer")])):E("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):E("v-if",!0)],64)):E("v-if",!0)],16))}});var ma=Ce(va,[["__file","image.vue"]]);const wa=Le(ma);export{wa as E};
